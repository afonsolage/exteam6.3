; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

	TITLE	D:\Projects\ExTeam6.3\Source\GameServer\GameServer\PlayerConnect.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	??_H@YGXPAXIHP6EPAX0@Z@Z			; `vector constructor iterator'
; Function compile flags: /Odtp /ZI
;	COMDAT ??_H@YGXPAXIHP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIHP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
$LN2@vector:
  00009	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  0000c	83 e8 01	 sub	 eax, 1
  0000f	89 45 10	 mov	 DWORD PTR ___n$[ebp], eax
  00012	78 11		 js	 SHORT $LN3@vector
  00014	8b 4d 08	 mov	 ecx, DWORD PTR ___t$[ebp]
  00017	ff 55 14	 call	 DWORD PTR ___f$[ebp]
  0001a	8b 45 08	 mov	 eax, DWORD PTR ___t$[ebp]
  0001d	03 45 0c	 add	 eax, DWORD PTR ___s$[ebp]
  00020	89 45 08	 mov	 DWORD PTR ___t$[ebp], eax
  00023	eb e4		 jmp	 SHORT $LN2@vector
$LN3@vector:
  00025	5f		 pop	 edi
  00026	5e		 pop	 esi
  00027	5b		 pop	 ebx
  00028	8b e5		 mov	 esp, ebp
  0002a	5d		 pop	 ebp
  0002b	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIHP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
PUBLIC	??_C@_0M@HEPEADLP@?$FL?$CFs?$FN?3Online?$AA@	; `string'
PUBLIC	??_C@_08IJKOBABM@?$FLSystem?$FN?$AA@		; `string'
PUBLIC	??_C@_09EFMLPCOM@?$CFs?5Online?$AA@		; `string'
PUBLIC	?ExPlayerConnectSystem@@YAXH@Z			; ExPlayerConnectSystem
EXTRN	?MsgNormal@@YAXHPADZZ:PROC			; MsgNormal
EXTRN	?GetText@CExText@@QAEPADH@Z:PROC		; CExText::GetText
EXTRN	?g_ExText@@3VCExText@@A:BYTE			; g_ExText
EXTRN	?getShowOnline@@YAHXZ:PROC			; getShowOnline
EXTRN	?MessaageAllGlobal@@YAXPADZZ:PROC		; MessaageAllGlobal
EXTRN	?CheckAuthorityCondition@@YA_NHPAUOBJECTSTRUCT@@@Z:PROC ; CheckAuthorityCondition
EXTRN	?MessageSendAllEx@@YAXHPAD0ZZ:PROC		; MessageSendAllEx
EXTRN	?ExConfig@@3VcExConfigs@@A:BYTE			; ExConfig
EXTRN	?CheckUser@CExLicense@@QAE_NH@Z:PROC		; CExLicense::CheckUser
EXTRN	?g_ExLicense@@3VCExLicense@@A:BYTE		; g_ExLicense
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
;	COMDAT ??_C@_0M@HEPEADLP@?$FL?$CFs?$FN?3Online?$AA@
; File d:\projects\exteam6.3\source\gameserver\gameserver\playerconnect.cpp
CONST	SEGMENT
??_C@_0M@HEPEADLP@?$FL?$CFs?$FN?3Online?$AA@ DB '[%s]:Online', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_08IJKOBABM@?$FLSystem?$FN?$AA@
CONST	SEGMENT
??_C@_08IJKOBABM@?$FLSystem?$FN?$AA@ DB '[System]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_09EFMLPCOM@?$CFs?5Online?$AA@
CONST	SEGMENT
??_C@_09EFMLPCOM@?$CFs?5Online?$AA@ DB '%s Online', 00H	; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_lpObj$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?ExPlayerConnectSystem@@YAXH@Z PROC			; ExPlayerConnectSystem

; 15   : {	

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 16   : 	LPOBJ lpObj = &gObj[aIndex];

  00009	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0000c	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00012	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00018	89 45 fc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 17   : 	if(lpObj->MapNumber == 10){
; 18   : 	
; 19   : 	}
; 20   : 
; 21   : #ifdef TWO_IP_CONNECT_OFF
; 22   : 	if(g_ExLicense.CheckUser(eExUB::ulasevich) || g_ExLicense.CheckUser(eExUB::Local) || g_ExLicense.CheckUser(eExUB::ulasevich2))
; 23   : 	{
; 24   : 		int CountIpAddress;
; 25   : 		CountIpAddress = 0;
; 26   : 		for ( int n = OBJ_STARTUSERINDEX ; n < OBJMAX ; n++)
; 27   : 		{
; 28   : 				if ( gObj[n].Type == OBJ_USER && gObj[n].Connected == PLAYER_PLAYING )
; 29   : 				{
; 30   : 					if (lpObj->m_Index == gObj[n].m_Index)
; 31   : 					{
; 32   : 						continue;
; 33   : 					}
; 34   : 						if(!strcmp(lpObj->Ip_addr, gObj[n].Ip_addr))
; 35   : 						{
; 36   : 							CountIpAddress++;
; 37   : 								
; 38   : 						}
; 39   : 						
; 40   : 				}
; 41   : 		}
; 42   : 		if(CountIpAddress >= 2)
; 43   : 		{
; 44   : 			g_ConnectEx.SendClose(aIndex, NORM_DC);
; 45   : 			return;
; 46   : 		}
; 47   : 			
; 48   : 	}
; 49   : #endif
; 50   : 
; 51   : 	if(g_ExLicense.CheckUser(eExUB::ulasevich) || g_ExLicense.CheckUser(eExUB::Local3) || g_ExLicense.CheckUser(eExUB::ulasevich2))

  0001b	6a 17		 push	 23			; 00000017H
  0001d	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ExLicense@@3VCExLicense@@A ; g_ExLicense
  00022	e8 00 00 00 00	 call	 ?CheckUser@CExLicense@@QAE_NH@Z ; CExLicense::CheckUser
  00027	0f b6 c0	 movzx	 eax, al
  0002a	85 c0		 test	 eax, eax
  0002c	75 26		 jne	 SHORT $LN8@ExPlayerCo
  0002e	6a 1c		 push	 28			; 0000001cH
  00030	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ExLicense@@3VCExLicense@@A ; g_ExLicense
  00035	e8 00 00 00 00	 call	 ?CheckUser@CExLicense@@QAE_NH@Z ; CExLicense::CheckUser
  0003a	0f b6 c0	 movzx	 eax, al
  0003d	85 c0		 test	 eax, eax
  0003f	75 13		 jne	 SHORT $LN8@ExPlayerCo
  00041	6a 24		 push	 36			; 00000024H
  00043	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ExLicense@@3VCExLicense@@A ; g_ExLicense
  00048	e8 00 00 00 00	 call	 ?CheckUser@CExLicense@@QAE_NH@Z ; CExLicense::CheckUser
  0004d	0f b6 c0	 movzx	 eax, al
  00050	85 c0		 test	 eax, eax
  00052	74 5c		 je	 SHORT $LN9@ExPlayerCo
$LN8@ExPlayerCo:

; 52   : 	{
; 53   : 		if(ExConfig.PlayerConnect.ShowNameAll == 1)

  00054	83 3d ec 09 00
	00 01		 cmp	 DWORD PTR ?ExConfig@@3VcExConfigs@@A+2540, 1
  0005b	75 20		 jne	 SHORT $LN7@ExPlayerCo

; 54   : 		{
; 55   : 			MessageSendAllEx(ExConfig.PlayerConnect.ShowNameColor,"[System]", "%s Online" , lpObj->Name);

  0005d	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00060	83 c0 77	 add	 eax, 119		; 00000077H
  00063	50		 push	 eax
  00064	68 00 00 00 00	 push	 OFFSET ??_C@_09EFMLPCOM@?$CFs?5Online?$AA@
  00069	68 00 00 00 00	 push	 OFFSET ??_C@_08IJKOBABM@?$FLSystem?$FN?$AA@
  0006e	8b 0d f0 09 00
	00		 mov	 ecx, DWORD PTR ?ExConfig@@3VcExConfigs@@A+2544
  00074	51		 push	 ecx
  00075	e8 00 00 00 00	 call	 ?MessageSendAllEx@@YAXHPAD0ZZ ; MessageSendAllEx
  0007a	83 c4 10	 add	 esp, 16			; 00000010H
$LN7@ExPlayerCo:

; 56   : 		}
; 57   : 		if ( CheckAuthorityCondition(98, lpObj) == true) //season4 changed

  0007d	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00080	50		 push	 eax
  00081	6a 62		 push	 98			; 00000062H
  00083	e8 00 00 00 00	 call	 ?CheckAuthorityCondition@@YA_NHPAUOBJECTSTRUCT@@@Z ; CheckAuthorityCondition
  00088	83 c4 08	 add	 esp, 8
  0008b	0f b6 c8	 movzx	 ecx, al
  0008e	83 f9 01	 cmp	 ecx, 1
  00091	75 1d		 jne	 SHORT $LN9@ExPlayerCo

; 58   : 		{
; 59   : 			if(ExConfig.PlayerConnect.ShowGMAll == 1)

  00093	83 3d f4 09 00
	00 01		 cmp	 DWORD PTR ?ExConfig@@3VcExConfigs@@A+2548, 1
  0009a	75 14		 jne	 SHORT $LN9@ExPlayerCo

; 60   : 			{
; 61   : 				MessaageAllGlobal("[%s]:Online", lpObj->Name);

  0009c	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0009f	83 c0 77	 add	 eax, 119		; 00000077H
  000a2	50		 push	 eax
  000a3	68 00 00 00 00	 push	 OFFSET ??_C@_0M@HEPEADLP@?$FL?$CFs?$FN?3Online?$AA@
  000a8	e8 00 00 00 00	 call	 ?MessaageAllGlobal@@YAXPADZZ ; MessaageAllGlobal
  000ad	83 c4 08	 add	 esp, 8
$LN9@ExPlayerCo:

; 62   : 			}
; 63   : 		}
; 64   : 	}
; 65   : 	if(!ExConfig.PlayerConnect.EnablePlayerConnectSystem)

  000b0	83 3d dc 09 00
	00 00		 cmp	 DWORD PTR ?ExConfig@@3VcExConfigs@@A+2524, 0
  000b7	75 05		 jne	 SHORT $LN4@ExPlayerCo

; 66   : 		return;

  000b9	e9 80 00 00 00	 jmp	 $LN11@ExPlayerCo
$LN4@ExPlayerCo:

; 67   : 
; 68   : #ifdef _UPDATE8_
; 69   : 	if(ExConfig.PlayerConnect.ShowOnline)	MsgNormal(aIndex, g_ExText.GetText(2), getShowOnline());

  000be	83 3d e8 09 00
	00 00		 cmp	 DWORD PTR ?ExConfig@@3VcExConfigs@@A+2536, 0
  000c5	74 1f		 je	 SHORT $LN3@ExPlayerCo
  000c7	e8 00 00 00 00	 call	 ?getShowOnline@@YAHXZ	; getShowOnline
  000cc	50		 push	 eax
  000cd	6a 02		 push	 2
  000cf	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ExText@@3VCExText@@A ; g_ExText
  000d4	e8 00 00 00 00	 call	 ?GetText@CExText@@QAEPADH@Z ; CExText::GetText
  000d9	50		 push	 eax
  000da	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  000dd	50		 push	 eax
  000de	e8 00 00 00 00	 call	 ?MsgNormal@@YAXHPADZZ	; MsgNormal
  000e3	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN3@ExPlayerCo:

; 70   : #endif
; 71   : 	if(ExConfig.PlayerConnect.ShowReset) MsgNormal(aIndex, g_ExText.GetText(0), lpObj->Reset);

  000e6	83 3d e0 09 00
	00 00		 cmp	 DWORD PTR ?ExConfig@@3VcExConfigs@@A+2528, 0
  000ed	74 23		 je	 SHORT $LN2@ExPlayerCo
  000ef	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  000f2	8b 88 90 22 00
	00		 mov	 ecx, DWORD PTR [eax+8848]
  000f8	51		 push	 ecx
  000f9	6a 00		 push	 0
  000fb	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ExText@@3VCExText@@A ; g_ExText
  00100	e8 00 00 00 00	 call	 ?GetText@CExText@@QAEPADH@Z ; CExText::GetText
  00105	50		 push	 eax
  00106	8b 55 08	 mov	 edx, DWORD PTR _aIndex$[ebp]
  00109	52		 push	 edx
  0010a	e8 00 00 00 00	 call	 ?MsgNormal@@YAXHPADZZ	; MsgNormal
  0010f	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN2@ExPlayerCo:

; 72   : 	if(ExConfig.PlayerConnect.ShowGReset) MsgNormal(aIndex, g_ExText.GetText(1), lpObj->GReset);

  00112	83 3d e4 09 00
	00 00		 cmp	 DWORD PTR ?ExConfig@@3VcExConfigs@@A+2532, 0
  00119	74 23		 je	 SHORT $LN11@ExPlayerCo
  0011b	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0011e	8b 88 94 22 00
	00		 mov	 ecx, DWORD PTR [eax+8852]
  00124	51		 push	 ecx
  00125	6a 01		 push	 1
  00127	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_ExText@@3VCExText@@A ; g_ExText
  0012c	e8 00 00 00 00	 call	 ?GetText@CExText@@QAEPADH@Z ; CExText::GetText
  00131	50		 push	 eax
  00132	8b 55 08	 mov	 edx, DWORD PTR _aIndex$[ebp]
  00135	52		 push	 edx
  00136	e8 00 00 00 00	 call	 ?MsgNormal@@YAXHPADZZ	; MsgNormal
  0013b	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN11@ExPlayerCo:

; 73   : }

  0013e	5f		 pop	 edi
  0013f	5e		 pop	 esi
  00140	5b		 pop	 ebx
  00141	8b e5		 mov	 esp, ebp
  00143	5d		 pop	 ebp
  00144	c3		 ret	 0
?ExPlayerConnectSystem@@YAXH@Z ENDP			; ExPlayerConnectSystem
_TEXT	ENDS
END
