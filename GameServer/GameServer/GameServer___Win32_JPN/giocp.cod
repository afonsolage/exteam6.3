; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

	TITLE	D:\Projects\ExTeam6.3\Source\GameServer\GameServer\giocp.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?SOCKET_FLAG@@3W4<unnamed-type-SOCKET_FLAG>@@A	; SOCKET_FLAG
PUBLIC	?g_CompletionPort@@3PAXA			; g_CompletionPort
PUBLIC	?g_dwThreadCount@@3KA				; g_dwThreadCount
PUBLIC	?criti@@3U_RTL_CRITICAL_SECTION@@A		; criti
PUBLIC	?g_ThreadHandles@@3PAPAXA			; g_ThreadHandles
PUBLIC	?g_ServerPort@@3HA				; g_ServerPort
PUBLIC	?g_IocpThreadHandle@@3PAXA			; g_IocpThreadHandle
PUBLIC	?ExSendBuf@@3PAEA				; ExSendBuf
PUBLIC	?g_Listen@@3IA					; g_Listen
PUBLIC	?dwDebugDataSendSize@@3KA			; dwDebugDataSendSize
_BSS	SEGMENT
?SOCKET_FLAG@@3W4<unnamed-type-SOCKET_FLAG>@@A DD 01H DUP (?) ; SOCKET_FLAG
?g_CompletionPort@@3PAXA DD 01H DUP (?)			; g_CompletionPort
?g_dwThreadCount@@3KA DD 01H DUP (?)			; g_dwThreadCount
?criti@@3U_RTL_CRITICAL_SECTION@@A DB 018H DUP (?)	; criti
?g_ThreadHandles@@3PAPAXA DD 064H DUP (?)		; g_ThreadHandles
?g_ServerPort@@3HA DD 01H DUP (?)			; g_ServerPort
?g_IocpThreadHandle@@3PAXA DD 01H DUP (?)		; g_IocpThreadHandle
?ExSendBuf@@3PAEA DD 01H DUP (?)			; ExSendBuf
?dwDebugDataSendSize@@3KA DD 01H DUP (?)		; dwDebugDataSendSize
_BSS	ENDS
_DATA	SEGMENT
_g_iNpcUpDfLevel_CGATE DD 01H
	DD	02H
	DD	02dc6c0H
	DD	02H
	DD	03H
	DD	02dc6c0H
	DD	03H
	DD	04H
	DD	02dc6c0H
_g_iNpcUpDfLevel_CSTATUE DD 01H
	DD	03H
	DD	02dc6c0H
	DD	02H
	DD	05H
	DD	02dc6c0H
	DD	03H
	DD	07H
	DD	02dc6c0H
_g_iNpcUpMaxHP_CGATE DD 02625a0H
	DD	02H
	DD	0f4240H
	DD	03567e0H
	DD	03H
	DD	0f4240H
	DD	04f5880H
	DD	04H
	DD	0f4240H
_g_iNpcUpMaxHP_CSTATUE DD 02191c0H
	DD	03H
	DD	0f4240H
	DD	033e140H
	DD	05H
	DD	0f4240H
	DD	04c4b40H
	DD	07H
	DD	0f4240H
_g_iNpcUpRgLevel_CSTATUE DD 01H
	DD	03H
	DD	04c4b40H
	DD	02H
	DD	05H
	DD	04c4b40H
	DD	03H
	DD	07H
	DD	04c4b40H
_g_iCsUserReSpawnArea DD 023H
	DD	011H
	DD	090H
	DD	030H
	DD	04aH
	DD	090H
	DD	073H
	DD	09aH
	DD	023H
	DD	011H
	DD	090H
	DD	030H
_g_iNpcDefense_CGATE DD 064H
	DD	0b4H
	DD	012cH
	DD	0208H
_g_iNpcDefense_CSTATUE DD 050H
	DD	0b4H
	DD	0154H
	DD	0226H
_g_iCastleWallStepAxisY DD 071H
	DD	0a0H
	DD	0cbH
?g_Listen@@3IA DD 0ffffffffH				; g_Listen
_DATA	ENDS
PUBLIC	??_H@YGXPAXIHP6EPAX0@Z@Z			; `vector constructor iterator'
; Function compile flags: /Odtp /ZI
;	COMDAT ??_H@YGXPAXIHP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIHP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
$LN2@vector:
  00009	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  0000c	83 e8 01	 sub	 eax, 1
  0000f	89 45 10	 mov	 DWORD PTR ___n$[ebp], eax
  00012	78 11		 js	 SHORT $LN3@vector
  00014	8b 4d 08	 mov	 ecx, DWORD PTR ___t$[ebp]
  00017	ff 55 14	 call	 DWORD PTR ___f$[ebp]
  0001a	8b 45 08	 mov	 eax, DWORD PTR ___t$[ebp]
  0001d	03 45 0c	 add	 eax, DWORD PTR ___s$[ebp]
  00020	89 45 08	 mov	 DWORD PTR ___t$[ebp], eax
  00023	eb e4		 jmp	 SHORT $LN2@vector
$LN3@vector:
  00025	5f		 pop	 edi
  00026	5e		 pop	 esi
  00027	5b		 pop	 ebx
  00028	8b e5		 mov	 esp, ebp
  0002a	5d		 pop	 ebp
  0002b	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIHP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
PUBLIC	?GiocpInit@@YAXXZ				; GiocpInit
EXTRN	??_U@YAPAXI@Z:PROC				; operator new[]
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\giocp.cpp
_TEXT	SEGMENT
$T230778 = -68						; size = 4
?GiocpInit@@YAXXZ PROC					; GiocpInit

; 69   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 70   : 	ExSendBuf=new BYTE[MAX_EXSENDBUF_SIZE];

  00009	68 ff 7f 00 00	 push	 32767			; 00007fffH
  0000e	e8 00 00 00 00	 call	 ??_U@YAPAXI@Z		; operator new[]
  00013	83 c4 04	 add	 esp, 4
  00016	89 45 bc	 mov	 DWORD PTR $T230778[ebp], eax
  00019	8b 45 bc	 mov	 eax, DWORD PTR $T230778[ebp]
  0001c	a3 00 00 00 00	 mov	 DWORD PTR ?ExSendBuf@@3PAEA, eax ; ExSendBuf

; 71   : }

  00021	5f		 pop	 edi
  00022	5e		 pop	 esi
  00023	5b		 pop	 ebx
  00024	8b e5		 mov	 esp, ebp
  00026	5d		 pop	 ebp
  00027	c3		 ret	 0
?GiocpInit@@YAXXZ ENDP					; GiocpInit
_TEXT	ENDS
PUBLIC	?GiocpDelete@@YAXXZ				; GiocpDelete
EXTRN	??_V@YAXPAX@Z:PROC				; operator delete[]
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
$T230780 = -68						; size = 4
?GiocpDelete@@YAXXZ PROC				; GiocpDelete

; 74   : {

  00030	55		 push	 ebp
  00031	8b ec		 mov	 ebp, esp
  00033	83 ec 44	 sub	 esp, 68			; 00000044H
  00036	53		 push	 ebx
  00037	56		 push	 esi
  00038	57		 push	 edi

; 75   : 	delete[] ExSendBuf;

  00039	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  0003e	89 45 bc	 mov	 DWORD PTR $T230780[ebp], eax
  00041	8b 4d bc	 mov	 ecx, DWORD PTR $T230780[ebp]
  00044	51		 push	 ecx
  00045	e8 00 00 00 00	 call	 ??_V@YAXPAX@Z		; operator delete[]
  0004a	83 c4 04	 add	 esp, 4

; 76   : }

  0004d	5f		 pop	 edi
  0004e	5e		 pop	 esi
  0004f	5b		 pop	 ebx
  00050	8b e5		 mov	 esp, ebp
  00052	5d		 pop	 ebp
  00053	c3		 ret	 0
?GiocpDelete@@YAXXZ ENDP				; GiocpDelete
_TEXT	ENDS
PUBLIC	??_C@_0FI@JLMDBNFF@?$FLHACKTOOL?$FN?5?3?5Packets?5Per?5Second?5@ ; `string'
PUBLIC	??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@ ; `string'
PUBLIC	?__LINE__Var@?1??HackToolCheck@@YAHEHHE@Z@4JA	; `HackToolCheck'::`2'::__LINE__Var
PUBLIC	?HackToolCheck@@YAHEHHE@Z			; HackToolCheck
EXTRN	?IncreasePacketCount@CHackToolPacket@@QAEXEK@Z:PROC ; CHackToolPacket::IncreasePacketCount
EXTRN	?LogAddC@@3P6AXEPADZZA:DWORD			; LogAddC
EXTRN	?CheckPacketCount@CHackToolPacket@@QAEHXZ:PROC	; CHackToolPacket::CheckPacketCount
EXTRN	?GetState@CHackToolPacket@@QAEXPAHPAK1@Z:PROC	; CHackToolPacket::GetState
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
;	COMDAT ??_C@_0FI@JLMDBNFF@?$FLHACKTOOL?$FN?5?3?5Packets?5Per?5Second?5@
CONST	SEGMENT
??_C@_0FI@JLMDBNFF@?$FLHACKTOOL?$FN?5?3?5Packets?5Per?5Second?5@ DB '[HAC'
	DB	'KTOOL] : Packets Per Second = %dip = %s account:%s name:%s HE'
	DB	'AD:%x (%s,%d) State:%d', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
CONST	SEGMENT
??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@ DB 'd:\project'
	DB	's\exteam6.3\source\gameserver\gameserver\giocp.cpp', 00H ; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?1??HackToolCheck@@YAHEHHE@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?1??HackToolCheck@@YAHEHHE@Z@4JA DD 04fH	; `HackToolCheck'::`2'::__LINE__Var
; Function compile flags: /Odtp /ZI
_DATA	ENDS
_TEXT	SEGMENT
tv67 = -80						; size = 4
tv150 = -77						; size = 1
_loc3$ = -12						; size = 4
_loc2$ = -8						; size = 4
_PacketCount$ = -4					; size = 4
_headcode$ = 8						; size = 1
_size$ = 12						; size = 4
_uIndex$ = 16						; size = 4
_xcode$ = 20						; size = 1
?HackToolCheck@@YAHEHHE@Z PROC				; HackToolCheck

; 79   : {

  00060	55		 push	 ebp
  00061	8b ec		 mov	 ebp, esp
  00063	83 ec 50	 sub	 esp, 80			; 00000050H
  00066	53		 push	 ebx
  00067	56		 push	 esi
  00068	57		 push	 edi

; 80   : 	int PacketCount;
; 81   : 	DWORD loc2, loc3;
; 82   : 
; 83   : 	if(OBJMAX_RANGE(uIndex) != FALSE)

  00069	83 7d 10 00	 cmp	 DWORD PTR _uIndex$[ebp], 0
  0006d	7d 09		 jge	 SHORT $LN7@HackToolCh
  0006f	c7 45 b0 00 00
	00 00		 mov	 DWORD PTR tv67[ebp], 0
  00076	eb 0f		 jmp	 SHORT $LN8@HackToolCh
$LN7@HackToolCh:
  00078	33 c0		 xor	 eax, eax
  0007a	81 7d 10 97 3a
	00 00		 cmp	 DWORD PTR _uIndex$[ebp], 14999 ; 00003a97H
  00081	0f 9e c0	 setle	 al
  00084	89 45 b0	 mov	 DWORD PTR tv67[ebp], eax
$LN8@HackToolCh:
  00087	83 7d b0 00	 cmp	 DWORD PTR tv67[ebp], 0
  0008b	0f 84 25 01 00
	00		 je	 $LN4@HackToolCh

; 84   : 	{
; 85   : 		gObj[uIndex].m_HackToolCheck.GetState(&PacketCount, &loc2, &loc3);

  00091	8d 45 f4	 lea	 eax, DWORD PTR _loc3$[ebp]
  00094	50		 push	 eax
  00095	8d 4d f8	 lea	 ecx, DWORD PTR _loc2$[ebp]
  00098	51		 push	 ecx
  00099	8d 55 fc	 lea	 edx, DWORD PTR _PacketCount$[ebp]
  0009c	52		 push	 edx
  0009d	8b 45 10	 mov	 eax, DWORD PTR _uIndex$[ebp]
  000a0	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  000a6	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  000ac	8d 8c 01 98 21
	00 00		 lea	 ecx, DWORD PTR [ecx+eax+8600]
  000b3	e8 00 00 00 00	 call	 ?GetState@CHackToolPacket@@QAEXPAHPAK1@Z ; CHackToolPacket::GetState

; 86   : 		gObj[uIndex].m_HackToolCheck.CheckPacketCount();

  000b8	8b 45 10	 mov	 eax, DWORD PTR _uIndex$[ebp]
  000bb	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  000c1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  000c7	8d 8c 01 98 21
	00 00		 lea	 ecx, DWORD PTR [ecx+eax+8600]
  000ce	e8 00 00 00 00	 call	 ?CheckPacketCount@CHackToolPacket@@QAEHXZ ; CHackToolPacket::CheckPacketCount

; 87   : 
; 88   : 		if(PacketCount > MAX_PACKET_SERVER)

  000d3	81 7d fc e8 03
	00 00		 cmp	 DWORD PTR _PacketCount$[ebp], 1000 ; 000003e8H
  000da	7e 7b		 jle	 SHORT $LN3@HackToolCh

; 89   : 		{
; 90   : 			LogAddC(2,"[HACKTOOL] : Packets Per Second = %dip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d", 
; 91   : 				PacketCount, gObj[uIndex].Ip_addr, gObj[uIndex].AccountID, gObj[uIndex].Name, headcode, __FILE__, __LINE__, 
; 92   : 				gObj[uIndex].Connected);

  000dc	8b 45 10	 mov	 eax, DWORD PTR _uIndex$[ebp]
  000df	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  000e5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  000eb	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  000ef	52		 push	 edx
  000f0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??HackToolCheck@@YAHEHHE@Z@4JA
  000f5	83 c0 0c	 add	 eax, 12			; 0000000cH
  000f8	50		 push	 eax
  000f9	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  000fe	0f b6 4d 08	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  00102	51		 push	 ecx
  00103	8b 55 10	 mov	 edx, DWORD PTR _uIndex$[ebp]
  00106	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  0010c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00111	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  00115	51		 push	 ecx
  00116	8b 55 10	 mov	 edx, DWORD PTR _uIndex$[ebp]
  00119	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  0011f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00124	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  00128	51		 push	 ecx
  00129	8b 55 10	 mov	 edx, DWORD PTR _uIndex$[ebp]
  0012c	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  00132	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00137	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  0013b	51		 push	 ecx
  0013c	8b 55 fc	 mov	 edx, DWORD PTR _PacketCount$[ebp]
  0013f	52		 push	 edx
  00140	68 00 00 00 00	 push	 OFFSET ??_C@_0FI@JLMDBNFF@?$FLHACKTOOL?$FN?5?3?5Packets?5Per?5Second?5@
  00145	6a 02		 push	 2
  00147	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  0014d	83 c4 28	 add	 esp, 40			; 00000028H

; 93   : 			return TRUE;

  00150	b8 01 00 00 00	 mov	 eax, 1
  00155	eb 61		 jmp	 SHORT $LN5@HackToolCh
$LN3@HackToolCh:

; 94   : 		}
; 95   : 		
; 96   : 		if(headcode == 0xC3 || headcode == 0xC8)

  00157	0f b6 45 08	 movzx	 eax, BYTE PTR _headcode$[ebp]
  0015b	3d c3 00 00 00	 cmp	 eax, 195		; 000000c3H
  00160	74 0b		 je	 SHORT $LN1@HackToolCh
  00162	0f b6 45 08	 movzx	 eax, BYTE PTR _headcode$[ebp]
  00166	3d c8 00 00 00	 cmp	 eax, 200		; 000000c8H
  0016b	75 04		 jne	 SHORT $LN2@HackToolCh
$LN1@HackToolCh:

; 97   : 		{
; 98   : 			return FALSE;

  0016d	33 c0		 xor	 eax, eax
  0016f	eb 47		 jmp	 SHORT $LN5@HackToolCh
$LN2@HackToolCh:

; 99   : 		}
; 100  : 
; 101  : 		gObj[uIndex].m_HackToolCheck.IncreasePacketCount(((xcode != 0xC3 && xcode != 0xC4)?(BYTE)(0x00):(BYTE)(0x01)), size);

  00171	0f b6 45 14	 movzx	 eax, BYTE PTR _xcode$[ebp]
  00175	3d c3 00 00 00	 cmp	 eax, 195		; 000000c3H
  0017a	74 12		 je	 SHORT $LN9@HackToolCh
  0017c	0f b6 4d 14	 movzx	 ecx, BYTE PTR _xcode$[ebp]
  00180	81 f9 c4 00 00
	00		 cmp	 ecx, 196		; 000000c4H
  00186	74 06		 je	 SHORT $LN9@HackToolCh
  00188	c6 45 b3 00	 mov	 BYTE PTR tv150[ebp], 0
  0018c	eb 04		 jmp	 SHORT $LN10@HackToolCh
$LN9@HackToolCh:
  0018e	c6 45 b3 01	 mov	 BYTE PTR tv150[ebp], 1
$LN10@HackToolCh:
  00192	8b 55 0c	 mov	 edx, DWORD PTR _size$[ebp]
  00195	52		 push	 edx
  00196	0f b6 45 b3	 movzx	 eax, BYTE PTR tv150[ebp]
  0019a	50		 push	 eax
  0019b	8b 4d 10	 mov	 ecx, DWORD PTR _uIndex$[ebp]
  0019e	69 c9 38 2b 00
	00		 imul	 ecx, 11064		; 00002b38H
  001a4	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  001aa	8d 8c 0a 98 21
	00 00		 lea	 ecx, DWORD PTR [edx+ecx+8600]
  001b1	e8 00 00 00 00	 call	 ?IncreasePacketCount@CHackToolPacket@@QAEXEK@Z ; CHackToolPacket::IncreasePacketCount
$LN4@HackToolCh:

; 102  : 	}
; 103  : 
; 104  : 	return FALSE;

  001b6	33 c0		 xor	 eax, eax
$LN5@HackToolCh:

; 105  : }

  001b8	5f		 pop	 edi
  001b9	5e		 pop	 esi
  001ba	5b		 pop	 ebx
  001bb	8b e5		 mov	 esp, ebp
  001bd	5d		 pop	 ebp
  001be	c3		 ret	 0
?HackToolCheck@@YAHEHHE@Z ENDP				; HackToolCheck
_TEXT	ENDS
PUBLIC	??_C@_0CE@HNFLFMJK@CreateThread?$CI?$CJ?5failed?5with?5error@ ; `string'
PUBLIC	?IocpServerWorker@@YGKPAX@Z			; IocpServerWorker
PUBLIC	?CreateGIocp@@YAHH@Z				; CreateGIocp
EXTRN	?LogAdd@@3P6AXPADZZA:DWORD			; LogAdd
EXTRN	__imp__GetLastError@0:PROC
EXTRN	__imp__CreateThread@24:PROC
;	COMDAT ??_C@_0CE@HNFLFMJK@CreateThread?$CI?$CJ?5failed?5with?5error@
CONST	SEGMENT
??_C@_0CE@HNFLFMJK@CreateThread?$CI?$CJ?5failed?5with?5error@ DB 'CreateT'
	DB	'hread() failed with error %d', 00H		; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_ThreadID$ = -4						; size = 4
_server_port$ = 8					; size = 4
?CreateGIocp@@YAHH@Z PROC				; CreateGIocp

; 169  : {

  001c0	55		 push	 ebp
  001c1	8b ec		 mov	 ebp, esp
  001c3	83 ec 44	 sub	 esp, 68			; 00000044H
  001c6	53		 push	 ebx
  001c7	56		 push	 esi
  001c8	57		 push	 edi

; 170  : 	DWORD	ThreadID;
; 171  : 	
; 172  : 	g_ServerPort = server_port;

  001c9	8b 45 08	 mov	 eax, DWORD PTR _server_port$[ebp]
  001cc	a3 00 00 00 00	 mov	 DWORD PTR ?g_ServerPort@@3HA, eax ; g_ServerPort

; 173  : 	if ((g_IocpThreadHandle = CreateThread(NULL, 0, IocpServerWorker, (LPVOID)NULL,
; 174  : 			0, &ThreadID)) == NULL)

  001d1	8d 45 fc	 lea	 eax, DWORD PTR _ThreadID$[ebp]
  001d4	50		 push	 eax
  001d5	6a 00		 push	 0
  001d7	6a 00		 push	 0
  001d9	68 00 00 00 00	 push	 OFFSET ?IocpServerWorker@@YGKPAX@Z ; IocpServerWorker
  001de	6a 00		 push	 0
  001e0	6a 00		 push	 0
  001e2	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CreateThread@24
  001e8	a3 00 00 00 00	 mov	 DWORD PTR ?g_IocpThreadHandle@@3PAXA, eax ; g_IocpThreadHandle
  001ed	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_IocpThreadHandle@@3PAXA, 0 ; g_IocpThreadHandle
  001f4	75 19		 jne	 SHORT $LN1@CreateGIoc

; 175  : 	{
; 176  : 		LogAdd("CreateThread() failed with error %d", GetLastError());

  001f6	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  001fc	50		 push	 eax
  001fd	68 00 00 00 00	 push	 OFFSET ??_C@_0CE@HNFLFMJK@CreateThread?$CI?$CJ?5failed?5with?5error@
  00202	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00208	83 c4 08	 add	 esp, 8

; 177  : 		return FALSE;

  0020b	33 c0		 xor	 eax, eax
  0020d	eb 05		 jmp	 SHORT $LN2@CreateGIoc
$LN1@CreateGIoc:

; 178  : 	}
; 179  : 
; 180  : #if(ENABLE_PROTOCOL_QUEUE)
; 181  : 	if(CreateServerQueue() == 0)
; 182  : 	{
; 183  : 		return 0;
; 184  : 	}
; 185  : #endif
; 186  : 
; 187  : 	return TRUE;

  0020f	b8 01 00 00 00	 mov	 eax, 1
$LN2@CreateGIoc:

; 188  : }

  00214	5f		 pop	 edi
  00215	5e		 pop	 esi
  00216	5b		 pop	 ebx
  00217	8b e5		 mov	 esp, ebp
  00219	5d		 pop	 ebp
  0021a	c3		 ret	 0
?CreateGIocp@@YAHH@Z ENDP				; CreateGIocp
_TEXT	ENDS
PUBLIC	??_C@_09HNKOADHB@Error?9L10?$AA@		; `string'
PUBLIC	?DestroyGIocp@@YAXXZ				; DestroyGIocp
EXTRN	__imp__CloseHandle@4:PROC
EXTRN	__imp__TerminateThread@8:PROC
EXTRN	__imp__closesocket@4:PROC
EXTRN	?LogAddTD@@3P6AXPADZZA:DWORD			; LogAddTD
;	COMDAT ??_C@_09HNKOADHB@Error?9L10?$AA@
CONST	SEGMENT
??_C@_09HNKOADHB@Error?9L10?$AA@ DB 'Error-L10', 00H	; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_dwCPU$230278 = -4					; size = 4
?DestroyGIocp@@YAXXZ PROC				; DestroyGIocp

; 191  : {

  00220	55		 push	 ebp
  00221	8b ec		 mov	 ebp, esp
  00223	83 ec 44	 sub	 esp, 68			; 00000044H
  00226	53		 push	 ebx
  00227	56		 push	 esi
  00228	57		 push	 edi

; 192  : 	LogAddTD("Error-L10");

  00229	68 00 00 00 00	 push	 OFFSET ??_C@_09HNKOADHB@Error?9L10?$AA@
  0022e	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00234	83 c4 04	 add	 esp, 4

; 193  : 
; 194  : 	closesocket(g_Listen);

  00237	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_Listen@@3IA ; g_Listen
  0023c	50		 push	 eax
  0023d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 195  : 
; 196  : 	for (DWORD dwCPU=0; dwCPU < g_dwThreadCount;dwCPU++ )

  00243	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _dwCPU$230278[ebp], 0
  0024a	eb 09		 jmp	 SHORT $LN4@DestroyGIo
$LN3@DestroyGIo:
  0024c	8b 45 fc	 mov	 eax, DWORD PTR _dwCPU$230278[ebp]
  0024f	83 c0 01	 add	 eax, 1
  00252	89 45 fc	 mov	 DWORD PTR _dwCPU$230278[ebp], eax
$LN4@DestroyGIo:
  00255	8b 45 fc	 mov	 eax, DWORD PTR _dwCPU$230278[ebp]
  00258	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_dwThreadCount@@3KA ; g_dwThreadCount
  0025e	73 15		 jae	 SHORT $LN2@DestroyGIo

; 197  : 	{
; 198  : 		TerminateThread( g_ThreadHandles[dwCPU] , 0);

  00260	6a 00		 push	 0
  00262	8b 45 fc	 mov	 eax, DWORD PTR _dwCPU$230278[ebp]
  00265	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?g_ThreadHandles@@3PAPAXA[eax*4]
  0026c	51		 push	 ecx
  0026d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__TerminateThread@8

; 199  : 	}

  00273	eb d7		 jmp	 SHORT $LN3@DestroyGIo
$LN2@DestroyGIo:

; 200  : 
; 201  : 	TerminateThread(g_IocpThreadHandle, 0);

  00275	6a 00		 push	 0
  00277	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_IocpThreadHandle@@3PAXA ; g_IocpThreadHandle
  0027c	50		 push	 eax
  0027d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__TerminateThread@8

; 202  : 
; 203  : 	if ( g_CompletionPort != NULL )

  00283	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_CompletionPort@@3PAXA, 0 ; g_CompletionPort
  0028a	74 16		 je	 SHORT $LN5@DestroyGIo

; 204  : 	{
; 205  : 		CloseHandle(g_CompletionPort);

  0028c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_CompletionPort@@3PAXA ; g_CompletionPort
  00291	50		 push	 eax
  00292	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CloseHandle@4

; 206  : 		g_CompletionPort=NULL;

  00298	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?g_CompletionPort@@3PAXA, 0 ; g_CompletionPort
$LN5@DestroyGIo:

; 207  : 	} 
; 208  : 	
; 209  : }

  002a2	5f		 pop	 edi
  002a3	5e		 pop	 esi
  002a4	5b		 pop	 ebx
  002a5	8b e5		 mov	 esp, ebp
  002a7	5d		 pop	 ebp
  002a8	c3		 ret	 0
?DestroyGIocp@@YAXXZ ENDP				; DestroyGIocp
_TEXT	ENDS
PUBLIC	??_C@_0BO@KHMIJPLC@listen?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@ ; `string'
PUBLIC	??_C@_0CB@MJLDDOOB@WSASocket?$CI?$CJ?5failed?5with?5error?5?$CFd@ ; `string'
PUBLIC	__$ArrayPad$
PUBLIC	?CreateListenSocket@@YAHXZ			; CreateListenSocket
EXTRN	__imp__listen@8:PROC
EXTRN	__imp__SendMessageA@16:PROC
EXTRN	?ghWnd@@3PAUHWND__@@A:DWORD			; ghWnd
EXTRN	?MsgBox@@YAXPADZZ:PROC				; MsgBox
EXTRN	?Get@CMsg@@QAEPADH@Z:PROC			; CMsg::Get
EXTRN	?lMsg@@3VCMsg@@A:BYTE				; lMsg
EXTRN	__imp__bind@12:PROC
EXTRN	__imp__htons@4:PROC
EXTRN	__imp__htonl@4:PROC
EXTRN	__imp__WSAGetLastError@0:PROC
EXTRN	__imp__WSASocketA@24:PROC
EXTRN	___security_cookie:DWORD
EXTRN	@__security_check_cookie@4:PROC
;	COMDAT ??_C@_0BO@KHMIJPLC@listen?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BO@KHMIJPLC@listen?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@ DB 'li'
	DB	'sten() failed with error %d', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0CB@MJLDDOOB@WSASocket?$CI?$CJ?5failed?5with?5error?5?$CFd@
CONST	SEGMENT
??_C@_0CB@MJLDDOOB@WSASocket?$CI?$CJ?5failed?5with?5error?5?$CFd@ DB 'WSA'
	DB	'Socket() failed with error %d', 00H		; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_nRet$ = -24						; size = 4
_InternetAddr$ = -20					; size = 16
__$ArrayPad$ = -4					; size = 4
?CreateListenSocket@@YAHXZ PROC				; CreateListenSocket

; 212  : {

  002b0	55		 push	 ebp
  002b1	8b ec		 mov	 ebp, esp
  002b3	83 ec 58	 sub	 esp, 88			; 00000058H
  002b6	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  002bb	33 c5		 xor	 eax, ebp
  002bd	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  002c0	53		 push	 ebx
  002c1	56		 push	 esi
  002c2	57		 push	 edi

; 213  : 	sockaddr_in InternetAddr;
; 214  : 	int nRet;
; 215  : 
; 216  : 	g_Listen=WSASocket(AF_INET, SOCK_STREAM, IPPROTO_IP, NULL, 0, WSA_FLAG_OVERLAPPED);

  002c3	6a 01		 push	 1
  002c5	6a 00		 push	 0
  002c7	6a 00		 push	 0
  002c9	6a 00		 push	 0
  002cb	6a 01		 push	 1
  002cd	6a 02		 push	 2
  002cf	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSASocketA@24
  002d5	a3 00 00 00 00	 mov	 DWORD PTR ?g_Listen@@3IA, eax ; g_Listen

; 217  : 
; 218  : 	if ( g_Listen == -1 )

  002da	83 3d 00 00 00
	00 ff		 cmp	 DWORD PTR ?g_Listen@@3IA, -1 ; g_Listen
  002e1	75 21		 jne	 SHORT $LN6@CreateList

; 219  : 	{
; 220  : 		LogAdd("WSASocket() failed with error %d", WSAGetLastError() );

  002e3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  002e9	50		 push	 eax
  002ea	68 00 00 00 00	 push	 OFFSET ??_C@_0CB@MJLDDOOB@WSASocket?$CI?$CJ?5failed?5with?5error?5?$CFd@
  002ef	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  002f5	83 c4 08	 add	 esp, 8

; 221  : 		return 0;

  002f8	33 c0		 xor	 eax, eax
  002fa	e9 ae 00 00 00	 jmp	 $LN7@CreateList

; 222  : 	}
; 223  : 	else

  002ff	e9 a9 00 00 00	 jmp	 $LN7@CreateList
$LN6@CreateList:

; 224  : 	{
; 225  : 		InternetAddr.sin_family=AF_INET;

  00304	b8 02 00 00 00	 mov	 eax, 2
  00309	66 89 45 ec	 mov	 WORD PTR _InternetAddr$[ebp], ax

; 226  : 		InternetAddr.sin_addr.S_un.S_addr=htonl(0);

  0030d	6a 00		 push	 0
  0030f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__htonl@4
  00315	89 45 f0	 mov	 DWORD PTR _InternetAddr$[ebp+4], eax

; 227  : 		InternetAddr.sin_port=htons(g_ServerPort);

  00318	0f b7 05 00 00
	00 00		 movzx	 eax, WORD PTR ?g_ServerPort@@3HA
  0031f	50		 push	 eax
  00320	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__htons@4
  00326	66 89 45 ee	 mov	 WORD PTR _InternetAddr$[ebp+2], ax

; 228  : 		nRet=bind(g_Listen, (sockaddr*)&InternetAddr, 16);

  0032a	6a 10		 push	 16			; 00000010H
  0032c	8d 45 ec	 lea	 eax, DWORD PTR _InternetAddr$[ebp]
  0032f	50		 push	 eax
  00330	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_Listen@@3IA ; g_Listen
  00336	51		 push	 ecx
  00337	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__bind@12
  0033d	89 45 e8	 mov	 DWORD PTR _nRet$[ebp], eax

; 229  : 		
; 230  : 		if ( nRet == -1 )

  00340	83 7d e8 ff	 cmp	 DWORD PTR _nRet$[ebp], -1
  00344	75 30		 jne	 SHORT $LN4@CreateList

; 231  : 		{
; 232  : 			MsgBox(lMsg.Get(MSGGET(2, 55)));

  00346	68 37 02 00 00	 push	 567			; 00000237H
  0034b	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  00350	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  00355	50		 push	 eax
  00356	e8 00 00 00 00	 call	 ?MsgBox@@YAXPADZZ	; MsgBox
  0035b	83 c4 04	 add	 esp, 4

; 233  : 			SendMessage(ghWnd, WM_CLOSE, 0,0);	// Kill aplication

  0035e	6a 00		 push	 0
  00360	6a 00		 push	 0
  00362	6a 10		 push	 16			; 00000010H
  00364	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ghWnd@@3PAUHWND__@@A ; ghWnd
  00369	50		 push	 eax
  0036a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SendMessageA@16

; 234  : 			return 0 ;

  00370	33 c0		 xor	 eax, eax
  00372	eb 39		 jmp	 SHORT $LN7@CreateList

; 235  : 		}
; 236  : 		else

  00374	eb 37		 jmp	 SHORT $LN7@CreateList
$LN4@CreateList:

; 237  : 		{
; 238  : 			nRet=listen(g_Listen, 5);

  00376	6a 05		 push	 5
  00378	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_Listen@@3IA ; g_Listen
  0037d	50		 push	 eax
  0037e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__listen@8
  00384	89 45 e8	 mov	 DWORD PTR _nRet$[ebp], eax

; 239  : 			if (nRet == -1)

  00387	83 7d e8 ff	 cmp	 DWORD PTR _nRet$[ebp], -1
  0038b	75 1b		 jne	 SHORT $LN2@CreateList

; 240  : 			{
; 241  : 				LogAdd("listen() failed with error %d", WSAGetLastError());

  0038d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  00393	50		 push	 eax
  00394	68 00 00 00 00	 push	 OFFSET ??_C@_0BO@KHMIJPLC@listen?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@
  00399	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  0039f	83 c4 08	 add	 esp, 8

; 242  : 				return 0;

  003a2	33 c0		 xor	 eax, eax
  003a4	eb 07		 jmp	 SHORT $LN7@CreateList

; 243  : 			}
; 244  : 			else

  003a6	eb 05		 jmp	 SHORT $LN7@CreateList
$LN2@CreateList:

; 245  : 			{
; 246  : 				return 1;

  003a8	b8 01 00 00 00	 mov	 eax, 1
$LN7@CreateList:

; 247  : 			}
; 248  : 		}
; 249  : 	} 
; 250  : }

  003ad	5f		 pop	 edi
  003ae	5e		 pop	 esi
  003af	5b		 pop	 ebx
  003b0	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  003b3	33 cd		 xor	 ecx, ebp
  003b5	e8 00 00 00 00	 call	 @__security_check_cookie@4
  003ba	8b e5		 mov	 esp, ebp
  003bc	5d		 pop	 ebp
  003bd	c3		 ret	 0
?CreateListenSocket@@YAHXZ ENDP				; CreateListenSocket
_TEXT	ENDS
PUBLIC	?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z	; CloseClient
PUBLIC	??_C@_0CK@FNPFENCA@error?9L1?5?3?5WSARecv?$CI?$CJ?5failed?5with@ ; `string'
PUBLIC	??_C@_0DA@CNIBOKAF@error?9L1?5?3?5?$CFd?5?$CFd?5gObjAdd?$CI?$CJ?5faile@ ; `string'
PUBLIC	??_C@_0DN@KCGEKGOM@error?9L1?5?3?5?$CFd?5?$CFd?5CreateIoComplet@ ; `string'
PUBLIC	?UpdateCompletionPort@@YAHIHH@Z			; UpdateCompletionPort
PUBLIC	??_C@_0BM@PFLJNKN@error?9L2?5?3?5ClientIndex?5?$DN?5?91?$AA@ ; `string'
PUBLIC	??_C@_0CB@CBCMIDPM@WSAAccept?$CI?$CJ?5failed?5with?5error?5?$CFd@ ; `string'
PUBLIC	?ServerWorkerThread@@YGKPAX@Z			; ServerWorkerThread
PUBLIC	??_C@_0CN@DNNAFBKA@CreateIoCompletionPort?5failed?5wi@ ; `string'
PUBLIC	__$ArrayPad$
EXTRN	__imp__PostQueuedCompletionStatus@16:PROC
EXTRN	?SCPJoinResultSend@@YAXHE@Z:PROC		; SCPJoinResultSend
EXTRN	__imp__WSARecv@28:PROC
EXTRN	_memset:PROC
EXTRN	?gObjAdd@@YAFIPADH@Z:PROC			; gObjAdd
EXTRN	?LogAddL@@3P6AXPADZZA:DWORD			; LogAddL
EXTRN	?gObjAddSearch@@YAFIPAD@Z:PROC			; gObjAddSearch
EXTRN	__imp__inet_ntoa@4:PROC
EXTRN	_memcpy:PROC
EXTRN	__imp__LeaveCriticalSection@4:PROC
EXTRN	__imp__EnterCriticalSection@4:PROC
EXTRN	__imp__WSAAccept@20:PROC
EXTRN	__imp__CreateIoCompletionPort@16:PROC
EXTRN	__imp__GetSystemInfo@4:PROC
EXTRN	__imp__InitializeCriticalSection@4:PROC
EXTRN	__except_handler4:PROC
;	COMDAT ??_C@_0CK@FNPFENCA@error?9L1?5?3?5WSARecv?$CI?$CJ?5failed?5with@
CONST	SEGMENT
??_C@_0CK@FNPFENCA@error?9L1?5?3?5WSARecv?$CI?$CJ?5failed?5with@ DB 'erro'
	DB	'r-L1 : WSARecv() failed with error %d', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0DA@CNIBOKAF@error?9L1?5?3?5?$CFd?5?$CFd?5gObjAdd?$CI?$CJ?5faile@
CONST	SEGMENT
??_C@_0DA@CNIBOKAF@error?9L1?5?3?5?$CFd?5?$CFd?5gObjAdd?$CI?$CJ?5faile@ DB 'e'
	DB	'rror-L1 : %d %d gObjAdd() failed with error %d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DN@KCGEKGOM@error?9L1?5?3?5?$CFd?5?$CFd?5CreateIoComplet@
CONST	SEGMENT
??_C@_0DN@KCGEKGOM@error?9L1?5?3?5?$CFd?5?$CFd?5CreateIoComplet@ DB 'erro'
	DB	'r-L1 : %d %d CreateIoCompletionPort failed with error %d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BM@PFLJNKN@error?9L2?5?3?5ClientIndex?5?$DN?5?91?$AA@
CONST	SEGMENT
??_C@_0BM@PFLJNKN@error?9L2?5?3?5ClientIndex?5?$DN?5?91?$AA@ DB 'error-L2'
	DB	' : ClientIndex = -1', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CB@CBCMIDPM@WSAAccept?$CI?$CJ?5failed?5with?5error?5?$CFd@
CONST	SEGMENT
??_C@_0CB@CBCMIDPM@WSAAccept?$CI?$CJ?5failed?5with?5error?5?$CFd@ DB 'WSA'
	DB	'Accept() failed with error %d', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0CN@DNNAFBKA@CreateIoCompletionPort?5failed?5wi@
CONST	SEGMENT
??_C@_0CN@DNNAFBKA@CreateIoCompletionPort?5failed?5wi@ DB 'CreateIoComple'
	DB	'tionPort failed with error: %d', 00H	; `string'
CONST	ENDS
xdata$x	SEGMENT
__sehtable$?IocpServerWorker@@YGKPAX@Z DD 0ffffffe4H
	DD	00H
	DD	0ffffff30H
	DD	00H
	DD	0fffffffeH
	DD	00H
	DD	FLAT:$LN24@IocpServer
; Function compile flags: /Odtp /ZI
xdata$x	ENDS
_TEXT	SEGMENT
_i$230339 = -128					; size = 4
_ThreadHandle$230319 = -124				; size = 4
_dwCPU$230315 = -120					; size = 4
_Flags$ = -116						; size = 4
_RecvBytes$ = -112					; size = 4
_lpPerSocketContext$ = -108				; size = 4
_cAddrlen$ = -104					; size = 4
_cInAddr$ = -100					; size = 4
_cAddr$ = -96						; size = 16
_ClientIndex$ = -80					; size = 4
_nRet$ = -76						; size = 4
_Accept$ = -72						; size = 4
_ThreadID$ = -68					; size = 4
_SystemInfo$ = -64					; size = 36
__$ArrayPad$ = -28					; size = 4
__$SEHRec$ = -24					; size = 24
_p$ = 8							; size = 4
?IocpServerWorker@@YGKPAX@Z PROC			; IocpServerWorker

; 253  : {

  003c0	55		 push	 ebp
  003c1	8b ec		 mov	 ebp, esp
  003c3	6a fe		 push	 -2			; fffffffeH
  003c5	68 00 00 00 00	 push	 OFFSET __sehtable$?IocpServerWorker@@YGKPAX@Z
  003ca	68 00 00 00 00	 push	 OFFSET __except_handler4
  003cf	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  003d5	50		 push	 eax
  003d6	81 c4 50 ff ff
	ff		 add	 esp, -176		; ffffff50H
  003dc	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  003e1	31 45 f8	 xor	 DWORD PTR __$SEHRec$[ebp+16], eax
  003e4	33 c5		 xor	 eax, ebp
  003e6	89 45 e4	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  003e9	53		 push	 ebx
  003ea	56		 push	 esi
  003eb	57		 push	 edi
  003ec	50		 push	 eax
  003ed	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  003f0	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax

; 254  : 	SYSTEM_INFO SystemInfo;
; 255  : 	DWORD ThreadID;
; 256  : 	SOCKET Accept;
; 257  : 	int nRet;
; 258  : 	int ClientIndex;
; 259  : 	SOCKADDR_IN cAddr;
; 260  : 	IN_ADDR		cInAddr;
; 261  : 	int			cAddrlen = sizeof( cAddr );

  003f6	c7 45 98 10 00
	00 00		 mov	 DWORD PTR _cAddrlen$[ebp], 16 ; 00000010H

; 262  : 	LPPER_SOCKET_CONTEXT lpPerSocketContext = NULL; 

  003fd	c7 45 94 00 00
	00 00		 mov	 DWORD PTR _lpPerSocketContext$[ebp], 0

; 263  : 	DWORD RecvBytes;
; 264  : 	DWORD Flags=0;

  00404	c7 45 8c 00 00
	00 00		 mov	 DWORD PTR _Flags$[ebp], 0

; 265  : 	
; 266  : 	InitializeCriticalSection(&criti);

  0040b	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00410	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__InitializeCriticalSection@4

; 267  : 	GetSystemInfo(&SystemInfo);

  00416	8d 45 c0	 lea	 eax, DWORD PTR _SystemInfo$[ebp]
  00419	50		 push	 eax
  0041a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetSystemInfo@4

; 268  : 
; 269  : 	g_dwThreadCount = SystemInfo.dwNumberOfProcessors * 2;

  00420	8b 45 d4	 mov	 eax, DWORD PTR _SystemInfo$[ebp+20]
  00423	d1 e0		 shl	 eax, 1
  00425	a3 00 00 00 00	 mov	 DWORD PTR ?g_dwThreadCount@@3KA, eax ; g_dwThreadCount

; 270  : 	__try

  0042a	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$SEHRec$[ebp+20], 0

; 271  : 	{
; 272  : 
; 273  : 		g_CompletionPort = CreateIoCompletionPort(INVALID_HANDLE_VALUE, NULL, 0, 0);

  00431	6a 00		 push	 0
  00433	6a 00		 push	 0
  00435	6a 00		 push	 0
  00437	6a ff		 push	 -1
  00439	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CreateIoCompletionPort@16
  0043f	a3 00 00 00 00	 mov	 DWORD PTR ?g_CompletionPort@@3PAXA, eax ; g_CompletionPort

; 274  : 		if ( g_CompletionPort == NULL)

  00444	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_CompletionPort@@3PAXA, 0 ; g_CompletionPort
  0044b	75 1a		 jne	 SHORT $LN19@IocpServer

; 275  : 		{
; 276  : 			LogAdd("CreateIoCompletionPort failed with error: %d", GetLastError());

  0044d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  00453	50		 push	 eax
  00454	68 00 00 00 00	 push	 OFFSET ??_C@_0CN@DNNAFBKA@CreateIoCompletionPort?5failed?5wi@
  00459	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  0045f	83 c4 08	 add	 esp, 8

; 277  : 			__leave;

  00462	e9 43 05 00 00	 jmp	 $LN20@IocpServer
$LN19@IocpServer:

; 278  : 		}
; 279  : 		
; 280  : 		for(DWORD dwCPU = 0; dwCPU < g_dwThreadCount; dwCPU++)

  00467	c7 45 88 00 00
	00 00		 mov	 DWORD PTR _dwCPU$230315[ebp], 0
  0046e	eb 09		 jmp	 SHORT $LN18@IocpServer
$LN17@IocpServer:
  00470	8b 45 88	 mov	 eax, DWORD PTR _dwCPU$230315[ebp]
  00473	83 c0 01	 add	 eax, 1
  00476	89 45 88	 mov	 DWORD PTR _dwCPU$230315[ebp], eax
$LN18@IocpServer:
  00479	8b 45 88	 mov	 eax, DWORD PTR _dwCPU$230315[ebp]
  0047c	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_dwThreadCount@@3KA ; g_dwThreadCount
  00482	73 58		 jae	 SHORT $LN16@IocpServer

; 281  : 		{
; 282  : 			HANDLE ThreadHandle;
; 283  : 			// Create a server worker thread and pass the completion port to the thread.
; 284  : 			
; 285  : 			ThreadHandle = CreateThread(NULL, 0, ServerWorkerThread, g_CompletionPort, 0, &ThreadID);

  00484	8d 45 bc	 lea	 eax, DWORD PTR _ThreadID$[ebp]
  00487	50		 push	 eax
  00488	6a 00		 push	 0
  0048a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_CompletionPort@@3PAXA ; g_CompletionPort
  00490	51		 push	 ecx
  00491	68 00 00 00 00	 push	 OFFSET ?ServerWorkerThread@@YGKPAX@Z ; ServerWorkerThread
  00496	6a 00		 push	 0
  00498	6a 00		 push	 0
  0049a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CreateThread@24
  004a0	89 45 84	 mov	 DWORD PTR _ThreadHandle$230319[ebp], eax

; 286  : 			if ( ThreadHandle == NULL)

  004a3	83 7d 84 00	 cmp	 DWORD PTR _ThreadHandle$230319[ebp], 0
  004a7	75 1a		 jne	 SHORT $LN15@IocpServer

; 287  : 			{
; 288  : 				LogAdd("CreateThread() failed with error %d", GetLastError());

  004a9	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  004af	50		 push	 eax
  004b0	68 00 00 00 00	 push	 OFFSET ??_C@_0CE@HNFLFMJK@CreateThread?$CI?$CJ?5failed?5with?5error@
  004b5	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  004bb	83 c4 08	 add	 esp, 8

; 289  : 				__leave;

  004be	e9 e7 04 00 00	 jmp	 $LN20@IocpServer
$LN15@IocpServer:

; 290  : 			}
; 291  : 			g_ThreadHandles[dwCPU] = ThreadHandle;

  004c3	8b 45 88	 mov	 eax, DWORD PTR _dwCPU$230315[ebp]
  004c6	8b 4d 84	 mov	 ecx, DWORD PTR _ThreadHandle$230319[ebp]
  004c9	89 0c 85 00 00
	00 00		 mov	 DWORD PTR ?g_ThreadHandles@@3PAPAXA[eax*4], ecx

; 292  : 			CloseHandle(ThreadHandle);

  004d0	8b 45 84	 mov	 eax, DWORD PTR _ThreadHandle$230319[ebp]
  004d3	50		 push	 eax
  004d4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CloseHandle@4

; 293  : 
; 294  : 		}

  004da	eb 94		 jmp	 SHORT $LN17@IocpServer
$LN16@IocpServer:

; 295  : 
; 296  : 		if (!CreateListenSocket() )

  004dc	e8 00 00 00 00	 call	 ?CreateListenSocket@@YAHXZ ; CreateListenSocket
  004e1	85 c0		 test	 eax, eax
  004e3	75 05		 jne	 SHORT $LN13@IocpServer

; 297  : 			__leave;

  004e5	e9 c0 04 00 00	 jmp	 $LN20@IocpServer
$LN13@IocpServer:

; 298  : 
; 299  : 		
; 300  : 		while(TRUE)		

  004ea	b8 01 00 00 00	 mov	 eax, 1
  004ef	85 c0		 test	 eax, eax
  004f1	0f 84 b3 04 00
	00		 je	 $LN20@IocpServer

; 301  : 		{
; 302  : 			Accept = WSAAccept(g_Listen, (LPSOCKADDR)&cAddr, &cAddrlen, NULL, 0);

  004f7	6a 00		 push	 0
  004f9	6a 00		 push	 0
  004fb	8d 45 98	 lea	 eax, DWORD PTR _cAddrlen$[ebp]
  004fe	50		 push	 eax
  004ff	8d 4d a0	 lea	 ecx, DWORD PTR _cAddr$[ebp]
  00502	51		 push	 ecx
  00503	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_Listen@@3IA ; g_Listen
  00509	52		 push	 edx
  0050a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAAccept@20
  00510	89 45 b8	 mov	 DWORD PTR _Accept$[ebp], eax

; 303  : 			if (Accept==SOCKET_ERROR)

  00513	83 7d b8 ff	 cmp	 DWORD PTR _Accept$[ebp], -1
  00517	75 2d		 jne	 SHORT $LN11@IocpServer

; 304  : 			{
; 305  : 				EnterCriticalSection(&criti);

  00519	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0051e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 306  : 				LogAdd("WSAAccept() failed with error %d", WSAGetLastError());

  00524	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  0052a	50		 push	 eax
  0052b	68 00 00 00 00	 push	 OFFSET ??_C@_0CB@CBCMIDPM@WSAAccept?$CI?$CJ?5failed?5with?5error?5?$CFd@
  00530	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00536	83 c4 08	 add	 esp, 8

; 307  : 				LeaveCriticalSection(&criti);

  00539	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0053e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 308  : 				continue;

  00544	eb a4		 jmp	 SHORT $LN13@IocpServer
$LN11@IocpServer:

; 309  : 			}
; 310  : 			EnterCriticalSection(&criti);

  00546	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0054b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 311  : 
; 312  : 			memcpy( &cInAddr, &cAddr.sin_addr.s_addr, 4 );

  00551	6a 04		 push	 4
  00553	8d 45 a4	 lea	 eax, DWORD PTR _cAddr$[ebp+4]
  00556	50		 push	 eax
  00557	8d 4d 9c	 lea	 ecx, DWORD PTR _cInAddr$[ebp]
  0055a	51		 push	 ecx
  0055b	e8 00 00 00 00	 call	 _memcpy
  00560	83 c4 0c	 add	 esp, 12			; 0000000cH

; 313  : 
; 314  : 			ClientIndex = gObjAddSearch(Accept, inet_ntoa(cInAddr) );

  00563	8b 45 9c	 mov	 eax, DWORD PTR _cInAddr$[ebp]
  00566	50		 push	 eax
  00567	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_ntoa@4
  0056d	50		 push	 eax
  0056e	8b 4d b8	 mov	 ecx, DWORD PTR _Accept$[ebp]
  00571	51		 push	 ecx
  00572	e8 00 00 00 00	 call	 ?gObjAddSearch@@YAFIPAD@Z ; gObjAddSearch
  00577	83 c4 08	 add	 esp, 8
  0057a	0f bf d0	 movsx	 edx, ax
  0057d	89 55 b0	 mov	 DWORD PTR _ClientIndex$[ebp], edx

; 315  : 			
; 316  : 			if ( ClientIndex == -1 )

  00580	83 7d b0 ff	 cmp	 DWORD PTR _ClientIndex$[ebp], -1
  00584	75 28		 jne	 SHORT $LN10@IocpServer

; 317  : 			{
; 318  : 				LogAddL("error-L2 : ClientIndex = -1");

  00586	68 00 00 00 00	 push	 OFFSET ??_C@_0BM@PFLJNKN@error?9L2?5?3?5ClientIndex?5?$DN?5?91?$AA@
  0058b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddL@@3P6AXPADZZA ; LogAddL
  00591	83 c4 04	 add	 esp, 4

; 319  : 				closesocket(Accept);

  00594	8b 45 b8	 mov	 eax, DWORD PTR _Accept$[ebp]
  00597	50		 push	 eax
  00598	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 320  : 				LeaveCriticalSection(&criti);

  0059e	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  005a3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 321  : 				continue;

  005a9	e9 3c ff ff ff	 jmp	 $LN13@IocpServer
$LN10@IocpServer:

; 322  : 			}
; 323  : 
; 324  : 			if (UpdateCompletionPort(Accept, ClientIndex, 1) == 0 )

  005ae	6a 01		 push	 1
  005b0	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  005b3	50		 push	 eax
  005b4	8b 4d b8	 mov	 ecx, DWORD PTR _Accept$[ebp]
  005b7	51		 push	 ecx
  005b8	e8 00 00 00 00	 call	 ?UpdateCompletionPort@@YAHIHH@Z ; UpdateCompletionPort
  005bd	83 c4 0c	 add	 esp, 12			; 0000000cH
  005c0	85 c0		 test	 eax, eax
  005c2	75 37		 jne	 SHORT $LN9@IocpServer

; 325  : 			{
; 326  : 				LogAddL("error-L1 : %d %d CreateIoCompletionPort failed with error %d", Accept, ClientIndex, GetLastError() );

  005c4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  005ca	50		 push	 eax
  005cb	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  005ce	50		 push	 eax
  005cf	8b 4d b8	 mov	 ecx, DWORD PTR _Accept$[ebp]
  005d2	51		 push	 ecx
  005d3	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@KCGEKGOM@error?9L1?5?3?5?$CFd?5?$CFd?5CreateIoComplet@
  005d8	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddL@@3P6AXPADZZA ; LogAddL
  005de	83 c4 10	 add	 esp, 16			; 00000010H

; 327  : 				closesocket(Accept);

  005e1	8b 45 b8	 mov	 eax, DWORD PTR _Accept$[ebp]
  005e4	50		 push	 eax
  005e5	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 328  : 				LeaveCriticalSection(&criti);

  005eb	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  005f0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 329  : 				continue;

  005f6	e9 ef fe ff ff	 jmp	 $LN13@IocpServer
$LN9@IocpServer:

; 330  : 			}
; 331  : 
; 332  : 			if (gObjAdd(Accept, inet_ntoa(cInAddr), ClientIndex) == -1 )

  005fb	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  005fe	50		 push	 eax
  005ff	8b 4d 9c	 mov	 ecx, DWORD PTR _cInAddr$[ebp]
  00602	51		 push	 ecx
  00603	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__inet_ntoa@4
  00609	50		 push	 eax
  0060a	8b 55 b8	 mov	 edx, DWORD PTR _Accept$[ebp]
  0060d	52		 push	 edx
  0060e	e8 00 00 00 00	 call	 ?gObjAdd@@YAFIPADH@Z	; gObjAdd
  00613	83 c4 0c	 add	 esp, 12			; 0000000cH
  00616	98		 cwde
  00617	83 f8 ff	 cmp	 eax, -1
  0061a	75 37		 jne	 SHORT $LN8@IocpServer

; 333  : 			{
; 334  : 				LogAddL("error-L1 : %d %d gObjAdd() failed with error %d", Accept, ClientIndex, GetLastError() );

  0061c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  00622	50		 push	 eax
  00623	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00626	50		 push	 eax
  00627	8b 4d b8	 mov	 ecx, DWORD PTR _Accept$[ebp]
  0062a	51		 push	 ecx
  0062b	68 00 00 00 00	 push	 OFFSET ??_C@_0DA@CNIBOKAF@error?9L1?5?3?5?$CFd?5?$CFd?5gObjAdd?$CI?$CJ?5faile@
  00630	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddL@@3P6AXPADZZA ; LogAddL
  00636	83 c4 10	 add	 esp, 16			; 00000010H

; 335  : 				LeaveCriticalSection(&criti);

  00639	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0063e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 336  : 				closesocket(Accept);

  00644	8b 45 b8	 mov	 eax, DWORD PTR _Accept$[ebp]
  00647	50		 push	 eax
  00648	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 337  : 				continue;

  0064e	e9 97 fe ff ff	 jmp	 $LN13@IocpServer
$LN8@IocpServer:

; 338  : 			}
; 339  : 				
; 340  : 			memset(&gObj[ClientIndex].PerSocketContext->IOContext[0].Overlapped, 0, sizeof(OVERLAPPED));

  00653	6a 14		 push	 20			; 00000014H
  00655	6a 00		 push	 0
  00657	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0065a	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00660	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00666	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0066a	83 c2 08	 add	 edx, 8
  0066d	52		 push	 edx
  0066e	e8 00 00 00 00	 call	 _memset
  00673	83 c4 0c	 add	 esp, 12			; 0000000cH

; 341  : 			memset(&gObj[ClientIndex].PerSocketContext->IOContext[1].Overlapped, 0, sizeof(OVERLAPPED));

  00676	6a 14		 push	 20			; 00000014H
  00678	6a 00		 push	 0
  0067a	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0067d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00683	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00689	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0068d	81 c2 38 00 02
	00		 add	 edx, 131128		; 00020038H
  00693	52		 push	 edx
  00694	e8 00 00 00 00	 call	 _memset
  00699	83 c4 0c	 add	 esp, 12			; 0000000cH

; 342  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].wsabuf.buf = gObj[ClientIndex].PerSocketContext->IOContext[0].Buffer;

  0069c	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0069f	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  006a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  006ab	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  006af	83 c2 24	 add	 edx, 36			; 00000024H
  006b2	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  006b5	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  006bb	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  006c1	8b 44 01 10	 mov	 eax, DWORD PTR [ecx+eax+16]
  006c5	89 50 20	 mov	 DWORD PTR [eax+32], edx

; 343  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].wsabuf.len = MAX_IO_BUFFER_SIZE;

  006c8	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  006cb	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  006d1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  006d7	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  006db	c7 42 1c ff ff
	00 00		 mov	 DWORD PTR [edx+28], 65535 ; 0000ffffH

; 344  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].nTotalBytes = 0;

  006e2	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  006e5	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  006eb	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  006f1	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  006f5	c7 82 28 00 02
	00 00 00 00 00	 mov	 DWORD PTR [edx+131112], 0

; 345  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].nSentBytes = 0;

  006ff	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00702	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00708	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0070e	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00712	c7 82 2c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [edx+131116], 0

; 346  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].nWaitIO    = 0;

  0071c	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0071f	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00725	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0072b	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0072f	c7 82 34 00 02
	00 00 00 00 00	 mov	 DWORD PTR [edx+131124], 0

; 347  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].nSecondOfs = 0;

  00739	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0073c	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00742	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00748	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0074c	c7 82 24 00 02
	00 00 00 00 00	 mov	 DWORD PTR [edx+131108], 0

; 348  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].IOOperation = RECV_IO;

  00756	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00759	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0075f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00765	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00769	c7 82 30 00 02
	00 00 00 00 00	 mov	 DWORD PTR [edx+131120], 0

; 349  : 			
; 350  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].wsabuf.buf = gObj[ClientIndex].PerSocketContext->IOContext[0].Buffer;

  00773	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00776	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0077c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00782	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00786	83 c2 24	 add	 edx, 36			; 00000024H
  00789	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0078c	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00792	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00798	8b 44 01 10	 mov	 eax, DWORD PTR [ecx+eax+16]
  0079c	89 90 50 00 02
	00		 mov	 DWORD PTR [eax+131152], edx

; 351  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].wsabuf.len = MAX_IO_BUFFER_SIZE;

  007a2	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  007a5	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  007ab	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  007b1	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  007b5	c7 82 4c 00 02
	00 ff ff 00 00	 mov	 DWORD PTR [edx+131148], 65535 ; 0000ffffH

; 352  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].nTotalBytes= 0;

  007bf	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  007c2	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  007c8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  007ce	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  007d2	c7 82 58 00 04
	00 00 00 00 00	 mov	 DWORD PTR [edx+262232], 0

; 353  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].nSentBytes = 0;

  007dc	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  007df	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  007e5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  007eb	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  007ef	c7 82 5c 00 04
	00 00 00 00 00	 mov	 DWORD PTR [edx+262236], 0

; 354  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].nWaitIO    = 0;

  007f9	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  007fc	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00802	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00808	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0080c	c7 82 64 00 04
	00 00 00 00 00	 mov	 DWORD PTR [edx+262244], 0

; 355  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].nSecondOfs = 0;

  00816	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00819	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0081f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00825	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00829	c7 82 54 00 04
	00 00 00 00 00	 mov	 DWORD PTR [edx+262228], 0

; 356  : 			gObj[ClientIndex].PerSocketContext->IOContext[1].IOOperation = SEND_IO;

  00833	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00836	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0083c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00842	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00846	c7 82 60 00 04
	00 01 00 00 00	 mov	 DWORD PTR [edx+262240], 1

; 357  : 			gObj[ClientIndex].PerSocketContext->m_socket = Accept;

  00850	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00853	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00859	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0085f	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00863	8b 45 b8	 mov	 eax, DWORD PTR _Accept$[ebp]
  00866	89 02		 mov	 DWORD PTR [edx], eax

; 358  : 			gObj[ClientIndex].PerSocketContext->nIndex   = ClientIndex;

  00868	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0086b	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00871	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00877	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0087b	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0087e	89 42 04	 mov	 DWORD PTR [edx+4], eax

; 359  : 
; 360  : 			nRet = WSARecv(Accept, &(gObj[ClientIndex].PerSocketContext->IOContext[0].wsabuf), 1, &RecvBytes, &Flags,
; 361  : 				&(gObj[ClientIndex].PerSocketContext->IOContext[0].Overlapped), NULL);

  00881	6a 00		 push	 0
  00883	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00886	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0088c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00892	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00896	83 c2 08	 add	 edx, 8
  00899	52		 push	 edx
  0089a	8d 45 8c	 lea	 eax, DWORD PTR _Flags$[ebp]
  0089d	50		 push	 eax
  0089e	8d 4d 90	 lea	 ecx, DWORD PTR _RecvBytes$[ebp]
  008a1	51		 push	 ecx
  008a2	6a 01		 push	 1
  008a4	8b 55 b0	 mov	 edx, DWORD PTR _ClientIndex$[ebp]
  008a7	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  008ad	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  008b2	8b 4c 10 10	 mov	 ecx, DWORD PTR [eax+edx+16]
  008b6	83 c1 1c	 add	 ecx, 28			; 0000001cH
  008b9	51		 push	 ecx
  008ba	8b 55 b8	 mov	 edx, DWORD PTR _Accept$[ebp]
  008bd	52		 push	 edx
  008be	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSARecv@28
  008c4	89 45 b4	 mov	 DWORD PTR _nRet$[ebp], eax

; 362  : 
; 363  : 			if( nRet == SOCKET_ERROR && WSAGetLastError() != ERROR_IO_PENDING )

  008c7	83 7d b4 ff	 cmp	 DWORD PTR _nRet$[ebp], -1
  008cb	75 6d		 jne	 SHORT $LN7@IocpServer
  008cd	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  008d3	3d e5 03 00 00	 cmp	 eax, 997		; 000003e5H
  008d8	74 60		 je	 SHORT $LN7@IocpServer

; 364  : 			{
; 365  : 				LogAdd("error-L1 : WSARecv() failed with error %d", WSAGetLastError());

  008da	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  008e0	50		 push	 eax
  008e1	68 00 00 00 00	 push	 OFFSET ??_C@_0CK@FNPFENCA@error?9L1?5?3?5WSARecv?$CI?$CJ?5failed?5with@
  008e6	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  008ec	83 c4 08	 add	 esp, 8

; 366  : 				//#if(!FIX_SOCKET_MAXBUFFER)
; 367  : 				gObj[ClientIndex].PerSocketContext->IOContext[0].nWaitIO = 4;

  008ef	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  008f2	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  008f8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  008fe	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00902	c7 82 34 00 02
	00 04 00 00 00	 mov	 DWORD PTR [edx+131124], 4

; 368  : 				//#endif
; 369  : 				CloseClient(gObj[ClientIndex].PerSocketContext, FALSE);

  0090c	6a 00		 push	 0
  0090e	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00911	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00917	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0091d	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00921	52		 push	 edx
  00922	e8 00 00 00 00	 call	 ?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z ; CloseClient
  00927	83 c4 08	 add	 esp, 8

; 370  : 				LeaveCriticalSection(&criti);

  0092a	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0092f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 371  : 				continue;

  00935	e9 b0 fb ff ff	 jmp	 $LN13@IocpServer
$LN7@IocpServer:

; 372  : 			}
; 373  : 
; 374  : 			//#if(!FIX_SOCKET_MAXBUFFER)
; 375  : 			gObj[ClientIndex].PerSocketContext->IOContext[0].nWaitIO = 1;

  0093a	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0093d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00943	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00949	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0094d	c7 82 34 00 02
	00 01 00 00 00	 mov	 DWORD PTR [edx+131124], 1

; 376  : 			//#endif
; 377  : 			gObj[ClientIndex].PerSocketContext->dwIOCount++;

  00957	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0095a	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00960	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00966	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0096a	8b 82 68 00 04
	00		 mov	 eax, DWORD PTR [edx+262248]
  00970	83 c0 01	 add	 eax, 1
  00973	8b 4d b0	 mov	 ecx, DWORD PTR _ClientIndex$[ebp]
  00976	69 c9 38 2b 00
	00		 imul	 ecx, 11064		; 00002b38H
  0097c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00982	8b 4c 0a 10	 mov	 ecx, DWORD PTR [edx+ecx+16]
  00986	89 81 68 00 04
	00		 mov	 DWORD PTR [ecx+262248], eax

; 378  : 
; 379  : 			LeaveCriticalSection(&criti);

  0098c	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00991	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 380  : 			SCPJoinResultSend(ClientIndex, 1);

  00997	6a 01		 push	 1
  00999	8b 45 b0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0099c	50		 push	 eax
  0099d	e8 00 00 00 00	 call	 ?SCPJoinResultSend@@YAXHE@Z ; SCPJoinResultSend
  009a2	83 c4 08	 add	 esp, 8

; 381  : 
; 382  : 		}

  009a5	e9 40 fb ff ff	 jmp	 $LN13@IocpServer
$LN20@IocpServer:

; 383  : 	}
; 384  : 	__finally  

  009aa	c7 45 fc fe ff
	ff ff		 mov	 DWORD PTR __$SEHRec$[ebp+20], -2 ; fffffffeH
  009b1	e8 02 00 00 00	 call	 $LN26@IocpServer
  009b6	eb 79		 jmp	 SHORT $LN27@IocpServer
$LN24@IocpServer:
$LN29@IocpServer:
$LN26@IocpServer:

; 385  : 	{
; 386  : 		if( g_CompletionPort )

  009b8	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_CompletionPort@@3PAXA, 0 ; g_CompletionPort
  009bf	74 31		 je	 SHORT $LN6@IocpServer

; 387  : 		{
; 388  : 			for (DWORD i = 0; i < g_dwThreadCount; i++) 

  009c1	c7 45 80 00 00
	00 00		 mov	 DWORD PTR _i$230339[ebp], 0
  009c8	eb 09		 jmp	 SHORT $LN5@IocpServer
$LN4@IocpServer:
  009ca	8b 45 80	 mov	 eax, DWORD PTR _i$230339[ebp]
  009cd	83 c0 01	 add	 eax, 1
  009d0	89 45 80	 mov	 DWORD PTR _i$230339[ebp], eax
$LN5@IocpServer:
  009d3	8b 45 80	 mov	 eax, DWORD PTR _i$230339[ebp]
  009d6	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_dwThreadCount@@3KA ; g_dwThreadCount
  009dc	73 14		 jae	 SHORT $LN6@IocpServer

; 389  : 					PostQueuedCompletionStatus(g_CompletionPort, 0, 0, NULL); 

  009de	6a 00		 push	 0
  009e0	6a 00		 push	 0
  009e2	6a 00		 push	 0
  009e4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_CompletionPort@@3PAXA ; g_CompletionPort
  009e9	50		 push	 eax
  009ea	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__PostQueuedCompletionStatus@16
  009f0	eb d8		 jmp	 SHORT $LN4@IocpServer
$LN6@IocpServer:

; 390  : 		}
; 391  : 		if( g_CompletionPort )

  009f2	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?g_CompletionPort@@3PAXA, 0 ; g_CompletionPort
  009f9	74 16		 je	 SHORT $LN2@IocpServer

; 392  : 		{
; 393  : 			CloseHandle(g_CompletionPort);

  009fb	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_CompletionPort@@3PAXA ; g_CompletionPort
  00a00	50		 push	 eax
  00a01	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CloseHandle@4

; 394  : 			g_CompletionPort = NULL;

  00a07	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?g_CompletionPort@@3PAXA, 0 ; g_CompletionPort
$LN2@IocpServer:

; 395  : 		}
; 396  : 		if (g_Listen != INVALID_SOCKET)  

  00a11	83 3d 00 00 00
	00 ff		 cmp	 DWORD PTR ?g_Listen@@3IA, -1 ; g_Listen
  00a18	74 16		 je	 SHORT $LN25@IocpServer

; 397  : 		{ 
; 398  :             closesocket(g_Listen);  

  00a1a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_Listen@@3IA ; g_Listen
  00a1f	50		 push	 eax
  00a20	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 399  :             g_Listen = INVALID_SOCKET; 

  00a26	c7 05 00 00 00
	00 ff ff ff ff	 mov	 DWORD PTR ?g_Listen@@3IA, -1 ; g_Listen
$LN25@IocpServer:
$LN28@IocpServer:
  00a30	c3		 ret	 0
$LN27@IocpServer:

; 400  : 		} 
; 401  : 	}
; 402  : 	return TRUE;

  00a31	b8 01 00 00 00	 mov	 eax, 1

; 403  : }

  00a36	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00a39	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00a40	59		 pop	 ecx
  00a41	5f		 pop	 edi
  00a42	5e		 pop	 esi
  00a43	5b		 pop	 ebx
  00a44	8b 4d e4	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00a47	33 cd		 xor	 ecx, ebp
  00a49	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00a4e	8b e5		 mov	 esp, ebp
  00a50	5d		 pop	 ebp
  00a51	c2 04 00	 ret	 4
?IocpServerWorker@@YGKPAX@Z ENDP			; IocpServerWorker
_TEXT	ENDS
PUBLIC	??_C@_0BP@CPHIIPEF@WSARecv?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@ ; `string'
PUBLIC	??_C@_0CG@MJPNHJDJ@error?9L1?5?3?5Socket?5Header?5error?5?$CF@ ; `string'
PUBLIC	?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z	; RecvDataParse
PUBLIC	?IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z	; IoMoreSend
PUBLIC	?IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z	; IoSendSecond
PUBLIC	??_C@_0CM@PHCJMMBN@Connection?5Closed?0?5dwIoSize?5?$DN?$DN?50@ ; `string'
PUBLIC	??_C@_0CO@KIOKACIH@Error?5Thread?5?3?5GetQueueCompletio@ ; `string'
EXTRN	__imp__GetQueuedCompletionStatus@20:PROC
;	COMDAT ??_C@_0BP@CPHIIPEF@WSARecv?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BP@CPHIIPEF@WSARecv?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@ DB 'W'
	DB	'SARecv() failed with error %d', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0CG@MJPNHJDJ@error?9L1?5?3?5Socket?5Header?5error?5?$CF@
CONST	SEGMENT
??_C@_0CG@MJPNHJDJ@error?9L1?5?3?5Socket?5Header?5error?5?$CF@ DB 'error-'
	DB	'L1 : Socket Header error %d, %d', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0CM@PHCJMMBN@Connection?5Closed?0?5dwIoSize?5?$DN?$DN?50@
CONST	SEGMENT
??_C@_0CM@PHCJMMBN@Connection?5Closed?0?5dwIoSize?5?$DN?$DN?50@ DB 'Conne'
	DB	'ction Closed, dwIoSize == 0 (Index:%d)', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CO@KIOKACIH@Error?5Thread?5?3?5GetQueueCompletio@
CONST	SEGMENT
??_C@_0CO@KIOKACIH@Error?5Thread?5?3?5GetQueueCompletio@ DB 'Error Thread'
	DB	' : GetQueueCompletionStatus( %d )', 00H	; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_aError$230368 = -48					; size = 4
_lpIOContext$ = -44					; size = 4
_lpOverlapped$ = -40					; size = 4
_lpPerSocketContext$ = -36				; size = 4
_ClientIndex$ = -32					; size = 4
_nRet$ = -28						; size = 4
_bSuccess$ = -24					; size = 4
_dwSendNumBytes$ = -20					; size = 4
_Flags$ = -16						; size = 4
_RecvBytes$ = -12					; size = 4
_dwIoSize$ = -8						; size = 4
_CompletionPort$ = -4					; size = 4
_CompletionPortID$ = 8					; size = 4
?ServerWorkerThread@@YGKPAX@Z PROC			; ServerWorkerThread

; 406  : {

  00a60	55		 push	 ebp
  00a61	8b ec		 mov	 ebp, esp
  00a63	83 ec 70	 sub	 esp, 112		; 00000070H
  00a66	53		 push	 ebx
  00a67	56		 push	 esi
  00a68	57		 push	 edi

; 407  : 	HANDLE	CompletionPort = (HANDLE) CompletionPortID;

  00a69	8b 45 08	 mov	 eax, DWORD PTR _CompletionPortID$[ebp]
  00a6c	89 45 fc	 mov	 DWORD PTR _CompletionPort$[ebp], eax

; 408  : 	DWORD	dwIoSize;
; 409  : 	DWORD	RecvBytes;
; 410  : 	DWORD	Flags;
; 411  : 	DWORD	dwSendNumBytes = 0;

  00a6f	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _dwSendNumBytes$[ebp], 0

; 412  : 	BOOL	bSuccess = FALSE; 

  00a76	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _bSuccess$[ebp], 0

; 413  : 	int		nRet;
; 414  : 	int     ClientIndex;
; 415  : 
; 416  : 	LPPER_SOCKET_CONTEXT	lpPerSocketContext = NULL;

  00a7d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _lpPerSocketContext$[ebp], 0

; 417  : 	LPOVERLAPPED			lpOverlapped = NULL; 

  00a84	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _lpOverlapped$[ebp], 0

; 418  : 	LPPER_IO_CONTEXT		lpIOContext = NULL;

  00a8b	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _lpIOContext$[ebp], 0
$LN15@ServerWork:

; 419  : 	
; 420  : 	while(TRUE)

  00a92	b8 01 00 00 00	 mov	 eax, 1
  00a97	85 c0		 test	 eax, eax
  00a99	0f 84 e3 02 00
	00		 je	 $LN14@ServerWork

; 421  : 	{
; 422  : 		bSuccess = GetQueuedCompletionStatus(
; 423  : 			CompletionPort,
; 424  : 			&dwIoSize,
; 425  : 			(LPDWORD)&ClientIndex,
; 426  : 			&lpOverlapped,
; 427  : 			INFINITE
; 428  : 		);

  00a9f	6a ff		 push	 -1
  00aa1	8d 45 d8	 lea	 eax, DWORD PTR _lpOverlapped$[ebp]
  00aa4	50		 push	 eax
  00aa5	8d 4d e0	 lea	 ecx, DWORD PTR _ClientIndex$[ebp]
  00aa8	51		 push	 ecx
  00aa9	8d 55 f8	 lea	 edx, DWORD PTR _dwIoSize$[ebp]
  00aac	52		 push	 edx
  00aad	8b 45 fc	 mov	 eax, DWORD PTR _CompletionPort$[ebp]
  00ab0	50		 push	 eax
  00ab1	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetQueuedCompletionStatus@20
  00ab7	89 45 e8	 mov	 DWORD PTR _bSuccess$[ebp], eax

; 429  : 
; 430  : 		if( !bSuccess )

  00aba	83 7d e8 00	 cmp	 DWORD PTR _bSuccess$[ebp], 0
  00abe	75 5f		 jne	 SHORT $LN13@ServerWork

; 431  : 		{
; 432  : 			if( lpOverlapped != NULL )

  00ac0	83 7d d8 00	 cmp	 DWORD PTR _lpOverlapped$[ebp], 0
  00ac4	74 59		 je	 SHORT $LN13@ServerWork

; 433  : 			{
; 434  : 				int aError = GetLastError();

  00ac6	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  00acc	89 45 d0	 mov	 DWORD PTR _aError$230368[ebp], eax

; 435  : 				if ( (aError != ERROR_SEM_TIMEOUT)		  && (aError != ERROR_NETNAME_DELETED) && 
; 436  : 					 (aError != ERROR_CONNECTION_ABORTED) && (aError != ERROR_OPERATION_ABORTED) )

  00acf	83 7d d0 79	 cmp	 DWORD PTR _aError$230368[ebp], 121 ; 00000079H
  00ad3	74 4a		 je	 SHORT $LN13@ServerWork
  00ad5	83 7d d0 40	 cmp	 DWORD PTR _aError$230368[ebp], 64 ; 00000040H
  00ad9	74 44		 je	 SHORT $LN13@ServerWork
  00adb	81 7d d0 d4 04
	00 00		 cmp	 DWORD PTR _aError$230368[ebp], 1236 ; 000004d4H
  00ae2	74 3b		 je	 SHORT $LN13@ServerWork
  00ae4	81 7d d0 e3 03
	00 00		 cmp	 DWORD PTR _aError$230368[ebp], 995 ; 000003e3H
  00aeb	74 32		 je	 SHORT $LN13@ServerWork

; 437  : 				{
; 438  : 					EnterCriticalSection(&criti);

  00aed	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00af2	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 439  : 					LogAdd("Error Thread : GetQueueCompletionStatus( %d )", GetLastError());

  00af8	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  00afe	50		 push	 eax
  00aff	68 00 00 00 00	 push	 OFFSET ??_C@_0CO@KIOKACIH@Error?5Thread?5?3?5GetQueueCompletio@
  00b04	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00b0a	83 c4 08	 add	 esp, 8

; 440  : 					LeaveCriticalSection(&criti);

  00b0d	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00b12	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 441  : 					return 0;

  00b18	33 c0		 xor	 eax, eax
  00b1a	e9 68 02 00 00	 jmp	 $LN16@ServerWork
$LN13@ServerWork:

; 442  : 				}
; 443  : 			}
; 444  : 		}
; 445  : 
; 446  : 		EnterCriticalSection(&criti);

  00b1f	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00b24	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 447  : 		lpPerSocketContext = gObj[ClientIndex].PerSocketContext;

  00b2a	8b 45 e0	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  00b2d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00b33	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00b39	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  00b3d	89 55 dc	 mov	 DWORD PTR _lpPerSocketContext$[ebp], edx

; 448  : 		
; 449  : 		lpPerSocketContext->dwIOCount--;

  00b40	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00b43	8b 88 68 00 04
	00		 mov	 ecx, DWORD PTR [eax+262248]
  00b49	83 e9 01	 sub	 ecx, 1
  00b4c	8b 55 dc	 mov	 edx, DWORD PTR _lpPerSocketContext$[ebp]
  00b4f	89 8a 68 00 04
	00		 mov	 DWORD PTR [edx+262248], ecx

; 450  : 		if( dwIoSize == 0 )

  00b55	83 7d f8 00	 cmp	 DWORD PTR _dwIoSize$[ebp], 0
  00b59	75 33		 jne	 SHORT $LN10@ServerWork

; 451  : 		{
; 452  : 			LogAdd("Connection Closed, dwIoSize == 0 (Index:%d)", lpPerSocketContext->nIndex);

  00b5b	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00b5e	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00b61	51		 push	 ecx
  00b62	68 00 00 00 00	 push	 OFFSET ??_C@_0CM@PHCJMMBN@Connection?5Closed?0?5dwIoSize?5?$DN?$DN?50@
  00b67	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00b6d	83 c4 08	 add	 esp, 8

; 453  : 			CloseClient(lpPerSocketContext, 0);

  00b70	6a 00		 push	 0
  00b72	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00b75	50		 push	 eax
  00b76	e8 00 00 00 00	 call	 ?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z ; CloseClient
  00b7b	83 c4 08	 add	 esp, 8

; 454  : 			LeaveCriticalSection(&criti);

  00b7e	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00b83	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 455  : 			continue;

  00b89	e9 04 ff ff ff	 jmp	 $LN15@ServerWork
$LN10@ServerWork:

; 456  : 		}
; 457  : 
; 458  : 		lpIOContext = (LPPER_IO_CONTEXT)lpOverlapped;

  00b8e	8b 45 d8	 mov	 eax, DWORD PTR _lpOverlapped$[ebp]
  00b91	89 45 d4	 mov	 DWORD PTR _lpIOContext$[ebp], eax

; 459  : 
; 460  : 		if( lpIOContext == NULL ) continue;

  00b94	83 7d d4 00	 cmp	 DWORD PTR _lpIOContext$[ebp], 0
  00b98	75 05		 jne	 SHORT $LN9@ServerWork
  00b9a	e9 f3 fe ff ff	 jmp	 $LN15@ServerWork
$LN9@ServerWork:

; 461  : 
; 462  : 		if( lpIOContext->IOOperation == SEND_IO )

  00b9f	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00ba2	83 b8 28 00 02
	00 01		 cmp	 DWORD PTR [eax+131112], 1
  00ba9	75 61		 jne	 SHORT $LN8@ServerWork

; 463  : 		{
; 464  : 			#if(!FIX_SOCKET_MAXBUFFER)
; 465  : 			lpIOContext->nSentBytes += dwIoSize;

  00bab	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00bae	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  00bb4	03 4d f8	 add	 ecx, DWORD PTR _dwIoSize$[ebp]
  00bb7	8b 55 d4	 mov	 edx, DWORD PTR _lpIOContext$[ebp]
  00bba	89 8a 24 00 02
	00		 mov	 DWORD PTR [edx+131108], ecx

; 466  : 
; 467  : 			if( lpIOContext->nSentBytes >= lpIOContext->nTotalBytes )

  00bc0	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00bc3	8b 4d d4	 mov	 ecx, DWORD PTR _lpIOContext$[ebp]
  00bc6	8b 90 24 00 02
	00		 mov	 edx, DWORD PTR [eax+131108]
  00bcc	3b 91 20 00 02
	00		 cmp	 edx, DWORD PTR [ecx+131104]
  00bd2	7c 27		 jl	 SHORT $LN7@ServerWork

; 468  : 			{
; 469  : 				lpIOContext->nWaitIO = 0;

  00bd4	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00bd7	c7 80 2c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131116], 0

; 470  : 				if( lpIOContext->nSecondOfs > 0 )

  00be1	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00be4	83 b8 1c 00 02
	00 00		 cmp	 DWORD PTR [eax+131100], 0
  00beb	7e 0c		 jle	 SHORT $LN6@ServerWork

; 471  : 				{
; 472  : 					IoSendSecond(lpPerSocketContext);

  00bed	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00bf0	50		 push	 eax
  00bf1	e8 00 00 00 00	 call	 ?IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z ; IoSendSecond
  00bf6	83 c4 04	 add	 esp, 4
$LN6@ServerWork:

; 473  : 				}
; 474  : 			}
; 475  : 			else

  00bf9	eb 0c		 jmp	 SHORT $LN5@ServerWork
$LN7@ServerWork:

; 476  : 			{
; 477  : 				IoMoreSend(lpPerSocketContext);

  00bfb	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00bfe	50		 push	 eax
  00bff	e8 00 00 00 00	 call	 ?IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z ; IoMoreSend
  00c04	83 c4 04	 add	 esp, 4
$LN5@ServerWork:

; 478  : 			}

  00c07	e9 66 01 00 00	 jmp	 $LN4@ServerWork
$LN8@ServerWork:

; 479  : 			#endif
; 480  : 		}
; 481  : 		else if( lpIOContext->IOOperation == RECV_IO )

  00c0c	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00c0f	83 b8 28 00 02
	00 00		 cmp	 DWORD PTR [eax+131112], 0
  00c16	0f 85 56 01 00
	00		 jne	 $LN4@ServerWork

; 482  : 		{
; 483  : 			RecvBytes = 0;

  00c1c	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _RecvBytes$[ebp], 0

; 484  : 
; 485  : 			lpIOContext->nSentBytes += dwIoSize;

  00c23	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00c26	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  00c2c	03 4d f8	 add	 ecx, DWORD PTR _dwIoSize$[ebp]
  00c2f	8b 55 d4	 mov	 edx, DWORD PTR _lpIOContext$[ebp]
  00c32	89 8a 24 00 02
	00		 mov	 DWORD PTR [edx+131108], ecx

; 486  : 			
; 487  : 			if( RecvDataParse(lpIOContext, lpPerSocketContext->nIndex) == FALSE )

  00c38	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00c3b	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00c3e	51		 push	 ecx
  00c3f	8b 55 d4	 mov	 edx, DWORD PTR _lpIOContext$[ebp]
  00c42	52		 push	 edx
  00c43	e8 00 00 00 00	 call	 ?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z ; RecvDataParse
  00c48	83 c4 08	 add	 esp, 8
  00c4b	85 c0		 test	 eax, eax
  00c4d	75 3a		 jne	 SHORT $LN2@ServerWork

; 488  : 			{
; 489  : 				LogAdd("error-L1 : Socket Header error %d, %d", WSAGetLastError(), lpPerSocketContext->nIndex);

  00c4f	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00c52	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  00c55	51		 push	 ecx
  00c56	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  00c5c	50		 push	 eax
  00c5d	68 00 00 00 00	 push	 OFFSET ??_C@_0CG@MJPNHJDJ@error?9L1?5?3?5Socket?5Header?5error?5?$CF@
  00c62	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00c68	83 c4 0c	 add	 esp, 12			; 0000000cH

; 490  : 				CloseClient(lpPerSocketContext, 0);

  00c6b	6a 00		 push	 0
  00c6d	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00c70	50		 push	 eax
  00c71	e8 00 00 00 00	 call	 ?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z ; CloseClient
  00c76	83 c4 08	 add	 esp, 8

; 491  : 				LeaveCriticalSection(&criti);

  00c79	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00c7e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 492  : 				continue;

  00c84	e9 09 fe ff ff	 jmp	 $LN15@ServerWork
$LN2@ServerWork:

; 493  : 			}
; 494  : 			
; 495  : 			//#if(!FIX_SOCKET_MAXBUFFER)
; 496  : 			lpIOContext->nWaitIO = 0;

  00c89	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00c8c	c7 80 2c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131116], 0

; 497  : 			//#endif
; 498  : 			Flags = 0;

  00c96	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _Flags$[ebp], 0

; 499  : 			ZeroMemory(&(lpIOContext->Overlapped), sizeof(OVERLAPPED));

  00c9d	6a 14		 push	 20			; 00000014H
  00c9f	6a 00		 push	 0
  00ca1	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00ca4	50		 push	 eax
  00ca5	e8 00 00 00 00	 call	 _memset
  00caa	83 c4 0c	 add	 esp, 12			; 0000000cH

; 500  : 				
; 501  : 			lpIOContext->wsabuf.len		= MAX_IO_BUFFER_SIZE-lpIOContext->nSentBytes;

  00cad	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00cb0	b9 ff ff 00 00	 mov	 ecx, 65535		; 0000ffffH
  00cb5	2b 88 24 00 02
	00		 sub	 ecx, DWORD PTR [eax+131108]
  00cbb	8b 55 d4	 mov	 edx, DWORD PTR _lpIOContext$[ebp]
  00cbe	89 4a 14	 mov	 DWORD PTR [edx+20], ecx

; 502  : 			lpIOContext->wsabuf.buf		= lpIOContext->Buffer+lpIOContext->nSentBytes;

  00cc1	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00cc4	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  00cca	8b 55 d4	 mov	 edx, DWORD PTR _lpIOContext$[ebp]
  00ccd	8d 44 0a 1c	 lea	 eax, DWORD PTR [edx+ecx+28]
  00cd1	8b 4d d4	 mov	 ecx, DWORD PTR _lpIOContext$[ebp]
  00cd4	89 41 18	 mov	 DWORD PTR [ecx+24], eax

; 503  : 			lpIOContext->IOOperation	= RECV_IO;

  00cd7	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00cda	c7 80 28 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131112], 0

; 504  : 				
; 505  : 			nRet = WSARecv(lpPerSocketContext->m_socket, &(lpIOContext->wsabuf), 1, &RecvBytes, &Flags,
; 506  : 				&(lpIOContext->Overlapped), NULL);

  00ce4	6a 00		 push	 0
  00ce6	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00ce9	50		 push	 eax
  00cea	8d 4d f0	 lea	 ecx, DWORD PTR _Flags$[ebp]
  00ced	51		 push	 ecx
  00cee	8d 55 f4	 lea	 edx, DWORD PTR _RecvBytes$[ebp]
  00cf1	52		 push	 edx
  00cf2	6a 01		 push	 1
  00cf4	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00cf7	83 c0 14	 add	 eax, 20			; 00000014H
  00cfa	50		 push	 eax
  00cfb	8b 4d dc	 mov	 ecx, DWORD PTR _lpPerSocketContext$[ebp]
  00cfe	8b 11		 mov	 edx, DWORD PTR [ecx]
  00d00	52		 push	 edx
  00d01	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSARecv@28
  00d07	89 45 e4	 mov	 DWORD PTR _nRet$[ebp], eax

; 507  : 			
; 508  : 			if( nRet == SOCKET_ERROR && (WSAGetLastError() != ERROR_IO_PENDING) )

  00d0a	83 7d e4 ff	 cmp	 DWORD PTR _nRet$[ebp], -1
  00d0e	75 40		 jne	 SHORT $LN1@ServerWork
  00d10	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  00d16	3d e5 03 00 00	 cmp	 eax, 997		; 000003e5H
  00d1b	74 33		 je	 SHORT $LN1@ServerWork

; 509  : 			{
; 510  : 				LogAdd("WSARecv() failed with error %d", WSAGetLastError());

  00d1d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  00d23	50		 push	 eax
  00d24	68 00 00 00 00	 push	 OFFSET ??_C@_0BP@CPHIIPEF@WSARecv?$CI?$CJ?5failed?5with?5error?5?$CFd?$AA@
  00d29	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00d2f	83 c4 08	 add	 esp, 8

; 511  : 				//lpIOContext->nWaitIO = 2;
; 512  : 				CloseClient( lpPerSocketContext, FALSE);

  00d32	6a 00		 push	 0
  00d34	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00d37	50		 push	 eax
  00d38	e8 00 00 00 00	 call	 ?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z ; CloseClient
  00d3d	83 c4 08	 add	 esp, 8

; 513  : 				LeaveCriticalSection(&criti);

  00d40	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00d45	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 514  : 				continue;

  00d4b	e9 42 fd ff ff	 jmp	 $LN15@ServerWork
$LN1@ServerWork:

; 515  : 			}
; 516  : 				
; 517  : 			lpPerSocketContext->dwIOCount++;

  00d50	8b 45 dc	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  00d53	8b 88 68 00 04
	00		 mov	 ecx, DWORD PTR [eax+262248]
  00d59	83 c1 01	 add	 ecx, 1
  00d5c	8b 55 dc	 mov	 edx, DWORD PTR _lpPerSocketContext$[ebp]
  00d5f	89 8a 68 00 04
	00		 mov	 DWORD PTR [edx+262248], ecx

; 518  : 			//#if(!FIX_SOCKET_MAXBUFFER)
; 519  : 			lpIOContext->nWaitIO = 1;

  00d65	8b 45 d4	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00d68	c7 80 2c 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131116], 1
$LN4@ServerWork:

; 520  : 			//#endif
; 521  : 		}
; 522  : 		LeaveCriticalSection(&criti);

  00d72	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  00d77	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 523  : 	}

  00d7d	e9 10 fd ff ff	 jmp	 $LN15@ServerWork
$LN14@ServerWork:

; 524  : 	return TRUE;

  00d82	b8 01 00 00 00	 mov	 eax, 1
$LN16@ServerWork:

; 525  : }

  00d87	5f		 pop	 edi
  00d88	5e		 pop	 esi
  00d89	5b		 pop	 ebx
  00d8a	8b e5		 mov	 esp, ebp
  00d8c	5d		 pop	 ebp
  00d8d	c2 04 00	 ret	 4
?ServerWorkerThread@@YGKPAX@Z ENDP			; ServerWorkerThread
_TEXT	ENDS
PUBLIC	??_C@_0BA@OIIBACED@Message?5copy?5?$CFd?$AA@	; `string'
PUBLIC	??_C@_0BO@OCHJCCMB@error?9L1?5?3?5recvbuflen?51?5?$CFs?5?$CFd?$AA@ ; `string'
PUBLIC	??_C@_0BC@GEFELIJM@?$LO?O?H?$KD?F?P?E?$LG?5?3?5?$FL0x?$CFx?$FN?$AA@ ; `string'
PUBLIC	??_C@_0GJ@IFEOENIG@error?9L1?5?3?5CStreamPacketEngine?5E@ ; `string'
PUBLIC	?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z ; CStreamPacketEngine_Server::ExtractPacket
PUBLIC	??1CStreamPacketEngine_Server@@UAE@XZ		; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
PUBLIC	??_C@_0GC@CEPNFMLO@error?9L1?5?3?5CStreamPacketEngine?5A@ ; `string'
PUBLIC	?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z	; CStreamPacketEngine_Server::AddData
PUBLIC	?Clear@CStreamPacketEngine_Server@@QAEXXZ	; CStreamPacketEngine_Server::Clear
PUBLIC	??0CStreamPacketEngine_Server@@QAE@XZ		; CStreamPacketEngine_Server::CStreamPacketEngine_Server
PUBLIC	??_C@_0BD@OEJCIIJN@error?9L1?5?3?5size?5?$CFd?$AA@ ; `string'
PUBLIC	??_C@_0DA@PEHCNCMI@error?9L1?5?3?5Header?5error?5?$CI?$CFs?5?$CFd?$CJl@ ; `string'
PUBLIC	?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA ; `RecvDataParse'::`2'::__LINE__Var
PUBLIC	__$ArrayPad$
EXTRN	?ProtocolCore@@YAXEPAEHHHH@Z:PROC		; ProtocolCore
EXTRN	?Decrypt@CSimpleModulus@@QAEHPAX0H@Z:PROC	; CSimpleModulus::Decrypt
EXTRN	?g_SimpleModulusCS@@3VCSimpleModulus@@A:BYTE	; g_SimpleModulusCS
EXTRN	___CxxFrameHandler3:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0BA@OIIBACED@Message?5copy?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BA@OIIBACED@Message?5copy?5?$CFd?$AA@ DB 'Message copy %d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BO@OCHJCCMB@error?9L1?5?3?5recvbuflen?51?5?$CFs?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BO@OCHJCCMB@error?9L1?5?3?5recvbuflen?51?5?$CFs?5?$CFd?$AA@ DB 'er'
	DB	'ror-L1 : recvbuflen 1 %s %d', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BC@GEFELIJM@?$LO?O?H?$KD?F?P?E?$LG?5?3?5?$FL0x?$CFx?$FN?$AA@
CONST	SEGMENT
??_C@_0BC@GEFELIJM@?$LO?O?H?$KD?F?P?E?$LG?5?3?5?$FL0x?$CFx?$FN?$AA@ DB 0beH
	DB	0cfH, 0c8H, 0a3H, 0c6H, 0d0H, 0c5H, 0b6H, ' : [0x%x]', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0GJ@IFEOENIG@error?9L1?5?3?5CStreamPacketEngine?5E@
CONST	SEGMENT
??_C@_0GJ@IFEOENIG@error?9L1?5?3?5CStreamPacketEngine?5E@ DB 'error-L1 : '
	DB	'CStreamPacketEngine ExtractPacket Error : ip = %s account:%s '
	DB	'name:%s HEAD:%x (%s,%d) State:%d', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0GC@CEPNFMLO@error?9L1?5?3?5CStreamPacketEngine?5A@
CONST	SEGMENT
??_C@_0GC@CEPNFMLO@error?9L1?5?3?5CStreamPacketEngine?5A@ DB 'error-L1 : '
	DB	'CStreamPacketEngine Adding Error : ip = %s account:%s name:%s'
	DB	' HEAD:%x (%s,%d) State:%d', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BD@OEJCIIJN@error?9L1?5?3?5size?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BD@OEJCIIJN@error?9L1?5?3?5size?5?$CFd?$AA@ DB 'error-L1 : size %d'
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_0DA@PEHCNCMI@error?9L1?5?3?5Header?5error?5?$CI?$CFs?5?$CFd?$CJl@
CONST	SEGMENT
??_C@_0DA@PEHCNCMI@error?9L1?5?3?5Header?5error?5?$CI?$CFs?5?$CFd?$CJl@ DB 'e'
	DB	'rror-L1 : Header error (%s %d)lOfs:%d, size:%d', 00H ; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA DD 0210H ; `RecvDataParse'::`2'::__LINE__Var
_DATA	ENDS
xdata$x	SEGMENT
__unwindtable$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z$0
	DD	0ffffffffH
	DD	FLAT:__unwindfunclet$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z$1
	DD	0ffffffffH
	DD	FLAT:__unwindfunclet$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z$2
__ehfuncinfo$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z DD 019930522H
	DD	03H
	DD	FLAT:__unwindtable$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Odtp /ZI
xdata$x	ENDS
_TEXT	SEGMENT
$T230812 = -39104					; size = 4
$T230813 = -39100					; size = 4
$T230814 = -39096					; size = 4
$T230815 = -39092					; size = 4
$T230816 = -39088					; size = 4
$T230817 = -39084					; size = 4
$T230818 = -39080					; size = 4
$T230819 = -39076					; size = 4
$T230820 = -39072					; size = 4
_ps$230460 = -39004					; size = 2056
_PacketStream$230451 = -36948				; size = 2056
_wsize$230444 = -34892					; size = 2
_subhead$230443 = -34885				; size = 1
_pDecBuf$230442 = -34884				; size = 4
_iSize$230439 = -34880					; size = 4
_PacketStream$230426 = -34876				; size = 2056
_subhead$230424 = -32817				; size = 1
_lphead$230422 = -32816					; size = 4
_iSize$230419 = -32812					; size = 4
_lphead$230408 = -32808					; size = 4
_lphead$230403 = -32804					; size = 4
_byDec$ = -32800					; size = 32767
_xcode$ = -30						; size = 1
_headcode$ = -29					; size = 1
_size$ = -28						; size = 4
_lOfs$ = -24						; size = 4
_recvbuf$ = -20						; size = 4
__$ArrayPad$ = -16					; size = 4
__$EHRec$ = -12						; size = 12
_lpIOContext$ = 8					; size = 4
_uIndex$ = 12						; size = 4
?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z PROC		; RecvDataParse

; 528  : {

  00d90	55		 push	 ebp
  00d91	8b ec		 mov	 ebp, esp
  00d93	6a ff		 push	 -1
  00d95	68 00 00 00 00	 push	 __ehhandler$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z
  00d9a	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00da0	50		 push	 eax
  00da1	b8 b4 98 00 00	 mov	 eax, 39092		; 000098b4H
  00da6	e8 00 00 00 00	 call	 __chkstk
  00dab	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00db0	33 c5		 xor	 eax, ebp
  00db2	89 45 f0	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00db5	53		 push	 ebx
  00db6	56		 push	 esi
  00db7	57		 push	 edi
  00db8	50		 push	 eax
  00db9	8d 45 f4	 lea	 eax, DWORD PTR __$EHRec$[ebp]
  00dbc	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax

; 529  : 	if ( lpIOContext->nSentBytes < 3 )

  00dc2	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00dc5	83 b8 24 00 02
	00 03		 cmp	 DWORD PTR [eax+131108], 3
  00dcc	7d 0a		 jge	 SHORT $LN36@RecvDataPa

; 530  : 	{
; 531  : 		return TRUE;

  00dce	b8 01 00 00 00	 mov	 eax, 1
  00dd3	e9 a5 09 00 00	 jmp	 $LN37@RecvDataPa
$LN36@RecvDataPa:

; 532  : 	}
; 533  : 
; 534  : 	LPBYTE recvbuf;
; 535  : 	int lOfs = 0;

  00dd8	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _lOfs$[ebp], 0

; 536  : 	int size = 0;

  00ddf	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _size$[ebp], 0

; 537  : 	BYTE headcode;
; 538  : 	BYTE xcode = 0;

  00de6	c6 45 e2 00	 mov	 BYTE PTR _xcode$[ebp], 0

; 539  : 	BYTE byDec[MAX_EXSENDBUF_SIZE];	//[7024];
; 540  : 
; 541  : #if(ENABLE_PROTOCOL_QUEUE)
; 542  : 	static QUEUE_INFO QueueInfo;
; 543  : #endif
; 544  : 
; 545  : 	recvbuf = (LPBYTE)lpIOContext->Buffer;

  00dea	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00ded	83 c0 1c	 add	 eax, 28			; 0000001cH
  00df0	89 45 ec	 mov	 DWORD PTR _recvbuf$[ebp], eax
$LN35@RecvDataPa:

; 546  : 
; 547  : 	while ( 1 )

  00df3	b8 01 00 00 00	 mov	 eax, 1
  00df8	85 c0		 test	 eax, eax
  00dfa	0f 84 78 09 00
	00		 je	 $LN34@RecvDataPa

; 548  : 	{
; 549  : 		if( recvbuf[lOfs] == 0xC1 || 
; 550  : 			recvbuf[lOfs] == 0xC3 ) 

  00e00	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e03	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e06	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00e09	81 f9 c1 00 00
	00		 cmp	 ecx, 193		; 000000c1H
  00e0f	74 11		 je	 SHORT $LN32@RecvDataPa
  00e11	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e14	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e17	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00e1a	81 f9 c3 00 00
	00		 cmp	 ecx, 195		; 000000c3H
  00e20	75 35		 jne	 SHORT $LN33@RecvDataPa
$LN32@RecvDataPa:

; 551  : 		{
; 552  : 			PBMSG_HEAD* lphead = (PBMSG_HEAD*)(recvbuf+lOfs);

  00e22	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e25	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e28	89 85 dc 7f ff
	ff		 mov	 DWORD PTR _lphead$230403[ebp], eax

; 553  : 			size				= lphead->size;

  00e2e	8b 85 dc 7f ff
	ff		 mov	 eax, DWORD PTR _lphead$230403[ebp]
  00e34	0f b6 48 01	 movzx	 ecx, BYTE PTR [eax+1]
  00e38	89 4d e4	 mov	 DWORD PTR _size$[ebp], ecx

; 554  : 			headcode			= lphead->headcode;

  00e3b	8b 85 dc 7f ff
	ff		 mov	 eax, DWORD PTR _lphead$230403[ebp]
  00e41	8a 48 02	 mov	 cl, BYTE PTR [eax+2]
  00e44	88 4d e3	 mov	 BYTE PTR _headcode$[ebp], cl

; 555  : 			xcode				= recvbuf[lOfs];

  00e47	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e4a	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e4d	8a 08		 mov	 cl, BYTE PTR [eax]
  00e4f	88 4d e2	 mov	 BYTE PTR _xcode$[ebp], cl

; 556  : 		}
; 557  : 		else if( recvbuf[lOfs] == 0xC2 || 

  00e52	e9 a5 00 00 00	 jmp	 $LN31@RecvDataPa
$LN33@RecvDataPa:

; 558  : 				 recvbuf[lOfs] == 0xC4 ) //

  00e57	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e5a	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e5d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00e60	81 f9 c2 00 00
	00		 cmp	 ecx, 194		; 000000c2H
  00e66	74 11		 je	 SHORT $LN29@RecvDataPa
  00e68	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e6b	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e6e	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00e71	81 f9 c4 00 00
	00		 cmp	 ecx, 196		; 000000c4H
  00e77	75 45		 jne	 SHORT $LN30@RecvDataPa
$LN29@RecvDataPa:

; 559  : 		{
; 560  : 			PWMSG_HEAD* lphead	= (PWMSG_HEAD*)(recvbuf+lOfs);

  00e79	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00e7c	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00e7f	89 85 d8 7f ff
	ff		 mov	 DWORD PTR _lphead$230408[ebp], eax

; 561  : 			size				= ((WORD)(lphead->sizeH)<<8);

  00e85	8b 85 d8 7f ff
	ff		 mov	 eax, DWORD PTR _lphead$230408[ebp]
  00e8b	0f b6 48 01	 movzx	 ecx, BYTE PTR [eax+1]
  00e8f	c1 e1 08	 shl	 ecx, 8
  00e92	89 4d e4	 mov	 DWORD PTR _size$[ebp], ecx

; 562  : 			size			   |= (WORD)(lphead->sizeL);

  00e95	8b 85 d8 7f ff
	ff		 mov	 eax, DWORD PTR _lphead$230408[ebp]
  00e9b	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  00e9f	0b 4d e4	 or	 ecx, DWORD PTR _size$[ebp]
  00ea2	89 4d e4	 mov	 DWORD PTR _size$[ebp], ecx

; 563  : 			headcode			= lphead->headcode;

  00ea5	8b 85 d8 7f ff
	ff		 mov	 eax, DWORD PTR _lphead$230408[ebp]
  00eab	8a 48 03	 mov	 cl, BYTE PTR [eax+3]
  00eae	88 4d e3	 mov	 BYTE PTR _headcode$[ebp], cl

; 564  : 			xcode				= recvbuf[lOfs];

  00eb1	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  00eb4	03 45 e8	 add	 eax, DWORD PTR _lOfs$[ebp]
  00eb7	8a 08		 mov	 cl, BYTE PTR [eax]
  00eb9	88 4d e2	 mov	 BYTE PTR _xcode$[ebp], cl

; 565  : 		}
; 566  : 		else  //   ..

  00ebc	eb 3e		 jmp	 SHORT $LN31@RecvDataPa
$LN30@RecvDataPa:

; 567  : 		{
; 568  : 			LogAdd("error-L1 : Header error (%s %d)lOfs:%d, size:%d",
; 569  : 				__FILE__, __LINE__, lOfs, 
; 570  : 				lpIOContext->nSentBytes);

  00ebe	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00ec1	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  00ec7	51		 push	 ecx
  00ec8	8b 55 e8	 mov	 edx, DWORD PTR _lOfs$[ebp]
  00ecb	52		 push	 edx
  00ecc	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  00ed1	83 c0 29	 add	 eax, 41			; 00000029H
  00ed4	50		 push	 eax
  00ed5	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  00eda	68 00 00 00 00	 push	 OFFSET ??_C@_0DA@PEHCNCMI@error?9L1?5?3?5Header?5error?5?$CI?$CFs?5?$CFd?$CJl@
  00edf	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00ee5	83 c4 14	 add	 esp, 20			; 00000014H

; 571  : 			lpIOContext->nSentBytes = 0;

  00ee8	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00eeb	c7 80 24 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131108], 0

; 572  : 			return FALSE;

  00ef5	33 c0		 xor	 eax, eax
  00ef7	e9 81 08 00 00	 jmp	 $LN37@RecvDataPa
$LN31@RecvDataPa:

; 573  : 		}
; 574  : 		if ( size <= 0 )

  00efc	83 7d e4 00	 cmp	 DWORD PTR _size$[ebp], 0
  00f00	7f 19		 jg	 SHORT $LN27@RecvDataPa

; 575  : 		{
; 576  : 			LogAdd("error-L1 : size %d",size);

  00f02	8b 45 e4	 mov	 eax, DWORD PTR _size$[ebp]
  00f05	50		 push	 eax
  00f06	68 00 00 00 00	 push	 OFFSET ??_C@_0BD@OEJCIIJN@error?9L1?5?3?5size?5?$CFd?$AA@
  00f0b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  00f11	83 c4 08	 add	 esp, 8

; 577  : 			return FALSE;

  00f14	33 c0		 xor	 eax, eax
  00f16	e9 62 08 00 00	 jmp	 $LN37@RecvDataPa
$LN27@RecvDataPa:

; 578  : 		}
; 579  : 
; 580  : 		if ( size <= lpIOContext->nSentBytes )

  00f1b	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  00f1e	8b 4d e4	 mov	 ecx, DWORD PTR _size$[ebp]
  00f21	3b 88 24 00 02
	00		 cmp	 ecx, DWORD PTR [eax+131108]
  00f27	0f 8f ca 07 00
	00		 jg	 $LN26@RecvDataPa

; 581  : 		{
; 582  : 			if ( xcode == 0xC3 )

  00f2d	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  00f31	3d c3 00 00 00	 cmp	 eax, 195		; 000000c3H
  00f36	0f 85 aa 02 00
	00		 jne	 $LN25@RecvDataPa

; 583  : 			{
; 584  : 				int iSize = g_SimpleModulusCS.Decrypt( byDec+2,(recvbuf+lOfs+2), size-2);

  00f3c	8b 45 e4	 mov	 eax, DWORD PTR _size$[ebp]
  00f3f	83 e8 02	 sub	 eax, 2
  00f42	50		 push	 eax
  00f43	8b 4d e8	 mov	 ecx, DWORD PTR _lOfs$[ebp]
  00f46	8b 55 ec	 mov	 edx, DWORD PTR _recvbuf$[ebp]
  00f49	8d 44 0a 02	 lea	 eax, DWORD PTR [edx+ecx+2]
  00f4d	50		 push	 eax
  00f4e	8d 8d e2 7f ff
	ff		 lea	 ecx, DWORD PTR _byDec$[ebp+2]
  00f54	51		 push	 ecx
  00f55	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_SimpleModulusCS@@3VCSimpleModulus@@A ; g_SimpleModulusCS
  00f5a	e8 00 00 00 00	 call	 ?Decrypt@CSimpleModulus@@QAEHPAX0H@Z ; CSimpleModulus::Decrypt
  00f5f	89 85 d4 7f ff
	ff		 mov	 DWORD PTR _iSize$230419[ebp], eax

; 585  : 
; 586  : 				if ( iSize < 0 )

  00f65	83 bd d4 7f ff
	ff 00		 cmp	 DWORD PTR _iSize$230419[ebp], 0
  00f6c	7d 05		 jge	 SHORT $LN24@RecvDataPa

; 587  : 				{
; 588  : 
; 589  : 				}
; 590  : 				else

  00f6e	e9 6e 02 00 00	 jmp	 $LN23@RecvDataPa
$LN24@RecvDataPa:

; 591  : 				{
; 592  : 					PBMSG_HEAD* lphead = (PBMSG_HEAD*)(byDec+1);

  00f73	8d 85 e1 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp+1]
  00f79	89 85 d0 7f ff
	ff		 mov	 DWORD PTR _lphead$230422[ebp], eax

; 593  : 					headcode		= lphead->headcode;

  00f7f	8b 85 d0 7f ff
	ff		 mov	 eax, DWORD PTR _lphead$230422[ebp]
  00f85	8a 48 02	 mov	 cl, BYTE PTR [eax+2]
  00f88	88 4d e3	 mov	 BYTE PTR _headcode$[ebp], cl

; 594  : 					BYTE subhead	= byDec[2];

  00f8b	8a 85 e2 7f ff
	ff		 mov	 al, BYTE PTR _byDec$[ebp+2]
  00f91	88 85 cf 7f ff
	ff		 mov	 BYTE PTR _subhead$230424[ebp], al

; 595  : 					byDec[1]		= 0xC1;

  00f97	c6 85 e1 7f ff
	ff c1		 mov	 BYTE PTR _byDec$[ebp+1], 193 ; 000000c1H

; 596  : 					byDec[2]		= ((BYTE)iSize)+2;

  00f9e	0f b6 85 d4 7f
	ff ff		 movzx	 eax, BYTE PTR _iSize$230419[ebp]
  00fa5	83 c0 02	 add	 eax, 2
  00fa8	88 85 e2 7f ff
	ff		 mov	 BYTE PTR _byDec$[ebp+2], al

; 597  : 
; 598  : 					CStreamPacketEngine_Server PacketStream;

  00fae	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  00fb4	e8 00 00 00 00	 call	 ??0CStreamPacketEngine_Server@@QAE@XZ ; CStreamPacketEngine_Server::CStreamPacketEngine_Server
  00fb9	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$EHRec$[ebp+8], 0

; 599  : 
; 600  : 					PacketStream.Clear();

  00fc0	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  00fc6	e8 00 00 00 00	 call	 ?Clear@CStreamPacketEngine_Server@@QAEXXZ ; CStreamPacketEngine_Server::Clear

; 601  : 
; 602  : 					if ( PacketStream.AddData(byDec+1, iSize+2) == 0 )

  00fcb	8b 85 d4 7f ff
	ff		 mov	 eax, DWORD PTR _iSize$230419[ebp]
  00fd1	83 c0 02	 add	 eax, 2
  00fd4	50		 push	 eax
  00fd5	8d 8d e1 7f ff
	ff		 lea	 ecx, DWORD PTR _byDec$[ebp+1]
  00fdb	51		 push	 ecx
  00fdc	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  00fe2	e8 00 00 00 00	 call	 ?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z ; CStreamPacketEngine_Server::AddData
  00fe7	85 c0		 test	 eax, eax
  00fe9	0f 85 97 00 00
	00		 jne	 $LN22@RecvDataPa

; 603  : 					{
; 604  : 						LogAddC(2, "error-L1 : CStreamPacketEngine Adding Error : ip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d", 
; 605  : 							gObj[uIndex].Ip_addr, 
; 606  : 							gObj[uIndex].AccountID, 
; 607  : 							gObj[uIndex].Name, 
; 608  : 							headcode, 
; 609  : 							__FILE__, __LINE__, 
; 610  : 							gObj[uIndex].Connected);

  00fef	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  00ff2	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00ff8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00ffe	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  01002	52		 push	 edx
  01003	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  01008	83 c0 51	 add	 eax, 81			; 00000051H
  0100b	50		 push	 eax
  0100c	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  01011	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  01015	51		 push	 ecx
  01016	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  01019	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  0101f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01024	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  01028	51		 push	 ecx
  01029	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  0102c	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  01032	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01037	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  0103b	51		 push	 ecx
  0103c	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  0103f	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  01045	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0104a	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  0104e	51		 push	 ecx
  0104f	68 00 00 00 00	 push	 OFFSET ??_C@_0GC@CEPNFMLO@error?9L1?5?3?5CStreamPacketEngine?5A@
  01054	6a 02		 push	 2
  01056	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  0105c	83 c4 24	 add	 esp, 36			; 00000024H

; 611  : 						return FALSE;

  0105f	c7 85 40 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230812[ebp], 0
  01069	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01070	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  01076	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  0107b	8b 85 40 67 ff
	ff		 mov	 eax, DWORD PTR $T230812[ebp]
  01081	e9 f7 06 00 00	 jmp	 $LN37@RecvDataPa
$LN22@RecvDataPa:

; 612  : 					}
; 613  : 
; 614  : 					if ( PacketStream.ExtractPacket(byDec) != 0 )

  01086	8d 85 e0 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp]
  0108c	50		 push	 eax
  0108d	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  01093	e8 00 00 00 00	 call	 ?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z ; CStreamPacketEngine_Server::ExtractPacket
  01098	85 c0		 test	 eax, eax
  0109a	0f 84 97 00 00
	00		 je	 $LN21@RecvDataPa

; 615  : 					{
; 616  : 						LogAddC(2, "error-L1 : CStreamPacketEngine ExtractPacket Error : ip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d", 
; 617  : 							gObj[uIndex].Ip_addr, 
; 618  : 							gObj[uIndex].AccountID, 
; 619  : 							gObj[uIndex].Name, 
; 620  : 							headcode, 
; 621  : 							__FILE__, __LINE__, 
; 622  : 							gObj[uIndex].Connected);

  010a0	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  010a3	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  010a9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  010af	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  010b3	52		 push	 edx
  010b4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  010b9	83 c0 5d	 add	 eax, 93			; 0000005dH
  010bc	50		 push	 eax
  010bd	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  010c2	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  010c6	51		 push	 ecx
  010c7	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  010ca	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  010d0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  010d5	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  010d9	51		 push	 ecx
  010da	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  010dd	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  010e3	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  010e8	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  010ec	51		 push	 ecx
  010ed	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  010f0	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  010f6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  010fb	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  010ff	51		 push	 ecx
  01100	68 00 00 00 00	 push	 OFFSET ??_C@_0GJ@IFEOENIG@error?9L1?5?3?5CStreamPacketEngine?5E@
  01105	6a 02		 push	 2
  01107	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  0110d	83 c4 24	 add	 esp, 36			; 00000024H

; 623  : 						return FALSE;

  01110	c7 85 44 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230813[ebp], 0
  0111a	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01121	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  01127	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  0112c	8b 85 44 67 ff
	ff		 mov	 eax, DWORD PTR $T230813[ebp]
  01132	e9 46 06 00 00	 jmp	 $LN37@RecvDataPa
$LN21@RecvDataPa:

; 624  : 					}
; 625  : 
; 626  : 					if ( xcode == 0xC3 && headcode == 0xC5 )

  01137	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  0113b	3d c3 00 00 00	 cmp	 eax, 195		; 000000c3H
  01140	75 1e		 jne	 SHORT $LN20@RecvDataPa
  01142	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  01146	3d c5 00 00 00	 cmp	 eax, 197		; 000000c5H
  0114b	75 13		 jne	 SHORT $LN20@RecvDataPa

; 627  : 					{
; 628  : 						LogAdd(" : [0x%x]" , headcode);

  0114d	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  01151	50		 push	 eax
  01152	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@GEFELIJM@?$LO?O?H?$KD?F?P?E?$LG?5?3?5?$FL0x?$CFx?$FN?$AA@
  01157	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  0115d	83 c4 08	 add	 esp, 8
$LN20@RecvDataPa:

; 629  : 					}
; 630  : 
; 631  : 					if(HackToolCheck(headcode, size, uIndex, xcode) == TRUE)

  01160	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  01164	50		 push	 eax
  01165	8b 4d 0c	 mov	 ecx, DWORD PTR _uIndex$[ebp]
  01168	51		 push	 ecx
  01169	8b 55 e4	 mov	 edx, DWORD PTR _size$[ebp]
  0116c	52		 push	 edx
  0116d	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  01171	50		 push	 eax
  01172	e8 00 00 00 00	 call	 ?HackToolCheck@@YAHEHHE@Z ; HackToolCheck
  01177	83 c4 10	 add	 esp, 16			; 00000010H
  0117a	83 f8 01	 cmp	 eax, 1
  0117d	75 27		 jne	 SHORT $LN19@RecvDataPa

; 632  : 					{
; 633  : 						return FALSE;

  0117f	c7 85 48 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230814[ebp], 0
  01189	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01190	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  01196	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  0119b	8b 85 48 67 ff
	ff		 mov	 eax, DWORD PTR $T230814[ebp]
  011a1	e9 d7 05 00 00	 jmp	 $LN37@RecvDataPa
$LN19@RecvDataPa:

; 634  : 					}
; 635  : 
; 636  : #if(ENABLE_PROTOCOL_QUEUE)
; 637  : 
; 638  : 					QueueInfo.index = uIndex;
; 639  : 					QueueInfo.head = headcode;
; 640  : 					memcpy(QueueInfo.buff, byDec, size);
; 641  : 					QueueInfo.size = iSize;
; 642  : 					QueueInfo.encrypt = 1;
; 643  : 					QueueInfo.serial = subhead;
; 644  : 
; 645  : 					if(g_ServerQueue.AddToQueue(&QueueInfo) != 0)
; 646  : 					{
; 647  : 						ReleaseSemaphore(g_ServerQueueSemaphore, 1, 0);
; 648  : 					}
; 649  : 
; 650  : #else
; 651  : 
; 652  : 					//ProtocolCore(headcode, byDec+1, iSize, uIndex, 1, byDec[0]);
; 653  : 					ProtocolCore(headcode, byDec, iSize, uIndex, 1, subhead);

  011a6	0f b6 85 cf 7f
	ff ff		 movzx	 eax, BYTE PTR _subhead$230424[ebp]
  011ad	50		 push	 eax
  011ae	6a 01		 push	 1
  011b0	8b 4d 0c	 mov	 ecx, DWORD PTR _uIndex$[ebp]
  011b3	51		 push	 ecx
  011b4	8b 95 d4 7f ff
	ff		 mov	 edx, DWORD PTR _iSize$230419[ebp]
  011ba	52		 push	 edx
  011bb	8d 85 e0 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp]
  011c1	50		 push	 eax
  011c2	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  011c6	51		 push	 ecx
  011c7	e8 00 00 00 00	 call	 ?ProtocolCore@@YAXEPAEHHHH@Z ; ProtocolCore
  011cc	83 c4 18	 add	 esp, 24			; 00000018H

; 654  : 
; 655  : #endif
; 656  : 				}

  011cf	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  011d6	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  011dc	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
$LN23@RecvDataPa:
  011e1	e9 e0 04 00 00	 jmp	 $LN18@RecvDataPa
$LN25@RecvDataPa:

; 657  : 			}
; 658  : 
; 659  : 			else if ( xcode == 0xC4 )

  011e6	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  011ea	3d c4 00 00 00	 cmp	 eax, 196		; 000000c4H
  011ef	0f 85 d1 02 00
	00		 jne	 $LN17@RecvDataPa

; 660  : 			{
; 661  : 				int iSize = g_SimpleModulusCS.Decrypt( byDec+3, (recvbuf+lOfs+3), size-3);

  011f5	8b 45 e4	 mov	 eax, DWORD PTR _size$[ebp]
  011f8	83 e8 03	 sub	 eax, 3
  011fb	50		 push	 eax
  011fc	8b 4d e8	 mov	 ecx, DWORD PTR _lOfs$[ebp]
  011ff	8b 55 ec	 mov	 edx, DWORD PTR _recvbuf$[ebp]
  01202	8d 44 0a 03	 lea	 eax, DWORD PTR [edx+ecx+3]
  01206	50		 push	 eax
  01207	8d 8d e3 7f ff
	ff		 lea	 ecx, DWORD PTR _byDec$[ebp+3]
  0120d	51		 push	 ecx
  0120e	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_SimpleModulusCS@@3VCSimpleModulus@@A ; g_SimpleModulusCS
  01213	e8 00 00 00 00	 call	 ?Decrypt@CSimpleModulus@@QAEHPAX0H@Z ; CSimpleModulus::Decrypt
  01218	89 85 c0 77 ff
	ff		 mov	 DWORD PTR _iSize$230439[ebp], eax

; 662  : 				if ( iSize < 0 )

  0121e	83 bd c0 77 ff
	ff 00		 cmp	 DWORD PTR _iSize$230439[ebp], 0
  01225	7d 05		 jge	 SHORT $LN16@RecvDataPa

; 663  : 				{
; 664  : 
; 665  : 				}
; 666  : 				else

  01227	e9 95 02 00 00	 jmp	 $LN15@RecvDataPa
$LN16@RecvDataPa:

; 667  : 				{
; 668  : 					BYTE* pDecBuf = byDec+1;

  0122c	8d 85 e1 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp+1]
  01232	89 85 bc 77 ff
	ff		 mov	 DWORD PTR _pDecBuf$230442[ebp], eax

; 669  : 					BYTE subhead	= byDec[3];

  01238	8a 85 e3 7f ff
	ff		 mov	 al, BYTE PTR _byDec$[ebp+3]
  0123e	88 85 bb 77 ff
	ff		 mov	 BYTE PTR _subhead$230443[ebp], al

; 670  : 					byDec[1]		= 0xC2;

  01244	c6 85 e1 7f ff
	ff c2		 mov	 BYTE PTR _byDec$[ebp+1], 194 ; 000000c2H

; 671  : 					WORD wsize		= ((WORD)iSize)+3;

  0124b	0f b7 85 c0 77
	ff ff		 movzx	 eax, WORD PTR _iSize$230439[ebp]
  01252	83 c0 03	 add	 eax, 3
  01255	66 89 85 b4 77
	ff ff		 mov	 WORD PTR _wsize$230444[ebp], ax

; 672  : 					byDec[2]		= SET_NUMBERH(wsize);

  0125c	0f b7 85 b4 77
	ff ff		 movzx	 eax, WORD PTR _wsize$230444[ebp]
  01263	c1 e8 08	 shr	 eax, 8
  01266	88 85 e2 7f ff
	ff		 mov	 BYTE PTR _byDec$[ebp+2], al

; 673  : 					byDec[3]		= SET_NUMBERL(wsize);

  0126c	0f b7 85 b4 77
	ff ff		 movzx	 eax, WORD PTR _wsize$230444[ebp]
  01273	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  01278	88 85 e3 7f ff
	ff		 mov	 BYTE PTR _byDec$[ebp+3], al

; 674  : 
; 675  : 					CStreamPacketEngine_Server PacketStream;

  0127e	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  01284	e8 00 00 00 00	 call	 ??0CStreamPacketEngine_Server@@QAE@XZ ; CStreamPacketEngine_Server::CStreamPacketEngine_Server
  01289	c7 45 fc 01 00
	00 00		 mov	 DWORD PTR __$EHRec$[ebp+8], 1

; 676  : 
; 677  : 					PacketStream.Clear();

  01290	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  01296	e8 00 00 00 00	 call	 ?Clear@CStreamPacketEngine_Server@@QAEXXZ ; CStreamPacketEngine_Server::Clear

; 678  : 					if ( PacketStream.AddData(byDec+1, iSize+3) == 0 )

  0129b	8b 85 c0 77 ff
	ff		 mov	 eax, DWORD PTR _iSize$230439[ebp]
  012a1	83 c0 03	 add	 eax, 3
  012a4	50		 push	 eax
  012a5	8d 8d e1 7f ff
	ff		 lea	 ecx, DWORD PTR _byDec$[ebp+1]
  012ab	51		 push	 ecx
  012ac	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  012b2	e8 00 00 00 00	 call	 ?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z ; CStreamPacketEngine_Server::AddData
  012b7	85 c0		 test	 eax, eax
  012b9	0f 85 99 00 00
	00		 jne	 $LN14@RecvDataPa

; 679  : 					{
; 680  : 						LogAddC(2, "error-L1 : CStreamPacketEngine Adding Error : ip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d",	
; 681  : 							gObj[uIndex].Ip_addr, 
; 682  : 							gObj[uIndex].AccountID, 
; 683  : 							gObj[uIndex].Name, 
; 684  : 							headcode, 
; 685  : 							__FILE__, 
; 686  : 							__LINE__, 
; 687  : 							gObj[uIndex].Connected);

  012bf	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  012c2	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  012c8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  012ce	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  012d2	52		 push	 edx
  012d3	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  012d8	05 9e 00 00 00	 add	 eax, 158		; 0000009eH
  012dd	50		 push	 eax
  012de	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  012e3	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  012e7	51		 push	 ecx
  012e8	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  012eb	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  012f1	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  012f6	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  012fa	51		 push	 ecx
  012fb	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  012fe	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  01304	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01309	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  0130d	51		 push	 ecx
  0130e	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  01311	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  01317	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0131c	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  01320	51		 push	 ecx
  01321	68 00 00 00 00	 push	 OFFSET ??_C@_0GC@CEPNFMLO@error?9L1?5?3?5CStreamPacketEngine?5A@
  01326	6a 02		 push	 2
  01328	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  0132e	83 c4 24	 add	 esp, 36			; 00000024H

; 688  : 						return FALSE;

  01331	c7 85 4c 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230815[ebp], 0
  0133b	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01342	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  01348	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  0134d	8b 85 4c 67 ff
	ff		 mov	 eax, DWORD PTR $T230815[ebp]
  01353	e9 25 04 00 00	 jmp	 $LN37@RecvDataPa
$LN14@RecvDataPa:

; 689  : 					}
; 690  : 
; 691  : 					if ( PacketStream.ExtractPacket(byDec) != 0 )

  01358	8d 85 e0 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp]
  0135e	50		 push	 eax
  0135f	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  01365	e8 00 00 00 00	 call	 ?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z ; CStreamPacketEngine_Server::ExtractPacket
  0136a	85 c0		 test	 eax, eax
  0136c	0f 84 99 00 00
	00		 je	 $LN13@RecvDataPa

; 692  : 					{
; 693  : 						LogAddC(2, "error-L1 : CStreamPacketEngine ExtractPacket Error : ip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d", 
; 694  : 							gObj[uIndex].Ip_addr, 
; 695  : 							gObj[uIndex].AccountID, 
; 696  : 							gObj[uIndex].Name, 
; 697  : 							headcode, 
; 698  : 							__FILE__, 
; 699  : 							__LINE__, 
; 700  : 							gObj[uIndex].Connected);

  01372	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  01375	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0137b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01381	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  01385	52		 push	 edx
  01386	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  0138b	05 ab 00 00 00	 add	 eax, 171		; 000000abH
  01390	50		 push	 eax
  01391	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  01396	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  0139a	51		 push	 ecx
  0139b	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  0139e	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  013a4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  013a9	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  013ad	51		 push	 ecx
  013ae	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  013b1	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  013b7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  013bc	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  013c0	51		 push	 ecx
  013c1	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  013c4	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  013ca	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  013cf	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  013d3	51		 push	 ecx
  013d4	68 00 00 00 00	 push	 OFFSET ??_C@_0GJ@IFEOENIG@error?9L1?5?3?5CStreamPacketEngine?5E@
  013d9	6a 02		 push	 2
  013db	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  013e1	83 c4 24	 add	 esp, 36			; 00000024H

; 701  : 						return FALSE;

  013e4	c7 85 50 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230816[ebp], 0
  013ee	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  013f5	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  013fb	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  01400	8b 85 50 67 ff
	ff		 mov	 eax, DWORD PTR $T230816[ebp]
  01406	e9 72 03 00 00	 jmp	 $LN37@RecvDataPa
$LN13@RecvDataPa:

; 702  : 					}
; 703  : 
; 704  : 					headcode = pDecBuf[2];

  0140b	8b 85 bc 77 ff
	ff		 mov	 eax, DWORD PTR _pDecBuf$230442[ebp]
  01411	8a 48 02	 mov	 cl, BYTE PTR [eax+2]
  01414	88 4d e3	 mov	 BYTE PTR _headcode$[ebp], cl

; 705  : 
; 706  : 					if ( xcode == 0xC4 && headcode == 0xC5 )

  01417	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  0141b	3d c4 00 00 00	 cmp	 eax, 196		; 000000c4H
  01420	75 1e		 jne	 SHORT $LN12@RecvDataPa
  01422	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  01426	3d c5 00 00 00	 cmp	 eax, 197		; 000000c5H
  0142b	75 13		 jne	 SHORT $LN12@RecvDataPa

; 707  : 					{
; 708  : 						LogAdd(" : [0x%x]" , headcode);

  0142d	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  01431	50		 push	 eax
  01432	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@GEFELIJM@?$LO?O?H?$KD?F?P?E?$LG?5?3?5?$FL0x?$CFx?$FN?$AA@
  01437	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  0143d	83 c4 08	 add	 esp, 8
$LN12@RecvDataPa:

; 709  : 					}
; 710  : 
; 711  : 					if(HackToolCheck(headcode, size, uIndex, xcode) == TRUE)

  01440	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  01444	50		 push	 eax
  01445	8b 4d 0c	 mov	 ecx, DWORD PTR _uIndex$[ebp]
  01448	51		 push	 ecx
  01449	8b 55 e4	 mov	 edx, DWORD PTR _size$[ebp]
  0144c	52		 push	 edx
  0144d	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  01451	50		 push	 eax
  01452	e8 00 00 00 00	 call	 ?HackToolCheck@@YAHEHHE@Z ; HackToolCheck
  01457	83 c4 10	 add	 esp, 16			; 00000010H
  0145a	83 f8 01	 cmp	 eax, 1
  0145d	75 27		 jne	 SHORT $LN11@RecvDataPa

; 712  : 					{
; 713  : 						return FALSE;

  0145f	c7 85 54 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230817[ebp], 0
  01469	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01470	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  01476	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  0147b	8b 85 54 67 ff
	ff		 mov	 eax, DWORD PTR $T230817[ebp]
  01481	e9 f7 02 00 00	 jmp	 $LN37@RecvDataPa
$LN11@RecvDataPa:

; 714  : 					}
; 715  : 	
; 716  : #if(ENABLE_PROTOCOL_QUEUE)
; 717  : 
; 718  : 					QueueInfo.index = uIndex;
; 719  : 					QueueInfo.head = headcode;
; 720  : 					memcpy(QueueInfo.buff, byDec, size);
; 721  : 					QueueInfo.size = iSize;
; 722  : 					QueueInfo.encrypt = 1;
; 723  : 					QueueInfo.serial = subhead;
; 724  : 
; 725  : 					if(g_ServerQueue.AddToQueue(&QueueInfo) != 0)
; 726  : 					{
; 727  : 						ReleaseSemaphore(g_ServerQueueSemaphore, 1, 0);
; 728  : 					}
; 729  : 
; 730  : #else
; 731  : 
; 732  : 					ProtocolCore(headcode, byDec, iSize, uIndex, 1, subhead);

  01486	0f b6 85 bb 77
	ff ff		 movzx	 eax, BYTE PTR _subhead$230443[ebp]
  0148d	50		 push	 eax
  0148e	6a 01		 push	 1
  01490	8b 4d 0c	 mov	 ecx, DWORD PTR _uIndex$[ebp]
  01493	51		 push	 ecx
  01494	8b 95 c0 77 ff
	ff		 mov	 edx, DWORD PTR _iSize$230439[ebp]
  0149a	52		 push	 edx
  0149b	8d 85 e0 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp]
  014a1	50		 push	 eax
  014a2	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  014a6	51		 push	 ecx
  014a7	e8 00 00 00 00	 call	 ?ProtocolCore@@YAXEPAEHHHH@Z ; ProtocolCore
  014ac	83 c4 18	 add	 esp, 24			; 00000018H

; 733  : 
; 734  : #endif
; 735  : 				}

  014af	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  014b6	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  014bc	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
$LN15@RecvDataPa:

; 736  : 			}
; 737  : 			else

  014c1	e9 00 02 00 00	 jmp	 $LN18@RecvDataPa
$LN17@RecvDataPa:

; 738  : 			{
; 739  : 				CStreamPacketEngine_Server ps;

  014c6	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  014cc	e8 00 00 00 00	 call	 ??0CStreamPacketEngine_Server@@QAE@XZ ; CStreamPacketEngine_Server::CStreamPacketEngine_Server
  014d1	c7 45 fc 02 00
	00 00		 mov	 DWORD PTR __$EHRec$[ebp+8], 2

; 740  : 				ps.Clear();

  014d8	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  014de	e8 00 00 00 00	 call	 ?Clear@CStreamPacketEngine_Server@@QAEXXZ ; CStreamPacketEngine_Server::Clear

; 741  : 				
; 742  : 				if ( ps.AddData(recvbuf+lOfs, size) == 0 )

  014e3	0f b7 45 e4	 movzx	 eax, WORD PTR _size$[ebp]
  014e7	50		 push	 eax
  014e8	8b 4d ec	 mov	 ecx, DWORD PTR _recvbuf$[ebp]
  014eb	03 4d e8	 add	 ecx, DWORD PTR _lOfs$[ebp]
  014ee	51		 push	 ecx
  014ef	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  014f5	e8 00 00 00 00	 call	 ?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z ; CStreamPacketEngine_Server::AddData
  014fa	85 c0		 test	 eax, eax
  014fc	0f 85 99 00 00
	00		 jne	 $LN9@RecvDataPa

; 743  : 				{
; 744  : 					LogAddC(2, "error-L1 : CStreamPacketEngine Adding Error : ip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d", 
; 745  : 						gObj[uIndex].Ip_addr, 
; 746  : 						gObj[uIndex].AccountID, 
; 747  : 						gObj[uIndex].Name, 
; 748  : 						headcode, 
; 749  : 						__FILE__, __LINE__, 
; 750  : 						gObj[uIndex].Connected);

  01502	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  01505	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0150b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01511	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  01515	52		 push	 edx
  01516	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  0151b	05 dd 00 00 00	 add	 eax, 221		; 000000ddH
  01520	50		 push	 eax
  01521	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  01526	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  0152a	51		 push	 ecx
  0152b	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  0152e	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  01534	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01539	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  0153d	51		 push	 ecx
  0153e	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  01541	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  01547	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0154c	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  01550	51		 push	 ecx
  01551	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  01554	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  0155a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0155f	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  01563	51		 push	 ecx
  01564	68 00 00 00 00	 push	 OFFSET ??_C@_0GC@CEPNFMLO@error?9L1?5?3?5CStreamPacketEngine?5A@
  01569	6a 02		 push	 2
  0156b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  01571	83 c4 24	 add	 esp, 36			; 00000024H

; 751  : 					return FALSE;

  01574	c7 85 58 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230818[ebp], 0
  0157e	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01585	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  0158b	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  01590	8b 85 58 67 ff
	ff		 mov	 eax, DWORD PTR $T230818[ebp]
  01596	e9 e2 01 00 00	 jmp	 $LN37@RecvDataPa
$LN9@RecvDataPa:

; 752  : 				}
; 753  : 
; 754  : 
; 755  : 
; 756  : 				if ( ps.ExtractPacket(byDec) != 0 )

  0159b	8d 85 e0 7f ff
	ff		 lea	 eax, DWORD PTR _byDec$[ebp]
  015a1	50		 push	 eax
  015a2	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  015a8	e8 00 00 00 00	 call	 ?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z ; CStreamPacketEngine_Server::ExtractPacket
  015ad	85 c0		 test	 eax, eax
  015af	0f 84 99 00 00
	00		 je	 $LN8@RecvDataPa

; 757  : 				{
; 758  : 					LogAddC(2, "error-L1 : CStreamPacketEngine ExtractPacket Error : ip = %s account:%s name:%s HEAD:%x (%s,%d) State:%d", 
; 759  : 						gObj[uIndex].Ip_addr, 
; 760  : 						gObj[uIndex].AccountID, 
; 761  : 						gObj[uIndex].Name, 
; 762  : 						headcode, 
; 763  : 						__FILE__, __LINE__, 
; 764  : 						gObj[uIndex].Connected);

  015b5	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  015b8	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  015be	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  015c4	8b 54 01 04	 mov	 edx, DWORD PTR [ecx+eax+4]
  015c8	52		 push	 edx
  015c9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  015ce	05 eb 00 00 00	 add	 eax, 235		; 000000ebH
  015d3	50		 push	 eax
  015d4	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  015d9	0f b6 4d e3	 movzx	 ecx, BYTE PTR _headcode$[ebp]
  015dd	51		 push	 ecx
  015de	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  015e1	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  015e7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  015ec	8d 4c 10 77	 lea	 ecx, DWORD PTR [eax+edx+119]
  015f0	51		 push	 ecx
  015f1	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  015f4	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  015fa	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  015ff	8d 4c 10 6c	 lea	 ecx, DWORD PTR [eax+edx+108]
  01603	51		 push	 ecx
  01604	8b 55 0c	 mov	 edx, DWORD PTR _uIndex$[ebp]
  01607	69 d2 38 2b 00
	00		 imul	 edx, 11064		; 00002b38H
  0160d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01612	8d 4c 10 18	 lea	 ecx, DWORD PTR [eax+edx+24]
  01616	51		 push	 ecx
  01617	68 00 00 00 00	 push	 OFFSET ??_C@_0GJ@IFEOENIG@error?9L1?5?3?5CStreamPacketEngine?5E@
  0161c	6a 02		 push	 2
  0161e	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  01624	83 c4 24	 add	 esp, 36			; 00000024H

; 765  : 					return FALSE;

  01627	c7 85 5c 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230819[ebp], 0
  01631	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  01638	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  0163e	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  01643	8b 85 5c 67 ff
	ff		 mov	 eax, DWORD PTR $T230819[ebp]
  01649	e9 2f 01 00 00	 jmp	 $LN37@RecvDataPa
$LN8@RecvDataPa:

; 766  : 				}
; 767  : 
; 768  : 				if(HackToolCheck(headcode, size, uIndex, xcode) == TRUE)

  0164e	0f b6 45 e2	 movzx	 eax, BYTE PTR _xcode$[ebp]
  01652	50		 push	 eax
  01653	8b 4d 0c	 mov	 ecx, DWORD PTR _uIndex$[ebp]
  01656	51		 push	 ecx
  01657	8b 55 e4	 mov	 edx, DWORD PTR _size$[ebp]
  0165a	52		 push	 edx
  0165b	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  0165f	50		 push	 eax
  01660	e8 00 00 00 00	 call	 ?HackToolCheck@@YAHEHHE@Z ; HackToolCheck
  01665	83 c4 10	 add	 esp, 16			; 00000010H
  01668	83 f8 01	 cmp	 eax, 1
  0166b	75 27		 jne	 SHORT $LN7@RecvDataPa

; 769  : 				{
; 770  : 					return FALSE;

  0166d	c7 85 60 67 ff
	ff 00 00 00 00	 mov	 DWORD PTR $T230820[ebp], 0
  01677	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  0167e	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  01684	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  01689	8b 85 60 67 ff
	ff		 mov	 eax, DWORD PTR $T230820[ebp]
  0168f	e9 e9 00 00 00	 jmp	 $LN37@RecvDataPa
$LN7@RecvDataPa:

; 771  : 				}
; 772  : 
; 773  : #if(ENABLE_PROTOCOL_QUEUE)
; 774  : 
; 775  : 				QueueInfo.index = uIndex;
; 776  : 				QueueInfo.head = headcode;
; 777  : 				memcpy(QueueInfo.buff, byDec, size);
; 778  : 				QueueInfo.size = size;
; 779  : 				QueueInfo.encrypt = 0;
; 780  : 				QueueInfo.serial = -1;
; 781  : 
; 782  : 				if(g_ServerQueue.AddToQueue(&QueueInfo) != 0)
; 783  : 				{
; 784  : 					ReleaseSemaphore(g_ServerQueueSemaphore, 1, 0);
; 785  : 				}
; 786  : 				
; 787  : #else
; 788  : 
; 789  : 				ProtocolCore(headcode, byDec, size, uIndex, 0, -1);

  01694	6a ff		 push	 -1
  01696	6a 00		 push	 0
  01698	8b 45 0c	 mov	 eax, DWORD PTR _uIndex$[ebp]
  0169b	50		 push	 eax
  0169c	8b 4d e4	 mov	 ecx, DWORD PTR _size$[ebp]
  0169f	51		 push	 ecx
  016a0	8d 95 e0 7f ff
	ff		 lea	 edx, DWORD PTR _byDec$[ebp]
  016a6	52		 push	 edx
  016a7	0f b6 45 e3	 movzx	 eax, BYTE PTR _headcode$[ebp]
  016ab	50		 push	 eax
  016ac	e8 00 00 00 00	 call	 ?ProtocolCore@@YAXEPAEHHHH@Z ; ProtocolCore
  016b1	83 c4 18	 add	 esp, 24			; 00000018H

; 790  : 
; 791  : #endif
; 792  : 
; 793  : 			}

  016b4	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR __$EHRec$[ebp+8], -1
  016bb	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  016c1	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
$LN18@RecvDataPa:

; 794  : 
; 795  : 			lOfs += size;

  016c6	8b 45 e8	 mov	 eax, DWORD PTR _lOfs$[ebp]
  016c9	03 45 e4	 add	 eax, DWORD PTR _size$[ebp]
  016cc	89 45 e8	 mov	 DWORD PTR _lOfs$[ebp], eax

; 796  : 			lpIOContext->nSentBytes  -= size;

  016cf	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  016d2	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  016d8	2b 4d e4	 sub	 ecx, DWORD PTR _size$[ebp]
  016db	8b 55 08	 mov	 edx, DWORD PTR _lpIOContext$[ebp]
  016de	89 8a 24 00 02
	00		 mov	 DWORD PTR [edx+131108], ecx

; 797  : 
; 798  : 			if ( lpIOContext->nSentBytes <= 0 )

  016e4	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  016e7	83 b8 24 00 02
	00 00		 cmp	 DWORD PTR [eax+131108], 0
  016ee	7f 05		 jg	 SHORT $LN6@RecvDataPa

; 799  : 			{
; 800  : 				break;

  016f0	e9 83 00 00 00	 jmp	 $LN34@RecvDataPa
$LN6@RecvDataPa:

; 801  : 			}
; 802  : 		}

  016f5	eb 7c		 jmp	 SHORT $LN5@RecvDataPa
$LN26@RecvDataPa:

; 803  : 		else if ( lOfs > 0 )

  016f7	83 7d e8 00	 cmp	 DWORD PTR _lOfs$[ebp], 0
  016fb	7e 74		 jle	 SHORT $LN4@RecvDataPa

; 804  : 		{
; 805  : 			if ( lpIOContext->nSentBytes < 1 )

  016fd	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  01700	83 b8 24 00 02
	00 01		 cmp	 DWORD PTR [eax+131108], 1
  01707	7d 20		 jge	 SHORT $LN3@RecvDataPa

; 806  : 			{
; 807  : 				LogAdd("error-L1 : recvbuflen 1 %s %d", __FILE__, __LINE__);

  01709	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z@4JA
  0170e	05 17 01 00 00	 add	 eax, 279		; 00000117H
  01713	50		 push	 eax
  01714	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  01719	68 00 00 00 00	 push	 OFFSET ??_C@_0BO@OCHJCCMB@error?9L1?5?3?5recvbuflen?51?5?$CFs?5?$CFd?$AA@
  0171e	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01724	83 c4 0c	 add	 esp, 12			; 0000000cH

; 808  : 				break;

  01727	eb 4f		 jmp	 SHORT $LN34@RecvDataPa
$LN3@RecvDataPa:

; 809  : 			}
; 810  : 
; 811  : 			if ( lpIOContext->nSentBytes < MAX_IO_BUFFER_SIZE ) 

  01729	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  0172c	81 b8 24 00 02
	00 ff ff 00 00	 cmp	 DWORD PTR [eax+131108], 65535 ; 0000ffffH
  01736	7d 35		 jge	 SHORT $LN2@RecvDataPa

; 812  : 			{
; 813  : 				memcpy(recvbuf, &recvbuf[lOfs], lpIOContext->nSentBytes);

  01738	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  0173b	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  01741	51		 push	 ecx
  01742	8b 55 ec	 mov	 edx, DWORD PTR _recvbuf$[ebp]
  01745	03 55 e8	 add	 edx, DWORD PTR _lOfs$[ebp]
  01748	52		 push	 edx
  01749	8b 45 ec	 mov	 eax, DWORD PTR _recvbuf$[ebp]
  0174c	50		 push	 eax
  0174d	e8 00 00 00 00	 call	 _memcpy
  01752	83 c4 0c	 add	 esp, 12			; 0000000cH

; 814  : 				LogAdd("Message copy %d", lpIOContext->nSentBytes);

  01755	8b 45 08	 mov	 eax, DWORD PTR _lpIOContext$[ebp]
  01758	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  0175e	51		 push	 ecx
  0175f	68 00 00 00 00	 push	 OFFSET ??_C@_0BA@OIIBACED@Message?5copy?5?$CFd?$AA@
  01764	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  0176a	83 c4 08	 add	 esp, 8
$LN2@RecvDataPa:

; 815  : 				//break;
; 816  : 			}
; 817  : 			break;

  0176d	eb 09		 jmp	 SHORT $LN34@RecvDataPa

; 818  : 		
; 819  : 		}
; 820  : 		else

  0176f	eb 02		 jmp	 SHORT $LN5@RecvDataPa
$LN4@RecvDataPa:

; 821  : 		{
; 822  : 			break;

  01771	eb 05		 jmp	 SHORT $LN34@RecvDataPa
$LN5@RecvDataPa:

; 823  : 		}
; 824  : 		
; 825  : 	}

  01773	e9 7b f6 ff ff	 jmp	 $LN35@RecvDataPa
$LN34@RecvDataPa:

; 826  : 
; 827  : 	return true;

  01778	b8 01 00 00 00	 mov	 eax, 1
$LN37@RecvDataPa:

; 828  : }

  0177d	8b 4d f4	 mov	 ecx, DWORD PTR __$EHRec$[ebp]
  01780	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  01787	59		 pop	 ecx
  01788	5f		 pop	 edi
  01789	5e		 pop	 esi
  0178a	5b		 pop	 ebx
  0178b	8b 4d f0	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0178e	33 cd		 xor	 ecx, ebp
  01790	e8 00 00 00 00	 call	 @__security_check_cookie@4
  01795	8b e5		 mov	 esp, ebp
  01797	5d		 pop	 ebp
  01798	c3		 ret	 0
_TEXT	ENDS
text$x	SEGMENT
__unwindfunclet$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z$0:
  00000	8d 8d c4 77 ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230426[ebp]
  00006	e9 00 00 00 00	 jmp	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
__unwindfunclet$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z$1:
  0000b	8d 8d ac 6f ff
	ff		 lea	 ecx, DWORD PTR _PacketStream$230451[ebp]
  00011	e9 00 00 00 00	 jmp	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
__unwindfunclet$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z$2:
  00016	8d 8d a4 67 ff
	ff		 lea	 ecx, DWORD PTR _ps$230460[ebp]
  0001c	e9 00 00 00 00	 jmp	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
__ehhandler$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z:
  00021	8b 54 24 08	 mov	 edx, DWORD PTR [esp+8]
  00025	8d 42 0c	 lea	 eax, DWORD PTR [edx+12]
  00028	8b 8a 3c 67 ff
	ff		 mov	 ecx, DWORD PTR [edx-39108]
  0002e	33 c8		 xor	 ecx, eax
  00030	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00035	8b 4a fc	 mov	 ecx, DWORD PTR [edx-4]
  00038	33 c8		 xor	 ecx, eax
  0003a	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0003f	b8 00 00 00 00	 mov	 eax, OFFSET __ehfuncinfo$?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z
  00044	e9 00 00 00 00	 jmp	 ___CxxFrameHandler3
text$x	ENDS
?RecvDataParse@@YAHPAU_PER_IO_CONTEXT@@H@Z ENDP		; RecvDataParse
PUBLIC	??_7CStreamPacketEngine_Server@@6B@		; CStreamPacketEngine_Server::`vftable'
PUBLIC	??_R4CStreamPacketEngine_Server@@6B@		; CStreamPacketEngine_Server::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCStreamPacketEngine_Server@@@8		; CStreamPacketEngine_Server `RTTI Type Descriptor'
PUBLIC	??_R3CStreamPacketEngine_Server@@8		; CStreamPacketEngine_Server::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CStreamPacketEngine_Server@@8		; CStreamPacketEngine_Server::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CStreamPacketEngine_Server@@8	; CStreamPacketEngine_Server::`RTTI Base Class Descriptor at (0,-1,0,64)'
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	??_ECStreamPacketEngine_Server@@UAEPAXI@Z:PROC	; CStreamPacketEngine_Server::`vector deleting destructor'
;	COMDAT ??_R1A@?0A@EA@CStreamPacketEngine_Server@@8
; File d:\projects\exteam6.3\source\gameserver\gameserver\spe.h
rdata$r	SEGMENT
??_R1A@?0A@EA@CStreamPacketEngine_Server@@8 DD FLAT:??_R0?AVCStreamPacketEngine_Server@@@8 ; CStreamPacketEngine_Server::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CStreamPacketEngine_Server@@8
rdata$r	ENDS
;	COMDAT ??_R2CStreamPacketEngine_Server@@8
rdata$r	SEGMENT
??_R2CStreamPacketEngine_Server@@8 DD FLAT:??_R1A@?0A@EA@CStreamPacketEngine_Server@@8 ; CStreamPacketEngine_Server::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CStreamPacketEngine_Server@@8
rdata$r	SEGMENT
??_R3CStreamPacketEngine_Server@@8 DD 00H		; CStreamPacketEngine_Server::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CStreamPacketEngine_Server@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCStreamPacketEngine_Server@@@8
_DATA	SEGMENT
??_R0?AVCStreamPacketEngine_Server@@@8 DD FLAT:??_7type_info@@6B@ ; CStreamPacketEngine_Server `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCStreamPacketEngine_Server@@', 00H
_DATA	ENDS
;	COMDAT ??_R4CStreamPacketEngine_Server@@6B@
rdata$r	SEGMENT
??_R4CStreamPacketEngine_Server@@6B@ DD 00H		; CStreamPacketEngine_Server::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCStreamPacketEngine_Server@@@8
	DD	FLAT:??_R3CStreamPacketEngine_Server@@8
rdata$r	ENDS
;	COMDAT ??_7CStreamPacketEngine_Server@@6B@
CONST	SEGMENT
??_7CStreamPacketEngine_Server@@6B@ DD FLAT:??_R4CStreamPacketEngine_Server@@6B@ ; CStreamPacketEngine_Server::`vftable'
	DD	FLAT:??_ECStreamPacketEngine_Server@@UAEPAXI@Z
; Function compile flags: /Odtp /ZI
CONST	ENDS
;	COMDAT ??0CStreamPacketEngine_Server@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0CStreamPacketEngine_Server@@QAE@XZ PROC		; CStreamPacketEngine_Server::CStreamPacketEngine_Server, COMDAT
; _this$ = ecx

; 15   : 	CStreamPacketEngine_Server()

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CStreamPacketEngine_Server@@6B@

; 16   : 	{
; 17   : 		this->Clear();

  00015	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00018	e8 00 00 00 00	 call	 ?Clear@CStreamPacketEngine_Server@@QAEXXZ ; CStreamPacketEngine_Server::Clear

; 18   : 	};

  0001d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00020	5f		 pop	 edi
  00021	5e		 pop	 esi
  00022	5b		 pop	 ebx
  00023	8b e5		 mov	 esp, ebp
  00025	5d		 pop	 ebp
  00026	c3		 ret	 0
??0CStreamPacketEngine_Server@@QAE@XZ ENDP		; CStreamPacketEngine_Server::CStreamPacketEngine_Server
; Function compile flags: /Odtp /ZI
_TEXT	ENDS
;	COMDAT ??1CStreamPacketEngine_Server@@UAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??1CStreamPacketEngine_Server@@UAE@XZ PROC		; CStreamPacketEngine_Server::~CStreamPacketEngine_Server, COMDAT
; _this$ = ecx

; 21   : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CStreamPacketEngine_Server@@6B@

; 22   : 		return;
; 23   : 	};

  00015	5f		 pop	 edi
  00016	5e		 pop	 esi
  00017	5b		 pop	 ebx
  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c3		 ret	 0
??1CStreamPacketEngine_Server@@UAE@XZ ENDP		; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
; Function compile flags: /Odtp /ZI
_TEXT	ENDS
;	COMDAT ?Clear@CStreamPacketEngine_Server@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?Clear@CStreamPacketEngine_Server@@QAEXXZ PROC		; CStreamPacketEngine_Server::Clear, COMDAT
; _this$ = ecx

; 26   : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 27   : 		this->m_wSize = 0;

  0000c	33 c0		 xor	 eax, eax
  0000e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00011	66 89 41 04	 mov	 WORD PTR [ecx+4], ax

; 28   : 	};

  00015	5f		 pop	 edi
  00016	5e		 pop	 esi
  00017	5b		 pop	 ebx
  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c3		 ret	 0
?Clear@CStreamPacketEngine_Server@@QAEXXZ ENDP		; CStreamPacketEngine_Server::Clear
_TEXT	ENDS
PUBLIC	??_C@_0DA@IBFCCNK@CStreamPacketEngine?5Adding?5Buffe@ ; `string'
;	COMDAT ??_C@_0DA@IBFCCNK@CStreamPacketEngine?5Adding?5Buffe@
CONST	SEGMENT
??_C@_0DA@IBFCCNK@CStreamPacketEngine?5Adding?5Buffe@ DB 'CStreamPacketEn'
	DB	'gine Adding Buffer Size Error %d', 00H	; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
;	COMDAT ?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z
_TEXT	SEGMENT
_iSize$204504 = -8					; size = 4
_this$ = -4						; size = 4
_pSrc$ = 8						; size = 4
_wSize$ = 12						; size = 2
?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z PROC	; CStreamPacketEngine_Server::AddData, COMDAT
; _this$ = ecx

; 118  : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 119  : 		if ( ((this->m_wSize + wSize) >=  2048) ||  (wSize == 0) )

  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	0f b7 48 04	 movzx	 ecx, WORD PTR [eax+4]
  00013	0f b7 55 0c	 movzx	 edx, WORD PTR _wSize$[ebp]
  00017	03 ca		 add	 ecx, edx
  00019	81 f9 00 08 00
	00		 cmp	 ecx, 2048		; 00000800H
  0001f	7d 08		 jge	 SHORT $LN1@AddData
  00021	0f b7 45 0c	 movzx	 eax, WORD PTR _wSize$[ebp]
  00025	85 c0		 test	 eax, eax
  00027	75 29		 jne	 SHORT $LN2@AddData
$LN1@AddData:

; 120  : 		{
; 121  : 			LogAddC(2,"CStreamPacketEngine Adding Buffer Size Error %d", this->m_wSize + wSize);

  00029	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002c	0f b7 48 04	 movzx	 ecx, WORD PTR [eax+4]
  00030	0f b7 55 0c	 movzx	 edx, WORD PTR _wSize$[ebp]
  00034	03 ca		 add	 ecx, edx
  00036	51		 push	 ecx
  00037	68 00 00 00 00	 push	 OFFSET ??_C@_0DA@IBFCCNK@CStreamPacketEngine?5Adding?5Buffe@
  0003c	6a 02		 push	 2
  0003e	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  00044	83 c4 0c	 add	 esp, 12			; 0000000cH

; 122  : 			int iSize = 2048;

  00047	c7 45 f8 00 08
	00 00		 mov	 DWORD PTR _iSize$204504[ebp], 2048 ; 00000800H

; 123  : 			return FALSE;

  0004e	33 c0		 xor	 eax, eax
  00050	eb 39		 jmp	 SHORT $LN3@AddData
$LN2@AddData:

; 124  : 		}
; 125  : 
; 126  : 		memcpy((void*)&this->m_byBuffer[this->m_wSize], pSrc, wSize);

  00052	0f b7 45 0c	 movzx	 eax, WORD PTR _wSize$[ebp]
  00056	50		 push	 eax
  00057	8b 4d 08	 mov	 ecx, DWORD PTR _pSrc$[ebp]
  0005a	51		 push	 ecx
  0005b	8b 55 fc	 mov	 edx, DWORD PTR _this$[ebp]
  0005e	0f b7 42 04	 movzx	 eax, WORD PTR [edx+4]
  00062	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00065	8d 54 01 06	 lea	 edx, DWORD PTR [ecx+eax+6]
  00069	52		 push	 edx
  0006a	e8 00 00 00 00	 call	 _memcpy
  0006f	83 c4 0c	 add	 esp, 12			; 0000000cH

; 127  : 		this->m_wSize += wSize;

  00072	0f b7 45 0c	 movzx	 eax, WORD PTR _wSize$[ebp]
  00076	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00079	0f b7 51 04	 movzx	 edx, WORD PTR [ecx+4]
  0007d	03 d0		 add	 edx, eax
  0007f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00082	66 89 50 04	 mov	 WORD PTR [eax+4], dx

; 128  : 		return TRUE;

  00086	b8 01 00 00 00	 mov	 eax, 1
$LN3@AddData:

; 129  : 	}

  0008b	5f		 pop	 edi
  0008c	5e		 pop	 esi
  0008d	5b		 pop	 ebx
  0008e	8b e5		 mov	 esp, ebp
  00090	5d		 pop	 ebp
  00091	c2 08 00	 ret	 8
?AddData@CStreamPacketEngine_Server@@QAEHPAXG@Z ENDP	; CStreamPacketEngine_Server::AddData
_TEXT	ENDS
PUBLIC	?XorData@CStreamPacketEngine_Server@@IAEXHHH@Z	; CStreamPacketEngine_Server::XorData
PUBLIC	__$ArrayPad$
; Function compile flags: /Odtp /ZI
;	COMDAT ?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z
_TEXT	SEGMENT
tv67 = -2160						; size = 4
_byTemp$ = -2092					; size = 2048
_byXorFilter$ = -44					; size = 32
_wSize$ = -12						; size = 2
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
_pTar$ = 8						; size = 4
?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z PROC ; CStreamPacketEngine_Server::ExtractPacket, COMDAT
; _this$ = ecx

; 132  : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 70 08 00
	00		 sub	 esp, 2160		; 00000870H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	53		 push	 ebx
  00014	56		 push	 esi
  00015	57		 push	 edi
  00016	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 133  : 		WORD wSize;
; 134  : 		BYTE byXorFilter[32];
; 135  : 
; 136  : 		BYTE byTemp[2048];
; 137  : 
; 138  : 		
; 139  : 
; 140  : 		switch ( this->m_byBuffer[0] )

  00019	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0001c	8a 48 06	 mov	 cl, BYTE PTR [eax+6]
  0001f	88 8d 90 f7 ff
	ff		 mov	 BYTE PTR tv67[ebp], cl
  00025	80 bd 90 f7 ff
	ff c1		 cmp	 BYTE PTR tv67[ebp], 193	; 000000c1H
  0002c	74 0b		 je	 SHORT $LN4@ExtractPac
  0002e	80 bd 90 f7 ff
	ff c2		 cmp	 BYTE PTR tv67[ebp], 194	; 000000c2H
  00035	74 10		 je	 SHORT $LN3@ExtractPac
  00037	eb 27		 jmp	 SHORT $LN2@ExtractPac
$LN4@ExtractPac:

; 141  : 		{
; 142  : 			case 0xC1:
; 143  : 				wSize = this->m_byBuffer[1];

  00039	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0003c	66 0f b6 48 07	 movzx	 cx, BYTE PTR [eax+7]
  00041	66 89 4d f4	 mov	 WORD PTR _wSize$[ebp], cx

; 144  : 				break;

  00045	eb 23		 jmp	 SHORT $LN5@ExtractPac
$LN3@ExtractPac:

; 145  : 
; 146  : 			case 0xC2:
; 147  : 				wSize = this->m_byBuffer[1] * 256 + this->m_byBuffer[2];

  00047	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0004a	0f b6 48 07	 movzx	 ecx, BYTE PTR [eax+7]
  0004e	c1 e1 08	 shl	 ecx, 8
  00051	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00054	0f b6 42 08	 movzx	 eax, BYTE PTR [edx+8]
  00058	03 c8		 add	 ecx, eax
  0005a	66 89 4d f4	 mov	 WORD PTR _wSize$[ebp], cx

; 148  : 				break;

  0005e	eb 0a		 jmp	 SHORT $LN5@ExtractPac
$LN2@ExtractPac:

; 149  : 
; 150  : 			default:
; 151  : 				return true;

  00060	b8 01 00 00 00	 mov	 eax, 1
  00065	e9 30 01 00 00	 jmp	 $LN7@ExtractPac
$LN5@ExtractPac:

; 152  : 				break;
; 153  : 		}
; 154  : 
; 155  : 		if ( this->m_wSize < wSize )

  0006a	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0006d	0f b7 48 04	 movzx	 ecx, WORD PTR [eax+4]
  00071	0f b7 55 f4	 movzx	 edx, WORD PTR _wSize$[ebp]
  00075	3b ca		 cmp	 ecx, edx
  00077	7d 0a		 jge	 SHORT $LN1@ExtractPac

; 156  : 		{
; 157  : 			return 2;

  00079	b8 02 00 00 00	 mov	 eax, 2
  0007e	e9 17 01 00 00	 jmp	 $LN7@ExtractPac
$LN1@ExtractPac:

; 158  : 		}
; 159  : 
; 160  : 		byXorFilter[0] = 0xE7;

  00083	c6 45 d4 e7	 mov	 BYTE PTR _byXorFilter$[ebp], 231 ; 000000e7H

; 161  : 		byXorFilter[1] = 0x6D;

  00087	c6 45 d5 6d	 mov	 BYTE PTR _byXorFilter$[ebp+1], 109 ; 0000006dH

; 162  : 		byXorFilter[2] = 0x3A;

  0008b	c6 45 d6 3a	 mov	 BYTE PTR _byXorFilter$[ebp+2], 58 ; 0000003aH

; 163  : 		byXorFilter[3] = 0x89;

  0008f	c6 45 d7 89	 mov	 BYTE PTR _byXorFilter$[ebp+3], 137 ; 00000089H

; 164  : 		byXorFilter[4] = 0xBC;

  00093	c6 45 d8 bc	 mov	 BYTE PTR _byXorFilter$[ebp+4], 188 ; 000000bcH

; 165  : 		byXorFilter[5] = 0xB2;

  00097	c6 45 d9 b2	 mov	 BYTE PTR _byXorFilter$[ebp+5], 178 ; 000000b2H

; 166  : 		byXorFilter[6] = 0x9F;

  0009b	c6 45 da 9f	 mov	 BYTE PTR _byXorFilter$[ebp+6], 159 ; 0000009fH

; 167  : 		byXorFilter[7] = 0x73;

  0009f	c6 45 db 73	 mov	 BYTE PTR _byXorFilter$[ebp+7], 115 ; 00000073H

; 168  : 		byXorFilter[8] = 0x23;

  000a3	c6 45 dc 23	 mov	 BYTE PTR _byXorFilter$[ebp+8], 35 ; 00000023H

; 169  : 		byXorFilter[9] = 0xA8;

  000a7	c6 45 dd a8	 mov	 BYTE PTR _byXorFilter$[ebp+9], 168 ; 000000a8H

; 170  : 		byXorFilter[10] = 0xFE;

  000ab	c6 45 de fe	 mov	 BYTE PTR _byXorFilter$[ebp+10], 254 ; 000000feH

; 171  : 		byXorFilter[11] = 0xB6;

  000af	c6 45 df b6	 mov	 BYTE PTR _byXorFilter$[ebp+11], 182 ; 000000b6H

; 172  : 		byXorFilter[12] = 0x49;

  000b3	c6 45 e0 49	 mov	 BYTE PTR _byXorFilter$[ebp+12], 73 ; 00000049H

; 173  : 		byXorFilter[13] = 0x5D;

  000b7	c6 45 e1 5d	 mov	 BYTE PTR _byXorFilter$[ebp+13], 93 ; 0000005dH

; 174  : 		byXorFilter[14] = 0x39;

  000bb	c6 45 e2 39	 mov	 BYTE PTR _byXorFilter$[ebp+14], 57 ; 00000039H

; 175  : 		byXorFilter[15] = 0x5D;

  000bf	c6 45 e3 5d	 mov	 BYTE PTR _byXorFilter$[ebp+15], 93 ; 0000005dH

; 176  : 		byXorFilter[16] = 0x8A;

  000c3	c6 45 e4 8a	 mov	 BYTE PTR _byXorFilter$[ebp+16], 138 ; 0000008aH

; 177  : 		byXorFilter[17] = 0xCB;

  000c7	c6 45 e5 cb	 mov	 BYTE PTR _byXorFilter$[ebp+17], 203 ; 000000cbH

; 178  : 		byXorFilter[18] = 0x63;

  000cb	c6 45 e6 63	 mov	 BYTE PTR _byXorFilter$[ebp+18], 99 ; 00000063H

; 179  : 		byXorFilter[19] = 0x8D;

  000cf	c6 45 e7 8d	 mov	 BYTE PTR _byXorFilter$[ebp+19], 141 ; 0000008dH

; 180  : 		byXorFilter[20] = 0xEA;

  000d3	c6 45 e8 ea	 mov	 BYTE PTR _byXorFilter$[ebp+20], 234 ; 000000eaH

; 181  : 		byXorFilter[21] = 0x7D;

  000d7	c6 45 e9 7d	 mov	 BYTE PTR _byXorFilter$[ebp+21], 125 ; 0000007dH

; 182  : 		byXorFilter[22] = 0x2B;

  000db	c6 45 ea 2b	 mov	 BYTE PTR _byXorFilter$[ebp+22], 43 ; 0000002bH

; 183  : 		byXorFilter[23] = 0x5F;

  000df	c6 45 eb 5f	 mov	 BYTE PTR _byXorFilter$[ebp+23], 95 ; 0000005fH

; 184  : 		byXorFilter[24] = 0xC3;

  000e3	c6 45 ec c3	 mov	 BYTE PTR _byXorFilter$[ebp+24], 195 ; 000000c3H

; 185  : 		byXorFilter[25] = 0xB1;

  000e7	c6 45 ed b1	 mov	 BYTE PTR _byXorFilter$[ebp+25], 177 ; 000000b1H

; 186  : 		byXorFilter[26] = 0xE9;

  000eb	c6 45 ee e9	 mov	 BYTE PTR _byXorFilter$[ebp+26], 233 ; 000000e9H

; 187  : 		byXorFilter[27] = 0x83;

  000ef	c6 45 ef 83	 mov	 BYTE PTR _byXorFilter$[ebp+27], 131 ; 00000083H

; 188  : 		byXorFilter[28] = 0x29;

  000f3	c6 45 f0 29	 mov	 BYTE PTR _byXorFilter$[ebp+28], 41 ; 00000029H

; 189  : 		byXorFilter[29] = 0x51;

  000f7	c6 45 f1 51	 mov	 BYTE PTR _byXorFilter$[ebp+29], 81 ; 00000051H

; 190  : 		byXorFilter[30] = 0xE8;

  000fb	c6 45 f2 e8	 mov	 BYTE PTR _byXorFilter$[ebp+30], 232 ; 000000e8H

; 191  : 		byXorFilter[31] = 0x56;	

  000ff	c6 45 f3 56	 mov	 BYTE PTR _byXorFilter$[ebp+31], 86 ; 00000056H

; 192  : 
; 193  : 		this->XorData(wSize-1, (this->m_byBuffer[0] == 0xC1 ? 2 : 3), -1);

  00103	6a ff		 push	 -1
  00105	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00108	0f b6 48 06	 movzx	 ecx, BYTE PTR [eax+6]
  0010c	33 d2		 xor	 edx, edx
  0010e	81 f9 c1 00 00
	00		 cmp	 ecx, 193		; 000000c1H
  00114	0f 95 c2	 setne	 dl
  00117	83 c2 02	 add	 edx, 2
  0011a	52		 push	 edx
  0011b	0f b7 45 f4	 movzx	 eax, WORD PTR _wSize$[ebp]
  0011f	83 e8 01	 sub	 eax, 1
  00122	50		 push	 eax
  00123	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00126	e8 00 00 00 00	 call	 ?XorData@CStreamPacketEngine_Server@@IAEXHHH@Z ; CStreamPacketEngine_Server::XorData

; 194  : 		memcpy(pTar, this->m_byBuffer, wSize);

  0012b	0f b7 45 f4	 movzx	 eax, WORD PTR _wSize$[ebp]
  0012f	50		 push	 eax
  00130	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00133	83 c1 06	 add	 ecx, 6
  00136	51		 push	 ecx
  00137	8b 55 08	 mov	 edx, DWORD PTR _pTar$[ebp]
  0013a	52		 push	 edx
  0013b	e8 00 00 00 00	 call	 _memcpy
  00140	83 c4 0c	 add	 esp, 12			; 0000000cH

; 195  : 		this->m_wSize-=wSize;

  00143	0f b7 45 f4	 movzx	 eax, WORD PTR _wSize$[ebp]
  00147	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0014a	0f b7 51 04	 movzx	 edx, WORD PTR [ecx+4]
  0014e	2b d0		 sub	 edx, eax
  00150	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00153	66 89 50 04	 mov	 WORD PTR [eax+4], dx

; 196  : 		memcpy(byTemp, &this->m_byBuffer[wSize], this->m_wSize);

  00157	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0015a	0f b7 48 04	 movzx	 ecx, WORD PTR [eax+4]
  0015e	51		 push	 ecx
  0015f	0f b7 55 f4	 movzx	 edx, WORD PTR _wSize$[ebp]
  00163	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00166	8d 4c 10 06	 lea	 ecx, DWORD PTR [eax+edx+6]
  0016a	51		 push	 ecx
  0016b	8d 95 d4 f7 ff
	ff		 lea	 edx, DWORD PTR _byTemp$[ebp]
  00171	52		 push	 edx
  00172	e8 00 00 00 00	 call	 _memcpy
  00177	83 c4 0c	 add	 esp, 12			; 0000000cH

; 197  : 		memcpy(this->m_byBuffer, byTemp, this->m_wSize);

  0017a	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0017d	0f b7 48 04	 movzx	 ecx, WORD PTR [eax+4]
  00181	51		 push	 ecx
  00182	8d 95 d4 f7 ff
	ff		 lea	 edx, DWORD PTR _byTemp$[ebp]
  00188	52		 push	 edx
  00189	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0018c	83 c0 06	 add	 eax, 6
  0018f	50		 push	 eax
  00190	e8 00 00 00 00	 call	 _memcpy
  00195	83 c4 0c	 add	 esp, 12			; 0000000cH

; 198  : 		return false;

  00198	33 c0		 xor	 eax, eax
$LN7@ExtractPac:

; 199  : 	}

  0019a	5f		 pop	 edi
  0019b	5e		 pop	 esi
  0019c	5b		 pop	 ebx
  0019d	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  001a0	33 cd		 xor	 ecx, ebp
  001a2	e8 00 00 00 00	 call	 @__security_check_cookie@4
  001a7	8b e5		 mov	 esp, ebp
  001a9	5d		 pop	 ebp
  001aa	c2 04 00	 ret	 4
?ExtractPacket@CStreamPacketEngine_Server@@QAEHPAX@Z ENDP ; CStreamPacketEngine_Server::ExtractPacket
_TEXT	ENDS
PUBLIC	??_C@_0CI@NNCHDFLE@CStreamPacketEngine?5XorData?5Erro@ ; `string'
PUBLIC	__$ArrayPad$
;	COMDAT ??_C@_0CI@NNCHDFLE@CStreamPacketEngine?5XorData?5Erro@
CONST	SEGMENT
??_C@_0CI@NNCHDFLE@CStreamPacketEngine?5XorData?5Erro@ DB 'CStreamPacketE'
	DB	'ngine XorData Error %d,%d', 00H		; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
;	COMDAT ?XorData@CStreamPacketEngine_Server@@IAEXHHH@Z
_TEXT	SEGMENT
_i$204495 = -44						; size = 4
_byXorFilter$ = -40					; size = 32
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
_iStart$ = 8						; size = 4
_iEnd$ = 12						; size = 4
_iDir$ = 16						; size = 4
?XorData@CStreamPacketEngine_Server@@IAEXHHH@Z PROC	; CStreamPacketEngine_Server::XorData, COMDAT
; _this$ = ecx

; 33   : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 6c	 sub	 esp, 108		; 0000006cH
  00006	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000b	33 c5		 xor	 eax, ebp
  0000d	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00010	53		 push	 ebx
  00011	56		 push	 esi
  00012	57		 push	 edi
  00013	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 34   : 		if ( iStart < iEnd  )

  00016	8b 45 08	 mov	 eax, DWORD PTR _iStart$[ebp]
  00019	3b 45 0c	 cmp	 eax, DWORD PTR _iEnd$[ebp]
  0001c	7d 1d		 jge	 SHORT $LN4@XorData

; 35   : 		{
; 36   : 			LogAddC(2, "CStreamPacketEngine XorData Error %d,%d", iStart, iEnd);

  0001e	8b 45 0c	 mov	 eax, DWORD PTR _iEnd$[ebp]
  00021	50		 push	 eax
  00022	8b 4d 08	 mov	 ecx, DWORD PTR _iStart$[ebp]
  00025	51		 push	 ecx
  00026	68 00 00 00 00	 push	 OFFSET ??_C@_0CI@NNCHDFLE@CStreamPacketEngine?5XorData?5Erro@
  0002b	6a 02		 push	 2
  0002d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddC@@3P6AXEPADZZA ; LogAddC
  00033	83 c4 10	 add	 esp, 16			; 00000010H

; 37   : 			return;

  00036	e9 d1 00 00 00	 jmp	 $LN5@XorData
$LN4@XorData:

; 38   : 		}
; 39   : 
; 40   : 		BYTE byXorFilter[32];
; 41   : 
; 42   : 		//byXorFilter[0]	= 0xAB;
; 43   : 		//byXorFilter[1]	= 0x11; 
; 44   : 		//byXorFilter[2]	= 0xCD;
; 45   : 		//byXorFilter[3]	= 0xFE; 
; 46   : 		//byXorFilter[4]	= 0x18;
; 47   : 		//byXorFilter[5]	= 0x23;
; 48   : 		//byXorFilter[6]	= 0xC5;
; 49   : 		//byXorFilter[7]	= 0xA3;
; 50   : 		//byXorFilter[8]	= 0xCA; 
; 51   : 		//byXorFilter[9]	= 0x33;
; 52   : 		//byXorFilter[10]	= 0xC1; 
; 53   : 		//byXorFilter[11] = 0xCC; 
; 54   : 		//byXorFilter[12] = 0x66; 
; 55   : 		//byXorFilter[13] = 0x67; 
; 56   : 		//byXorFilter[14] = 0x21; 
; 57   : 		//byXorFilter[15] = 0xF3;
; 58   : 		//byXorFilter[16] = 0x32;
; 59   : 		//byXorFilter[17] = 0x12; 
; 60   : 		//byXorFilter[18] = 0x15; 
; 61   : 		//byXorFilter[19] = 0x35; 
; 62   : 		//byXorFilter[20] = 0x29; 
; 63   : 		//byXorFilter[21] = 0xFF;
; 64   : 		//byXorFilter[22] = 0xFE;
; 65   : 		//byXorFilter[23] = 0x1D;
; 66   : 		//byXorFilter[24] = 0x44; 
; 67   : 		//byXorFilter[25] = 0xEF; 
; 68   : 		//byXorFilter[26] = 0xCD; 
; 69   : 		//byXorFilter[27] = 0x41; 
; 70   : 		//byXorFilter[28] = 0x26; 
; 71   : 		//byXorFilter[29] = 0x3C; 
; 72   : 		//byXorFilter[30] = 0x4E; 
; 73   : 		//byXorFilter[31] = 0x4D;
; 74   : 
; 75   : 		//ExTeam Packet
; 76   : 		byXorFilter[0] = 0x54;

  0003b	c6 45 d8 54	 mov	 BYTE PTR _byXorFilter$[ebp], 84 ; 00000054H

; 77   : 		byXorFilter[1] = 0xAD;

  0003f	c6 45 d9 ad	 mov	 BYTE PTR _byXorFilter$[ebp+1], 173 ; 000000adH

; 78   : 		byXorFilter[2] = 0x65;

  00043	c6 45 da 65	 mov	 BYTE PTR _byXorFilter$[ebp+2], 101 ; 00000065H

; 79   : 		byXorFilter[3] = 0x0F;

  00047	c6 45 db 0f	 mov	 BYTE PTR _byXorFilter$[ebp+3], 15 ; 0000000fH

; 80   : 		byXorFilter[4] = 0x33;

  0004b	c6 45 dc 33	 mov	 BYTE PTR _byXorFilter$[ebp+4], 51 ; 00000033H

; 81   : 		byXorFilter[5] = 0xFE;

  0004f	c6 45 dd fe	 mov	 BYTE PTR _byXorFilter$[ebp+5], 254 ; 000000feH

; 82   : 		byXorFilter[6] = 0x31;

  00053	c6 45 de 31	 mov	 BYTE PTR _byXorFilter$[ebp+6], 49 ; 00000031H

; 83   : 		byXorFilter[7] = 0xBB;

  00057	c6 45 df bb	 mov	 BYTE PTR _byXorFilter$[ebp+7], 187 ; 000000bbH

; 84   : 		byXorFilter[8] = 0x9A;

  0005b	c6 45 e0 9a	 mov	 BYTE PTR _byXorFilter$[ebp+8], 154 ; 0000009aH

; 85   : 		byXorFilter[9] = 0x13;

  0005f	c6 45 e1 13	 mov	 BYTE PTR _byXorFilter$[ebp+9], 19 ; 00000013H

; 86   : 		byXorFilter[10] = 0x56;

  00063	c6 45 e2 56	 mov	 BYTE PTR _byXorFilter$[ebp+10], 86 ; 00000056H

; 87   : 		byXorFilter[11] = 0xAC;

  00067	c6 45 e3 ac	 mov	 BYTE PTR _byXorFilter$[ebp+11], 172 ; 000000acH

; 88   : 		byXorFilter[12] = 0x71;

  0006b	c6 45 e4 71	 mov	 BYTE PTR _byXorFilter$[ebp+12], 113 ; 00000071H

; 89   : 		byXorFilter[13] = 0x83;

  0006f	c6 45 e5 83	 mov	 BYTE PTR _byXorFilter$[ebp+13], 131 ; 00000083H

; 90   : 		byXorFilter[14] = 0x60;

  00073	c6 45 e6 60	 mov	 BYTE PTR _byXorFilter$[ebp+14], 96 ; 00000060H

; 91   : 		byXorFilter[15] = 0x2B;

  00077	c6 45 e7 2b	 mov	 BYTE PTR _byXorFilter$[ebp+15], 43 ; 0000002bH

; 92   : 		byXorFilter[16] = 0x13;

  0007b	c6 45 e8 13	 mov	 BYTE PTR _byXorFilter$[ebp+16], 19 ; 00000013H

; 93   : 		byXorFilter[17] = 0x47;

  0007f	c6 45 e9 47	 mov	 BYTE PTR _byXorFilter$[ebp+17], 71 ; 00000047H

; 94   : 		byXorFilter[18] = 0xBF;

  00083	c6 45 ea bf	 mov	 BYTE PTR _byXorFilter$[ebp+18], 191 ; 000000bfH

; 95   : 		byXorFilter[19] = 0x28;

  00087	c6 45 eb 28	 mov	 BYTE PTR _byXorFilter$[ebp+19], 40 ; 00000028H

; 96   : 		byXorFilter[20] = 0xE9;

  0008b	c6 45 ec e9	 mov	 BYTE PTR _byXorFilter$[ebp+20], 233 ; 000000e9H

; 97   : 		byXorFilter[21] = 0x00;

  0008f	c6 45 ed 00	 mov	 BYTE PTR _byXorFilter$[ebp+21], 0

; 98   : 		byXorFilter[22] = 0x7F;

  00093	c6 45 ee 7f	 mov	 BYTE PTR _byXorFilter$[ebp+22], 127 ; 0000007fH

; 99   : 		byXorFilter[23] = 0x10;

  00097	c6 45 ef 10	 mov	 BYTE PTR _byXorFilter$[ebp+23], 16 ; 00000010H

; 100  : 		byXorFilter[24] = 0x6F;

  0009b	c6 45 f0 6f	 mov	 BYTE PTR _byXorFilter$[ebp+24], 111 ; 0000006fH

; 101  : 		byXorFilter[25] = 0x32;

  0009f	c6 45 f1 32	 mov	 BYTE PTR _byXorFilter$[ebp+25], 50 ; 00000032H

; 102  : 		byXorFilter[26] = 0x65;

  000a3	c6 45 f2 65	 mov	 BYTE PTR _byXorFilter$[ebp+26], 101 ; 00000065H

; 103  : 		byXorFilter[27] = 0xF6;

  000a7	c6 45 f3 f6	 mov	 BYTE PTR _byXorFilter$[ebp+27], 246 ; 000000f6H

; 104  : 		byXorFilter[28] = 0x92;

  000ab	c6 45 f4 92	 mov	 BYTE PTR _byXorFilter$[ebp+28], 146 ; 00000092H

; 105  : 		byXorFilter[29] = 0x1D;

  000af	c6 45 f5 1d	 mov	 BYTE PTR _byXorFilter$[ebp+29], 29 ; 0000001dH

; 106  : 		byXorFilter[30] = 0xD3;

  000b3	c6 45 f6 d3	 mov	 BYTE PTR _byXorFilter$[ebp+30], 211 ; 000000d3H

; 107  : 		byXorFilter[31] = 0xEF;

  000b7	c6 45 f7 ef	 mov	 BYTE PTR _byXorFilter$[ebp+31], 239 ; 000000efH

; 108  : 
; 109  : 		for ( int i = iStart ; i != iEnd ; i+=iDir )

  000bb	8b 45 08	 mov	 eax, DWORD PTR _iStart$[ebp]
  000be	89 45 d4	 mov	 DWORD PTR _i$204495[ebp], eax
  000c1	eb 09		 jmp	 SHORT $LN3@XorData
$LN2@XorData:
  000c3	8b 45 d4	 mov	 eax, DWORD PTR _i$204495[ebp]
  000c6	03 45 10	 add	 eax, DWORD PTR _iDir$[ebp]
  000c9	89 45 d4	 mov	 DWORD PTR _i$204495[ebp], eax
$LN3@XorData:
  000cc	8b 45 d4	 mov	 eax, DWORD PTR _i$204495[ebp]
  000cf	3b 45 0c	 cmp	 eax, DWORD PTR _iEnd$[ebp]
  000d2	74 38		 je	 SHORT $LN5@XorData

; 110  : 		{
; 111  : 			this->m_byBuffer[i] ^= this->m_byBuffer[i-1] ^ byXorFilter[ i%32 ];

  000d4	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  000d7	03 45 d4	 add	 eax, DWORD PTR _i$204495[ebp]
  000da	0f b6 48 05	 movzx	 ecx, BYTE PTR [eax+5]
  000de	8b 55 d4	 mov	 edx, DWORD PTR _i$204495[ebp]
  000e1	81 e2 1f 00 00
	80		 and	 edx, -2147483617	; 8000001fH
  000e7	79 05		 jns	 SHORT $LN7@XorData
  000e9	4a		 dec	 edx
  000ea	83 ca e0	 or	 edx, -32		; ffffffe0H
  000ed	42		 inc	 edx
$LN7@XorData:
  000ee	0f b6 44 15 d8	 movzx	 eax, BYTE PTR _byXorFilter$[ebp+edx]
  000f3	33 c8		 xor	 ecx, eax
  000f5	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  000f8	03 55 d4	 add	 edx, DWORD PTR _i$204495[ebp]
  000fb	0f b6 42 06	 movzx	 eax, BYTE PTR [edx+6]
  000ff	33 c1		 xor	 eax, ecx
  00101	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00104	03 4d d4	 add	 ecx, DWORD PTR _i$204495[ebp]
  00107	88 41 06	 mov	 BYTE PTR [ecx+6], al

; 112  : 		}

  0010a	eb b7		 jmp	 SHORT $LN2@XorData
$LN5@XorData:

; 113  : 	}

  0010c	5f		 pop	 edi
  0010d	5e		 pop	 esi
  0010e	5b		 pop	 ebx
  0010f	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00112	33 cd		 xor	 ecx, ebp
  00114	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00119	8b e5		 mov	 esp, ebp
  0011b	5d		 pop	 ebp
  0011c	c2 0c 00	 ret	 12			; 0000000cH
?XorData@CStreamPacketEngine_Server@@IAEXHHH@Z ENDP	; CStreamPacketEngine_Server::XorData
_TEXT	ENDS
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
; Function compile flags: /Odtp /ZI
;	COMDAT ??_GCStreamPacketEngine_Server@@UAEPAXI@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
___flags$ = 8						; size = 4
??_GCStreamPacketEngine_Server@@UAEPAXI@Z PROC		; CStreamPacketEngine_Server::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000f	e8 00 00 00 00	 call	 ??1CStreamPacketEngine_Server@@UAE@XZ ; CStreamPacketEngine_Server::~CStreamPacketEngine_Server
  00014	8b 45 08	 mov	 eax, DWORD PTR ___flags$[ebp]
  00017	83 e0 01	 and	 eax, 1
  0001a	74 0c		 je	 SHORT $LN1@scalar
  0001c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001f	50		 push	 eax
  00020	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00025	83 c4 04	 add	 esp, 4
$LN1@scalar:
  00028	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002b	5f		 pop	 edi
  0002c	5e		 pop	 esi
  0002d	5b		 pop	 ebx
  0002e	8b e5		 mov	 esp, ebp
  00030	5d		 pop	 ebp
  00031	c2 04 00	 ret	 4
??_GCStreamPacketEngine_Server@@UAEPAXI@Z ENDP		; CStreamPacketEngine_Server::`scalar deleting destructor'
_TEXT	ENDS
PUBLIC	??_C@_0DC@KIEJLADI@?$CI?$CFd?$CJWSASend?$CI?$CFd?$CJ?5failed?5with?5erro@ ; `string'
PUBLIC	??_C@_0CM@MJNIMEPA@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@ ; `string'
PUBLIC	??_C@_0CP@OMKJIPGE@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@ ; `string'
PUBLIC	?CloseClient@@YAXH@Z				; CloseClient
PUBLIC	??_C@_0BK@HOECGHIH@Error?5?3?5Max?5msg?$CI?$CFd?$CJ?5?$CFs?5?$CFd?$AA@ ; `string'
PUBLIC	?__LINE__Var@?1??DataSend@@YAHHPAEK@Z@4JA	; `DataSend'::`2'::__LINE__Var
PUBLIC	??_C@_0BP@LLCNDKPF@error?9L2?5?3?5Index?$CI?$CFd?$CJ?5?$CFx?5?$CFx?5?$CFx?5?$AA@ ; `string'
PUBLIC	?DataSend@@YAHHPAEK@Z				; DataSend
EXTRN	__imp__WSASend@28:PROC
EXTRN	?Encrypt@CSimpleModulus@@QAEHPAX0H@Z:PROC	; CSimpleModulus::Encrypt
EXTRN	?g_SimpleModulusSC@@3VCSimpleModulus@@A:BYTE	; g_SimpleModulusSC
EXTRN	?GetSendSerial@NSerialCheck@@QAEEXZ:PROC	; NSerialCheck::GetSendSerial
EXTRN	?gNSerialCheck@@3PAVNSerialCheck@@A:BYTE	; gNSerialCheck
;	COMDAT ??_C@_0DC@KIEJLADI@?$CI?$CFd?$CJWSASend?$CI?$CFd?$CJ?5failed?5with?5erro@
; File d:\projects\exteam6.3\source\gameserver\gameserver\giocp.cpp
CONST	SEGMENT
??_C@_0DC@KIEJLADI@?$CI?$CFd?$CJWSASend?$CI?$CFd?$CJ?5failed?5with?5erro@ DB '('
	DB	'%d)WSASend(%d) failed with error [%x][%x] %d %s ', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CM@MJNIMEPA@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@
CONST	SEGMENT
??_C@_0CM@MJNIMEPA@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@ DB '('
	DB	'%d)error-L2 MAX BUFFER OVER %d %d [%s][%s]', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0CP@OMKJIPGE@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@
CONST	SEGMENT
??_C@_0CP@OMKJIPGE@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@ DB '('
	DB	'%d)error-L2 MAX BUFFER OVER %d %d %d [%s][%s]', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BK@HOECGHIH@Error?5?3?5Max?5msg?$CI?$CFd?$CJ?5?$CFs?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BK@HOECGHIH@Error?5?3?5Max?5msg?$CI?$CFd?$CJ?5?$CFs?5?$CFd?$AA@ DB 'E'
	DB	'rror : Max msg(%d) %s %d', 00H		; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?1??DataSend@@YAHHPAEK@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?1??DataSend@@YAHHPAEK@Z@4JA DD 03f7H	; `DataSend'::`2'::__LINE__Var
_DATA	ENDS
;	COMDAT ??_C@_0BP@LLCNDKPF@error?9L2?5?3?5Index?$CI?$CFd?$CJ?5?$CFx?5?$CFx?5?$CFx?5?$AA@
CONST	SEGMENT
??_C@_0BP@LLCNDKPF@error?9L2?5?3?5Index?$CI?$CFd?$CJ?5?$CFx?5?$CFx?5?$CFx?5?$AA@ DB 'e'
	DB	'rror-L2 : Index(%d) %x %x %x ', 00H		; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv74 = -92						; size = 4
_lpIoCtxt$ = -24					; size = 4
_btsize$230491 = -17					; size = 1
_ret$230490 = -16					; size = 4
_SendBuf$ = -12						; size = 4
_lpPerSocketContext$ = -8				; size = 4
_SendBytes$ = -4					; size = 4
_aIndex$ = 8						; size = 4
_lpMsg$ = 12						; size = 4
_dwSize$ = 16						; size = 4
?DataSend@@YAHHPAEK@Z PROC				; DataSend

; 1015 : {

  017a0	55		 push	 ebp
  017a1	8b ec		 mov	 ebp, esp
  017a3	83 ec 5c	 sub	 esp, 92			; 0000005cH
  017a6	53		 push	 ebx
  017a7	56		 push	 esi
  017a8	57		 push	 edi

; 1016 : 	DWORD SendBytes;
; 1017 : 	LPPER_SOCKET_CONTEXT lpPerSocketContext;
; 1018 : 	LPBYTE SendBuf;
; 1019 : 	
; 1020 : 
; 1021 : 	if ( aIndex < OBJ_STARTUSERINDEX )

  017a9	81 7d 08 b0 36
	00 00		 cmp	 DWORD PTR _aIndex$[ebp], 14000 ; 000036b0H
  017b0	7d 0a		 jge	 SHORT $LN20@DataSend

; 1022 : 	{
; 1023 : 		return true;

  017b2	b8 01 00 00 00	 mov	 eax, 1
  017b7	e9 00 06 00 00	 jmp	 $LN21@DataSend
$LN20@DataSend:

; 1024 : 	}
; 1025 : 
; 1026 : #if(OFFLINE_MODE == TRUE)
; 1027 : 	if( gObj[aIndex].m_OfflineMode )

  017bc	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  017bf	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  017c5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  017cb	0f b6 94 01 d4
	28 00 00	 movzx	 edx, BYTE PTR [ecx+eax+10452]
  017d3	85 d2		 test	 edx, edx
  017d5	74 07		 je	 SHORT $LN19@DataSend

; 1028 : 	{
; 1029 : 		return false;

  017d7	33 c0		 xor	 eax, eax
  017d9	e9 de 05 00 00	 jmp	 $LN21@DataSend
$LN19@DataSend:

; 1030 : 	}
; 1031 : #endif
; 1032 : 
; 1033 : 	EnterCriticalSection(&criti);

  017de	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  017e3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 1034 : 
; 1035 : 	if ( ((aIndex < 0)? FALSE : (aIndex > OBJMAX-1)? FALSE : TRUE )  == FALSE )

  017e9	83 7d 08 00	 cmp	 DWORD PTR _aIndex$[ebp], 0
  017ed	7d 09		 jge	 SHORT $LN23@DataSend
  017ef	c7 45 a4 00 00
	00 00		 mov	 DWORD PTR tv74[ebp], 0
  017f6	eb 0f		 jmp	 SHORT $LN24@DataSend
$LN23@DataSend:
  017f8	33 c0		 xor	 eax, eax
  017fa	81 7d 08 97 3a
	00 00		 cmp	 DWORD PTR _aIndex$[ebp], 14999 ; 00003a97H
  01801	0f 9e c0	 setle	 al
  01804	89 45 a4	 mov	 DWORD PTR tv74[ebp], eax
$LN24@DataSend:
  01807	83 7d a4 00	 cmp	 DWORD PTR tv74[ebp], 0
  0180b	75 3b		 jne	 SHORT $LN18@DataSend

; 1036 : 	{
; 1037 : 		LogAdd("error-L2 : Index(%d) %x %x %x ", dwSize, lpMsg[0], lpMsg[1], lpMsg[2]);

  0180d	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  01810	0f b6 48 02	 movzx	 ecx, BYTE PTR [eax+2]
  01814	51		 push	 ecx
  01815	8b 55 0c	 mov	 edx, DWORD PTR _lpMsg$[ebp]
  01818	0f b6 42 01	 movzx	 eax, BYTE PTR [edx+1]
  0181c	50		 push	 eax
  0181d	8b 4d 0c	 mov	 ecx, DWORD PTR _lpMsg$[ebp]
  01820	0f b6 11	 movzx	 edx, BYTE PTR [ecx]
  01823	52		 push	 edx
  01824	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01827	50		 push	 eax
  01828	68 00 00 00 00	 push	 OFFSET ??_C@_0BP@LLCNDKPF@error?9L2?5?3?5Index?$CI?$CFd?$CJ?5?$CFx?5?$CFx?5?$CFx?5?$AA@
  0182d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01833	83 c4 14	 add	 esp, 20			; 00000014H

; 1038 : 		LeaveCriticalSection(&criti);

  01836	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0183b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1039 : 		return false;

  01841	33 c0		 xor	 eax, eax
  01843	e9 74 05 00 00	 jmp	 $LN21@DataSend
$LN18@DataSend:

; 1040 : 	}
; 1041 : 
; 1042 : 	if ( lpMsg[0] == 0xC3 || lpMsg[0] == 0xC4 )

  01848	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  0184b	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0184e	81 f9 c3 00 00
	00		 cmp	 ecx, 195		; 000000c3H
  01854	74 12		 je	 SHORT $LN16@DataSend
  01856	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  01859	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0185c	81 f9 c4 00 00
	00		 cmp	 ecx, 196		; 000000c4H
  01862	0f 85 14 01 00
	00		 jne	 $LN17@DataSend
$LN16@DataSend:

; 1043 : 	{
; 1044 : 		int ret;
; 1045 : 		BYTE btsize;
; 1046 : 
; 1047 : 		if ( lpMsg[0] == 0xC3 )

  01868	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  0186b	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0186e	81 f9 c3 00 00
	00		 cmp	 ecx, 195		; 000000c3H
  01874	75 79		 jne	 SHORT $LN15@DataSend

; 1048 : 		{
; 1049 : 			btsize = lpMsg[1];

  01876	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  01879	8a 48 01	 mov	 cl, BYTE PTR [eax+1]
  0187c	88 4d ef	 mov	 BYTE PTR _btsize$230491[ebp], cl

; 1050 : 			lpMsg[1]=gNSerialCheck[aIndex].GetSendSerial();

  0187f	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01882	8d 0c c5 00 00
	00 00		 lea	 ecx, DWORD PTR ?gNSerialCheck@@3PAVNSerialCheck@@A[eax*8]
  01889	e8 00 00 00 00	 call	 ?GetSendSerial@NSerialCheck@@QAEEXZ ; NSerialCheck::GetSendSerial
  0188e	8b 4d 0c	 mov	 ecx, DWORD PTR _lpMsg$[ebp]
  01891	88 41 01	 mov	 BYTE PTR [ecx+1], al

; 1051 : 			ret = g_SimpleModulusSC.Encrypt(&ExSendBuf[2], &lpMsg[1], dwSize-1);

  01894	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01897	83 e8 01	 sub	 eax, 1
  0189a	50		 push	 eax
  0189b	8b 4d 0c	 mov	 ecx, DWORD PTR _lpMsg$[ebp]
  0189e	83 c1 01	 add	 ecx, 1
  018a1	51		 push	 ecx
  018a2	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  018a8	83 c2 02	 add	 edx, 2
  018ab	52		 push	 edx
  018ac	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_SimpleModulusSC@@3VCSimpleModulus@@A ; g_SimpleModulusSC
  018b1	e8 00 00 00 00	 call	 ?Encrypt@CSimpleModulus@@QAEHPAX0H@Z ; CSimpleModulus::Encrypt
  018b6	89 45 f0	 mov	 DWORD PTR _ret$230490[ebp], eax

; 1052 : 			ExSendBuf[0] = 0xC3;

  018b9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  018be	c6 00 c3	 mov	 BYTE PTR [eax], 195	; 000000c3H

; 1053 : 			ExSendBuf[1] = ret + 2;

  018c1	8b 45 f0	 mov	 eax, DWORD PTR _ret$230490[ebp]
  018c4	83 c0 02	 add	 eax, 2
  018c7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  018cd	88 41 01	 mov	 BYTE PTR [ecx+1], al

; 1054 : 			SendBuf = ExSendBuf;

  018d0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  018d5	89 45 f4	 mov	 DWORD PTR _SendBuf$[ebp], eax

; 1055 : 			dwSize = ret + 2;

  018d8	8b 45 f0	 mov	 eax, DWORD PTR _ret$230490[ebp]
  018db	83 c0 02	 add	 eax, 2
  018de	89 45 10	 mov	 DWORD PTR _dwSize$[ebp], eax

; 1056 : 			lpMsg[1] = btsize;

  018e1	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  018e4	8a 4d ef	 mov	 cl, BYTE PTR _btsize$230491[ebp]
  018e7	88 48 01	 mov	 BYTE PTR [eax+1], cl

; 1057 : 		}
; 1058 : 		else

  018ea	e9 8b 00 00 00	 jmp	 $LN14@DataSend
$LN15@DataSend:

; 1059 : 		{
; 1060 : 			btsize = lpMsg[2];

  018ef	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  018f2	8a 48 02	 mov	 cl, BYTE PTR [eax+2]
  018f5	88 4d ef	 mov	 BYTE PTR _btsize$230491[ebp], cl

; 1061 : 			lpMsg[2] = gNSerialCheck[aIndex].GetSendSerial();

  018f8	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  018fb	8d 0c c5 00 00
	00 00		 lea	 ecx, DWORD PTR ?gNSerialCheck@@3PAVNSerialCheck@@A[eax*8]
  01902	e8 00 00 00 00	 call	 ?GetSendSerial@NSerialCheck@@QAEEXZ ; NSerialCheck::GetSendSerial
  01907	8b 4d 0c	 mov	 ecx, DWORD PTR _lpMsg$[ebp]
  0190a	88 41 02	 mov	 BYTE PTR [ecx+2], al

; 1062 : 			ret = g_SimpleModulusSC.Encrypt(&ExSendBuf[3], &lpMsg[2], dwSize-2);

  0190d	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01910	83 e8 02	 sub	 eax, 2
  01913	50		 push	 eax
  01914	8b 4d 0c	 mov	 ecx, DWORD PTR _lpMsg$[ebp]
  01917	83 c1 02	 add	 ecx, 2
  0191a	51		 push	 ecx
  0191b	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  01921	83 c2 03	 add	 edx, 3
  01924	52		 push	 edx
  01925	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_SimpleModulusSC@@3VCSimpleModulus@@A ; g_SimpleModulusSC
  0192a	e8 00 00 00 00	 call	 ?Encrypt@CSimpleModulus@@QAEHPAX0H@Z ; CSimpleModulus::Encrypt
  0192f	89 45 f0	 mov	 DWORD PTR _ret$230490[ebp], eax

; 1063 : 			ExSendBuf[0] = 0xC4;

  01932	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  01937	c6 00 c4	 mov	 BYTE PTR [eax], 196	; 000000c4H

; 1064 : 			ExSendBuf[1] = SET_NUMBERH(ret +3 );

  0193a	8b 45 f0	 mov	 eax, DWORD PTR _ret$230490[ebp]
  0193d	83 c0 03	 add	 eax, 3
  01940	c1 e8 08	 shr	 eax, 8
  01943	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  01949	88 41 01	 mov	 BYTE PTR [ecx+1], al

; 1065 : 			ExSendBuf[2] = SET_NUMBERL(ret+3);

  0194c	8b 45 f0	 mov	 eax, DWORD PTR _ret$230490[ebp]
  0194f	83 c0 03	 add	 eax, 3
  01952	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  01957	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  0195d	88 41 02	 mov	 BYTE PTR [ecx+2], al

; 1066 : 			SendBuf = ExSendBuf;

  01960	a1 00 00 00 00	 mov	 eax, DWORD PTR ?ExSendBuf@@3PAEA ; ExSendBuf
  01965	89 45 f4	 mov	 DWORD PTR _SendBuf$[ebp], eax

; 1067 : 			dwSize = ret + 3;

  01968	8b 45 f0	 mov	 eax, DWORD PTR _ret$230490[ebp]
  0196b	83 c0 03	 add	 eax, 3
  0196e	89 45 10	 mov	 DWORD PTR _dwSize$[ebp], eax

; 1068 : 			lpMsg[2] = btsize;

  01971	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  01974	8a 4d ef	 mov	 cl, BYTE PTR _btsize$230491[ebp]
  01977	88 48 02	 mov	 BYTE PTR [eax+2], cl
$LN14@DataSend:

; 1069 : 		}
; 1070 : 	}
; 1071 : 	else

  0197a	eb 06		 jmp	 SHORT $LN13@DataSend
$LN17@DataSend:

; 1072 : 	{
; 1073 : 		SendBuf = lpMsg;

  0197c	8b 45 0c	 mov	 eax, DWORD PTR _lpMsg$[ebp]
  0197f	89 45 f4	 mov	 DWORD PTR _SendBuf$[ebp], eax
$LN13@DataSend:

; 1074 : 	}
; 1075 : 
; 1076 : 	if ( gObj[aIndex].Connected < PLAYER_CONNECTED )

  01982	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01985	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0198b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01991	83 7c 01 04 01	 cmp	 DWORD PTR [ecx+eax+4], 1
  01996	7d 12		 jge	 SHORT $LN12@DataSend

; 1077 : 	{
; 1078 : 		LeaveCriticalSection(&criti);

  01998	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0199d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1079 : 		return FALSE;

  019a3	33 c0		 xor	 eax, eax
  019a5	e9 12 04 00 00	 jmp	 $LN21@DataSend
$LN12@DataSend:

; 1080 : 	}
; 1081 : 
; 1082 : 	lpPerSocketContext= gObj[aIndex].PerSocketContext;

  019aa	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  019ad	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  019b3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  019b9	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  019bd	89 55 f8	 mov	 DWORD PTR _lpPerSocketContext$[ebp], edx

; 1083 : 
; 1084 : 	if ( dwSize > sizeof(lpPerSocketContext->IOContext[0].Buffer))

  019c0	81 7d 10 ff ff
	00 00		 cmp	 DWORD PTR _dwSize$[ebp], 65535 ; 0000ffffH
  019c7	76 3e		 jbe	 SHORT $LN11@DataSend

; 1085 : 	{
; 1086 : 		LogAdd("Error : Max msg(%d) %s %d", dwSize, __FILE__, __LINE__);

  019c9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??DataSend@@YAHHPAEK@Z@4JA
  019ce	83 c0 47	 add	 eax, 71			; 00000047H
  019d1	50		 push	 eax
  019d2	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@FBFBGJPJ@d?3?2projects?2exteam6?43?2source?2gam@
  019d7	8b 4d 10	 mov	 ecx, DWORD PTR _dwSize$[ebp]
  019da	51		 push	 ecx
  019db	68 00 00 00 00	 push	 OFFSET ??_C@_0BK@HOECGHIH@Error?5?3?5Max?5msg?$CI?$CFd?$CJ?5?$CFs?5?$CFd?$AA@
  019e0	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  019e6	83 c4 10	 add	 esp, 16			; 00000010H

; 1087 : 		CloseClient(aIndex);

  019e9	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  019ec	50		 push	 eax
  019ed	e8 00 00 00 00	 call	 ?CloseClient@@YAXH@Z	; CloseClient
  019f2	83 c4 04	 add	 esp, 4

; 1088 : 		LeaveCriticalSection(&criti);

  019f5	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  019fa	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1089 : 		return false;

  01a00	33 c0		 xor	 eax, eax
  01a02	e9 b5 03 00 00	 jmp	 $LN21@DataSend
$LN11@DataSend:

; 1090 : 	}
; 1091 : 
; 1092 : 	LPPER_IO_CONTEXT	lpIoCtxt = (LPPER_IO_CONTEXT)&lpPerSocketContext->IOContext[1];

  01a07	8b 45 f8	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01a0a	05 38 00 02 00	 add	 eax, 131128		; 00020038H
  01a0f	89 45 e8	 mov	 DWORD PTR _lpIoCtxt$[ebp], eax

; 1093 : 
; 1094 : 	if ( lpIoCtxt->nWaitIO > 0 )

  01a12	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01a15	83 b8 2c 00 02
	00 00		 cmp	 DWORD PTR [eax+131116], 0
  01a1c	0f 8e e6 00 00
	00		 jle	 $LN10@DataSend

; 1095 : 	{
; 1096 : 		if ( ( lpIoCtxt->nSecondOfs + dwSize ) > MAX_IO_BUFFER_SIZE-1 )

  01a22	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01a25	8b 88 1c 00 02
	00		 mov	 ecx, DWORD PTR [eax+131100]
  01a2b	03 4d 10	 add	 ecx, DWORD PTR _dwSize$[ebp]
  01a2e	81 f9 fe ff 00
	00		 cmp	 ecx, 65534		; 0000fffeH
  01a34	0f 86 80 00 00
	00		 jbe	 $LN9@DataSend

; 1097 : 		{
; 1098 : 			LogAdd("(%d)error-L2 MAX BUFFER OVER %d %d %d [%s][%s]", 
; 1099 : 				aIndex, lpIoCtxt->nTotalBytes, lpIoCtxt->nSecondOfs, 
; 1100 : 				dwSize, gObj[aIndex].AccountID, gObj[aIndex].Name);

  01a3a	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01a3d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01a43	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01a49	8d 54 01 77	 lea	 edx, DWORD PTR [ecx+eax+119]
  01a4d	52		 push	 edx
  01a4e	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01a51	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01a57	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01a5d	8d 54 01 6c	 lea	 edx, DWORD PTR [ecx+eax+108]
  01a61	52		 push	 edx
  01a62	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01a65	50		 push	 eax
  01a66	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01a69	8b 91 1c 00 02
	00		 mov	 edx, DWORD PTR [ecx+131100]
  01a6f	52		 push	 edx
  01a70	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01a73	8b 88 20 00 02
	00		 mov	 ecx, DWORD PTR [eax+131104]
  01a79	51		 push	 ecx
  01a7a	8b 55 08	 mov	 edx, DWORD PTR _aIndex$[ebp]
  01a7d	52		 push	 edx
  01a7e	68 00 00 00 00	 push	 OFFSET ??_C@_0CP@OMKJIPGE@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@
  01a83	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01a89	83 c4 1c	 add	 esp, 28			; 0000001cH

; 1101 : 
; 1102 : 			lpIoCtxt->nWaitIO = 0;

  01a8c	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01a8f	c7 80 2c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131116], 0

; 1103 : 
; 1104 : 			CloseClient(aIndex);

  01a99	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01a9c	50		 push	 eax
  01a9d	e8 00 00 00 00	 call	 ?CloseClient@@YAXH@Z	; CloseClient
  01aa2	83 c4 04	 add	 esp, 4

; 1105 : 
; 1106 : 			LeaveCriticalSection(&criti);

  01aa5	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01aaa	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1107 : 			return true;

  01ab0	b8 01 00 00 00	 mov	 eax, 1
  01ab5	e9 02 03 00 00	 jmp	 $LN21@DataSend
$LN9@DataSend:

; 1108 : 		}
; 1109 : 
; 1110 : 		memcpy( &lpIoCtxt->BufferSecond[lpIoCtxt->nSecondOfs], SendBuf, dwSize);

  01aba	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01abd	50		 push	 eax
  01abe	8b 4d f4	 mov	 ecx, DWORD PTR _SendBuf$[ebp]
  01ac1	51		 push	 ecx
  01ac2	8b 55 e8	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01ac5	8b 82 1c 00 02
	00		 mov	 eax, DWORD PTR [edx+131100]
  01acb	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01ace	8d 94 01 1b 00
	01 00		 lea	 edx, DWORD PTR [ecx+eax+65563]
  01ad5	52		 push	 edx
  01ad6	e8 00 00 00 00	 call	 _memcpy
  01adb	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1111 : 		lpIoCtxt->nSecondOfs += dwSize;

  01ade	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01ae1	8b 88 1c 00 02
	00		 mov	 ecx, DWORD PTR [eax+131100]
  01ae7	03 4d 10	 add	 ecx, DWORD PTR _dwSize$[ebp]
  01aea	8b 55 e8	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01aed	89 8a 1c 00 02
	00		 mov	 DWORD PTR [edx+131100], ecx

; 1112 : 		LeaveCriticalSection(&criti);

  01af3	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01af8	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1113 : 		return true;

  01afe	b8 01 00 00 00	 mov	 eax, 1
  01b03	e9 b4 02 00 00	 jmp	 $LN21@DataSend
$LN10@DataSend:

; 1114 : 	}
; 1115 : 
; 1116 : 	lpIoCtxt->nTotalBytes = 0;

  01b08	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b0b	c7 80 20 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131104], 0

; 1117 : 	
; 1118 : 	if ( lpIoCtxt->nSecondOfs > 0 )

  01b15	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b18	83 b8 1c 00 02
	00 00		 cmp	 DWORD PTR [eax+131100], 0
  01b1f	7e 42		 jle	 SHORT $LN8@DataSend

; 1119 : 	{
; 1120 : 		memcpy(lpIoCtxt->Buffer, lpIoCtxt->BufferSecond, lpIoCtxt->nSecondOfs);

  01b21	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b24	8b 88 1c 00 02
	00		 mov	 ecx, DWORD PTR [eax+131100]
  01b2a	51		 push	 ecx
  01b2b	8b 55 e8	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01b2e	81 c2 1b 00 01
	00		 add	 edx, 65563		; 0001001bH
  01b34	52		 push	 edx
  01b35	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b38	83 c0 1c	 add	 eax, 28			; 0000001cH
  01b3b	50		 push	 eax
  01b3c	e8 00 00 00 00	 call	 _memcpy
  01b41	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1121 : 		lpIoCtxt->nTotalBytes = lpIoCtxt->nSecondOfs;

  01b44	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b47	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01b4a	8b 91 1c 00 02
	00		 mov	 edx, DWORD PTR [ecx+131100]
  01b50	89 90 20 00 02
	00		 mov	 DWORD PTR [eax+131104], edx

; 1122 : 		lpIoCtxt->nSecondOfs = 0;

  01b56	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b59	c7 80 1c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131100], 0
$LN8@DataSend:

; 1123 : 	}
; 1124 : 
; 1125 : 	if ( (lpIoCtxt->nTotalBytes+dwSize) > MAX_IO_BUFFER_SIZE-1 )

  01b63	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01b66	8b 88 20 00 02
	00		 mov	 ecx, DWORD PTR [eax+131104]
  01b6c	03 4d 10	 add	 ecx, DWORD PTR _dwSize$[ebp]
  01b6f	81 f9 fe ff 00
	00		 cmp	 ecx, 65534		; 0000fffeH
  01b75	76 73		 jbe	 SHORT $LN7@DataSend

; 1126 : 	{
; 1127 : 		LogAdd("(%d)error-L2 MAX BUFFER OVER %d %d [%s][%s]", 
; 1128 : 			aIndex, lpIoCtxt->nTotalBytes, dwSize, 
; 1129 : 			gObj[aIndex].AccountID, gObj[aIndex].Name);

  01b77	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01b7a	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01b80	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01b86	8d 54 01 77	 lea	 edx, DWORD PTR [ecx+eax+119]
  01b8a	52		 push	 edx
  01b8b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01b8e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01b94	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01b9a	8d 54 01 6c	 lea	 edx, DWORD PTR [ecx+eax+108]
  01b9e	52		 push	 edx
  01b9f	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01ba2	50		 push	 eax
  01ba3	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01ba6	8b 91 20 00 02
	00		 mov	 edx, DWORD PTR [ecx+131104]
  01bac	52		 push	 edx
  01bad	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01bb0	50		 push	 eax
  01bb1	68 00 00 00 00	 push	 OFFSET ??_C@_0CM@MJNIMEPA@?$CI?$CFd?$CJerror?9L2?5MAX?5BUFFER?5OVER?5?$CFd?5@
  01bb6	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01bbc	83 c4 18	 add	 esp, 24			; 00000018H

; 1130 : 
; 1131 : 		lpIoCtxt->nWaitIO = 0;

  01bbf	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01bc2	c7 80 2c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131116], 0

; 1132 : 		
; 1133 : 		CloseClient(aIndex);

  01bcc	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01bcf	50		 push	 eax
  01bd0	e8 00 00 00 00	 call	 ?CloseClient@@YAXH@Z	; CloseClient
  01bd5	83 c4 04	 add	 esp, 4

; 1134 : 		
; 1135 : 		LeaveCriticalSection(&criti);

  01bd8	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01bdd	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1136 : 		return FALSE;

  01be3	33 c0		 xor	 eax, eax
  01be5	e9 d2 01 00 00	 jmp	 $LN21@DataSend
$LN7@DataSend:

; 1137 : 	}
; 1138 : 
; 1139 : 	memcpy( &lpIoCtxt->Buffer[lpIoCtxt->nTotalBytes], SendBuf, dwSize);

  01bea	8b 45 10	 mov	 eax, DWORD PTR _dwSize$[ebp]
  01bed	50		 push	 eax
  01bee	8b 4d f4	 mov	 ecx, DWORD PTR _SendBuf$[ebp]
  01bf1	51		 push	 ecx
  01bf2	8b 55 e8	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01bf5	8b 82 20 00 02
	00		 mov	 eax, DWORD PTR [edx+131104]
  01bfb	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01bfe	8d 54 01 1c	 lea	 edx, DWORD PTR [ecx+eax+28]
  01c02	52		 push	 edx
  01c03	e8 00 00 00 00	 call	 _memcpy
  01c08	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1140 : 	lpIoCtxt->nTotalBytes += dwSize;

  01c0b	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01c0e	8b 88 20 00 02
	00		 mov	 ecx, DWORD PTR [eax+131104]
  01c14	03 4d 10	 add	 ecx, DWORD PTR _dwSize$[ebp]
  01c17	8b 55 e8	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01c1a	89 8a 20 00 02
	00		 mov	 DWORD PTR [edx+131104], ecx

; 1141 : 	lpIoCtxt->wsabuf.buf = (char*)&lpIoCtxt->Buffer;

  01c20	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01c23	83 c0 1c	 add	 eax, 28			; 0000001cH
  01c26	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01c29	89 41 18	 mov	 DWORD PTR [ecx+24], eax

; 1142 : 	lpIoCtxt->wsabuf.len = lpIoCtxt->nTotalBytes;

  01c2c	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01c2f	8b 4d e8	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01c32	8b 91 20 00 02
	00		 mov	 edx, DWORD PTR [ecx+131104]
  01c38	89 50 14	 mov	 DWORD PTR [eax+20], edx

; 1143 : 	lpIoCtxt->nSentBytes = 0;

  01c3b	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01c3e	c7 80 24 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131108], 0

; 1144 : 	lpIoCtxt->IOOperation = SEND_IO;

  01c48	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01c4b	c7 80 28 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131112], 1

; 1145 : 
; 1146 : 	if ( WSASend( gObj[aIndex].m_socket, &lpIoCtxt->wsabuf , 1, &SendBytes, 0, &lpIoCtxt->Overlapped, NULL) == -1 )

  01c55	6a 00		 push	 0
  01c57	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01c5a	50		 push	 eax
  01c5b	6a 00		 push	 0
  01c5d	8d 4d fc	 lea	 ecx, DWORD PTR _SendBytes$[ebp]
  01c60	51		 push	 ecx
  01c61	6a 01		 push	 1
  01c63	8b 55 e8	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01c66	83 c2 14	 add	 edx, 20			; 00000014H
  01c69	52		 push	 edx
  01c6a	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01c6d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01c73	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01c79	8b 54 01 14	 mov	 edx, DWORD PTR [ecx+eax+20]
  01c7d	52		 push	 edx
  01c7e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSASend@28
  01c84	83 f8 ff	 cmp	 eax, -1
  01c87	0f 85 fd 00 00
	00		 jne	 $LN6@DataSend

; 1147 : 	{
; 1148 : 
; 1149 : 		if ( WSAGetLastError() != WSA_IO_PENDING )	

  01c8d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  01c93	3d e5 03 00 00	 cmp	 eax, 997		; 000003e5H
  01c98	0f 84 ea 00 00
	00		 je	 $LN5@DataSend

; 1150 : 		{
; 1151 : 			lpIoCtxt->nWaitIO = 0;

  01c9e	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01ca1	c7 80 2c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131116], 0

; 1152 : 			
; 1153 : 
; 1154 : 			if ( lpIoCtxt->wsabuf.buf[0] == 0xC1 )

  01cab	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01cae	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  01cb1	0f be 11	 movsx	 edx, BYTE PTR [ecx]
  01cb4	81 fa c1 00 00
	00		 cmp	 edx, 193		; 000000c1H
  01cba	75 51		 jne	 SHORT $LN4@DataSend

; 1155 : 			{
; 1156 : 				LogAdd("(%d)WSASend(%d) failed with error [%x][%x] %d %s ", 
; 1157 : 					__LINE__, aIndex, (BYTE)lpIoCtxt->wsabuf.buf[0],
; 1158 : 					(BYTE)lpIoCtxt->wsabuf.buf[2], WSAGetLastError(), gObj[aIndex].Ip_addr);

  01cbc	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01cbf	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01cc5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01ccb	8d 54 01 18	 lea	 edx, DWORD PTR [ecx+eax+24]
  01ccf	52		 push	 edx
  01cd0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  01cd6	50		 push	 eax
  01cd7	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01cda	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  01cdd	0f b6 51 02	 movzx	 edx, BYTE PTR [ecx+2]
  01ce1	52		 push	 edx
  01ce2	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01ce5	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  01ce8	0f b6 11	 movzx	 edx, BYTE PTR [ecx]
  01ceb	52		 push	 edx
  01cec	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01cef	50		 push	 eax
  01cf0	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?__LINE__Var@?1??DataSend@@YAHHPAEK@Z@4JA
  01cf6	81 c1 8e 00 00
	00		 add	 ecx, 142		; 0000008eH
  01cfc	51		 push	 ecx
  01cfd	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@KIEJLADI@?$CI?$CFd?$CJWSASend?$CI?$CFd?$CJ?5failed?5with?5erro@
  01d02	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01d08	83 c4 1c	 add	 esp, 28			; 0000001cH
  01d0b	eb 60		 jmp	 SHORT $LN3@DataSend
$LN4@DataSend:

; 1159 : 			}
; 1160 : 			else if ( lpIoCtxt->wsabuf.buf[0] == 0xC2 )

  01d0d	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01d10	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  01d13	0f be 11	 movsx	 edx, BYTE PTR [ecx]
  01d16	81 fa c2 00 00
	00		 cmp	 edx, 194		; 000000c2H
  01d1c	75 4f		 jne	 SHORT $LN3@DataSend

; 1161 : 			{
; 1162 : 				LogAdd("(%d)WSASend(%d) failed with error [%x][%x] %d %s ", 
; 1163 : 					__LINE__, aIndex, (BYTE)lpIoCtxt->wsabuf.buf[0],
; 1164 : 					(BYTE)lpIoCtxt->wsabuf.buf[3], WSAGetLastError(), gObj[aIndex].Ip_addr);

  01d1e	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01d21	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01d27	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01d2d	8d 54 01 18	 lea	 edx, DWORD PTR [ecx+eax+24]
  01d31	52		 push	 edx
  01d32	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  01d38	50		 push	 eax
  01d39	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01d3c	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  01d3f	0f b6 51 03	 movzx	 edx, BYTE PTR [ecx+3]
  01d43	52		 push	 edx
  01d44	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01d47	8b 48 18	 mov	 ecx, DWORD PTR [eax+24]
  01d4a	0f b6 11	 movzx	 edx, BYTE PTR [ecx]
  01d4d	52		 push	 edx
  01d4e	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01d51	50		 push	 eax
  01d52	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?__LINE__Var@?1??DataSend@@YAHHPAEK@Z@4JA
  01d58	81 c1 94 00 00
	00		 add	 ecx, 148		; 00000094H
  01d5e	51		 push	 ecx
  01d5f	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@KIEJLADI@?$CI?$CFd?$CJWSASend?$CI?$CFd?$CJ?5failed?5with?5erro@
  01d64	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01d6a	83 c4 1c	 add	 esp, 28			; 0000001cH
$LN3@DataSend:

; 1165 : 			}
; 1166 : 			CloseClient(aIndex);

  01d6d	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01d70	50		 push	 eax
  01d71	e8 00 00 00 00	 call	 ?CloseClient@@YAXH@Z	; CloseClient
  01d76	83 c4 04	 add	 esp, 4

; 1167 : 			LeaveCriticalSection(&criti);

  01d79	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01d7e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1168 : 			return false;

  01d84	33 c0		 xor	 eax, eax
  01d86	eb 34		 jmp	 SHORT $LN21@DataSend
$LN5@DataSend:

; 1169 : 		}
; 1170 : 	}
; 1171 : 	else

  01d88	eb 15		 jmp	 SHORT $LN1@DataSend
$LN6@DataSend:

; 1172 : 	{
; 1173 : 		lpPerSocketContext->dwIOCount ++;

  01d8a	8b 45 f8	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01d8d	8b 88 68 00 04
	00		 mov	 ecx, DWORD PTR [eax+262248]
  01d93	83 c1 01	 add	 ecx, 1
  01d96	8b 55 f8	 mov	 edx, DWORD PTR _lpPerSocketContext$[ebp]
  01d99	89 8a 68 00 04
	00		 mov	 DWORD PTR [edx+262248], ecx
$LN1@DataSend:

; 1174 : 	}
; 1175 : 	
; 1176 : 	
; 1177 : 	lpIoCtxt->nWaitIO = 1;

  01d9f	8b 45 e8	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01da2	c7 80 2c 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131116], 1

; 1178 : 	LeaveCriticalSection(&criti);

  01dac	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01db1	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1179 : 	return true;

  01db7	b8 01 00 00 00	 mov	 eax, 1
$LN21@DataSend:

; 1180 : }

  01dbc	5f		 pop	 edi
  01dbd	5e		 pop	 esi
  01dbe	5b		 pop	 ebx
  01dbf	8b e5		 mov	 esp, ebp
  01dc1	5d		 pop	 ebp
  01dc2	c3		 ret	 0
?DataSend@@YAHHPAEK@Z ENDP				; DataSend
_TEXT	ENDS
PUBLIC	??_C@_0CF@NNJJAKBF@WSASend?$CI?$CFd?$CJ?5failed?5with?5error?5?$CFd@ ; `string'
PUBLIC	?__LINE__Var@?1??IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA ; `IoSendSecond'::`2'::__LINE__Var
;	COMDAT ??_C@_0CF@NNJJAKBF@WSASend?$CI?$CFd?$CJ?5failed?5with?5error?5?$CFd@
CONST	SEGMENT
??_C@_0CF@NNJJAKBF@WSASend?$CI?$CFd?$CJ?5failed?5with?5error?5?$CFd@ DB 'W'
	DB	'SASend(%d) failed with error %d %s ', 00H	; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?1??IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?1??IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA DD 04a2H ; `IoSendSecond'::`2'::__LINE__Var
; Function compile flags: /Odtp /ZI
_DATA	ENDS
_TEXT	SEGMENT
_lpIoCtxt$ = -12					; size = 4
_aIndex$ = -8						; size = 4
_SendBytes$ = -4					; size = 4
_lpPerSocketContext$ = 8				; size = 4
?IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z PROC	; IoSendSecond

; 1186 : {

  01dd0	55		 push	 ebp
  01dd1	8b ec		 mov	 ebp, esp
  01dd3	83 ec 4c	 sub	 esp, 76			; 0000004cH
  01dd6	53		 push	 ebx
  01dd7	56		 push	 esi
  01dd8	57		 push	 edi

; 1187 : 	DWORD SendBytes;
; 1188 : 	int aIndex;
; 1189 : 	EnterCriticalSection(&criti);

  01dd9	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01dde	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 1190 : 	aIndex = lpPerSocketContext->nIndex;

  01de4	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01de7	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  01dea	89 4d f8	 mov	 DWORD PTR _aIndex$[ebp], ecx

; 1191 : 	LPPER_IO_CONTEXT	lpIoCtxt = (LPPER_IO_CONTEXT)&lpPerSocketContext->IOContext[1];

  01ded	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01df0	05 38 00 02 00	 add	 eax, 131128		; 00020038H
  01df5	89 45 f4	 mov	 DWORD PTR _lpIoCtxt$[ebp], eax

; 1192 : 
; 1193 : 	if ( lpIoCtxt->nWaitIO > 0 )

  01df8	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01dfb	83 b8 2c 00 02
	00 00		 cmp	 DWORD PTR [eax+131116], 0
  01e02	7e 12		 jle	 SHORT $LN6@IoSendSeco

; 1194 : 	{
; 1195 : 		LeaveCriticalSection(&criti);

  01e04	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01e09	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1196 : 		return false;

  01e0f	33 c0		 xor	 eax, eax
  01e11	e9 66 01 00 00	 jmp	 $LN7@IoSendSeco
$LN6@IoSendSeco:

; 1197 : 	}
; 1198 : 
; 1199 : 	lpIoCtxt->nTotalBytes = 0;

  01e16	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e19	c7 80 20 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131104], 0

; 1200 : 	if ( lpIoCtxt->nSecondOfs > 0 )

  01e23	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e26	83 b8 1c 00 02
	00 00		 cmp	 DWORD PTR [eax+131100], 0
  01e2d	7e 44		 jle	 SHORT $LN5@IoSendSeco

; 1201 : 	{
; 1202 : 		memcpy(lpIoCtxt->Buffer, lpIoCtxt->BufferSecond, lpIoCtxt->nSecondOfs);

  01e2f	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e32	8b 88 1c 00 02
	00		 mov	 ecx, DWORD PTR [eax+131100]
  01e38	51		 push	 ecx
  01e39	8b 55 f4	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01e3c	81 c2 1b 00 01
	00		 add	 edx, 65563		; 0001001bH
  01e42	52		 push	 edx
  01e43	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e46	83 c0 1c	 add	 eax, 28			; 0000001cH
  01e49	50		 push	 eax
  01e4a	e8 00 00 00 00	 call	 _memcpy
  01e4f	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1203 : 		lpIoCtxt->nTotalBytes = lpIoCtxt->nSecondOfs;

  01e52	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e55	8b 4d f4	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01e58	8b 91 1c 00 02
	00		 mov	 edx, DWORD PTR [ecx+131100]
  01e5e	89 90 20 00 02
	00		 mov	 DWORD PTR [eax+131104], edx

; 1204 : 		lpIoCtxt->nSecondOfs = 0;

  01e64	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e67	c7 80 1c 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131100], 0

; 1205 : 	}
; 1206 : 	else

  01e71	eb 12		 jmp	 SHORT $LN4@IoSendSeco
$LN5@IoSendSeco:

; 1207 : 	{
; 1208 : 		LeaveCriticalSection(&criti);

  01e73	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01e78	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1209 : 		return false;

  01e7e	33 c0		 xor	 eax, eax
  01e80	e9 f7 00 00 00	 jmp	 $LN7@IoSendSeco
$LN4@IoSendSeco:

; 1210 : 	}
; 1211 : 
; 1212 : 	lpIoCtxt->wsabuf.buf = (char*)&lpIoCtxt->Buffer;

  01e85	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e88	83 c0 1c	 add	 eax, 28			; 0000001cH
  01e8b	8b 4d f4	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01e8e	89 41 18	 mov	 DWORD PTR [ecx+24], eax

; 1213 : 	lpIoCtxt->wsabuf.len = lpIoCtxt->nTotalBytes;

  01e91	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01e94	8b 4d f4	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01e97	8b 91 20 00 02
	00		 mov	 edx, DWORD PTR [ecx+131104]
  01e9d	89 50 14	 mov	 DWORD PTR [eax+20], edx

; 1214 : 	lpIoCtxt->nSentBytes = 0;

  01ea0	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01ea3	c7 80 24 00 02
	00 00 00 00 00	 mov	 DWORD PTR [eax+131108], 0

; 1215 : 	lpIoCtxt->IOOperation = SEND_IO;

  01ead	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01eb0	c7 80 28 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131112], 1

; 1216 : 
; 1217 : 	if ( WSASend(gObj[aIndex].m_socket, &lpIoCtxt->wsabuf, 1, &SendBytes, 0, &lpIoCtxt->Overlapped, NULL) == -1 )

  01eba	6a 00		 push	 0
  01ebc	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01ebf	50		 push	 eax
  01ec0	6a 00		 push	 0
  01ec2	8d 4d fc	 lea	 ecx, DWORD PTR _SendBytes$[ebp]
  01ec5	51		 push	 ecx
  01ec6	6a 01		 push	 1
  01ec8	8b 55 f4	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01ecb	83 c2 14	 add	 edx, 20			; 00000014H
  01ece	52		 push	 edx
  01ecf	8b 45 f8	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01ed2	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01ed8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01ede	8b 54 01 14	 mov	 edx, DWORD PTR [ecx+eax+20]
  01ee2	52		 push	 edx
  01ee3	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSASend@28
  01ee9	83 f8 ff	 cmp	 eax, -1
  01eec	75 5c		 jne	 SHORT $LN3@IoSendSeco

; 1218 : 	{
; 1219 : 		if ( WSAGetLastError() != WSA_IO_PENDING )

  01eee	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  01ef4	3d e5 03 00 00	 cmp	 eax, 997		; 000003e5H
  01ef9	74 4d		 je	 SHORT $LN2@IoSendSeco

; 1220 : 		{
; 1221 : 			LogAdd("WSASend(%d) failed with error %d %s ", __LINE__, WSAGetLastError(), gObj[aIndex].Ip_addr);

  01efb	8b 45 f8	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01efe	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01f04	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01f0a	8d 54 01 18	 lea	 edx, DWORD PTR [ecx+eax+24]
  01f0e	52		 push	 edx
  01f0f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  01f15	50		 push	 eax
  01f16	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA
  01f1b	83 c0 23	 add	 eax, 35			; 00000023H
  01f1e	50		 push	 eax
  01f1f	68 00 00 00 00	 push	 OFFSET ??_C@_0CF@NNJJAKBF@WSASend?$CI?$CFd?$CJ?5failed?5with?5error?5?$CFd@
  01f24	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  01f2a	83 c4 10	 add	 esp, 16			; 00000010H

; 1222 : 			CloseClient(aIndex);

  01f2d	8b 45 f8	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01f30	50		 push	 eax
  01f31	e8 00 00 00 00	 call	 ?CloseClient@@YAXH@Z	; CloseClient
  01f36	83 c4 04	 add	 esp, 4

; 1223 : 			LeaveCriticalSection(&criti);

  01f39	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01f3e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1224 : 			return false;

  01f44	33 c0		 xor	 eax, eax
  01f46	eb 34		 jmp	 SHORT $LN7@IoSendSeco
$LN2@IoSendSeco:

; 1225 : 		}
; 1226 : 	}
; 1227 : 	else

  01f48	eb 15		 jmp	 SHORT $LN1@IoSendSeco
$LN3@IoSendSeco:

; 1228 : 	{
; 1229 : 		lpPerSocketContext->dwIOCount ++;

  01f4a	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01f4d	8b 88 68 00 04
	00		 mov	 ecx, DWORD PTR [eax+262248]
  01f53	83 c1 01	 add	 ecx, 1
  01f56	8b 55 08	 mov	 edx, DWORD PTR _lpPerSocketContext$[ebp]
  01f59	89 8a 68 00 04
	00		 mov	 DWORD PTR [edx+262248], ecx
$LN1@IoSendSeco:

; 1230 : 	}
; 1231 : 	
; 1232 : 	lpIoCtxt->nWaitIO = 1;

  01f5f	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01f62	c7 80 2c 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131116], 1

; 1233 : 	LeaveCriticalSection(&criti);

  01f6c	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01f71	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1234 : 	
; 1235 : 	return true;

  01f77	b8 01 00 00 00	 mov	 eax, 1
$LN7@IoSendSeco:

; 1236 : }

  01f7c	5f		 pop	 edi
  01f7d	5e		 pop	 esi
  01f7e	5b		 pop	 ebx
  01f7f	8b e5		 mov	 esp, ebp
  01f81	5d		 pop	 ebp
  01f82	c3		 ret	 0
?IoSendSecond@@YAHPAU_PER_SOCKET_CONTEXT@@@Z ENDP	; IoSendSecond
_TEXT	ENDS
PUBLIC	?__LINE__Var@?1??IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA ; `IoMoreSend'::`2'::__LINE__Var
;	COMDAT ?__LINE__Var@?1??IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?1??IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA DD 04d8H ; `IoMoreSend'::`2'::__LINE__Var
; Function compile flags: /Odtp /ZI
_DATA	ENDS
_TEXT	SEGMENT
_lpIoCtxt$ = -12					; size = 4
_aIndex$ = -8						; size = 4
_SendBytes$ = -4					; size = 4
_lpPerSocketContext$ = 8				; size = 4
?IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z PROC		; IoMoreSend

; 1240 : {

  01f90	55		 push	 ebp
  01f91	8b ec		 mov	 ebp, esp
  01f93	83 ec 4c	 sub	 esp, 76			; 0000004cH
  01f96	53		 push	 ebx
  01f97	56		 push	 esi
  01f98	57		 push	 edi

; 1241 : 	DWORD SendBytes;
; 1242 : 	int aIndex;
; 1243 : 	
; 1244 : 	EnterCriticalSection(&criti);

  01f99	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01f9e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 1245 : 	aIndex = lpPerSocketContext->nIndex;

  01fa4	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01fa7	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  01faa	89 4d f8	 mov	 DWORD PTR _aIndex$[ebp], ecx

; 1246 : 	LPPER_IO_CONTEXT	lpIoCtxt = (LPPER_IO_CONTEXT)&lpPerSocketContext->IOContext[1];

  01fad	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  01fb0	05 38 00 02 00	 add	 eax, 131128		; 00020038H
  01fb5	89 45 f4	 mov	 DWORD PTR _lpIoCtxt$[ebp], eax

; 1247 : 
; 1248 : 	if ( (lpIoCtxt->nTotalBytes - lpIoCtxt->nSentBytes) < 0 )

  01fb8	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01fbb	8b 4d f4	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01fbe	8b 90 20 00 02
	00		 mov	 edx, DWORD PTR [eax+131104]
  01fc4	2b 91 24 00 02
	00		 sub	 edx, DWORD PTR [ecx+131108]
  01fca	79 12		 jns	 SHORT $LN4@IoMoreSend

; 1249 : 	{
; 1250 : 		LeaveCriticalSection(&criti);

  01fcc	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  01fd1	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1251 : 		return false;

  01fd7	33 c0		 xor	 eax, eax
  01fd9	e9 fd 00 00 00	 jmp	 $LN5@IoMoreSend
$LN4@IoMoreSend:

; 1252 : 	}
; 1253 : 
; 1254 : 	lpIoCtxt->wsabuf.buf = (char*)&lpIoCtxt->Buffer[lpIoCtxt->nSentBytes];

  01fde	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01fe1	8b 88 24 00 02
	00		 mov	 ecx, DWORD PTR [eax+131108]
  01fe7	8b 55 f4	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  01fea	8d 44 0a 1c	 lea	 eax, DWORD PTR [edx+ecx+28]
  01fee	8b 4d f4	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01ff1	89 41 18	 mov	 DWORD PTR [ecx+24], eax

; 1255 : 	lpIoCtxt->wsabuf.len = lpIoCtxt->nTotalBytes - lpIoCtxt->nSentBytes;

  01ff4	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  01ff7	8b 4d f4	 mov	 ecx, DWORD PTR _lpIoCtxt$[ebp]
  01ffa	8b 90 20 00 02
	00		 mov	 edx, DWORD PTR [eax+131104]
  02000	2b 91 24 00 02
	00		 sub	 edx, DWORD PTR [ecx+131108]
  02006	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  02009	89 50 14	 mov	 DWORD PTR [eax+20], edx

; 1256 : 	lpIoCtxt->IOOperation = SEND_IO;

  0200c	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  0200f	c7 80 28 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131112], 1

; 1257 : 
; 1258 : 	if ( WSASend(gObj[aIndex].m_socket, &lpIoCtxt->wsabuf, 1, &SendBytes, 0, &lpIoCtxt->Overlapped, NULL) == -1 )

  02019	6a 00		 push	 0
  0201b	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  0201e	50		 push	 eax
  0201f	6a 00		 push	 0
  02021	8d 4d fc	 lea	 ecx, DWORD PTR _SendBytes$[ebp]
  02024	51		 push	 ecx
  02025	6a 01		 push	 1
  02027	8b 55 f4	 mov	 edx, DWORD PTR _lpIoCtxt$[ebp]
  0202a	83 c2 14	 add	 edx, 20			; 00000014H
  0202d	52		 push	 edx
  0202e	8b 45 f8	 mov	 eax, DWORD PTR _aIndex$[ebp]
  02031	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02037	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0203d	8b 54 01 14	 mov	 edx, DWORD PTR [ecx+eax+20]
  02041	52		 push	 edx
  02042	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSASend@28
  02048	83 f8 ff	 cmp	 eax, -1
  0204b	75 5c		 jne	 SHORT $LN3@IoMoreSend

; 1259 : 	{
; 1260 : 		if ( WSAGetLastError() != WSA_IO_PENDING )

  0204d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  02053	3d e5 03 00 00	 cmp	 eax, 997		; 000003e5H
  02058	74 4d		 je	 SHORT $LN2@IoMoreSend

; 1261 : 		{
; 1262 : 			LogAdd("WSASend(%d) failed with error %d %s ", __LINE__, WSAGetLastError(), gObj[aIndex].Ip_addr);

  0205a	8b 45 f8	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0205d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02063	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02069	8d 54 01 18	 lea	 edx, DWORD PTR [ecx+eax+24]
  0206d	52		 push	 edx
  0206e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  02074	50		 push	 eax
  02075	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?1??IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z@4JA
  0207a	83 c0 16	 add	 eax, 22			; 00000016H
  0207d	50		 push	 eax
  0207e	68 00 00 00 00	 push	 OFFSET ??_C@_0CF@NNJJAKBF@WSASend?$CI?$CFd?$CJ?5failed?5with?5error?5?$CFd@
  02083	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  02089	83 c4 10	 add	 esp, 16			; 00000010H

; 1263 : 			CloseClient(aIndex);

  0208c	8b 45 f8	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0208f	50		 push	 eax
  02090	e8 00 00 00 00	 call	 ?CloseClient@@YAXH@Z	; CloseClient
  02095	83 c4 04	 add	 esp, 4

; 1264 : 			LeaveCriticalSection(&criti);

  02098	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0209d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1265 : 			return false;

  020a3	33 c0		 xor	 eax, eax
  020a5	eb 34		 jmp	 SHORT $LN5@IoMoreSend
$LN2@IoMoreSend:

; 1266 : 		}
; 1267 : 	}
; 1268 : 	else

  020a7	eb 15		 jmp	 SHORT $LN1@IoMoreSend
$LN3@IoMoreSend:

; 1269 : 	{
; 1270 : 		lpPerSocketContext->dwIOCount ++;

  020a9	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  020ac	8b 88 68 00 04
	00		 mov	 ecx, DWORD PTR [eax+262248]
  020b2	83 c1 01	 add	 ecx, 1
  020b5	8b 55 08	 mov	 edx, DWORD PTR _lpPerSocketContext$[ebp]
  020b8	89 8a 68 00 04
	00		 mov	 DWORD PTR [edx+262248], ecx
$LN1@IoMoreSend:

; 1271 : 	}
; 1272 : 	
; 1273 : 	
; 1274 : 	lpIoCtxt->nWaitIO = 1;

  020be	8b 45 f4	 mov	 eax, DWORD PTR _lpIoCtxt$[ebp]
  020c1	c7 80 2c 00 02
	00 01 00 00 00	 mov	 DWORD PTR [eax+131116], 1

; 1275 : 	LeaveCriticalSection(&criti);

  020cb	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  020d0	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4

; 1276 : 	return true;

  020d6	b8 01 00 00 00	 mov	 eax, 1
$LN5@IoMoreSend:

; 1277 : }

  020db	5f		 pop	 edi
  020dc	5e		 pop	 esi
  020dd	5b		 pop	 ebx
  020de	8b e5		 mov	 esp, ebp
  020e0	5d		 pop	 ebp
  020e1	c3		 ret	 0
?IoMoreSend@@YAHPAU_PER_SOCKET_CONTEXT@@@Z ENDP		; IoMoreSend
_TEXT	ENDS
PUBLIC	??_C@_0BL@HHALLDPN@CreateIoCompletionPort?3?5?$CFd?$AA@ ; `string'
;	COMDAT ??_C@_0BL@HHALLDPN@CreateIoCompletionPort?3?5?$CFd?$AA@
CONST	SEGMENT
??_C@_0BL@HHALLDPN@CreateIoCompletionPort?3?5?$CFd?$AA@ DB 'CreateIoCompl'
	DB	'etionPort: %d', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_cp$ = -8						; size = 4
_lpPerSocketContext$ = -4				; size = 4
_sd$ = 8						; size = 4
_ClientIndex$ = 12					; size = 4
_bAddToList$ = 16					; size = 4
?UpdateCompletionPort@@YAHIHH@Z PROC			; UpdateCompletionPort

; 1281 : {

  020f0	55		 push	 ebp
  020f1	8b ec		 mov	 ebp, esp
  020f3	83 ec 48	 sub	 esp, 72			; 00000048H
  020f6	53		 push	 ebx
  020f7	56		 push	 esi
  020f8	57		 push	 edi

; 1282 : 	LPPER_SOCKET_CONTEXT lpPerSocketContext = NULL;

  020f9	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _lpPerSocketContext$[ebp], 0

; 1283 : 
; 1284 : 	HANDLE cp = CreateIoCompletionPort((HANDLE)sd, g_CompletionPort, (DWORD)ClientIndex, 0); 

  02100	6a 00		 push	 0
  02102	8b 45 0c	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  02105	50		 push	 eax
  02106	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_CompletionPort@@3PAXA ; g_CompletionPort
  0210c	51		 push	 ecx
  0210d	8b 55 08	 mov	 edx, DWORD PTR _sd$[ebp]
  02110	52		 push	 edx
  02111	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__CreateIoCompletionPort@16
  02117	89 45 f8	 mov	 DWORD PTR _cp$[ebp], eax

; 1285 :     
; 1286 : 	if (cp == NULL)

  0211a	83 7d f8 00	 cmp	 DWORD PTR _cp$[ebp], 0
  0211e	75 19		 jne	 SHORT $LN1@UpdateComp

; 1287 : 	{
; 1288 : 		LogAdd("CreateIoCompletionPort: %d", GetLastError() );

  02120	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetLastError@0
  02126	50		 push	 eax
  02127	68 00 00 00 00	 push	 OFFSET ??_C@_0BL@HHALLDPN@CreateIoCompletionPort?3?5?$CFd?$AA@
  0212c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  02132	83 c4 08	 add	 esp, 8

; 1289 : 		return FALSE;

  02135	33 c0		 xor	 eax, eax
  02137	eb 22		 jmp	 SHORT $LN2@UpdateComp
$LN1@UpdateComp:

; 1290 : 	}
; 1291 : 
; 1292 : 	#if(ENABLE_OPTIMIZATION)
; 1293 : 	g_Optimization.AddedMemoryObject(ClientIndex);
; 1294 : 	#endif
; 1295 : 
; 1296 : 	gObj[ClientIndex].PerSocketContext->dwIOCount = 0;

  02139	8b 45 0c	 mov	 eax, DWORD PTR _ClientIndex$[ebp]
  0213c	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02142	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02148	8b 54 01 10	 mov	 edx, DWORD PTR [ecx+eax+16]
  0214c	c7 82 68 00 04
	00 00 00 00 00	 mov	 DWORD PTR [edx+262248], 0

; 1297 : 	return TRUE;

  02156	b8 01 00 00 00	 mov	 eax, 1
$LN2@UpdateComp:

; 1298 : }

  0215b	5f		 pop	 edi
  0215c	5e		 pop	 esi
  0215d	5b		 pop	 ebx
  0215e	8b e5		 mov	 esp, ebp
  02160	5d		 pop	 ebp
  02161	c3		 ret	 0
?UpdateCompletionPort@@YAHIHH@Z ENDP			; UpdateCompletionPort
_TEXT	ENDS
EXTRN	?gObjDel@@YAFH@Z:PROC				; gObjDel
EXTRN	?CheckOnlineUser@cOffTrade@@QAE_NH@Z:PROC	; cOffTrade::CheckOnlineUser
EXTRN	?gOffTrade@@3VcOffTrade@@A:BYTE			; gOffTrade
EXTRN	__imp__GetTickCount@0:PROC
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
_lpObj$230570 = -8					; size = 4
_index$ = -4						; size = 4
_lpPerSocketContext$ = 8				; size = 4
_bGraceful$ = 12					; size = 4
?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z PROC	; CloseClient

; 1302 : {

  02170	55		 push	 ebp
  02171	8b ec		 mov	 ebp, esp
  02173	83 ec 48	 sub	 esp, 72			; 00000048H
  02176	53		 push	 ebx
  02177	56		 push	 esi
  02178	57		 push	 edi

; 1303 : 	int index = -1;

  02179	c7 45 fc ff ff
	ff ff		 mov	 DWORD PTR _index$[ebp], -1

; 1304 : 	index = lpPerSocketContext->nIndex ;

  02180	8b 45 08	 mov	 eax, DWORD PTR _lpPerSocketContext$[ebp]
  02183	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  02186	89 4d fc	 mov	 DWORD PTR _index$[ebp], ecx

; 1305 : 
; 1306 : 	if ( index >= OBJ_STARTUSERINDEX && index < OBJMAX )

  02189	81 7d fc b0 36
	00 00		 cmp	 DWORD PTR _index$[ebp], 14000 ; 000036b0H
  02190	0f 8c d7 00 00
	00		 jl	 $LN8@CloseClien
  02196	81 7d fc 98 3a
	00 00		 cmp	 DWORD PTR _index$[ebp], 15000 ; 00003a98H
  0219d	0f 8d ca 00 00
	00		 jge	 $LN8@CloseClien

; 1307 : 	{
; 1308 : 		LPOBJ lpObj = &gObj[index];

  021a3	8b 45 fc	 mov	 eax, DWORD PTR _index$[ebp]
  021a6	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  021ac	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  021b2	89 45 f8	 mov	 DWORD PTR _lpObj$230570[ebp], eax

; 1309 : 
; 1310 : #if(OFFLINE_MODE==TRUE)
; 1311 : 		if(lpObj->m_OfflineMode == true)

  021b5	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$230570[ebp]
  021b8	0f b6 88 d4 28
	00 00		 movzx	 ecx, BYTE PTR [eax+10452]
  021bf	83 f9 01	 cmp	 ecx, 1
  021c2	75 11		 jne	 SHORT $LN6@CloseClien

; 1312 : 		{
; 1313 : 			lpObj->CheckTick = GetTickCount();

  021c4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  021ca	8b 4d f8	 mov	 ecx, DWORD PTR _lpObj$230570[ebp]
  021cd	89 41 40	 mov	 DWORD PTR [ecx+64], eax

; 1314 : 			return;

  021d0	e9 98 00 00 00	 jmp	 $LN8@CloseClien
$LN6@CloseClien:

; 1315 : 		}
; 1316 : #endif
; 1317 : 
; 1318 : 		//OffExp
; 1319 : 		if(lpObj->OffExp == 1)

  021d5	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$230570[ebp]
  021d8	83 b8 98 22 00
	00 01		 cmp	 DWORD PTR [eax+8856], 1
  021df	75 0e		 jne	 SHORT $LN5@CloseClien

; 1320 : 		{
; 1321 : 			//LPOBJ lpObj = &gObj[index];
; 1322 : 			lpObj->CheckTick = GetTickCount();

  021e1	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  021e7	8b 4d f8	 mov	 ecx, DWORD PTR _lpObj$230570[ebp]
  021ea	89 41 40	 mov	 DWORD PTR [ecx+64], eax

; 1323 : 			return;

  021ed	eb 7e		 jmp	 SHORT $LN8@CloseClien
$LN5@CloseClien:

; 1324 : 		}
; 1325 : 
; 1326 : #ifdef _OFFTRADE_
; 1327 : 		if(gOffTrade.CheckOnlineUser(index))return;

  021ef	8b 45 fc	 mov	 eax, DWORD PTR _index$[ebp]
  021f2	50		 push	 eax
  021f3	b9 00 00 00 00	 mov	 ecx, OFFSET ?gOffTrade@@3VcOffTrade@@A ; gOffTrade
  021f8	e8 00 00 00 00	 call	 ?CheckOnlineUser@cOffTrade@@QAE_NH@Z ; cOffTrade::CheckOnlineUser
  021fd	0f b6 c8	 movzx	 ecx, al
  02200	85 c9		 test	 ecx, ecx
  02202	74 02		 je	 SHORT $LN4@CloseClien
  02204	eb 67		 jmp	 SHORT $LN8@CloseClien
$LN4@CloseClien:

; 1328 : #endif
; 1329 : 
; 1330 : 		if ( gObj[index].m_socket != INVALID_SOCKET )

  02206	8b 45 fc	 mov	 eax, DWORD PTR _index$[ebp]
  02209	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0220f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02215	83 7c 01 14 ff	 cmp	 DWORD PTR [ecx+eax+20], -1
  0221a	74 45		 je	 SHORT $LN3@CloseClien

; 1331 : 		{
; 1332 : 			if (closesocket(gObj[index].m_socket) == -1 )

  0221c	8b 45 fc	 mov	 eax, DWORD PTR _index$[ebp]
  0221f	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02225	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0222b	8b 54 01 14	 mov	 edx, DWORD PTR [ecx+eax+20]
  0222f	52		 push	 edx
  02230	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4
  02236	83 f8 ff	 cmp	 eax, -1
  02239	75 0f		 jne	 SHORT $LN2@CloseClien

; 1333 : 			{
; 1334 : 				if ( WSAGetLastError() != 10038 )

  0223b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__WSAGetLastError@0
  02241	3d 36 27 00 00	 cmp	 eax, 10038		; 00002736H
  02246	74 02		 je	 SHORT $LN2@CloseClien

; 1335 : 				{
; 1336 : 					return;

  02248	eb 23		 jmp	 SHORT $LN8@CloseClien
$LN2@CloseClien:

; 1337 : 				}
; 1338 : 			}
; 1339 : 
; 1340 : 			gObj[index].m_socket = INVALID_SOCKET;

  0224a	8b 45 fc	 mov	 eax, DWORD PTR _index$[ebp]
  0224d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02253	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02259	c7 44 01 14 ff
	ff ff ff	 mov	 DWORD PTR [ecx+eax+20], -1
$LN3@CloseClien:

; 1341 : 		}
; 1342 : 
; 1343 : 		gObjDel(index);

  02261	8b 45 fc	 mov	 eax, DWORD PTR _index$[ebp]
  02264	50		 push	 eax
  02265	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel
  0226a	83 c4 04	 add	 esp, 4
$LN8@CloseClien:

; 1344 : 	}
; 1345 : }

  0226d	5f		 pop	 edi
  0226e	5e		 pop	 esi
  0226f	5b		 pop	 ebx
  02270	8b e5		 mov	 esp, ebp
  02272	5d		 pop	 ebp
  02273	c3		 ret	 0
?CloseClient@@YAXPAU_PER_SOCKET_CONTEXT@@H@Z ENDP	; CloseClient
_TEXT	ENDS
PUBLIC	??_C@_0CG@EMNFJCMC@error?9L1?5?3?5CloseClient?5INVALID_S@ ; `string'
PUBLIC	??_C@_0CF@PBECJIMH@error?9L1?5?3?5CloseClient?5connect?5e@ ; `string'
PUBLIC	??_C@_0CD@NBNKEDMK@error?9L1?5?3?5CloseClient?5index?5err@ ; `string'
;	COMDAT ??_C@_0CG@EMNFJCMC@error?9L1?5?3?5CloseClient?5INVALID_S@
CONST	SEGMENT
??_C@_0CG@EMNFJCMC@error?9L1?5?3?5CloseClient?5INVALID_S@ DB 'error-L1 : '
	DB	'CloseClient INVALID_SOCKET', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0CF@PBECJIMH@error?9L1?5?3?5CloseClient?5connect?5e@
CONST	SEGMENT
??_C@_0CF@PBECJIMH@error?9L1?5?3?5CloseClient?5connect?5e@ DB 'error-L1 :'
	DB	' CloseClient connect error', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0CD@NBNKEDMK@error?9L1?5?3?5CloseClient?5index?5err@
CONST	SEGMENT
??_C@_0CD@NBNKEDMK@error?9L1?5?3?5CloseClient?5index?5err@ DB 'error-L1 :'
	DB	' CloseClient index error', 00H		; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_lpObj$ = -4						; size = 4
_index$ = 8						; size = 4
?CloseClient@@YAXH@Z PROC				; CloseClient

; 1350 : {

  02280	55		 push	 ebp
  02281	8b ec		 mov	 ebp, esp
  02283	83 ec 44	 sub	 esp, 68			; 00000044H
  02286	53		 push	 ebx
  02287	56		 push	 esi
  02288	57		 push	 edi

; 1351 : 	if ( index < 0 || index > OBJMAX-1 )

  02289	83 7d 08 00	 cmp	 DWORD PTR _index$[ebp], 0
  0228d	7c 09		 jl	 SHORT $LN7@CloseClien@2
  0228f	81 7d 08 97 3a
	00 00		 cmp	 DWORD PTR _index$[ebp], 14999 ; 00003a97H
  02296	7e 13		 jle	 SHORT $LN8@CloseClien@2
$LN7@CloseClien@2:

; 1352 : 	{
; 1353 : 		LogAdd("error-L1 : CloseClient index error");

  02298	68 00 00 00 00	 push	 OFFSET ??_C@_0CD@NBNKEDMK@error?9L1?5?3?5CloseClient?5index?5err@
  0229d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  022a3	83 c4 04	 add	 esp, 4

; 1354 : 		return;

  022a6	e9 fc 00 00 00	 jmp	 $LN9@CloseClien@2
$LN8@CloseClien@2:

; 1355 : 	}
; 1356 : 
; 1357 : 	if ( gObj[index].Connected == PLAYER_EMPTY )

  022ab	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  022ae	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  022b4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  022ba	83 7c 01 04 00	 cmp	 DWORD PTR [ecx+eax+4], 0
  022bf	75 13		 jne	 SHORT $LN6@CloseClien@2

; 1358 : 	{
; 1359 : 		LogAdd("error-L1 : CloseClient connect error");

  022c1	68 00 00 00 00	 push	 OFFSET ??_C@_0CF@PBECJIMH@error?9L1?5?3?5CloseClient?5connect?5e@
  022c6	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  022cc	83 c4 04	 add	 esp, 4

; 1360 : 		return;

  022cf	e9 d3 00 00 00	 jmp	 $LN9@CloseClien@2
$LN6@CloseClien@2:

; 1361 : 	}
; 1362 : 
; 1363 : 	LPOBJ lpObj = &gObj[index];

  022d4	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  022d7	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  022dd	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  022e3	89 45 fc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1364 : 
; 1365 : #if(OFFLINE_MODE==TRUE)
; 1366 : 	if(lpObj->m_OfflineMode == true)

  022e6	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  022e9	0f b6 88 d4 28
	00 00		 movzx	 ecx, BYTE PTR [eax+10452]
  022f0	83 f9 01	 cmp	 ecx, 1
  022f3	75 11		 jne	 SHORT $LN5@CloseClien@2

; 1367 : 	{
; 1368 : 		lpObj->CheckTick = GetTickCount();

  022f5	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  022fb	8b 4d fc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  022fe	89 41 40	 mov	 DWORD PTR [ecx+64], eax

; 1369 : 		return;

  02301	e9 a1 00 00 00	 jmp	 $LN9@CloseClien@2
$LN5@CloseClien@2:

; 1370 : 	}
; 1371 : #endif
; 1372 : 
; 1373 : 	//	OffExp
; 1374 : 	if(lpObj->OffExp == 1)

  02306	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02309	83 b8 98 22 00
	00 01		 cmp	 DWORD PTR [eax+8856], 1
  02310	75 11		 jne	 SHORT $LN4@CloseClien@2

; 1375 : 	{
; 1376 : 		lpObj->CheckTick = GetTickCount();

  02312	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  02318	8b 4d fc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0231b	89 41 40	 mov	 DWORD PTR [ecx+64], eax

; 1377 : 		return;

  0231e	e9 84 00 00 00	 jmp	 $LN9@CloseClien@2
$LN4@CloseClien@2:

; 1378 : 	}
; 1379 : 
; 1380 : #ifdef _OFFTRADE_
; 1381 : 		if(gOffTrade.CheckOnlineUser(index))return;

  02323	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02326	50		 push	 eax
  02327	b9 00 00 00 00	 mov	 ecx, OFFSET ?gOffTrade@@3VcOffTrade@@A ; gOffTrade
  0232c	e8 00 00 00 00	 call	 ?CheckOnlineUser@cOffTrade@@QAE_NH@Z ; cOffTrade::CheckOnlineUser
  02331	0f b6 c8	 movzx	 ecx, al
  02334	85 c9		 test	 ecx, ecx
  02336	74 02		 je	 SHORT $LN3@CloseClien@2
  02338	eb 6d		 jmp	 SHORT $LN9@CloseClien@2
$LN3@CloseClien@2:

; 1382 : #endif
; 1383 : 
; 1384 : 	EnterCriticalSection(&criti);

  0233a	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0233f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 1385 : 
; 1386 : 	if ( gObj[index].m_socket != INVALID_SOCKET )

  02345	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02348	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0234e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02354	83 7c 01 14 ff	 cmp	 DWORD PTR [ecx+eax+20], -1
  02359	74 33		 je	 SHORT $LN2@CloseClien@2

; 1387 : 	{
; 1388 : 		closesocket(gObj[index].m_socket );

  0235b	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  0235e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02364	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0236a	8b 54 01 14	 mov	 edx, DWORD PTR [ecx+eax+20]
  0236e	52		 push	 edx
  0236f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 1389 : 		gObj[index].m_socket = INVALID_SOCKET;

  02375	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02378	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0237e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02384	c7 44 01 14 ff
	ff ff ff	 mov	 DWORD PTR [ecx+eax+20], -1

; 1390 : 	}
; 1391 : 	else

  0238c	eb 0e		 jmp	 SHORT $LN1@CloseClien@2
$LN2@CloseClien@2:

; 1392 : 	{
; 1393 : 		LogAdd("error-L1 : CloseClient INVALID_SOCKET");

  0238e	68 00 00 00 00	 push	 OFFSET ??_C@_0CG@EMNFJCMC@error?9L1?5?3?5CloseClient?5INVALID_S@
  02393	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  02399	83 c4 04	 add	 esp, 4
$LN1@CloseClien@2:

; 1394 : 	}
; 1395 : 
; 1396 : 	LeaveCriticalSection(&criti);

  0239c	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  023a1	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4
$LN9@CloseClien@2:

; 1397 : }

  023a7	5f		 pop	 edi
  023a8	5e		 pop	 esi
  023a9	5b		 pop	 ebx
  023aa	8b e5		 mov	 esp, ebp
  023ac	5d		 pop	 ebp
  023ad	c3		 ret	 0
?CloseClient@@YAXH@Z ENDP				; CloseClient
_TEXT	ENDS
PUBLIC	?ResponErrorCloseClient@@YAXH@Z			; ResponErrorCloseClient
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
_lpObj$ = -4						; size = 4
_index$ = 8						; size = 4
?ResponErrorCloseClient@@YAXH@Z PROC			; ResponErrorCloseClient

; 1400 : {

  023b0	55		 push	 ebp
  023b1	8b ec		 mov	 ebp, esp
  023b3	83 ec 44	 sub	 esp, 68			; 00000044H
  023b6	53		 push	 ebx
  023b7	56		 push	 esi
  023b8	57		 push	 edi

; 1401 : 	if ( index < 0 || index > OBJMAX-1 )

  023b9	83 7d 08 00	 cmp	 DWORD PTR _index$[ebp], 0
  023bd	7c 09		 jl	 SHORT $LN6@ResponErro
  023bf	81 7d 08 97 3a
	00 00		 cmp	 DWORD PTR _index$[ebp], 14999 ; 00003a97H
  023c6	7e 13		 jle	 SHORT $LN7@ResponErro
$LN6@ResponErro:

; 1402 : 	{
; 1403 : 		LogAdd("error-L1 : CloseClient index error");

  023c8	68 00 00 00 00	 push	 OFFSET ??_C@_0CD@NBNKEDMK@error?9L1?5?3?5CloseClient?5index?5err@
  023cd	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  023d3	83 c4 04	 add	 esp, 4

; 1404 : 		return;

  023d6	e9 06 01 00 00	 jmp	 $LN8@ResponErro
$LN7@ResponErro:

; 1405 : 	}
; 1406 : 
; 1407 : 	if ( gObj[index].Connected == PLAYER_EMPTY )

  023db	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  023de	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  023e4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  023ea	83 7c 01 04 00	 cmp	 DWORD PTR [ecx+eax+4], 0
  023ef	75 13		 jne	 SHORT $LN5@ResponErro

; 1408 : 	{
; 1409 : 		LogAdd("error-L1 : CloseClient connect error");

  023f1	68 00 00 00 00	 push	 OFFSET ??_C@_0CF@PBECJIMH@error?9L1?5?3?5CloseClient?5connect?5e@
  023f6	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  023fc	83 c4 04	 add	 esp, 4

; 1410 : 		return;

  023ff	e9 dd 00 00 00	 jmp	 $LN8@ResponErro
$LN5@ResponErro:

; 1411 : 	}
; 1412 : 
; 1413 : 	LPOBJ lpObj = &gObj[index];

  02404	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02407	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0240d	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02413	89 45 fc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1414 : 
; 1415 : #if(OFFLINE_MODE==TRUE)
; 1416 : 	if(lpObj->m_OfflineMode == true)

  02416	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02419	0f b6 88 d4 28
	00 00		 movzx	 ecx, BYTE PTR [eax+10452]
  02420	83 f9 01	 cmp	 ecx, 1
  02423	75 11		 jne	 SHORT $LN4@ResponErro

; 1417 : 	{
; 1418 : 		lpObj->CheckTick = GetTickCount();

  02425	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  0242b	8b 4d fc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0242e	89 41 40	 mov	 DWORD PTR [ecx+64], eax

; 1419 : 		return;

  02431	e9 ab 00 00 00	 jmp	 $LN8@ResponErro
$LN4@ResponErro:

; 1420 : 	}
; 1421 : #endif
; 1422 : 
; 1423 : 	//	OffExp
; 1424 : 	if(lpObj->OffExp == 1)

  02436	8b 45 fc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02439	83 b8 98 22 00
	00 01		 cmp	 DWORD PTR [eax+8856], 1
  02440	75 11		 jne	 SHORT $LN3@ResponErro

; 1425 : 	{
; 1426 : 		
; 1427 : 		lpObj->CheckTick = GetTickCount();

  02442	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  02448	8b 4d fc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0244b	89 41 40	 mov	 DWORD PTR [ecx+64], eax

; 1428 : 		return;

  0244e	e9 8e 00 00 00	 jmp	 $LN8@ResponErro
$LN3@ResponErro:

; 1429 : 	}
; 1430 : 
; 1431 : #ifdef _OFFTRADE_
; 1432 : 		if(gOffTrade.CheckOnlineUser(index))return;

  02453	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02456	50		 push	 eax
  02457	b9 00 00 00 00	 mov	 ecx, OFFSET ?gOffTrade@@3VcOffTrade@@A ; gOffTrade
  0245c	e8 00 00 00 00	 call	 ?CheckOnlineUser@cOffTrade@@QAE_NH@Z ; cOffTrade::CheckOnlineUser
  02461	0f b6 c8	 movzx	 ecx, al
  02464	85 c9		 test	 ecx, ecx
  02466	74 02		 je	 SHORT $LN2@ResponErro
  02468	eb 77		 jmp	 SHORT $LN8@ResponErro
$LN2@ResponErro:

; 1433 : #endif
; 1434 : 
; 1435 : 	EnterCriticalSection(&criti);

  0246a	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  0246f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 1436 : 	closesocket(gObj[index].m_socket);

  02475	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02478	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  0247e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02484	8b 54 01 14	 mov	 edx, DWORD PTR [ecx+eax+20]
  02488	52		 push	 edx
  02489	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__closesocket@4

; 1437 : 	gObj[index].m_socket = INVALID_SOCKET;

  0248f	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  02492	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02498	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0249e	c7 44 01 14 ff
	ff ff ff	 mov	 DWORD PTR [ecx+eax+20], -1

; 1438 : 
; 1439 : 	if ( gObj[index].m_socket == INVALID_SOCKET )

  024a6	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  024a9	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  024af	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  024b5	83 7c 01 14 ff	 cmp	 DWORD PTR [ecx+eax+20], -1
  024ba	75 0e		 jne	 SHORT $LN1@ResponErro

; 1440 : 	{
; 1441 : 		LogAdd("error-L1 : CloseClient INVALID_SOCKET");

  024bc	68 00 00 00 00	 push	 OFFSET ??_C@_0CG@EMNFJCMC@error?9L1?5?3?5CloseClient?5INVALID_S@
  024c1	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  024c7	83 c4 04	 add	 esp, 4
$LN1@ResponErro:

; 1442 : 	}
; 1443 : 
; 1444 : 	gObjDel(index);

  024ca	8b 45 08	 mov	 eax, DWORD PTR _index$[ebp]
  024cd	50		 push	 eax
  024ce	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel
  024d3	83 c4 04	 add	 esp, 4

; 1445 : 	LeaveCriticalSection(&criti);

  024d6	68 00 00 00 00	 push	 OFFSET ?criti@@3U_RTL_CRITICAL_SECTION@@A ; criti
  024db	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4
$LN8@ResponErro:

; 1446 : }

  024e1	5f		 pop	 edi
  024e2	5e		 pop	 esi
  024e3	5b		 pop	 ebx
  024e4	8b e5		 mov	 esp, ebp
  024e6	5d		 pop	 ebp
  024e7	c3		 ret	 0
?ResponErrorCloseClient@@YAXH@Z ENDP			; ResponErrorCloseClient
_TEXT	ENDS
END
