; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

	TITLE	D:\Projects\ExTeam6.3\Source\GameServer\GameServer\ItemBagEx.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

_DATA	SEGMENT
_g_iNpcUpDfLevel_CGATE DD 01H
	DD	02H
	DD	02dc6c0H
	DD	02H
	DD	03H
	DD	02dc6c0H
	DD	03H
	DD	04H
	DD	02dc6c0H
_g_iNpcUpDfLevel_CSTATUE DD 01H
	DD	03H
	DD	02dc6c0H
	DD	02H
	DD	05H
	DD	02dc6c0H
	DD	03H
	DD	07H
	DD	02dc6c0H
_g_iNpcUpMaxHP_CGATE DD 02625a0H
	DD	02H
	DD	0f4240H
	DD	03567e0H
	DD	03H
	DD	0f4240H
	DD	04f5880H
	DD	04H
	DD	0f4240H
_g_iNpcUpMaxHP_CSTATUE DD 02191c0H
	DD	03H
	DD	0f4240H
	DD	033e140H
	DD	05H
	DD	0f4240H
	DD	04c4b40H
	DD	07H
	DD	0f4240H
_g_iNpcUpRgLevel_CSTATUE DD 01H
	DD	03H
	DD	04c4b40H
	DD	02H
	DD	05H
	DD	04c4b40H
	DD	03H
	DD	07H
	DD	04c4b40H
_g_iCsUserReSpawnArea DD 023H
	DD	011H
	DD	090H
	DD	030H
	DD	04aH
	DD	090H
	DD	073H
	DD	09aH
	DD	023H
	DD	011H
	DD	090H
	DD	030H
_g_iNpcDefense_CGATE DD 064H
	DD	0b4H
	DD	012cH
	DD	0208H
_g_iNpcDefense_CSTATUE DD 050H
	DD	0b4H
	DD	0154H
	DD	0226H
_g_iCastleWallStepAxisY DD 071H
	DD	0a0H
	DD	0cbH
_DATA	ENDS
PUBLIC	??_H@YGXPAXIHP6EPAX0@Z@Z			; `vector constructor iterator'
; Function compile flags: /Odtp /ZI
;	COMDAT ??_H@YGXPAXIHP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIHP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
$LN2@vector:
  00009	8b 45 10	 mov	 eax, DWORD PTR ___n$[ebp]
  0000c	83 e8 01	 sub	 eax, 1
  0000f	89 45 10	 mov	 DWORD PTR ___n$[ebp], eax
  00012	78 11		 js	 SHORT $LN3@vector
  00014	8b 4d 08	 mov	 ecx, DWORD PTR ___t$[ebp]
  00017	ff 55 14	 call	 DWORD PTR ___f$[ebp]
  0001a	8b 45 08	 mov	 eax, DWORD PTR ___t$[ebp]
  0001d	03 45 0c	 add	 eax, DWORD PTR ___s$[ebp]
  00020	89 45 08	 mov	 DWORD PTR ___t$[ebp], eax
  00023	eb e4		 jmp	 SHORT $LN2@vector
$LN3@vector:
  00025	5f		 pop	 edi
  00026	5e		 pop	 esi
  00027	5b		 pop	 ebx
  00028	8b e5		 mov	 esp, ebp
  0002a	5d		 pop	 ebp
  0002b	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIHP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
PUBLIC	??0CItemBagAttrEx@@QAE@XZ			; CItemBagAttrEx::CItemBagAttrEx
PUBLIC	??0CItemBagDropMapInfo@@QAE@XZ			; CItemBagDropMapInfo::CItemBagDropMapInfo
PUBLIC	??_7CItemBagEx@@6B@				; CItemBagEx::`vftable'
PUBLIC	??0CItemBagEx@@QAE@XZ				; CItemBagEx::CItemBagEx
PUBLIC	??_R4CItemBagEx@@6B@				; CItemBagEx::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCItemBagEx@@@8				; CItemBagEx `RTTI Type Descriptor'
PUBLIC	??_R3CItemBagEx@@8				; CItemBagEx::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CItemBagEx@@8				; CItemBagEx::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CItemBagEx@@8			; CItemBagEx::`RTTI Base Class Descriptor at (0,-1,0,64)'
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	??_ECItemBagEx@@UAEPAXI@Z:PROC			; CItemBagEx::`vector deleting destructor'
;	COMDAT ??_R1A@?0A@EA@CItemBagEx@@8
; File d:\projects\exteam6.3\source\gameserver\gameserver\itembagex.cpp
rdata$r	SEGMENT
??_R1A@?0A@EA@CItemBagEx@@8 DD FLAT:??_R0?AVCItemBagEx@@@8 ; CItemBagEx::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CItemBagEx@@8
rdata$r	ENDS
;	COMDAT ??_R2CItemBagEx@@8
rdata$r	SEGMENT
??_R2CItemBagEx@@8 DD FLAT:??_R1A@?0A@EA@CItemBagEx@@8	; CItemBagEx::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CItemBagEx@@8
rdata$r	SEGMENT
??_R3CItemBagEx@@8 DD 00H				; CItemBagEx::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CItemBagEx@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCItemBagEx@@@8
_DATA	SEGMENT
??_R0?AVCItemBagEx@@@8 DD FLAT:??_7type_info@@6B@	; CItemBagEx `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCItemBagEx@@', 00H
_DATA	ENDS
;	COMDAT ??_R4CItemBagEx@@6B@
rdata$r	SEGMENT
??_R4CItemBagEx@@6B@ DD 00H				; CItemBagEx::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCItemBagEx@@@8
	DD	FLAT:??_R3CItemBagEx@@8
rdata$r	ENDS
;	COMDAT ??_7CItemBagEx@@6B@
CONST	SEGMENT
??_7CItemBagEx@@6B@ DD FLAT:??_R4CItemBagEx@@6B@	; CItemBagEx::`vftable'
	DD	FLAT:??_ECItemBagEx@@UAEPAXI@Z
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0CItemBagEx@@QAE@XZ PROC				; CItemBagEx::CItemBagEx
; _this$ = ecx

; 13   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CItemBagEx@@6B@
  00015	68 00 00 00 00	 push	 OFFSET ??0CItemBagDropMapInfo@@QAE@XZ ; CItemBagDropMapInfo::CItemBagDropMapInfo
  0001a	6a 5a		 push	 90			; 0000005aH
  0001c	6a 03		 push	 3
  0001e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00021	05 24 01 00 00	 add	 eax, 292		; 00000124H
  00026	50		 push	 eax
  00027	e8 00 00 00 00	 call	 ??_H@YGXPAXIHP6EPAX0@Z@Z
  0002c	68 00 00 00 00	 push	 OFFSET ??0CItemBagAttrEx@@QAE@XZ ; CItemBagAttrEx::CItemBagAttrEx
  00031	68 96 00 00 00	 push	 150			; 00000096H
  00036	6a 08		 push	 8
  00038	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0003b	05 32 02 00 00	 add	 eax, 562		; 00000232H
  00040	50		 push	 eax
  00041	e8 00 00 00 00	 call	 ??_H@YGXPAXIHP6EPAX0@Z@Z

; 14   : 	return;
; 15   : }

  00046	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00049	5f		 pop	 edi
  0004a	5e		 pop	 esi
  0004b	5b		 pop	 ebx
  0004c	8b e5		 mov	 esp, ebp
  0004e	5d		 pop	 ebp
  0004f	c3		 ret	 0
??0CItemBagEx@@QAE@XZ ENDP				; CItemBagEx::CItemBagEx
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\gamblesystem.h
_TEXT	ENDS
;	COMDAT ??0CItemBagAttrEx@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0CItemBagAttrEx@@QAE@XZ PROC				; CItemBagAttrEx::CItemBagAttrEx, COMDAT
; _this$ = ecx

; 23   : 	CItemBagAttrEx()

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 24   : 	{
; 25   : 		this->m_type = 0;

  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	c6 00 00	 mov	 BYTE PTR [eax], 0

; 26   : 		this->m_index = 0;

  00012	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00015	c6 40 01 00	 mov	 BYTE PTR [eax+1], 0

; 27   : 		this->m_minLevel = 0;

  00019	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001c	c6 40 02 00	 mov	 BYTE PTR [eax+2], 0

; 28   : 		this->m_maxLevel = 0;

  00020	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00023	c6 40 03 00	 mov	 BYTE PTR [eax+3], 0

; 29   : 		this->m_isskill = 0;

  00027	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002a	c6 40 04 00	 mov	 BYTE PTR [eax+4], 0

; 30   : 		this->m_isluck = 0;

  0002e	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00031	c6 40 05 00	 mov	 BYTE PTR [eax+5], 0

; 31   : 		this->m_isoption = 0;

  00035	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00038	c6 40 06 00	 mov	 BYTE PTR [eax+6], 0

; 32   : 		this->m_isexitem = 0;

  0003c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0003f	c6 40 07 00	 mov	 BYTE PTR [eax+7], 0

; 33   : 	}

  00043	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00046	5f		 pop	 edi
  00047	5e		 pop	 esi
  00048	5b		 pop	 ebx
  00049	8b e5		 mov	 esp, ebp
  0004b	5d		 pop	 ebp
  0004c	c3		 ret	 0
??0CItemBagAttrEx@@QAE@XZ ENDP				; CItemBagAttrEx::CItemBagAttrEx
_TEXT	ENDS
PUBLIC	?Init@CItemBagDropMapInfo@@QAEXXZ		; CItemBagDropMapInfo::Init
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\itembagex.h
;	COMDAT ??0CItemBagDropMapInfo@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??0CItemBagDropMapInfo@@QAE@XZ PROC			; CItemBagDropMapInfo::CItemBagDropMapInfo, COMDAT
; _this$ = ecx

; 19   : 	CItemBagDropMapInfo()

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 20   : 	{
; 21   : 		this->Init();

  0000c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000f	e8 00 00 00 00	 call	 ?Init@CItemBagDropMapInfo@@QAEXXZ ; CItemBagDropMapInfo::Init

; 22   : 	};

  00014	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00017	5f		 pop	 edi
  00018	5e		 pop	 esi
  00019	5b		 pop	 ebx
  0001a	8b e5		 mov	 esp, ebp
  0001c	5d		 pop	 ebp
  0001d	c3		 ret	 0
??0CItemBagDropMapInfo@@QAE@XZ ENDP			; CItemBagDropMapInfo::CItemBagDropMapInfo
; Function compile flags: /Odtp /ZI
_TEXT	ENDS
;	COMDAT ?Init@CItemBagDropMapInfo@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?Init@CItemBagDropMapInfo@@QAEXXZ PROC			; CItemBagDropMapInfo::Init, COMDAT
; _this$ = ecx

; 25   : 	{

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 26   : 		this->m_bIsDrop = false;

  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	c6 00 00	 mov	 BYTE PTR [eax], 0

; 27   : 		this->m_MinMonsterLevel = 0;

  00012	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00015	c6 40 01 00	 mov	 BYTE PTR [eax+1], 0

; 28   : 		this->m_MaxMonsterLevel = 0;

  00019	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001c	c6 40 02 00	 mov	 BYTE PTR [eax+2], 0

; 29   : 	};

  00020	5f		 pop	 edi
  00021	5e		 pop	 esi
  00022	5b		 pop	 ebx
  00023	8b e5		 mov	 esp, ebp
  00025	5d		 pop	 ebp
  00026	c3		 ret	 0
?Init@CItemBagDropMapInfo@@QAEXXZ ENDP			; CItemBagDropMapInfo::Init
_TEXT	ENDS
PUBLIC	??1CItemBagEx@@UAE@XZ				; CItemBagEx::~CItemBagEx
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
; Function compile flags: /Odtp /ZI
;	COMDAT ??_GCItemBagEx@@UAEPAXI@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
___flags$ = 8						; size = 4
??_GCItemBagEx@@UAEPAXI@Z PROC				; CItemBagEx::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0000f	e8 00 00 00 00	 call	 ??1CItemBagEx@@UAE@XZ	; CItemBagEx::~CItemBagEx
  00014	8b 45 08	 mov	 eax, DWORD PTR ___flags$[ebp]
  00017	83 e0 01	 and	 eax, 1
  0001a	74 0c		 je	 SHORT $LN1@scalar
  0001c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0001f	50		 push	 eax
  00020	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00025	83 c4 04	 add	 esp, 4
$LN1@scalar:
  00028	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0002b	5f		 pop	 edi
  0002c	5e		 pop	 esi
  0002d	5b		 pop	 ebx
  0002e	8b e5		 mov	 esp, ebp
  00030	5d		 pop	 ebp
  00031	c2 04 00	 ret	 4
??_GCItemBagEx@@UAEPAXI@Z ENDP				; CItemBagEx::`scalar deleting destructor'
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\itembagex.cpp
_TEXT	ENDS
_TEXT	SEGMENT
_this$ = -4						; size = 4
??1CItemBagEx@@UAE@XZ PROC				; CItemBagEx::~CItemBagEx
; _this$ = ecx

; 18   : {

  00050	55		 push	 ebp
  00051	8b ec		 mov	 ebp, esp
  00053	83 ec 44	 sub	 esp, 68			; 00000044H
  00056	53		 push	 ebx
  00057	56		 push	 esi
  00058	57		 push	 edi
  00059	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0005c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0005f	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], OFFSET ??_7CItemBagEx@@6B@

; 19   : 	return;
; 20   : }

  00065	5f		 pop	 edi
  00066	5e		 pop	 esi
  00067	5b		 pop	 ebx
  00068	8b e5		 mov	 esp, ebp
  0006a	5d		 pop	 ebp
  0006b	c3		 ret	 0
??1CItemBagEx@@UAE@XZ ENDP				; CItemBagEx::~CItemBagEx
_TEXT	ENDS
PUBLIC	?LoadItem@CItemBagEx@@QAEXPAD@Z			; CItemBagEx::LoadItem
PUBLIC	?Init@CItemBagEx@@QAEXPAD@Z			; CItemBagEx::Init
EXTRN	?GetNewPath@CDirPath@@QAEPADPAD@Z:PROC		; CDirPath::GetNewPath
EXTRN	?gDirPath@@3VCDirPath@@A:BYTE			; gDirPath
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
_this$ = -4						; size = 4
_name$ = 8						; size = 4
?Init@CItemBagEx@@QAEXPAD@Z PROC			; CItemBagEx::Init
; _this$ = ecx

; 23   : {

  00070	55		 push	 ebp
  00071	8b ec		 mov	 ebp, esp
  00073	83 ec 44	 sub	 esp, 68			; 00000044H
  00076	53		 push	 ebx
  00077	56		 push	 esi
  00078	57		 push	 edi
  00079	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 24   : 	this->m_bLoad = FALSE;

  0007c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0007f	c7 40 04 00 00
	00 00		 mov	 DWORD PTR [eax+4], 0

; 25   : 	this->m_sEventName[0] = 0;

  00086	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00089	c6 40 08 00	 mov	 BYTE PTR [eax+8], 0

; 26   : 	this->m_iEventItemType = -1;

  0008d	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00090	c7 80 08 01 00
	00 ff ff ff ff	 mov	 DWORD PTR [eax+264], -1

; 27   : 	this->m_iEventItemLevel = 0;

  0009a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0009d	c7 80 0c 01 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+268], 0

; 28   : 	this->m_iDropZen = 0;

  000a7	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000aa	c7 80 10 01 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+272], 0

; 29   : 	this->m_iEventItemDropRate = 0;

  000b4	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000b7	c7 80 14 01 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+276], 0

; 30   : 	this->m_iItemDropRate = 0;

  000c1	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000c4	c7 80 18 01 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+280], 0

; 31   : 	this->m_iExItemDropRate = 0;

  000ce	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000d1	c7 80 1c 01 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+284], 0

; 32   : 	this->m_iBagObjectCount = 0;

  000db	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  000de	c7 80 20 01 00
	00 00 00 00 00	 mov	 DWORD PTR [eax+288], 0

; 33   : 
; 34   : 	this->LoadItem(gDirPath.GetNewPath(name));

  000e8	8b 45 08	 mov	 eax, DWORD PTR _name$[ebp]
  000eb	50		 push	 eax
  000ec	b9 00 00 00 00	 mov	 ecx, OFFSET ?gDirPath@@3VCDirPath@@A ; gDirPath
  000f1	e8 00 00 00 00	 call	 ?GetNewPath@CDirPath@@QAEPADPAD@Z ; CDirPath::GetNewPath
  000f6	50		 push	 eax
  000f7	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  000fa	e8 00 00 00 00	 call	 ?LoadItem@CItemBagEx@@QAEXPAD@Z ; CItemBagEx::LoadItem

; 35   : }

  000ff	5f		 pop	 edi
  00100	5e		 pop	 esi
  00101	5b		 pop	 ebx
  00102	8b e5		 mov	 esp, ebp
  00104	5d		 pop	 ebp
  00105	c2 04 00	 ret	 4
?Init@CItemBagEx@@QAEXPAD@Z ENDP			; CItemBagEx::Init
_TEXT	ENDS
PUBLIC	??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@ ; `string'
PUBLIC	??_C@_0BO@PPHECIOP@ExEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@ ; `string'
PUBLIC	??_C@_03JBJLGPFL@end?$AA@			; `string'
PUBLIC	??_C@_01KDCPPGHE@r?$AA@				; `string'
PUBLIC	__$ArrayPad$
EXTRN	_fclose:PROC
EXTRN	?LogAddTD@@3P6AXPADZZA:DWORD			; LogAddTD
EXTRN	__imp__wsprintfA:PROC
EXTRN	_strcpy:PROC
EXTRN	?MsgBox@@YAXPADZZ:PROC				; MsgBox
EXTRN	_strcmp:PROC
EXTRN	?LogAdd@@3P6AXPADZZA:DWORD			; LogAdd
EXTRN	?Get@CMsg@@QAEPADH@Z:PROC			; CMsg::Get
EXTRN	?lMsg@@3VCMsg@@A:BYTE				; lMsg
EXTRN	_fopen:PROC
EXTRN	___security_cookie:DWORD
EXTRN	@__security_check_cookie@4:PROC
EXTRN	__ftol2_sse:PROC
_BSS	SEGMENT
_TokenString DB	064H DUP (?)
_TokenNumber DD	01H DUP (?)
_SMDFile DD	01H DUP (?)
_BSS	ENDS
;	COMDAT ??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@
CONST	SEGMENT
??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@ DB '['
	DB	'%s] Eventitemnum = %d,EventItemLevel = %d, EventItemDropRate '
	DB	'= %d, ItemDropRate = %d, ExItemDropRate = %d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BO@PPHECIOP@ExEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@
CONST	SEGMENT
??_C@_0BO@PPHECIOP@ExEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@ DB 'ExE'
	DB	'vent ItemBag LoadFail [%s]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_03JBJLGPFL@end?$AA@
CONST	SEGMENT
??_C@_03JBJLGPFL@end?$AA@ DB 'end', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_01KDCPPGHE@r?$AA@
CONST	SEGMENT
??_C@_01KDCPPGHE@r?$AA@ DB 'r', 00H			; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv469 = -364						; size = 4
tv458 = -364						; size = 4
tv447 = -364						; size = 4
tv436 = -364						; size = 4
tv425 = -364						; size = 4
tv414 = -364						; size = 4
tv403 = -364						; size = 4
tv392 = -364						; size = 4
tv313 = -364						; size = 4
tv302 = -364						; size = 4
tv291 = -364						; size = 4
tv467 = -360						; size = 4
tv456 = -360						; size = 4
tv445 = -360						; size = 4
tv434 = -360						; size = 4
tv423 = -360						; size = 4
tv412 = -360						; size = 4
tv401 = -360						; size = 4
tv390 = -360						; size = 4
tv311 = -360						; size = 4
tv300 = -360						; size = 4
tv289 = -360						; size = 4
tv91 = -356						; size = 4
tv464 = -354						; size = 2
tv453 = -354						; size = 2
tv442 = -354						; size = 2
tv431 = -354						; size = 2
tv420 = -354						; size = 2
tv409 = -354						; size = 2
tv398 = -354						; size = 2
tv387 = -354						; size = 2
tv308 = -354						; size = 2
tv297 = -354						; size = 2
tv286 = -354						; size = 2
_szTemp$228107 = -288					; size = 256
_index$228101 = -32					; size = 4
_type$228099 = -28					; size = 4
_map$228084 = -24					; size = 4
_st$228075 = -20					; size = 4
_n$ = -16						; size = 4
_Token$ = -12						; size = 4
_this$ = -8						; size = 4
__$ArrayPad$ = -4					; size = 4
_script_file$ = 8					; size = 4
?LoadItem@CItemBagEx@@QAEXPAD@Z PROC			; CItemBagEx::LoadItem
; _this$ = ecx

; 38   : {

  00110	55		 push	 ebp
  00111	8b ec		 mov	 ebp, esp
  00113	81 ec 6c 01 00
	00		 sub	 esp, 364		; 0000016cH
  00119	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0011e	33 c5		 xor	 eax, ebp
  00120	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00123	53		 push	 ebx
  00124	56		 push	 esi
  00125	57		 push	 edi
  00126	89 4d f8	 mov	 DWORD PTR _this$[ebp], ecx

; 39   : 	int Token;
; 40   : 
; 41   : 	this->m_bLoad = FALSE;

  00129	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0012c	c7 40 04 00 00
	00 00		 mov	 DWORD PTR [eax+4], 0

; 42   : 	SMDFile = fopen(script_file, "r");

  00133	68 00 00 00 00	 push	 OFFSET ??_C@_01KDCPPGHE@r?$AA@
  00138	8b 45 08	 mov	 eax, DWORD PTR _script_file$[ebp]
  0013b	50		 push	 eax
  0013c	e8 00 00 00 00	 call	 _fopen
  00141	83 c4 08	 add	 esp, 8
  00144	a3 00 00 00 00	 mov	 DWORD PTR _SMDFile, eax

; 43   : 
; 44   : 	if ( SMDFile == NULL )

  00149	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR _SMDFile, 0
  00150	75 22		 jne	 SHORT $LN24@LoadItem

; 45   : 	{
; 46   : 		LogAdd(lMsg.Get(MSGGET(1, 197)), script_file);

  00152	8b 45 08	 mov	 eax, DWORD PTR _script_file$[ebp]
  00155	50		 push	 eax
  00156	68 c5 01 00 00	 push	 453			; 000001c5H
  0015b	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  00160	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  00165	50		 push	 eax
  00166	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  0016c	83 c4 08	 add	 esp, 8

; 47   : 		return;

  0016f	e9 45 06 00 00	 jmp	 $LN25@LoadItem
$LN24@LoadItem:

; 48   : 	}
; 49   : 
; 50   : 	int n=0;

  00174	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _n$[ebp], 0
$LN23@LoadItem:

; 51   : 
; 52   : 	while ( true )

  0017b	b8 01 00 00 00	 mov	 eax, 1
  00180	85 c0		 test	 eax, eax
  00182	0f 84 fc 05 00
	00		 je	 $LN22@LoadItem

; 53   : 	{
; 54   : 		Token = GetToken();

  00188	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  0018d	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 55   : 
; 56   : 		if ( Token == 2 )

  00190	83 7d f4 02	 cmp	 DWORD PTR _Token$[ebp], 2
  00194	75 05		 jne	 SHORT $LN21@LoadItem

; 57   : 		{
; 58   : 			break;

  00196	e9 e9 05 00 00	 jmp	 $LN22@LoadItem
$LN21@LoadItem:

; 59   : 		}
; 60   : 
; 61   : 		if ( Token == 1 )

  0019b	83 7d f4 01	 cmp	 DWORD PTR _Token$[ebp], 1
  0019f	0f 85 da 05 00
	00		 jne	 $LN4@LoadItem

; 62   : 		{
; 63   : 			int st = (int)TokenNumber;	// script_type

  001a5	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  001ab	e8 00 00 00 00	 call	 __ftol2_sse
  001b0	89 45 ec	 mov	 DWORD PTR _st$228075[ebp], eax

; 64   : 
; 65   : 			if ( st == 0 )

  001b3	83 7d ec 00	 cmp	 DWORD PTR _st$228075[ebp], 0
  001b7	0f 85 78 01 00
	00		 jne	 $LN19@LoadItem
$LN18@LoadItem:

; 66   : 			{
; 67   : 				while ( true )

  001bd	b8 01 00 00 00	 mov	 eax, 1
  001c2	85 c0		 test	 eax, eax
  001c4	0f 84 66 01 00
	00		 je	 $LN17@LoadItem

; 68   : 				{
; 69   : 					Token = GetToken();

  001ca	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  001cf	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 70   : 
; 71   : 					if ( Token == 0 )

  001d2	83 7d f4 00	 cmp	 DWORD PTR _Token$[ebp], 0
  001d6	75 1b		 jne	 SHORT $LN15@LoadItem

; 72   : 					{
; 73   : 						if ( strcmp("end", TokenString) == 0 )

  001d8	68 00 00 00 00	 push	 OFFSET _TokenString
  001dd	68 00 00 00 00	 push	 OFFSET ??_C@_03JBJLGPFL@end?$AA@
  001e2	e8 00 00 00 00	 call	 _strcmp
  001e7	83 c4 08	 add	 esp, 8
  001ea	85 c0		 test	 eax, eax
  001ec	75 05		 jne	 SHORT $LN15@LoadItem

; 74   : 						{
; 75   : 							break;

  001ee	e9 3d 01 00 00	 jmp	 $LN17@LoadItem
$LN15@LoadItem:

; 76   : 						}
; 77   : 					}
; 78   : 
; 79   : 					int map = (int)TokenNumber;

  001f3	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  001f9	e8 00 00 00 00	 call	 __ftol2_sse
  001fe	89 45 e8	 mov	 DWORD PTR _map$228084[ebp], eax

; 80   : 
; 81   : 					if ( MAX_MAP_RANGE(map) == FALSE )

  00201	83 7d e8 00	 cmp	 DWORD PTR _map$228084[ebp], 0
  00205	7d 0c		 jge	 SHORT $LN27@LoadItem
  00207	c7 85 9c fe ff
	ff 00 00 00 00	 mov	 DWORD PTR tv91[ebp], 0
  00211	eb 0f		 jmp	 SHORT $LN28@LoadItem
$LN27@LoadItem:
  00213	33 c0		 xor	 eax, eax
  00215	83 7d e8 59	 cmp	 DWORD PTR _map$228084[ebp], 89 ; 00000059H
  00219	0f 9e c0	 setle	 al
  0021c	89 85 9c fe ff
	ff		 mov	 DWORD PTR tv91[ebp], eax
$LN28@LoadItem:
  00222	83 bd 9c fe ff
	ff 00		 cmp	 DWORD PTR tv91[ebp], 0
  00229	75 16		 jne	 SHORT $LN14@LoadItem

; 82   : 					{
; 83   : 						MsgBox("ExEvent ItemBag LoadFail [%s]", script_file);

  0022b	8b 45 08	 mov	 eax, DWORD PTR _script_file$[ebp]
  0022e	50		 push	 eax
  0022f	68 00 00 00 00	 push	 OFFSET ??_C@_0BO@PPHECIOP@ExEvent?5ItemBag?5LoadFail?5?$FL?$CFs?$FN?$AA@
  00234	e8 00 00 00 00	 call	 ?MsgBox@@YAXPADZZ	; MsgBox
  00239	83 c4 08	 add	 esp, 8

; 84   : 						return;

  0023c	e9 78 05 00 00	 jmp	 $LN25@LoadItem
$LN14@LoadItem:

; 85   : 					}
; 86   : 
; 87   : 					Token = GetToken();

  00241	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00246	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 88   : 					this->DropMapInfo[map].m_bIsDrop = (BYTE)TokenNumber;

  00249	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0024f	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv286[ebp]
  00255	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv286[ebp]
  0025c	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00261	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv289[ebp], eax
  00267	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv289[ebp]
  0026d	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv291[ebp]
  00273	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv286[ebp]
  00279	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv291[ebp]
  0027f	8b 4d e8	 mov	 ecx, DWORD PTR _map$228084[ebp]
  00282	6b c9 03	 imul	 ecx, 3
  00285	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00288	88 84 0a 24 01
	00 00		 mov	 BYTE PTR [edx+ecx+292], al

; 89   : 
; 90   : 					Token = GetToken();

  0028f	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00294	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 91   : 					this->DropMapInfo[map].m_MinMonsterLevel = (BYTE)TokenNumber;

  00297	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0029d	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv297[ebp]
  002a3	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv297[ebp]
  002aa	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  002af	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv300[ebp], eax
  002b5	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv300[ebp]
  002bb	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv302[ebp]
  002c1	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv297[ebp]
  002c7	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv302[ebp]
  002cd	8b 4d e8	 mov	 ecx, DWORD PTR _map$228084[ebp]
  002d0	6b c9 03	 imul	 ecx, 3
  002d3	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  002d6	88 84 0a 25 01
	00 00		 mov	 BYTE PTR [edx+ecx+293], al

; 92   : 
; 93   : 					Token = GetToken();

  002dd	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  002e2	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 94   : 					this->DropMapInfo[map].m_MaxMonsterLevel = (BYTE)TokenNumber;

  002e5	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  002eb	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv308[ebp]
  002f1	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv308[ebp]
  002f8	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  002fd	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv311[ebp], eax
  00303	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv311[ebp]
  00309	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv313[ebp]
  0030f	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv308[ebp]
  00315	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv313[ebp]
  0031b	8b 4d e8	 mov	 ecx, DWORD PTR _map$228084[ebp]
  0031e	6b c9 03	 imul	 ecx, 3
  00321	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00324	88 84 0a 26 01
	00 00		 mov	 BYTE PTR [edx+ecx+294], al

; 95   : 				}

  0032b	e9 8d fe ff ff	 jmp	 $LN18@LoadItem
$LN17@LoadItem:

; 96   : 			
; 97   : 			}
; 98   : 			else if ( st == 1 )

  00330	e9 4a 04 00 00	 jmp	 $LN4@LoadItem
$LN19@LoadItem:
  00335	83 7d ec 01	 cmp	 DWORD PTR _st$228075[ebp], 1
  00339	0f 85 7c 01 00
	00		 jne	 $LN12@LoadItem
$LN11@LoadItem:

; 99   : 			{
; 100  : 				while ( true )

  0033f	b8 01 00 00 00	 mov	 eax, 1
  00344	85 c0		 test	 eax, eax
  00346	0f 84 6a 01 00
	00		 je	 $LN10@LoadItem

; 101  : 				{
; 102  : 					Token = GetToken();

  0034c	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00351	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 103  : 
; 104  : 					if ( Token == 0 )

  00354	83 7d f4 00	 cmp	 DWORD PTR _Token$[ebp], 0
  00358	75 1b		 jne	 SHORT $LN8@LoadItem

; 105  : 					{
; 106  : 						if ( strcmp("end", TokenString) == 0 )

  0035a	68 00 00 00 00	 push	 OFFSET _TokenString
  0035f	68 00 00 00 00	 push	 OFFSET ??_C@_03JBJLGPFL@end?$AA@
  00364	e8 00 00 00 00	 call	 _strcmp
  00369	83 c4 08	 add	 esp, 8
  0036c	85 c0		 test	 eax, eax
  0036e	75 05		 jne	 SHORT $LN8@LoadItem

; 107  : 						{
; 108  : 							break;

  00370	e9 41 01 00 00	 jmp	 $LN10@LoadItem
$LN8@LoadItem:

; 109  : 						}
; 110  : 					}
; 111  : 
; 112  : 					strcpy(this->m_sEventName, TokenString);

  00375	68 00 00 00 00	 push	 OFFSET _TokenString
  0037a	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0037d	83 c0 08	 add	 eax, 8
  00380	50		 push	 eax
  00381	e8 00 00 00 00	 call	 _strcpy
  00386	83 c4 08	 add	 esp, 8

; 113  : 
; 114  : 					Token = GetToken();

  00389	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  0038e	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 115  : 					this->m_iDropZen = (int)TokenNumber;

  00391	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00397	e8 00 00 00 00	 call	 __ftol2_sse
  0039c	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0039f	89 81 10 01 00
	00		 mov	 DWORD PTR [ecx+272], eax

; 116  : 
; 117  : 					Token = GetToken();

  003a5	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  003aa	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 118  : 					int type = (int)TokenNumber;

  003ad	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  003b3	e8 00 00 00 00	 call	 __ftol2_sse
  003b8	89 45 e4	 mov	 DWORD PTR _type$228099[ebp], eax

; 119  : 
; 120  : 					Token = GetToken();

  003bb	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  003c0	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 121  : 					int index = (int)TokenNumber;

  003c3	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  003c9	e8 00 00 00 00	 call	 __ftol2_sse
  003ce	89 45 e0	 mov	 DWORD PTR _index$228101[ebp], eax

; 122  : 
; 123  : 					this->m_iEventItemType = ITEMGET(type, index);

  003d1	8b 45 e4	 mov	 eax, DWORD PTR _type$228099[ebp]
  003d4	c1 e0 09	 shl	 eax, 9
  003d7	03 45 e0	 add	 eax, DWORD PTR _index$228101[ebp]
  003da	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  003dd	89 81 08 01 00
	00		 mov	 DWORD PTR [ecx+264], eax

; 124  : 
; 125  : 					Token = GetToken();

  003e3	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  003e8	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 126  : 					this->m_iEventItemLevel = (int)TokenNumber;

  003eb	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  003f1	e8 00 00 00 00	 call	 __ftol2_sse
  003f6	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  003f9	89 81 0c 01 00
	00		 mov	 DWORD PTR [ecx+268], eax

; 127  : 
; 128  : 					Token = GetToken();

  003ff	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00404	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 129  : 					this->m_iEventItemDropRate = (int)TokenNumber;

  00407	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0040d	e8 00 00 00 00	 call	 __ftol2_sse
  00412	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00415	89 81 14 01 00
	00		 mov	 DWORD PTR [ecx+276], eax

; 130  : 
; 131  : 					Token = GetToken();

  0041b	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00420	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 132  : 					this->m_iItemDropRate = (int)TokenNumber;

  00423	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00429	e8 00 00 00 00	 call	 __ftol2_sse
  0042e	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00431	89 81 18 01 00
	00		 mov	 DWORD PTR [ecx+280], eax

; 133  : 
; 134  : 					Token = GetToken();

  00437	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  0043c	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 135  : 					this->m_iExItemDropRate = (int)TokenNumber;

  0043f	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00445	e8 00 00 00 00	 call	 __ftol2_sse
  0044a	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0044d	89 81 1c 01 00
	00		 mov	 DWORD PTR [ecx+284], eax

; 136  : 
; 137  : 					char szTemp[256];
; 138  : 
; 139  : 					wsprintf(szTemp, "[%s] Eventitemnum = %d,EventItemLevel = %d, EventItemDropRate = %d, ItemDropRate = %d, ExItemDropRate = %d",
; 140  : 						this->m_sEventName, this->m_iEventItemType, this->m_iEventItemLevel, this->m_iEventItemDropRate, this->m_iItemDropRate, this->m_iExItemDropRate);

  00453	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00456	8b 88 1c 01 00
	00		 mov	 ecx, DWORD PTR [eax+284]
  0045c	51		 push	 ecx
  0045d	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00460	8b 82 18 01 00
	00		 mov	 eax, DWORD PTR [edx+280]
  00466	50		 push	 eax
  00467	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  0046a	8b 91 14 01 00
	00		 mov	 edx, DWORD PTR [ecx+276]
  00470	52		 push	 edx
  00471	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00474	8b 88 0c 01 00
	00		 mov	 ecx, DWORD PTR [eax+268]
  0047a	51		 push	 ecx
  0047b	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  0047e	8b 82 08 01 00
	00		 mov	 eax, DWORD PTR [edx+264]
  00484	50		 push	 eax
  00485	8b 4d f8	 mov	 ecx, DWORD PTR _this$[ebp]
  00488	83 c1 08	 add	 ecx, 8
  0048b	51		 push	 ecx
  0048c	68 00 00 00 00	 push	 OFFSET ??_C@_0GL@LIMNLNHJ@?$FL?$CFs?$FN?5Eventitemnum?5?$DN?5?$CFd?0EventItem@
  00491	8d 95 e0 fe ff
	ff		 lea	 edx, DWORD PTR _szTemp$228107[ebp]
  00497	52		 push	 edx
  00498	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wsprintfA
  0049e	83 c4 20	 add	 esp, 32			; 00000020H

; 141  : 					LogAddTD(szTemp);

  004a1	8d 85 e0 fe ff
	ff		 lea	 eax, DWORD PTR _szTemp$228107[ebp]
  004a7	50		 push	 eax
  004a8	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  004ae	83 c4 04	 add	 esp, 4

; 142  : 				}

  004b1	e9 89 fe ff ff	 jmp	 $LN11@LoadItem
$LN10@LoadItem:

; 143  : 			}
; 144  : 			else if ( st == 2 )

  004b6	e9 c4 02 00 00	 jmp	 $LN4@LoadItem
$LN12@LoadItem:
  004bb	83 7d ec 02	 cmp	 DWORD PTR _st$228075[ebp], 2
  004bf	0f 85 ba 02 00
	00		 jne	 $LN4@LoadItem
$LN5@LoadItem:

; 145  : 			{
; 146  : 				while ( true )

  004c5	b8 01 00 00 00	 mov	 eax, 1
  004ca	85 c0		 test	 eax, eax
  004cc	0f 84 ad 02 00
	00		 je	 $LN4@LoadItem

; 147  : 				{
; 148  : 					Token = GetToken();

  004d2	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  004d7	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 149  : 
; 150  : 					if ( Token == 0 )

  004da	83 7d f4 00	 cmp	 DWORD PTR _Token$[ebp], 0
  004de	75 1b		 jne	 SHORT $LN2@LoadItem

; 151  : 					{
; 152  : 						if ( strcmp("end", TokenString) == 0 )

  004e0	68 00 00 00 00	 push	 OFFSET _TokenString
  004e5	68 00 00 00 00	 push	 OFFSET ??_C@_03JBJLGPFL@end?$AA@
  004ea	e8 00 00 00 00	 call	 _strcmp
  004ef	83 c4 08	 add	 esp, 8
  004f2	85 c0		 test	 eax, eax
  004f4	75 05		 jne	 SHORT $LN2@LoadItem

; 153  : 						{
; 154  : 							break;

  004f6	e9 84 02 00 00	 jmp	 $LN4@LoadItem
$LN2@LoadItem:

; 155  : 						}
; 156  : 					}
; 157  : 
; 158  : 					this->BagObject[n].m_type = (BYTE)TokenNumber;

  004fb	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00501	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv387[ebp]
  00507	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv387[ebp]
  0050e	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00513	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv390[ebp], eax
  00519	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv390[ebp]
  0051f	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv392[ebp]
  00525	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv387[ebp]
  0052b	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv392[ebp]
  00531	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  00534	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00537	88 84 ca 32 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+562], al

; 159  : 
; 160  : 					Token = GetToken();

  0053e	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00543	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 161  : 					this->BagObject[n].m_index = (BYTE)TokenNumber;

  00546	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0054c	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv398[ebp]
  00552	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv398[ebp]
  00559	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  0055e	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv401[ebp], eax
  00564	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv401[ebp]
  0056a	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv403[ebp]
  00570	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv398[ebp]
  00576	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv403[ebp]
  0057c	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  0057f	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00582	88 84 ca 33 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+563], al

; 162  : 
; 163  : 					Token = GetToken();

  00589	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  0058e	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 164  : 					this->BagObject[n].m_minLevel = (BYTE)TokenNumber;

  00591	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00597	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv409[ebp]
  0059d	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv409[ebp]
  005a4	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  005a9	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv412[ebp], eax
  005af	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv412[ebp]
  005b5	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv414[ebp]
  005bb	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv409[ebp]
  005c1	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv414[ebp]
  005c7	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  005ca	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  005cd	88 84 ca 34 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+564], al

; 165  : 
; 166  : 					Token = GetToken();

  005d4	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  005d9	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 167  : 					this->BagObject[n].m_maxLevel = (BYTE)TokenNumber;

  005dc	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  005e2	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv420[ebp]
  005e8	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv420[ebp]
  005ef	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  005f4	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv423[ebp], eax
  005fa	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv423[ebp]
  00600	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv425[ebp]
  00606	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv420[ebp]
  0060c	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv425[ebp]
  00612	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  00615	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00618	88 84 ca 35 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+565], al

; 168  : 
; 169  : 					Token = GetToken();

  0061f	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00624	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 170  : 					this->BagObject[n].m_isskill = (BYTE)TokenNumber;

  00627	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0062d	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv431[ebp]
  00633	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv431[ebp]
  0063a	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  0063f	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv434[ebp], eax
  00645	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv434[ebp]
  0064b	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv436[ebp]
  00651	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv431[ebp]
  00657	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv436[ebp]
  0065d	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  00660	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00663	88 84 ca 36 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+566], al

; 171  : 
; 172  : 					Token = GetToken();

  0066a	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  0066f	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 173  : 					this->BagObject[n].m_isluck = (BYTE)TokenNumber;

  00672	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  00678	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv442[ebp]
  0067e	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv442[ebp]
  00685	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  0068a	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv445[ebp], eax
  00690	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv445[ebp]
  00696	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv447[ebp]
  0069c	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv442[ebp]
  006a2	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv447[ebp]
  006a8	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  006ab	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  006ae	88 84 ca 37 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+567], al

; 174  : 
; 175  : 					Token = GetToken();

  006b5	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  006ba	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 176  : 					this->BagObject[n].m_isoption = (BYTE)TokenNumber;

  006bd	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  006c3	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv453[ebp]
  006c9	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv453[ebp]
  006d0	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  006d5	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv456[ebp], eax
  006db	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv456[ebp]
  006e1	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv458[ebp]
  006e7	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv453[ebp]
  006ed	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv458[ebp]
  006f3	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  006f6	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  006f9	88 84 ca 38 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+568], al

; 177  : 
; 178  : 					Token = GetToken();

  00700	e8 00 00 00 00	 call	 ?GetToken@@YA?AW4SMDToken@@XZ ; GetToken
  00705	89 45 f4	 mov	 DWORD PTR _Token$[ebp], eax

; 179  : 					this->BagObject[n].m_isexitem = (BYTE)TokenNumber;

  00708	d9 05 00 00 00
	00		 fld	 DWORD PTR _TokenNumber
  0070e	d9 bd 9e fe ff
	ff		 fnstcw	 WORD PTR tv464[ebp]
  00714	0f b7 85 9e fe
	ff ff		 movzx	 eax, WORD PTR tv464[ebp]
  0071b	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00720	89 85 98 fe ff
	ff		 mov	 DWORD PTR tv467[ebp], eax
  00726	d9 ad 98 fe ff
	ff		 fldcw	 WORD PTR tv467[ebp]
  0072c	db 9d 94 fe ff
	ff		 fistp	 DWORD PTR tv469[ebp]
  00732	d9 ad 9e fe ff
	ff		 fldcw	 WORD PTR tv464[ebp]
  00738	8a 85 94 fe ff
	ff		 mov	 al, BYTE PTR tv469[ebp]
  0073e	8b 4d f0	 mov	 ecx, DWORD PTR _n$[ebp]
  00741	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00744	88 84 ca 39 02
	00 00		 mov	 BYTE PTR [edx+ecx*8+569], al

; 180  : 
; 181  : 					n++;

  0074b	8b 45 f0	 mov	 eax, DWORD PTR _n$[ebp]
  0074e	83 c0 01	 add	 eax, 1
  00751	89 45 f0	 mov	 DWORD PTR _n$[ebp], eax

; 182  : 					this->m_iBagObjectCount++;

  00754	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  00757	8b 88 20 01 00
	00		 mov	 ecx, DWORD PTR [eax+288]
  0075d	83 c1 01	 add	 ecx, 1
  00760	8b 55 f8	 mov	 edx, DWORD PTR _this$[ebp]
  00763	89 8a 20 01 00
	00		 mov	 DWORD PTR [edx+288], ecx

; 183  : 
; 184  : 					if ( this->m_iBagObjectCount > MAX_ITEMBAG_ATTR-1 )

  00769	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  0076c	81 b8 20 01 00
	00 95 00 00 00	 cmp	 DWORD PTR [eax+288], 149 ; 00000095H
  00776	7e 02		 jle	 SHORT $LN1@LoadItem

; 185  : 					{
; 186  : 						break;

  00778	eb 05		 jmp	 SHORT $LN4@LoadItem
$LN1@LoadItem:

; 187  : 					}
; 188  : 				}

  0077a	e9 46 fd ff ff	 jmp	 $LN5@LoadItem
$LN4@LoadItem:

; 189  : 			}
; 190  : 		}
; 191  : 	}

  0077f	e9 f7 f9 ff ff	 jmp	 $LN23@LoadItem
$LN22@LoadItem:

; 192  : 
; 193  : 	fclose(SMDFile);

  00784	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00789	50		 push	 eax
  0078a	e8 00 00 00 00	 call	 _fclose
  0078f	83 c4 04	 add	 esp, 4

; 194  : 	LogAdd(lMsg.Get(MSGGET(1, 198)), script_file);

  00792	8b 45 08	 mov	 eax, DWORD PTR _script_file$[ebp]
  00795	50		 push	 eax
  00796	68 c6 01 00 00	 push	 454			; 000001c6H
  0079b	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  007a0	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  007a5	50		 push	 eax
  007a6	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  007ac	83 c4 08	 add	 esp, 8

; 195  : 	this->m_bLoad = TRUE;

  007af	8b 45 f8	 mov	 eax, DWORD PTR _this$[ebp]
  007b2	c7 40 04 01 00
	00 00		 mov	 DWORD PTR [eax+4], 1
$LN25@LoadItem:

; 196  : }

  007b9	5f		 pop	 edi
  007ba	5e		 pop	 esi
  007bb	5b		 pop	 ebx
  007bc	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  007bf	33 cd		 xor	 ecx, ebp
  007c1	e8 00 00 00 00	 call	 @__security_check_cookie@4
  007c6	8b e5		 mov	 esp, ebp
  007c8	5d		 pop	 ebp
  007c9	c2 04 00	 ret	 4
?LoadItem@CItemBagEx@@QAEXPAD@Z ENDP			; CItemBagEx::LoadItem
_TEXT	ENDS
PUBLIC	__$ArrayPad$
EXTRN	_isalnum:PROC
EXTRN	_isalpha:PROC
EXTRN	_atof:PROC
EXTRN	_isdigit:PROC
EXTRN	_getc:PROC
EXTRN	_ungetc:PROC
EXTRN	_isspace:PROC
EXTRN	_fgetc:PROC
EXTRN	__fltused:DWORD
_BSS	SEGMENT
_CurrentToken DD 01H DUP (?)
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\include\readscript.h
_BSS	ENDS
_TEXT	SEGMENT
tv90 = -180						; size = 4
_TempString$ = -112					; size = 100
_p$ = -12						; size = 4
_ch$ = -5						; size = 1
__$ArrayPad$ = -4					; size = 4
?GetToken@@YA?AW4SMDToken@@XZ PROC			; GetToken

; 24   : {

  007d0	55		 push	 ebp
  007d1	8b ec		 mov	 ebp, esp
  007d3	81 ec b4 00 00
	00		 sub	 esp, 180		; 000000b4H
  007d9	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  007de	33 c5		 xor	 eax, ebp
  007e0	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  007e3	53		 push	 ebx
  007e4	56		 push	 esi
  007e5	57		 push	 edi

; 25   : 	char ch;
; 26   : 	char* p;
; 27   : 	char TempString[100];
; 28   : 
; 29   : 	TokenString[0]=0;

  007e6	c6 05 00 00 00
	00 00		 mov	 BYTE PTR _TokenString, 0
$LN31@GetToken:

; 30   : 
; 31   : 	do
; 32   : 	{
; 33   : 		if ((ch=fgetc(SMDFile)) == -1)

  007ed	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  007f2	50		 push	 eax
  007f3	e8 00 00 00 00	 call	 _fgetc
  007f8	83 c4 04	 add	 esp, 4
  007fb	88 45 fb	 mov	 BYTE PTR _ch$[ebp], al
  007fe	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00802	83 f9 ff	 cmp	 ecx, -1
  00805	75 0c		 jne	 SHORT $LN28@GetToken

; 34   : 		{
; 35   : 			return END;	// End of FILE (EOF)

  00807	b8 02 00 00 00	 mov	 eax, 2
  0080c	e9 f7 02 00 00	 jmp	 $LN32@GetToken

; 36   : 		}
; 37   : 		else

  00811	eb 5b		 jmp	 SHORT $LN22@GetToken
$LN28@GetToken:

; 38   : 		{	
; 39   : 			if (ch=='/')		// this is /

  00813	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00817	83 f8 2f	 cmp	 eax, 47			; 0000002fH
  0081a	75 52		 jne	 SHORT $LN22@GetToken

; 40   : 			{
; 41   : 				if((ch=fgetc(SMDFile)) == '/')

  0081c	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00821	50		 push	 eax
  00822	e8 00 00 00 00	 call	 _fgetc
  00827	83 c4 04	 add	 esp, 4
  0082a	88 45 fb	 mov	 BYTE PTR _ch$[ebp], al
  0082d	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00831	83 f9 2f	 cmp	 ecx, 47			; 0000002fH
  00834	75 38		 jne	 SHORT $LN22@GetToken
$LN24@GetToken:

; 42   : 				{
; 43   : 					while ((ch != '\n') && (ch != -1))	// End of Line (EOL)

  00836	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  0083a	83 f8 0a	 cmp	 eax, 10			; 0000000aH
  0083d	74 1c		 je	 SHORT $LN23@GetToken
  0083f	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00843	83 f8 ff	 cmp	 eax, -1
  00846	74 13		 je	 SHORT $LN23@GetToken

; 44   : 					{
; 45   : 						ch=fgetc(SMDFile);

  00848	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  0084d	50		 push	 eax
  0084e	e8 00 00 00 00	 call	 _fgetc
  00853	83 c4 04	 add	 esp, 4
  00856	88 45 fb	 mov	 BYTE PTR _ch$[ebp], al

; 46   : 					}

  00859	eb db		 jmp	 SHORT $LN24@GetToken
$LN23@GetToken:

; 47   : 	
; 48   : 					if (ch == -1)

  0085b	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  0085f	83 f8 ff	 cmp	 eax, -1
  00862	75 0a		 jne	 SHORT $LN22@GetToken

; 49   : 					{
; 50   : 						return END;	// End of FILE

  00864	b8 02 00 00 00	 mov	 eax, 2
  00869	e9 9a 02 00 00	 jmp	 $LN32@GetToken
$LN22@GetToken:

; 51   : 					}
; 52   : 				}
; 53   : 			}
; 54   : 		}
; 55   : 	}
; 56   : 	while (isspace(ch) != 0);

  0086e	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00872	50		 push	 eax
  00873	e8 00 00 00 00	 call	 _isspace
  00878	83 c4 04	 add	 esp, 4
  0087b	85 c0		 test	 eax, eax
  0087d	0f 85 6a ff ff
	ff		 jne	 $LN31@GetToken

; 57   : 
; 58   : 	
; 59   : 	switch(ch)

  00883	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00887	89 85 4c ff ff
	ff		 mov	 DWORD PTR tv90[ebp], eax
  0088d	8b 8d 4c ff ff
	ff		 mov	 ecx, DWORD PTR tv90[ebp]
  00893	83 e9 22	 sub	 ecx, 34			; 00000022H
  00896	89 8d 4c ff ff
	ff		 mov	 DWORD PTR tv90[ebp], ecx
  0089c	83 bd 4c ff ff
	ff 5b		 cmp	 DWORD PTR tv90[ebp], 91	; 0000005bH
  008a3	0f 87 a3 01 00
	00		 ja	 $LN6@GetToken
  008a9	8b 95 4c ff ff
	ff		 mov	 edx, DWORD PTR tv90[ebp]
  008af	0f b6 82 00 00
	00 00		 movzx	 eax, BYTE PTR $LN34@GetToken[edx]
  008b6	ff 24 85 00 00
	00 00		 jmp	 DWORD PTR $LN35@GetToken[eax*4]
$LN19@GetToken:

; 60   : 	{
; 61   : 
; 62   : 	case 0x23:	// #
; 63   : 		return CurrentToken=COMMAND;

  008bd	c7 05 00 00 00
	00 23 00 00 00	 mov	 DWORD PTR _CurrentToken, 35 ; 00000023H
  008c7	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  008cc	e9 37 02 00 00	 jmp	 $LN32@GetToken

; 64   : 		break;

  008d1	e9 30 02 00 00	 jmp	 $LN20@GetToken
$LN18@GetToken:

; 65   : 	
; 66   : 	case 0x3B:	// ;
; 67   : 		return CurrentToken=SEMICOLON;

  008d6	c7 05 00 00 00
	00 3b 00 00 00	 mov	 DWORD PTR _CurrentToken, 59 ; 0000003bH
  008e0	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  008e5	e9 1e 02 00 00	 jmp	 $LN32@GetToken

; 68   : 		break;

  008ea	e9 17 02 00 00	 jmp	 $LN20@GetToken
$LN17@GetToken:

; 69   : 	
; 70   : 	case 0x2C:	// ,
; 71   : 
; 72   : 		return CurrentToken=COMMA;

  008ef	c7 05 00 00 00
	00 2c 00 00 00	 mov	 DWORD PTR _CurrentToken, 44 ; 0000002cH
  008f9	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  008fe	e9 05 02 00 00	 jmp	 $LN32@GetToken

; 73   : 		break;

  00903	e9 fe 01 00 00	 jmp	 $LN20@GetToken
$LN16@GetToken:

; 74   : 	
; 75   : 	case 0x7B:	// {
; 76   : 		return CurrentToken = LP;

  00908	c7 05 00 00 00
	00 7b 00 00 00	 mov	 DWORD PTR _CurrentToken, 123 ; 0000007bH
  00912	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  00917	e9 ec 01 00 00	 jmp	 $LN32@GetToken

; 77   : 		break;

  0091c	e9 e5 01 00 00	 jmp	 $LN20@GetToken
$LN15@GetToken:

; 78   : 
; 79   : 	case 0x7D:	// }
; 80   : 		return CurrentToken = RP;

  00921	c7 05 00 00 00
	00 7d 00 00 00	 mov	 DWORD PTR _CurrentToken, 125 ; 0000007dH
  0092b	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  00930	e9 d3 01 00 00	 jmp	 $LN32@GetToken

; 81   : 		break;

  00935	e9 cc 01 00 00	 jmp	 $LN20@GetToken
$LN14@GetToken:

; 82   : 	// Nice Index Table :)	by Deathway
; 83   : 	// Numbers Case
; 84   : 	case 0x2D:	//-
; 85   : 	case 0x2E:	//.
; 86   : 	case '0':	//0
; 87   : 	case '1':	//1
; 88   : 	case '2':	//2
; 89   : 	case '3':	//3
; 90   : 	case '4':	//4		
; 91   : 	case '5':	//5
; 92   : 	case '6':	//6
; 93   : 	case '7':	//7
; 94   : 	case '8':	//8
; 95   : 	case '9':	//9
; 96   : 		ungetc(ch, SMDFile);

  0093a	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  0093f	50		 push	 eax
  00940	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00944	51		 push	 ecx
  00945	e8 00 00 00 00	 call	 _ungetc
  0094a	83 c4 08	 add	 esp, 8

; 97   : 		p = TempString;

  0094d	8d 45 90	 lea	 eax, DWORD PTR _TempString$[ebp]
  00950	89 45 f4	 mov	 DWORD PTR _p$[ebp], eax
$LN13@GetToken:

; 98   : 		
; 99   : 		while (((ch=getc(SMDFile)) != -1) && ((ch == 0x2E) || (isdigit(ch) != 0) || (ch == 0x2D)))  // 2e '.'  2D '-'

  00953	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00958	50		 push	 eax
  00959	e8 00 00 00 00	 call	 _getc
  0095e	83 c4 04	 add	 esp, 4
  00961	88 45 fb	 mov	 BYTE PTR _ch$[ebp], al
  00964	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00968	83 f9 ff	 cmp	 ecx, -1
  0096b	74 36		 je	 SHORT $LN12@GetToken
  0096d	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00971	83 f8 2e	 cmp	 eax, 46			; 0000002eH
  00974	74 1a		 je	 SHORT $LN11@GetToken
  00976	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  0097a	50		 push	 eax
  0097b	e8 00 00 00 00	 call	 _isdigit
  00980	83 c4 04	 add	 esp, 4
  00983	85 c0		 test	 eax, eax
  00985	75 09		 jne	 SHORT $LN11@GetToken
  00987	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  0098b	83 f8 2d	 cmp	 eax, 45			; 0000002dH
  0098e	75 13		 jne	 SHORT $LN12@GetToken
$LN11@GetToken:

; 100  : 		{
; 101  : 			*p = ch;	// Construct a String

  00990	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00993	8a 4d fb	 mov	 cl, BYTE PTR _ch$[ebp]
  00996	88 08		 mov	 BYTE PTR [eax], cl

; 102  : 			p++;

  00998	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  0099b	83 c0 01	 add	 eax, 1
  0099e	89 45 f4	 mov	 DWORD PTR _p$[ebp], eax

; 103  : 		}		

  009a1	eb b0		 jmp	 SHORT $LN13@GetToken
$LN12@GetToken:

; 104  : 		*p = 0;

  009a3	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  009a6	c6 00 00	 mov	 BYTE PTR [eax], 0

; 105  : 		TokenNumber = atof( TempString);	// Select the first Byte as Main ID

  009a9	8d 45 90	 lea	 eax, DWORD PTR _TempString$[ebp]
  009ac	50		 push	 eax
  009ad	e8 00 00 00 00	 call	 _atof
  009b2	83 c4 04	 add	 esp, 4
  009b5	d9 1d 00 00 00
	00		 fstp	 DWORD PTR _TokenNumber

; 106  : 		return CurrentToken  = NUMBER ;

  009bb	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR _CurrentToken, 1
  009c5	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  009ca	e9 39 01 00 00	 jmp	 $LN32@GetToken

; 107  : 		break;

  009cf	e9 32 01 00 00	 jmp	 $LN20@GetToken
$LN10@GetToken:

; 108  : 
; 109  : 	case '\"':	// "	String Case
; 110  : 		p=&TokenString[0];

  009d4	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _p$[ebp], OFFSET _TokenString
$LN9@GetToken:

; 111  : 		
; 112  : 		while (((ch=getc(SMDFile)) != -1 ) && (ch != 0x22))	// nice

  009db	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  009e0	50		 push	 eax
  009e1	e8 00 00 00 00	 call	 _getc
  009e6	83 c4 04	 add	 esp, 4
  009e9	88 45 fb	 mov	 BYTE PTR _ch$[ebp], al
  009ec	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  009f0	83 f9 ff	 cmp	 ecx, -1
  009f3	74 1c		 je	 SHORT $LN8@GetToken
  009f5	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  009f9	83 f8 22	 cmp	 eax, 34			; 00000022H
  009fc	74 13		 je	 SHORT $LN8@GetToken

; 113  : 		{
; 114  : 			*p = ch;

  009fe	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00a01	8a 4d fb	 mov	 cl, BYTE PTR _ch$[ebp]
  00a04	88 08		 mov	 BYTE PTR [eax], cl

; 115  : 			p++;

  00a06	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00a09	83 c0 01	 add	 eax, 1
  00a0c	89 45 f4	 mov	 DWORD PTR _p$[ebp], eax

; 116  : 		}

  00a0f	eb ca		 jmp	 SHORT $LN9@GetToken
$LN8@GetToken:

; 117  : 		if (ch != 0x22 )

  00a11	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00a15	83 f8 22	 cmp	 eax, 34			; 00000022H
  00a18	74 13		 je	 SHORT $LN7@GetToken

; 118  : 		{
; 119  : 			ungetc(ch, SMDFile);

  00a1a	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00a1f	50		 push	 eax
  00a20	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00a24	51		 push	 ecx
  00a25	e8 00 00 00 00	 call	 _ungetc
  00a2a	83 c4 08	 add	 esp, 8
$LN7@GetToken:

; 120  : 		}
; 121  : 		*p = 0;

  00a2d	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00a30	c6 00 00	 mov	 BYTE PTR [eax], 0

; 122  : 		return CurrentToken = NAME;

  00a33	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR _CurrentToken, 0
  00a3d	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  00a42	e9 c1 00 00 00	 jmp	 $LN32@GetToken

; 123  : 		break;

  00a47	e9 ba 00 00 00	 jmp	 $LN20@GetToken
$LN6@GetToken:

; 124  : 
; 125  : 	default:	// Others
; 126  : 		if (isalpha(ch))

  00a4c	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00a50	50		 push	 eax
  00a51	e8 00 00 00 00	 call	 _isalpha
  00a56	83 c4 04	 add	 esp, 4
  00a59	85 c0		 test	 eax, eax
  00a5b	0f 84 94 00 00
	00		 je	 $LN5@GetToken

; 127  : 		{
; 128  : 			p=&TokenString[0];

  00a61	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _p$[ebp], OFFSET _TokenString

; 129  : 			*p=ch;

  00a68	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00a6b	8a 4d fb	 mov	 cl, BYTE PTR _ch$[ebp]
  00a6e	88 08		 mov	 BYTE PTR [eax], cl

; 130  : 			p++;

  00a70	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00a73	83 c0 01	 add	 eax, 1
  00a76	89 45 f4	 mov	 DWORD PTR _p$[ebp], eax
$LN4@GetToken:

; 131  : 
; 132  : 			while ( ((ch=getc(SMDFile)) != -1) && ( (ch == 0x2E) || (ch == 0x5F) || (isalnum(ch) != 0) ) )

  00a79	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00a7e	50		 push	 eax
  00a7f	e8 00 00 00 00	 call	 _getc
  00a84	83 c4 04	 add	 esp, 4
  00a87	88 45 fb	 mov	 BYTE PTR _ch$[ebp], al
  00a8a	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00a8e	83 f9 ff	 cmp	 ecx, -1
  00a91	74 36		 je	 SHORT $LN3@GetToken
  00a93	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00a97	83 f8 2e	 cmp	 eax, 46			; 0000002eH
  00a9a	74 1a		 je	 SHORT $LN2@GetToken
  00a9c	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00aa0	83 f8 5f	 cmp	 eax, 95			; 0000005fH
  00aa3	74 11		 je	 SHORT $LN2@GetToken
  00aa5	0f be 45 fb	 movsx	 eax, BYTE PTR _ch$[ebp]
  00aa9	50		 push	 eax
  00aaa	e8 00 00 00 00	 call	 _isalnum
  00aaf	83 c4 04	 add	 esp, 4
  00ab2	85 c0		 test	 eax, eax
  00ab4	74 13		 je	 SHORT $LN3@GetToken
$LN2@GetToken:

; 133  : 			{
; 134  : 				*p=ch;

  00ab6	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00ab9	8a 4d fb	 mov	 cl, BYTE PTR _ch$[ebp]
  00abc	88 08		 mov	 BYTE PTR [eax], cl

; 135  : 				p++;

  00abe	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00ac1	83 c0 01	 add	 eax, 1
  00ac4	89 45 f4	 mov	 DWORD PTR _p$[ebp], eax

; 136  : 				
; 137  : 			}

  00ac7	eb b0		 jmp	 SHORT $LN4@GetToken
$LN3@GetToken:

; 138  : 
; 139  : 			ungetc(ch, SMDFile);

  00ac9	a1 00 00 00 00	 mov	 eax, DWORD PTR _SMDFile
  00ace	50		 push	 eax
  00acf	0f be 4d fb	 movsx	 ecx, BYTE PTR _ch$[ebp]
  00ad3	51		 push	 ecx
  00ad4	e8 00 00 00 00	 call	 _ungetc
  00ad9	83 c4 08	 add	 esp, 8

; 140  : 			*p=0;

  00adc	8b 45 f4	 mov	 eax, DWORD PTR _p$[ebp]
  00adf	c6 00 00	 mov	 BYTE PTR [eax], 0

; 141  : 			CurrentToken=NAME;

  00ae2	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR _CurrentToken, 0

; 142  : 			return CurrentToken;

  00aec	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  00af1	eb 15		 jmp	 SHORT $LN32@GetToken

; 143  : 		}
; 144  : 		else

  00af3	eb 11		 jmp	 SHORT $LN1@GetToken
$LN5@GetToken:

; 145  : 		{
; 146  : 			return CurrentToken = SMD_ERROR; // '<'

  00af5	c7 05 00 00 00
	00 3c 00 00 00	 mov	 DWORD PTR _CurrentToken, 60 ; 0000003cH
  00aff	a1 00 00 00 00	 mov	 eax, DWORD PTR _CurrentToken
  00b04	eb 02		 jmp	 SHORT $LN32@GetToken
$LN1@GetToken:
$LN20@GetToken:

; 147  : 		}
; 148  : 		break;
; 149  : 
; 150  : 	}
; 151  : 
; 152  : 	return NAME;

  00b06	33 c0		 xor	 eax, eax
$LN32@GetToken:

; 153  : }

  00b08	5f		 pop	 edi
  00b09	5e		 pop	 esi
  00b0a	5b		 pop	 ebx
  00b0b	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00b0e	33 cd		 xor	 ecx, ebp
  00b10	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00b15	8b e5		 mov	 esp, ebp
  00b17	5d		 pop	 ebp
  00b18	c3		 ret	 0
  00b19	8d 49 00	 npad	 3
$LN35@GetToken:
  00b1c	00 00 00 00	 DD	 $LN10@GetToken
  00b20	00 00 00 00	 DD	 $LN19@GetToken
  00b24	00 00 00 00	 DD	 $LN17@GetToken
  00b28	00 00 00 00	 DD	 $LN14@GetToken
  00b2c	00 00 00 00	 DD	 $LN18@GetToken
  00b30	00 00 00 00	 DD	 $LN16@GetToken
  00b34	00 00 00 00	 DD	 $LN15@GetToken
  00b38	00 00 00 00	 DD	 $LN6@GetToken
$LN34@GetToken:
  00b3c	00		 DB	 0
  00b3d	01		 DB	 1
  00b3e	07		 DB	 7
  00b3f	07		 DB	 7
  00b40	07		 DB	 7
  00b41	07		 DB	 7
  00b42	07		 DB	 7
  00b43	07		 DB	 7
  00b44	07		 DB	 7
  00b45	07		 DB	 7
  00b46	02		 DB	 2
  00b47	03		 DB	 3
  00b48	03		 DB	 3
  00b49	07		 DB	 7
  00b4a	03		 DB	 3
  00b4b	03		 DB	 3
  00b4c	03		 DB	 3
  00b4d	03		 DB	 3
  00b4e	03		 DB	 3
  00b4f	03		 DB	 3
  00b50	03		 DB	 3
  00b51	03		 DB	 3
  00b52	03		 DB	 3
  00b53	03		 DB	 3
  00b54	07		 DB	 7
  00b55	04		 DB	 4
  00b56	07		 DB	 7
  00b57	07		 DB	 7
  00b58	07		 DB	 7
  00b59	07		 DB	 7
  00b5a	07		 DB	 7
  00b5b	07		 DB	 7
  00b5c	07		 DB	 7
  00b5d	07		 DB	 7
  00b5e	07		 DB	 7
  00b5f	07		 DB	 7
  00b60	07		 DB	 7
  00b61	07		 DB	 7
  00b62	07		 DB	 7
  00b63	07		 DB	 7
  00b64	07		 DB	 7
  00b65	07		 DB	 7
  00b66	07		 DB	 7
  00b67	07		 DB	 7
  00b68	07		 DB	 7
  00b69	07		 DB	 7
  00b6a	07		 DB	 7
  00b6b	07		 DB	 7
  00b6c	07		 DB	 7
  00b6d	07		 DB	 7
  00b6e	07		 DB	 7
  00b6f	07		 DB	 7
  00b70	07		 DB	 7
  00b71	07		 DB	 7
  00b72	07		 DB	 7
  00b73	07		 DB	 7
  00b74	07		 DB	 7
  00b75	07		 DB	 7
  00b76	07		 DB	 7
  00b77	07		 DB	 7
  00b78	07		 DB	 7
  00b79	07		 DB	 7
  00b7a	07		 DB	 7
  00b7b	07		 DB	 7
  00b7c	07		 DB	 7
  00b7d	07		 DB	 7
  00b7e	07		 DB	 7
  00b7f	07		 DB	 7
  00b80	07		 DB	 7
  00b81	07		 DB	 7
  00b82	07		 DB	 7
  00b83	07		 DB	 7
  00b84	07		 DB	 7
  00b85	07		 DB	 7
  00b86	07		 DB	 7
  00b87	07		 DB	 7
  00b88	07		 DB	 7
  00b89	07		 DB	 7
  00b8a	07		 DB	 7
  00b8b	07		 DB	 7
  00b8c	07		 DB	 7
  00b8d	07		 DB	 7
  00b8e	07		 DB	 7
  00b8f	07		 DB	 7
  00b90	07		 DB	 7
  00b91	07		 DB	 7
  00b92	07		 DB	 7
  00b93	07		 DB	 7
  00b94	07		 DB	 7
  00b95	05		 DB	 5
  00b96	07		 DB	 7
  00b97	06		 DB	 6
?GetToken@@YA?AW4SMDToken@@XZ ENDP			; GetToken
_TEXT	ENDS
PUBLIC	?GetLevel@CItemBagEx@@AAEEH@Z			; CItemBagEx::GetLevel
EXTRN	_rand:PROC
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\itembagex.cpp
_TEXT	SEGMENT
_level$ = -12						; size = 4
_sub$ = -8						; size = 4
_this$ = -4						; size = 4
_n$ = 8							; size = 4
?GetLevel@CItemBagEx@@AAEEH@Z PROC			; CItemBagEx::GetLevel
; _this$ = ecx

; 200  : {

  00ba0	55		 push	 ebp
  00ba1	8b ec		 mov	 ebp, esp
  00ba3	83 ec 4c	 sub	 esp, 76			; 0000004cH
  00ba6	53		 push	 ebx
  00ba7	56		 push	 esi
  00ba8	57		 push	 edi
  00ba9	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 201  : 	if ( n <0 || n > MAX_ITEMBAG_ATTR-1 )

  00bac	83 7d 08 00	 cmp	 DWORD PTR _n$[ebp], 0
  00bb0	7c 09		 jl	 SHORT $LN3@GetLevel
  00bb2	81 7d 08 95 00
	00 00		 cmp	 DWORD PTR _n$[ebp], 149	; 00000095H
  00bb9	7e 07		 jle	 SHORT $LN4@GetLevel
$LN3@GetLevel:

; 202  : 	{
; 203  : 		return 0;

  00bbb	32 c0		 xor	 al, al
  00bbd	e9 88 00 00 00	 jmp	 $LN5@GetLevel
$LN4@GetLevel:

; 204  : 	}
; 205  : 
; 206  : #if(FIX_CRASH==TRUE)
; 207  : 	if(this->BagObject[n].m_minLevel < 0 )

  00bc2	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00bc5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00bc8	0f b6 94 c1 34
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+564]
  00bd0	85 d2		 test	 edx, edx
  00bd2	7d 04		 jge	 SHORT $LN2@GetLevel

; 208  : 	{
; 209  : 		return 0;

  00bd4	32 c0		 xor	 al, al
  00bd6	eb 72		 jmp	 SHORT $LN5@GetLevel
$LN2@GetLevel:

; 210  : 	}
; 211  : 	if ( this->BagObject[n].m_minLevel >= this->BagObject[n].m_maxLevel )

  00bd8	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00bdb	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00bde	0f b6 94 c1 34
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+564]
  00be6	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00be9	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00bec	0f b6 84 c1 35
	02 00 00	 movzx	 eax, BYTE PTR [ecx+eax*8+565]
  00bf4	3b d0		 cmp	 edx, eax
  00bf6	7c 0f		 jl	 SHORT $LN1@GetLevel

; 212  : 	{
; 213  : 		return this->BagObject[n].m_minLevel;

  00bf8	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00bfb	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00bfe	8a 84 c1 34 02
	00 00		 mov	 al, BYTE PTR [ecx+eax*8+564]
  00c05	eb 43		 jmp	 SHORT $LN5@GetLevel
$LN1@GetLevel:

; 214  : 	}
; 215  : #else
; 216  : 	if ( this->BagObject[n].m_minLevel == this->BagObject[n].m_maxLevel )
; 217  : 	{
; 218  : 		return this->BagObject[n].m_minLevel;
; 219  : 	}
; 220  : #endif
; 221  : 
; 222  : 	int sub = (this->BagObject[n].m_maxLevel - this->BagObject[n].m_minLevel) + 1;

  00c07	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00c0a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00c0d	0f b6 94 c1 35
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+565]
  00c15	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00c18	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00c1b	0f b6 84 c1 34
	02 00 00	 movzx	 eax, BYTE PTR [ecx+eax*8+564]
  00c23	2b d0		 sub	 edx, eax
  00c25	83 c2 01	 add	 edx, 1
  00c28	89 55 f8	 mov	 DWORD PTR _sub$[ebp], edx

; 223  : 	int level = this->BagObject[n].m_minLevel + (rand()%sub);

  00c2b	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  00c2e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00c31	0f b6 b4 c1 34
	02 00 00	 movzx	 esi, BYTE PTR [ecx+eax*8+564]
  00c39	e8 00 00 00 00	 call	 _rand
  00c3e	99		 cdq
  00c3f	f7 7d f8	 idiv	 DWORD PTR _sub$[ebp]
  00c42	03 f2		 add	 esi, edx
  00c44	89 75 f4	 mov	 DWORD PTR _level$[ebp], esi

; 224  : 
; 225  : 	return level;

  00c47	8a 45 f4	 mov	 al, BYTE PTR _level$[ebp]
$LN5@GetLevel:

; 226  : }

  00c4a	5f		 pop	 edi
  00c4b	5e		 pop	 esi
  00c4c	5b		 pop	 ebx
  00c4d	8b e5		 mov	 esp, ebp
  00c4f	5d		 pop	 ebp
  00c50	c2 04 00	 ret	 4
?GetLevel@CItemBagEx@@AAEEH@Z ENDP			; CItemBagEx::GetLevel
_TEXT	ENDS
PUBLIC	?IsEnableEventItemDrop@CItemBagEx@@AAEHH@Z	; CItemBagEx::IsEnableEventItemDrop
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:DWORD		; gObj
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
_iLevel$ = -12						; size = 4
_iMapNumber$ = -8					; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?IsEnableEventItemDrop@CItemBagEx@@AAEHH@Z PROC		; CItemBagEx::IsEnableEventItemDrop
; _this$ = ecx

; 229  : {

  00c60	55		 push	 ebp
  00c61	8b ec		 mov	 ebp, esp
  00c63	83 ec 4c	 sub	 esp, 76			; 0000004cH
  00c66	53		 push	 ebx
  00c67	56		 push	 esi
  00c68	57		 push	 edi
  00c69	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 230  : 	int iMapNumber = gObj[aIndex].MapNumber;

  00c6c	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00c6f	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00c75	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00c7b	0f b6 94 01 49
	01 00 00	 movzx	 edx, BYTE PTR [ecx+eax+329]
  00c83	89 55 f8	 mov	 DWORD PTR _iMapNumber$[ebp], edx

; 231  : 
; 232  : 	if ( this->DropMapInfo[iMapNumber].m_bIsDrop == FALSE )

  00c86	8b 45 f8	 mov	 eax, DWORD PTR _iMapNumber$[ebp]
  00c89	6b c0 03	 imul	 eax, 3
  00c8c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00c8f	0f b6 94 01 24
	01 00 00	 movzx	 edx, BYTE PTR [ecx+eax+292]
  00c97	85 d2		 test	 edx, edx
  00c99	75 04		 jne	 SHORT $LN3@IsEnableEv

; 233  : 	{
; 234  : 		return FALSE;

  00c9b	33 c0		 xor	 eax, eax
  00c9d	eb 4f		 jmp	 SHORT $LN4@IsEnableEv
$LN3@IsEnableEv:

; 235  : 	}
; 236  : 
; 237  : 	int iLevel = gObj[aIndex].Level;

  00c9f	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00ca2	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00ca8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00cae	0f bf 94 01 be
	00 00 00	 movsx	 edx, WORD PTR [ecx+eax+190]
  00cb6	89 55 f4	 mov	 DWORD PTR _iLevel$[ebp], edx

; 238  : 
; 239  : 	if  ( iLevel < this->DropMapInfo[iMapNumber].m_MinMonsterLevel || iLevel > this->DropMapInfo[iMapNumber].m_MaxMonsterLevel)

  00cb9	8b 45 f8	 mov	 eax, DWORD PTR _iMapNumber$[ebp]
  00cbc	6b c0 03	 imul	 eax, 3
  00cbf	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00cc2	0f b6 94 01 25
	01 00 00	 movzx	 edx, BYTE PTR [ecx+eax+293]
  00cca	39 55 f4	 cmp	 DWORD PTR _iLevel$[ebp], edx
  00ccd	7c 16		 jl	 SHORT $LN1@IsEnableEv
  00ccf	8b 45 f8	 mov	 eax, DWORD PTR _iMapNumber$[ebp]
  00cd2	6b c0 03	 imul	 eax, 3
  00cd5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00cd8	0f b6 94 01 26
	01 00 00	 movzx	 edx, BYTE PTR [ecx+eax+294]
  00ce0	39 55 f4	 cmp	 DWORD PTR _iLevel$[ebp], edx
  00ce3	7e 04		 jle	 SHORT $LN2@IsEnableEv
$LN1@IsEnableEv:

; 240  : 	{
; 241  : 		return FALSE;

  00ce5	33 c0		 xor	 eax, eax
  00ce7	eb 05		 jmp	 SHORT $LN4@IsEnableEv
$LN2@IsEnableEv:

; 242  : 	}
; 243  : 
; 244  : 	return TRUE;

  00ce9	b8 01 00 00 00	 mov	 eax, 1
$LN4@IsEnableEv:

; 245  : }

  00cee	5f		 pop	 edi
  00cef	5e		 pop	 esi
  00cf0	5b		 pop	 ebx
  00cf1	8b e5		 mov	 esp, ebp
  00cf3	5d		 pop	 ebp
  00cf4	c2 04 00	 ret	 4
?IsEnableEventItemDrop@CItemBagEx@@AAEHH@Z ENDP		; CItemBagEx::IsEnableEventItemDrop
_TEXT	ENDS
PUBLIC	??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@ ; `string'
PUBLIC	__real@437f0000
PUBLIC	__real@00000000
PUBLIC	?DropEventItem@CItemBagEx@@QAEHH@Z		; CItemBagEx::DropEventItem
EXTRN	?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z:PROC	; ItemSerialCreateSend
EXTRN	?gObjMonsterTopHitDamageUser@@YAHPAUOBJECTSTRUCT@@@Z:PROC ; gObjMonsterTopHitDamageUser
;	COMDAT ??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@
CONST	SEGMENT
??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@ DB '['
	DB	'%s][%s] [%s] MonsterEventItemDrop (%d)(%d/%d)', 00H ; `string'
CONST	ENDS
;	COMDAT __real@437f0000
CONST	SEGMENT
__real@437f0000 DD 0437f0000r			; 255
CONST	ENDS
;	COMDAT __real@00000000
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv172 = -108						; size = 4
tv170 = -104						; size = 4
tv167 = -98						; size = 2
_thdu$228157 = -32					; size = 4
_dur$228156 = -28					; size = 4
_y$228155 = -24						; size = 4
_x$228154 = -20						; size = 4
_eil$228153 = -16					; size = 4
_ei$228152 = -12					; size = 4
_lpObj$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropEventItem@CItemBagEx@@QAEHH@Z PROC			; CItemBagEx::DropEventItem
; _this$ = ecx

; 249  : {

  00d00	55		 push	 ebp
  00d01	8b ec		 mov	 ebp, esp
  00d03	83 ec 6c	 sub	 esp, 108		; 0000006cH
  00d06	53		 push	 ebx
  00d07	56		 push	 esi
  00d08	57		 push	 edi
  00d09	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 250  : 	if ( this->m_bLoad == FALSE )

  00d0c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00d0f	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  00d13	75 07		 jne	 SHORT $LN3@DropEventI

; 251  : 	{
; 252  : 		return FALSE;

  00d15	33 c0		 xor	 eax, eax
  00d17	e9 2d 01 00 00	 jmp	 $LN4@DropEventI
$LN3@DropEventI:

; 253  : 	}
; 254  : 
; 255  : 	if ( this->IsEnableEventItemDrop(aIndex) == FALSE )

  00d1c	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00d1f	50		 push	 eax
  00d20	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00d23	e8 00 00 00 00	 call	 ?IsEnableEventItemDrop@CItemBagEx@@AAEHH@Z ; CItemBagEx::IsEnableEventItemDrop
  00d28	85 c0		 test	 eax, eax
  00d2a	75 07		 jne	 SHORT $LN2@DropEventI

; 256  : 	{
; 257  : 		return FALSE;

  00d2c	33 c0		 xor	 eax, eax
  00d2e	e9 16 01 00 00	 jmp	 $LN4@DropEventI
$LN2@DropEventI:

; 258  : 	}
; 259  : 
; 260  : 	LPOBJ lpObj = &gObj[aIndex];

  00d33	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00d36	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00d3c	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00d42	89 45 f8	 mov	 DWORD PTR _lpObj$[ebp], eax

; 261  : 
; 262  : 	if ( (rand()%1000) < this->m_iEventItemDropRate )

  00d45	e8 00 00 00 00	 call	 _rand
  00d4a	99		 cdq
  00d4b	b9 e8 03 00 00	 mov	 ecx, 1000		; 000003e8H
  00d50	f7 f9		 idiv	 ecx
  00d52	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00d55	3b 90 14 01 00
	00		 cmp	 edx, DWORD PTR [eax+276]
  00d5b	0f 8d e6 00 00
	00		 jge	 $LN1@DropEventI

; 263  : 	{
; 264  : 		int ei;
; 265  : 		int eil;
; 266  : 		int x;
; 267  : 		int y;
; 268  : 		float dur = 0;

  00d61	d9 ee		 fldz
  00d63	d9 5d e4	 fstp	 DWORD PTR _dur$228156[ebp]

; 269  : 		dur = 255.0;

  00d66	d9 05 00 00 00
	00		 fld	 DWORD PTR __real@437f0000
  00d6c	d9 5d e4	 fstp	 DWORD PTR _dur$228156[ebp]

; 270  : 
; 271  : 		x = lpObj->X;

  00d6f	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00d72	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  00d79	89 4d ec	 mov	 DWORD PTR _x$228154[ebp], ecx

; 272  : 		y = lpObj->Y;

  00d7c	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00d7f	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  00d86	89 4d e8	 mov	 DWORD PTR _y$228155[ebp], ecx

; 273  : 		eil = this->m_iEventItemLevel;

  00d89	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00d8c	8b 88 0c 01 00
	00		 mov	 ecx, DWORD PTR [eax+268]
  00d92	89 4d f0	 mov	 DWORD PTR _eil$228153[ebp], ecx

; 274  : 		ei = this->m_iEventItemType;

  00d95	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00d98	8b 88 08 01 00
	00		 mov	 ecx, DWORD PTR [eax+264]
  00d9e	89 4d f4	 mov	 DWORD PTR _ei$228152[ebp], ecx

; 275  : 
; 276  : 		int thdu = gObjMonsterTopHitDamageUser(lpObj);

  00da1	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00da4	50		 push	 eax
  00da5	e8 00 00 00 00	 call	 ?gObjMonsterTopHitDamageUser@@YAHPAUOBJECTSTRUCT@@@Z ; gObjMonsterTopHitDamageUser
  00daa	83 c4 04	 add	 esp, 4
  00dad	89 45 e0	 mov	 DWORD PTR _thdu$228157[ebp], eax

; 277  : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x ,(BYTE)y, ei, (BYTE)eil, (BYTE)dur, 0, 0, 0, thdu, 0, 0);

  00db0	6a 00		 push	 0
  00db2	6a 00		 push	 0
  00db4	8b 45 e0	 mov	 eax, DWORD PTR _thdu$228157[ebp]
  00db7	50		 push	 eax
  00db8	6a 00		 push	 0
  00dba	6a 00		 push	 0
  00dbc	6a 00		 push	 0
  00dbe	d9 45 e4	 fld	 DWORD PTR _dur$228156[ebp]
  00dc1	d9 7d 9e	 fnstcw	 WORD PTR tv167[ebp]
  00dc4	0f b7 45 9e	 movzx	 eax, WORD PTR tv167[ebp]
  00dc8	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  00dcd	89 45 98	 mov	 DWORD PTR tv170[ebp], eax
  00dd0	d9 6d 98	 fldcw	 WORD PTR tv170[ebp]
  00dd3	db 5d 94	 fistp	 DWORD PTR tv172[ebp]
  00dd6	d9 6d 9e	 fldcw	 WORD PTR tv167[ebp]
  00dd9	0f b6 4d 94	 movzx	 ecx, BYTE PTR tv172[ebp]
  00ddd	51		 push	 ecx
  00dde	0f b6 55 f0	 movzx	 edx, BYTE PTR _eil$228153[ebp]
  00de2	52		 push	 edx
  00de3	8b 45 f4	 mov	 eax, DWORD PTR _ei$228152[ebp]
  00de6	50		 push	 eax
  00de7	0f b6 4d e8	 movzx	 ecx, BYTE PTR _y$228155[ebp]
  00deb	51		 push	 ecx
  00dec	0f b6 55 ec	 movzx	 edx, BYTE PTR _x$228154[ebp]
  00df0	52		 push	 edx
  00df1	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00df4	0f b6 88 49 01
	00 00		 movzx	 ecx, BYTE PTR [eax+329]
  00dfb	51		 push	 ecx
  00dfc	8b 55 f8	 mov	 edx, DWORD PTR _lpObj$[ebp]
  00dff	8b 02		 mov	 eax, DWORD PTR [edx]
  00e01	50		 push	 eax
  00e02	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  00e07	83 c4 34	 add	 esp, 52			; 00000034H

; 278  : 		LogAddTD("[%s][%s] [%s] MonsterEventItemDrop (%d)(%d/%d)", lpObj->AccountID, lpObj->Name, 
; 279  : 			this->m_sEventName, lpObj->MapNumber, x, y);

  00e0a	8b 45 e8	 mov	 eax, DWORD PTR _y$228155[ebp]
  00e0d	50		 push	 eax
  00e0e	8b 4d ec	 mov	 ecx, DWORD PTR _x$228154[ebp]
  00e11	51		 push	 ecx
  00e12	8b 55 f8	 mov	 edx, DWORD PTR _lpObj$[ebp]
  00e15	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  00e1c	50		 push	 eax
  00e1d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00e20	83 c1 08	 add	 ecx, 8
  00e23	51		 push	 ecx
  00e24	8b 55 f8	 mov	 edx, DWORD PTR _lpObj$[ebp]
  00e27	83 c2 77	 add	 edx, 119		; 00000077H
  00e2a	52		 push	 edx
  00e2b	8b 45 f8	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00e2e	83 c0 6c	 add	 eax, 108		; 0000006cH
  00e31	50		 push	 eax
  00e32	68 00 00 00 00	 push	 OFFSET ??_C@_0CP@CFLKNDIJ@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5MonsterEventItemDr@
  00e37	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  00e3d	83 c4 1c	 add	 esp, 28			; 0000001cH

; 280  : 		return TRUE;

  00e40	b8 01 00 00 00	 mov	 eax, 1
  00e45	eb 02		 jmp	 SHORT $LN4@DropEventI
$LN1@DropEventI:

; 281  : 	}
; 282  : 
; 283  : 	return FALSE;

  00e47	33 c0		 xor	 eax, eax
$LN4@DropEventI:

; 284  : }

  00e49	5f		 pop	 edi
  00e4a	5e		 pop	 esi
  00e4b	5b		 pop	 ebx
  00e4c	8b e5		 mov	 esp, ebp
  00e4e	5d		 pop	 ebp
  00e4f	c2 04 00	 ret	 4
?DropEventItem@CItemBagEx@@QAEHH@Z ENDP			; CItemBagEx::DropEventItem
_TEXT	ENDS
PUBLIC	??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@ ; `string'
PUBLIC	?GetBagCount@CItemBagEx@@AAEHXZ			; CItemBagEx::GetBagCount
PUBLIC	?DropItem@CItemBagEx@@QAEHH@Z			; CItemBagEx::DropItem
EXTRN	?MoneyItemDrop@MapClass@@QAEHHHH@Z:PROC		; MapClass::MoneyItemDrop
EXTRN	?MapC@@3PAVMapClass@@A:BYTE			; MapC
EXTRN	?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A:BYTE	; ItemAttribute
EXTRN	?NewOptionRand@@YAEH@Z:PROC			; NewOptionRand
EXTRN	?ItemGetNumberMake@@YAHHH@Z:PROC		; ItemGetNumberMake
;	COMDAT ??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@
CONST	SEGMENT
??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@ DB '['
	DB	'%s][%s] [%s] Event ItemDrop : (%d)(%d/%d) Item:(%s)%d Level:%'
	DB	'd op1:%d op2:%d op3:%d', 00H		; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv285 = -124						; size = 4
tv283 = -120						; size = 4
tv280 = -114						; size = 2
_lpObj$ = -48						; size = 4
_ExOption$ = -44					; size = 4
_DropItemNum$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropItem@CItemBagEx@@QAEHH@Z PROC			; CItemBagEx::DropItem
; _this$ = ecx

; 288  : {

  00e60	55		 push	 ebp
  00e61	8b ec		 mov	 ebp, esp
  00e63	83 ec 7c	 sub	 esp, 124		; 0000007cH
  00e66	53		 push	 ebx
  00e67	56		 push	 esi
  00e68	57		 push	 edi
  00e69	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 289  : 	if ( this->m_bLoad == FALSE )

  00e6c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00e6f	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  00e73	75 07		 jne	 SHORT $LN14@DropItem

; 290  : 	{
; 291  : 		return FALSE;

  00e75	33 c0		 xor	 eax, eax
  00e77	e9 1b 03 00 00	 jmp	 $LN15@DropItem
$LN14@DropItem:

; 292  : 	}
; 293  : 
; 294  : 	float dur;
; 295  : 	int type;
; 296  : 	int level;
; 297  : 	int x;
; 298  : 	int y;
; 299  : 	int Option1 = 0;

  00e7c	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 300  : 	int Option2 = 0;

  00e83	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 301  : 	int Option3 = 0;

  00e8a	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 302  : 	int DropItemNum;
; 303  : 	int ExOption = 0;

  00e91	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 304  : 	LPOBJ lpObj = &gObj[aIndex];

  00e98	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  00e9b	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  00ea1	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00ea7	89 45 d0	 mov	 DWORD PTR _lpObj$[ebp], eax

; 305  : 
; 306  : 	if ( this->GetBagCount() > 0 )

  00eaa	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00ead	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  00eb2	85 c0		 test	 eax, eax
  00eb4	0f 8e 91 02 00
	00		 jle	 $LN12@DropItem

; 307  : 	{
; 308  : 		if ( (rand()%100) < this->m_iItemDropRate )

  00eba	e8 00 00 00 00	 call	 _rand
  00ebf	99		 cdq
  00ec0	b9 64 00 00 00	 mov	 ecx, 100		; 00000064H
  00ec5	f7 f9		 idiv	 ecx
  00ec7	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  00eca	3b 90 18 01 00
	00		 cmp	 edx, DWORD PTR [eax+280]
  00ed0	0f 8d 75 02 00
	00		 jge	 $LN12@DropItem

; 309  : 		{
; 310  : 			DropItemNum =  rand() % this->GetBagCount();

  00ed6	e8 00 00 00 00	 call	 _rand
  00edb	8b f0		 mov	 esi, eax
  00edd	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00ee0	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  00ee5	8b c8		 mov	 ecx, eax
  00ee7	8b c6		 mov	 eax, esi
  00ee9	99		 cdq
  00eea	f7 f9		 idiv	 ecx
  00eec	89 55 d8	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 311  : 			dur = 0;

  00eef	d9 ee		 fldz
  00ef1	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 312  : 			x = lpObj->X;

  00ef4	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00ef7	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  00efe	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 313  : 			y = lpObj->Y;

  00f01	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  00f04	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  00f0b	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 314  : 			level = this->GetLevel(DropItemNum);

  00f0e	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00f11	50		 push	 eax
  00f12	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00f15	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  00f1a	0f b6 c8	 movzx	 ecx, al
  00f1d	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 315  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  00f20	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00f23	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00f26	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  00f2e	52		 push	 edx
  00f2f	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00f32	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00f35	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  00f3d	52		 push	 edx
  00f3e	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  00f43	83 c4 08	 add	 esp, 8
  00f46	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 316  : 
; 317  : 			if ( type == -1 )

  00f49	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  00f4d	75 07		 jne	 SHORT $LN11@DropItem

; 318  : 			{
; 319  : 				return FALSE;

  00f4f	33 c0		 xor	 eax, eax
  00f51	e9 41 02 00 00	 jmp	 $LN15@DropItem
$LN11@DropItem:

; 320  : 			}
; 321  : 
; 322  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  00f56	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00f59	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00f5c	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  00f64	85 d2		 test	 edx, edx
  00f66	74 14		 je	 SHORT $LN10@DropItem

; 323  : 			{
; 324  : 				Option1 = rand()%2;

  00f68	e8 00 00 00 00	 call	 _rand
  00f6d	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00f72	79 05		 jns	 SHORT $LN17@DropItem
  00f74	48		 dec	 eax
  00f75	83 c8 fe	 or	 eax, -2			; fffffffeH
  00f78	40		 inc	 eax
$LN17@DropItem:
  00f79	89 45 e4	 mov	 DWORD PTR _Option1$[ebp], eax
$LN10@DropItem:

; 325  : 			}
; 326  : 
; 327  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  00f7c	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00f7f	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00f82	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  00f8a	85 d2		 test	 edx, edx
  00f8c	74 14		 je	 SHORT $LN9@DropItem

; 328  : 			{
; 329  : 				Option2 = rand()%2;

  00f8e	e8 00 00 00 00	 call	 _rand
  00f93	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  00f98	79 05		 jns	 SHORT $LN18@DropItem
  00f9a	48		 dec	 eax
  00f9b	83 c8 fe	 or	 eax, -2			; fffffffeH
  00f9e	40		 inc	 eax
$LN18@DropItem:
  00f9f	89 45 e0	 mov	 DWORD PTR _Option2$[ebp], eax
$LN9@DropItem:

; 330  : 			}
; 331  : 
; 332  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  00fa2	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00fa5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00fa8	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  00fb0	85 d2		 test	 edx, edx
  00fb2	74 2b		 je	 SHORT $LN6@DropItem

; 333  : 			{
; 334  : 				if ( rand()%5 < 1 )

  00fb4	e8 00 00 00 00	 call	 _rand
  00fb9	99		 cdq
  00fba	b9 05 00 00 00	 mov	 ecx, 5
  00fbf	f7 f9		 idiv	 ecx
  00fc1	83 fa 01	 cmp	 edx, 1
  00fc4	7d 09		 jge	 SHORT $LN7@DropItem

; 335  : 				{
; 336  : 					Option3 = 3;

  00fc6	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 337  : 				}
; 338  : 				else

  00fcd	eb 10		 jmp	 SHORT $LN6@DropItem
$LN7@DropItem:

; 339  : 				{
; 340  : 					Option3 = rand()%3;

  00fcf	e8 00 00 00 00	 call	 _rand
  00fd4	99		 cdq
  00fd5	b9 03 00 00 00	 mov	 ecx, 3
  00fda	f7 f9		 idiv	 ecx
  00fdc	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropItem:

; 341  : 				}
; 342  : 			}
; 343  : 
; 344  : 			if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  00fdf	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  00fe2	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00fe5	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  00fed	85 d2		 test	 edx, edx
  00fef	74 17		 je	 SHORT $LN5@DropItem

; 345  : 			{
; 346  : 				ExOption = NewOptionRand(0);

  00ff1	6a 00		 push	 0
  00ff3	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  00ff8	83 c4 04	 add	 esp, 4
  00ffb	0f b6 c0	 movzx	 eax, al
  00ffe	89 45 d4	 mov	 DWORD PTR _ExOption$[ebp], eax

; 347  : 				Option1 = 1;

  01001	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN5@DropItem:

; 348  : 			}
; 349  : 
; 350  : 			if ( type == ITEMGET(12,15) || type == ITEMGET(14,13) || type == ITEMGET(14,14))	// Chaos, Bless, Soul

  01008	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  0100f	74 12		 je	 SHORT $LN3@DropItem
  01011	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  01018	74 09		 je	 SHORT $LN3@DropItem
  0101a	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  01021	75 1c		 jne	 SHORT $LN4@DropItem
$LN3@DropItem:

; 351  : 			{
; 352  : 				Option1 = 0;

  01023	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 353  : 				Option2 = 0;

  0102a	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 354  : 				Option3 = 0;

  01031	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 355  : 				level = 0;

  01038	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropItem:

; 356  : 			}
; 357  : 
; 358  : 			if ( type == ITEMGET(13,0) || type == ITEMGET(13,1) || type ==ITEMGET(13,2) ||
; 359  : 				 type == ITEMGET(13,8) || type == ITEMGET(13,9) || type == ITEMGET(13,12) ||
; 360  : 				 type ==ITEMGET(13,13) )	// Angel, imp, unirioa, dino, r and pendant of ice, poisonm

  0103f	81 7d f4 00 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6656 ; 00001a00H
  01046	74 36		 je	 SHORT $LN1@DropItem
  01048	81 7d f4 01 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6657 ; 00001a01H
  0104f	74 2d		 je	 SHORT $LN1@DropItem
  01051	81 7d f4 02 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6658 ; 00001a02H
  01058	74 24		 je	 SHORT $LN1@DropItem
  0105a	81 7d f4 08 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6664 ; 00001a08H
  01061	74 1b		 je	 SHORT $LN1@DropItem
  01063	81 7d f4 09 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6665 ; 00001a09H
  0106a	74 12		 je	 SHORT $LN1@DropItem
  0106c	81 7d f4 0c 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6668 ; 00001a0cH
  01073	74 09		 je	 SHORT $LN1@DropItem
  01075	81 7d f4 0d 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6669 ; 00001a0dH
  0107c	75 07		 jne	 SHORT $LN2@DropItem
$LN1@DropItem:

; 361  : 			{
; 362  : 				level = 0;

  0107e	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN2@DropItem:

; 363  : 			}
; 364  : 
; 365  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur, (BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  01085	6a 00		 push	 0
  01087	0f b6 45 d4	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  0108b	50		 push	 eax
  0108c	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0108f	8b 11		 mov	 edx, DWORD PTR [ecx]
  01091	52		 push	 edx
  01092	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  01096	50		 push	 eax
  01097	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  0109b	51		 push	 ecx
  0109c	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  010a0	52		 push	 edx
  010a1	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  010a4	d9 7d 8e	 fnstcw	 WORD PTR tv280[ebp]
  010a7	0f b7 45 8e	 movzx	 eax, WORD PTR tv280[ebp]
  010ab	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  010b0	89 45 88	 mov	 DWORD PTR tv283[ebp], eax
  010b3	d9 6d 88	 fldcw	 WORD PTR tv283[ebp]
  010b6	db 5d 84	 fistp	 DWORD PTR tv285[ebp]
  010b9	d9 6d 8e	 fldcw	 WORD PTR tv280[ebp]
  010bc	0f b6 45 84	 movzx	 eax, BYTE PTR tv285[ebp]
  010c0	50		 push	 eax
  010c1	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  010c5	51		 push	 ecx
  010c6	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  010c9	52		 push	 edx
  010ca	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  010ce	50		 push	 eax
  010cf	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  010d3	51		 push	 ecx
  010d4	8b 55 d0	 mov	 edx, DWORD PTR _lpObj$[ebp]
  010d7	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  010de	50		 push	 eax
  010df	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  010e2	8b 11		 mov	 edx, DWORD PTR [ecx]
  010e4	52		 push	 edx
  010e5	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  010ea	83 c4 34	 add	 esp, 52			; 00000034H

; 366  : 			LogAddTD("[%s][%s] [%s] Event ItemDrop : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d",
; 367  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName, lpObj->MapNumber, x, y, ItemAttribute[type].Name, type, level, Option1, Option2, Option3);

  010ed	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  010f0	50		 push	 eax
  010f1	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  010f4	51		 push	 ecx
  010f5	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  010f8	52		 push	 edx
  010f9	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  010fc	50		 push	 eax
  010fd	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  01100	51		 push	 ecx
  01101	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  01104	6b d2 70	 imul	 edx, 112		; 00000070H
  01107	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0110d	52		 push	 edx
  0110e	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  01111	50		 push	 eax
  01112	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  01115	51		 push	 ecx
  01116	8b 55 d0	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01119	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  01120	50		 push	 eax
  01121	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01124	83 c1 08	 add	 ecx, 8
  01127	51		 push	 ecx
  01128	8b 55 d0	 mov	 edx, DWORD PTR _lpObj$[ebp]
  0112b	83 c2 77	 add	 edx, 119		; 00000077H
  0112e	52		 push	 edx
  0112f	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01132	83 c0 6c	 add	 eax, 108		; 0000006cH
  01135	50		 push	 eax
  01136	68 00 00 00 00	 push	 OFFSET ??_C@_0FF@LDONOBLP@?$FL?$CFs?$FN?$FL?$CFs?$FN?5?$FL?$CFs?$FN?5Event?5ItemDrop?5?3?5?$CI@
  0113b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  01141	83 c4 34	 add	 esp, 52			; 00000034H

; 368  : 			return TRUE;

  01144	b8 01 00 00 00	 mov	 eax, 1
  01149	eb 4c		 jmp	 SHORT $LN15@DropItem
$LN12@DropItem:

; 369  : 		}
; 370  : 	}
; 371  : 
; 372  : 	x = lpObj->X;

  0114b	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0114e	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  01155	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 373  : 	y = lpObj->Y;

  01158	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0115b	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  01162	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 374  : 	MapC[lpObj->MapNumber].MoneyItemDrop(this->m_iDropZen, x, y);

  01165	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  01168	50		 push	 eax
  01169	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  0116c	51		 push	 ecx
  0116d	8b 55 fc	 mov	 edx, DWORD PTR _this$[ebp]
  01170	8b 82 10 01 00
	00		 mov	 eax, DWORD PTR [edx+272]
  01176	50		 push	 eax
  01177	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0117a	0f b6 89 49 01
	00 00		 movzx	 ecx, BYTE PTR [ecx+329]
  01181	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  01187	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0118d	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 375  : 	return TRUE;

  01192	b8 01 00 00 00	 mov	 eax, 1
$LN15@DropItem:

; 376  : }

  01197	5f		 pop	 edi
  01198	5e		 pop	 esi
  01199	5b		 pop	 ebx
  0119a	8b e5		 mov	 esp, ebp
  0119c	5d		 pop	 ebp
  0119d	c2 04 00	 ret	 4
?DropItem@CItemBagEx@@QAEHH@Z ENDP			; CItemBagEx::DropItem
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\itembagex.h
_TEXT	ENDS
;	COMDAT ?GetBagCount@CItemBagEx@@AAEHXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?GetBagCount@CItemBagEx@@AAEHXZ PROC			; CItemBagEx::GetBagCount, COMDAT
; _this$ = ecx

; 88   : 	int GetBagCount(){return this->m_iBagObjectCount;}

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi
  00009	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0000f	8b 80 20 01 00
	00		 mov	 eax, DWORD PTR [eax+288]
  00015	5f		 pop	 edi
  00016	5e		 pop	 esi
  00017	5b		 pop	 ebx
  00018	8b e5		 mov	 esp, ebp
  0001a	5d		 pop	 ebp
  0001b	c3		 ret	 0
?GetBagCount@CItemBagEx@@AAEHXZ ENDP			; CItemBagEx::GetBagCount
_TEXT	ENDS
PUBLIC	?GetMinLevel@CItemBagEx@@QAEEH@Z		; CItemBagEx::GetMinLevel
; Function compile flags: /Odtp /ZI
; File d:\projects\exteam6.3\source\gameserver\gameserver\itembagex.cpp
_TEXT	SEGMENT
_this$ = -4						; size = 4
_n$ = 8							; size = 4
?GetMinLevel@CItemBagEx@@QAEEH@Z PROC			; CItemBagEx::GetMinLevel
; _this$ = ecx

; 380  : {

  011a0	55		 push	 ebp
  011a1	8b ec		 mov	 ebp, esp
  011a3	83 ec 44	 sub	 esp, 68			; 00000044H
  011a6	53		 push	 ebx
  011a7	56		 push	 esi
  011a8	57		 push	 edi
  011a9	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 381  : 	if ( n<0 || n > MAX_ITEMBAG_ATTR-1 )

  011ac	83 7d 08 00	 cmp	 DWORD PTR _n$[ebp], 0
  011b0	7c 09		 jl	 SHORT $LN1@GetMinLeve
  011b2	81 7d 08 95 00
	00 00		 cmp	 DWORD PTR _n$[ebp], 149	; 00000095H
  011b9	7e 04		 jle	 SHORT $LN2@GetMinLeve
$LN1@GetMinLeve:

; 382  : 		return 0;

  011bb	32 c0		 xor	 al, al
  011bd	eb 0d		 jmp	 SHORT $LN3@GetMinLeve
$LN2@GetMinLeve:

; 383  : 
; 384  : 	return this->BagObject[n].m_minLevel;

  011bf	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  011c2	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  011c5	8a 84 c1 34 02
	00 00		 mov	 al, BYTE PTR [ecx+eax*8+564]
$LN3@GetMinLeve:

; 385  : }

  011cc	5f		 pop	 edi
  011cd	5e		 pop	 esi
  011ce	5b		 pop	 ebx
  011cf	8b e5		 mov	 esp, ebp
  011d1	5d		 pop	 ebp
  011d2	c2 04 00	 ret	 4
?GetMinLevel@CItemBagEx@@QAEEH@Z ENDP			; CItemBagEx::GetMinLevel
_TEXT	ENDS
PUBLIC	?GetMaxLevel@CItemBagEx@@QAEEH@Z		; CItemBagEx::GetMaxLevel
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
_this$ = -4						; size = 4
_n$ = 8							; size = 4
?GetMaxLevel@CItemBagEx@@QAEEH@Z PROC			; CItemBagEx::GetMaxLevel
; _this$ = ecx

; 388  : {

  011e0	55		 push	 ebp
  011e1	8b ec		 mov	 ebp, esp
  011e3	83 ec 44	 sub	 esp, 68			; 00000044H
  011e6	53		 push	 ebx
  011e7	56		 push	 esi
  011e8	57		 push	 edi
  011e9	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 389  : 	if ( n<0 || n > MAX_ITEMBAG_ATTR-1 )

  011ec	83 7d 08 00	 cmp	 DWORD PTR _n$[ebp], 0
  011f0	7c 09		 jl	 SHORT $LN1@GetMaxLeve
  011f2	81 7d 08 95 00
	00 00		 cmp	 DWORD PTR _n$[ebp], 149	; 00000095H
  011f9	7e 04		 jle	 SHORT $LN2@GetMaxLeve
$LN1@GetMaxLeve:

; 390  : 		return 0;

  011fb	32 c0		 xor	 al, al
  011fd	eb 0d		 jmp	 SHORT $LN3@GetMaxLeve
$LN2@GetMaxLeve:

; 391  : 
; 392  : 	return this->BagObject[n].m_maxLevel;

  011ff	8b 45 08	 mov	 eax, DWORD PTR _n$[ebp]
  01202	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01205	8a 84 c1 35 02
	00 00		 mov	 al, BYTE PTR [ecx+eax*8+565]
$LN3@GetMaxLeve:

; 393  : }

  0120c	5f		 pop	 edi
  0120d	5e		 pop	 esi
  0120e	5b		 pop	 ebx
  0120f	8b e5		 mov	 esp, ebp
  01211	5d		 pop	 ebp
  01212	c2 04 00	 ret	 4
?GetMaxLevel@CItemBagEx@@QAEEH@Z ENDP			; CItemBagEx::GetMaxLevel
_TEXT	ENDS
PUBLIC	?PickItem@CItemBagEx@@QAEHAAVCItem@@AAH@Z	; CItemBagEx::PickItem
; Function compile flags: /Odtp /ZI
_TEXT	SEGMENT
_DropItemNum$ = -8					; size = 4
_this$ = -4						; size = 4
_objItem$ = 8						; size = 4
_nItemIndex$ = 12					; size = 4
?PickItem@CItemBagEx@@QAEHAAVCItem@@AAH@Z PROC		; CItemBagEx::PickItem
; _this$ = ecx

; 397  : {

  01220	55		 push	 ebp
  01221	8b ec		 mov	 ebp, esp
  01223	83 ec 48	 sub	 esp, 72			; 00000048H
  01226	53		 push	 ebx
  01227	56		 push	 esi
  01228	57		 push	 edi
  01229	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 398  : 	if ( this->m_bLoad == FALSE )

  0122c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0122f	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  01233	75 07		 jne	 SHORT $LN11@PickItem

; 399  : 		return FALSE;

  01235	33 c0		 xor	 eax, eax
  01237	e9 e3 01 00 00	 jmp	 $LN12@PickItem
$LN11@PickItem:

; 400  : 
; 401  : 	int DropItemNum;
; 402  : 
; 403  : 	if ( this->GetBagCount() > 0 )

  0123c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0123f	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  01244	85 c0		 test	 eax, eax
  01246	0f 8e d1 01 00
	00		 jle	 $LN10@PickItem

; 404  : 	{
; 405  : 		DropItemNum = rand() % this->GetBagCount();

  0124c	e8 00 00 00 00	 call	 _rand
  01251	8b f0		 mov	 esi, eax
  01253	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01256	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  0125b	8b c8		 mov	 ecx, eax
  0125d	8b c6		 mov	 eax, esi
  0125f	99		 cdq
  01260	f7 f9		 idiv	 ecx
  01262	89 55 f8	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 406  : 		nItemIndex = DropItemNum;

  01265	8b 45 0c	 mov	 eax, DWORD PTR _nItemIndex$[ebp]
  01268	8b 4d f8	 mov	 ecx, DWORD PTR _DropItemNum$[ebp]
  0126b	89 08		 mov	 DWORD PTR [eax], ecx

; 407  : 		objItem.m_Type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  0126d	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01270	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01273	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0127b	52		 push	 edx
  0127c	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0127f	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01282	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  0128a	52		 push	 edx
  0128b	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  01290	83 c4 08	 add	 esp, 8
  01293	8b 4d 08	 mov	 ecx, DWORD PTR _objItem$[ebp]
  01296	66 89 41 06	 mov	 WORD PTR [ecx+6], ax

; 408  : 		objItem.m_Level = this->GetLevel(DropItemNum);

  0129a	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0129d	50		 push	 eax
  0129e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  012a1	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  012a6	66 0f b6 c8	 movzx	 cx, al
  012aa	8b 55 08	 mov	 edx, DWORD PTR _objItem$[ebp]
  012ad	66 89 4a 08	 mov	 WORD PTR [edx+8], cx

; 409  : 
; 410  : 		if ( objItem.m_Type == -1 )

  012b1	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  012b4	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  012b8	83 f9 ff	 cmp	 ecx, -1
  012bb	75 07		 jne	 SHORT $LN9@PickItem

; 411  : 			return FALSE;

  012bd	33 c0		 xor	 eax, eax
  012bf	e9 5b 01 00 00	 jmp	 $LN12@PickItem
$LN9@PickItem:

; 412  : 
; 413  : 		if ( this->BagObject[DropItemNum].m_isskill != 0 )

  012c4	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  012c7	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  012ca	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  012d2	85 d2		 test	 edx, edx
  012d4	74 0a		 je	 SHORT $LN8@PickItem

; 414  : 			objItem.m_Option1 = 1;

  012d6	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  012d9	c6 80 94 00 00
	00 01		 mov	 BYTE PTR [eax+148], 1
$LN8@PickItem:

; 415  : 
; 416  : 		if ( this->BagObject[DropItemNum].m_isluck != 0 )

  012e0	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  012e3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  012e6	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  012ee	85 d2		 test	 edx, edx
  012f0	74 0a		 je	 SHORT $LN7@PickItem

; 417  : 			objItem.m_Option2 = 1;

  012f2	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  012f5	c6 80 95 00 00
	00 01		 mov	 BYTE PTR [eax+149], 1
$LN7@PickItem:

; 418  : 
; 419  : 		if ( this->BagObject[DropItemNum].m_isoption != 0 )

  012fc	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  012ff	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01302	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  0130a	85 d2		 test	 edx, edx
  0130c	74 0a		 je	 SHORT $LN6@PickItem

; 420  : 			objItem.m_Option3 = 1;

  0130e	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01311	c6 80 96 00 00
	00 01		 mov	 BYTE PTR [eax+150], 1
$LN6@PickItem:

; 421  : 
; 422  : 		if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  01318	8b 45 f8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0131b	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0131e	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  01326	85 d2		 test	 edx, edx
  01328	74 1e		 je	 SHORT $LN5@PickItem

; 423  : 		{
; 424  : 			objItem.m_NewOption = 1;

  0132a	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  0132d	c6 80 97 00 00
	00 01		 mov	 BYTE PTR [eax+151], 1

; 425  : 			objItem.m_Option1 = 0;

  01334	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01337	c6 80 94 00 00
	00 00		 mov	 BYTE PTR [eax+148], 0

; 426  : 			objItem.m_Option2 = 0;

  0133e	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01341	c6 80 95 00 00
	00 00		 mov	 BYTE PTR [eax+149], 0
$LN5@PickItem:

; 427  : 		}
; 428  : 
; 429  : 		if ( objItem.m_Type == ITEMGET(12,15) ||
; 430  : 			 objItem.m_Type == ITEMGET(14,13) ||
; 431  : 			 objItem.m_Type == ITEMGET(14,14) )

  01348	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  0134b	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  0134f	81 f9 0f 18 00
	00		 cmp	 ecx, 6159		; 0000180fH
  01355	74 1e		 je	 SHORT $LN3@PickItem
  01357	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  0135a	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  0135e	81 f9 0d 1c 00
	00		 cmp	 ecx, 7181		; 00001c0dH
  01364	74 0f		 je	 SHORT $LN3@PickItem
  01366	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01369	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  0136d	81 f9 0e 1c 00
	00		 cmp	 ecx, 7182		; 00001c0eH
  01373	75 27		 jne	 SHORT $LN4@PickItem
$LN3@PickItem:

; 432  : 		{
; 433  : 			objItem.m_Option1 = 0;

  01375	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01378	c6 80 94 00 00
	00 00		 mov	 BYTE PTR [eax+148], 0

; 434  : 			objItem.m_Option2 = 0;

  0137f	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01382	c6 80 95 00 00
	00 00		 mov	 BYTE PTR [eax+149], 0

; 435  : 			objItem.m_Option3 = 0;

  01389	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  0138c	c6 80 96 00 00
	00 00		 mov	 BYTE PTR [eax+150], 0

; 436  : 			objItem.m_Level = 0;

  01393	33 c0		 xor	 eax, eax
  01395	8b 4d 08	 mov	 ecx, DWORD PTR _objItem$[ebp]
  01398	66 89 41 08	 mov	 WORD PTR [ecx+8], ax
$LN4@PickItem:

; 437  : 		}
; 438  : 
; 439  : 		if ( objItem.m_Type == ITEMGET(13,0) ||
; 440  : 			 objItem.m_Type == ITEMGET(13,1) ||
; 441  : 			 objItem.m_Type == ITEMGET(13,2) ||
; 442  : 			 objItem.m_Type == ITEMGET(13,8) ||
; 443  : 			 objItem.m_Type == ITEMGET(13,9) ||
; 444  : 			 objItem.m_Type == ITEMGET(13,12) ||
; 445  : 			 objItem.m_Type == ITEMGET(13,13) )

  0139c	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  0139f	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013a3	81 f9 00 1a 00
	00		 cmp	 ecx, 6656		; 00001a00H
  013a9	74 5a		 je	 SHORT $LN1@PickItem
  013ab	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  013ae	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013b2	81 f9 01 1a 00
	00		 cmp	 ecx, 6657		; 00001a01H
  013b8	74 4b		 je	 SHORT $LN1@PickItem
  013ba	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  013bd	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013c1	81 f9 02 1a 00
	00		 cmp	 ecx, 6658		; 00001a02H
  013c7	74 3c		 je	 SHORT $LN1@PickItem
  013c9	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  013cc	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013d0	81 f9 08 1a 00
	00		 cmp	 ecx, 6664		; 00001a08H
  013d6	74 2d		 je	 SHORT $LN1@PickItem
  013d8	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  013db	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013df	81 f9 09 1a 00
	00		 cmp	 ecx, 6665		; 00001a09H
  013e5	74 1e		 je	 SHORT $LN1@PickItem
  013e7	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  013ea	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013ee	81 f9 0c 1a 00
	00		 cmp	 ecx, 6668		; 00001a0cH
  013f4	74 0f		 je	 SHORT $LN1@PickItem
  013f6	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  013f9	0f bf 48 06	 movsx	 ecx, WORD PTR [eax+6]
  013fd	81 f9 0d 1a 00
	00		 cmp	 ecx, 6669		; 00001a0dH
  01403	75 09		 jne	 SHORT $LN2@PickItem
$LN1@PickItem:

; 446  : 		{
; 447  : 			objItem.m_Level = 0;

  01405	33 c0		 xor	 eax, eax
  01407	8b 4d 08	 mov	 ecx, DWORD PTR _objItem$[ebp]
  0140a	66 89 41 08	 mov	 WORD PTR [ecx+8], ax
$LN2@PickItem:

; 448  : 		}
; 449  : 
; 450  : 		objItem.m_Durability = 0;

  0140e	8b 45 08	 mov	 eax, DWORD PTR _objItem$[ebp]
  01411	d9 ee		 fldz
  01413	d9 58 24	 fstp	 DWORD PTR [eax+36]

; 451  : 
; 452  : 		return TRUE;

  01416	b8 01 00 00 00	 mov	 eax, 1
  0141b	eb 02		 jmp	 SHORT $LN12@PickItem
$LN10@PickItem:

; 453  : 	}
; 454  : 
; 455  : 	return FALSE;

  0141d	33 c0		 xor	 eax, eax
$LN12@PickItem:

; 456  : }

  0141f	5f		 pop	 edi
  01420	5e		 pop	 esi
  01421	5b		 pop	 ebx
  01422	8b e5		 mov	 esp, ebp
  01424	5d		 pop	 ebp
  01425	c2 08 00	 ret	 8
?PickItem@CItemBagEx@@QAEHAAVCItem@@AAH@Z ENDP		; CItemBagEx::PickItem
_TEXT	ENDS
PUBLIC	??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@ ; `string'
PUBLIC	??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@ ; `string'
PUBLIC	?DropRedRibbonBoxEventItem@CItemBagEx@@QAEHH@Z	; CItemBagEx::DropRedRibbonBoxEventItem
EXTRN	?DataSend@@YAHHPAEK@Z:PROC			; DataSend
EXTRN	?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z:PROC	; MsgSendV2
EXTRN	?PHeadSubSetB@@YAXPAEEEH@Z:PROC			; PHeadSubSetB
EXTRN	?g_iRedRibbonBoxDropZen@@3HA:DWORD		; g_iRedRibbonBoxDropZen
EXTRN	?g_iRedRibbonBoxDropZenRate@@3HA:DWORD		; g_iRedRibbonBoxDropZenRate
;	COMDAT ??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@
CONST	SEGMENT
??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@ DB '[EVENT'
	DB	' CHRISTMAS RIBBONBOX ] REDRIBBONBOX Event ItemDrop [%s][%s] ['
	DB	'%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d E'
	DB	'x:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@
CONST	SEGMENT
??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@ DB '[EVENT '
	DB	'CHRISTMAS RIBBONBOX] RIBBONBOX Event ItemDrop [%s][%s] [%d Ze'
	DB	'n]', 00H					; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv307 = -136						; size = 4
tv305 = -132						; size = 4
tv302 = -126						; size = 2
_ServerCmd$228274 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropRedRibbonBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropRedRibbonBoxEventItem
; _this$ = ecx

; 459  : {

  01430	55		 push	 ebp
  01431	8b ec		 mov	 ebp, esp
  01433	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  01439	53		 push	 ebx
  0143a	56		 push	 esi
  0143b	57		 push	 edi
  0143c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 460  : 	if ( this->m_bLoad == FALSE )

  0143f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  01442	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  01446	75 07		 jne	 SHORT $LN15@DropRedRib

; 461  : 		return FALSE;

  01448	33 c0		 xor	 eax, eax
  0144a	e9 92 03 00 00	 jmp	 $LN16@DropRedRib
$LN15@DropRedRib:

; 462  : 
; 463  : 	float dur;
; 464  : 	int type;
; 465  : 	int level;
; 466  : 	int x;
; 467  : 	int y;
; 468  : 	int Option1 = 0;

  0144f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 469  : 	int Option2 = 0;

  01456	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 470  : 	int Option3 = 0;

  0145d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 471  : 	int DropItemRate;
; 472  : 	int DropItemNum;
; 473  : 	int ExOption = 0;

  01464	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 474  : 	LPOBJ lpObj = &gObj[aIndex];

  0146b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0146e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01474	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0147a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 475  : 
; 476  : 	if ( this->GetBagCount() > 0 )

  0147d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01480	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  01485	85 c0		 test	 eax, eax
  01487	0f 8e 4f 03 00
	00		 jle	 $LN14@DropRedRib

; 477  : 	{
; 478  : 		DropItemRate = rand() % 10000;

  0148d	e8 00 00 00 00	 call	 _rand
  01492	99		 cdq
  01493	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  01498	f7 f9		 idiv	 ecx
  0149a	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 479  : 
; 480  : 		if ( DropItemRate < g_iRedRibbonBoxDropZenRate )

  0149d	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  014a0	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iRedRibbonBoxDropZenRate@@3HA ; g_iRedRibbonBoxDropZenRate
  014a6	7d 5f		 jge	 SHORT $LN13@DropRedRib

; 481  : 		{
; 482  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iRedRibbonBoxDropZen, 
; 483  : 				lpObj->X, lpObj->Y);

  014a8	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  014ab	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  014b2	51		 push	 ecx
  014b3	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  014b6	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  014bd	50		 push	 eax
  014be	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iRedRibbonBoxDropZen@@3HA ; g_iRedRibbonBoxDropZen
  014c4	51		 push	 ecx
  014c5	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  014c8	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  014cf	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  014d5	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  014db	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 484  : 
; 485  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX] RIBBONBOX Event ItemDrop [%s][%s] [%d Zen]",
; 486  : 				lpObj->AccountID, lpObj->Name,
; 487  : 				g_iRedRibbonBoxDropZen);

  014e0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iRedRibbonBoxDropZen@@3HA ; g_iRedRibbonBoxDropZen
  014e5	50		 push	 eax
  014e6	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  014e9	83 c1 77	 add	 ecx, 119		; 00000077H
  014ec	51		 push	 ecx
  014ed	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  014f0	83 c2 6c	 add	 edx, 108		; 0000006cH
  014f3	52		 push	 edx
  014f4	68 00 00 00 00	 push	 OFFSET ??_C@_0EH@BHMHGNEI@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5RIBB@
  014f9	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  014ff	83 c4 10	 add	 esp, 16			; 00000010H

; 488  : 		}
; 489  : 		else

  01502	e9 7e 02 00 00	 jmp	 $LN12@DropRedRib
$LN13@DropRedRib:

; 490  : 		{
; 491  : 			DropItemNum = rand() % this->GetBagCount();

  01507	e8 00 00 00 00	 call	 _rand
  0150c	8b f0		 mov	 esi, eax
  0150e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01511	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  01516	8b c8		 mov	 ecx, eax
  01518	8b c6		 mov	 eax, esi
  0151a	99		 cdq
  0151b	f7 f9		 idiv	 ecx
  0151d	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 492  : 			dur = 0;

  01520	d9 ee		 fldz
  01522	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 493  : 			x = lpObj->X;

  01525	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01528	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  0152f	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 494  : 			y = lpObj->Y;

  01532	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01535	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0153c	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 495  : 			level = this->GetLevel(DropItemNum);

  0153f	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01542	50		 push	 eax
  01543	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01546	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  0154b	0f b6 c8	 movzx	 ecx, al
  0154e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 496  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  01551	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01554	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01557	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0155f	52		 push	 edx
  01560	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01563	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01566	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  0156e	52		 push	 edx
  0156f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  01574	83 c4 08	 add	 esp, 8
  01577	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 497  : 
; 498  : 			if ( type == -1 )

  0157a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  0157e	75 07		 jne	 SHORT $LN11@DropRedRib

; 499  : 				return FALSE;

  01580	33 c0		 xor	 eax, eax
  01582	e9 5a 02 00 00	 jmp	 $LN16@DropRedRib
$LN11@DropRedRib:

; 500  : 
; 501  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  01587	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0158a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0158d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  01595	85 d2		 test	 edx, edx
  01597	74 07		 je	 SHORT $LN10@DropRedRib

; 502  : 				Option1 = 1;

  01599	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN10@DropRedRib:

; 503  : 
; 504  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  015a0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  015a3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  015a6	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  015ae	85 d2		 test	 edx, edx
  015b0	74 23		 je	 SHORT $LN8@DropRedRib

; 505  : 			{
; 506  : 				Option2 = 0;

  015b2	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 507  : 
; 508  : 				if ( (rand()%2) == 0 )

  015b9	e8 00 00 00 00	 call	 _rand
  015be	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  015c3	79 05		 jns	 SHORT $LN18@DropRedRib
  015c5	48		 dec	 eax
  015c6	83 c8 fe	 or	 eax, -2			; fffffffeH
  015c9	40		 inc	 eax
$LN18@DropRedRib:
  015ca	85 c0		 test	 eax, eax
  015cc	75 07		 jne	 SHORT $LN8@DropRedRib

; 509  : 				{
; 510  : 					Option2 = 1;

  015ce	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN8@DropRedRib:

; 511  : 				}
; 512  : 			}
; 513  : 
; 514  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  015d5	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  015d8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  015db	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  015e3	85 d2		 test	 edx, edx
  015e5	74 2b		 je	 SHORT $LN5@DropRedRib

; 515  : 			{
; 516  : 				if ( (rand()%5) < 1 )

  015e7	e8 00 00 00 00	 call	 _rand
  015ec	99		 cdq
  015ed	b9 05 00 00 00	 mov	 ecx, 5
  015f2	f7 f9		 idiv	 ecx
  015f4	83 fa 01	 cmp	 edx, 1
  015f7	7d 09		 jge	 SHORT $LN6@DropRedRib

; 517  : 				{
; 518  : 					Option3 = 3;

  015f9	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 519  : 				}
; 520  : 				else

  01600	eb 10		 jmp	 SHORT $LN5@DropRedRib
$LN6@DropRedRib:

; 521  : 				{
; 522  : 					Option3 = rand() % 3;

  01602	e8 00 00 00 00	 call	 _rand
  01607	99		 cdq
  01608	b9 03 00 00 00	 mov	 ecx, 3
  0160d	f7 f9		 idiv	 ecx
  0160f	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN5@DropRedRib:

; 523  : 				}
; 524  : 			}
; 525  : 
; 526  : 			ExOption = 0;

  01612	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 527  : 
; 528  : 			if ( type == ITEMGET(12,15) ||
; 529  : 				 type == ITEMGET(14,13) ||
; 530  : 				 type == ITEMGET(14,14) )

  01619	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  01620	74 12		 je	 SHORT $LN3@DropRedRib
  01622	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  01629	74 09		 je	 SHORT $LN3@DropRedRib
  0162b	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  01632	75 1c		 jne	 SHORT $LN4@DropRedRib
$LN3@DropRedRib:

; 531  : 			{
; 532  : 				Option1 = 0;

  01634	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 533  : 				Option2 = 0;

  0163b	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 534  : 				Option3 = 0;

  01642	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 535  : 				level = 0;

  01649	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropRedRib:

; 536  : 			}
; 537  : 
; 538  : 			if ( type == ITEMGET(14,19) ||
; 539  : 				 type == ITEMGET(14,28) ||
; 540  : 				 type == ITEMGET(13,18) )

  01650	81 7d f4 13 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7187 ; 00001c13H
  01657	74 12		 je	 SHORT $LN1@DropRedRib
  01659	81 7d f4 1c 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7196 ; 00001c1cH
  01660	74 09		 je	 SHORT $LN1@DropRedRib
  01662	81 7d f4 12 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6674 ; 00001a12H
  01669	75 15		 jne	 SHORT $LN2@DropRedRib
$LN1@DropRedRib:

; 541  : 			{
; 542  : 				Option1 = 0;

  0166b	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 543  : 				Option2 = 0;

  01672	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 544  : 				Option3 = 0;

  01679	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0
$LN2@DropRedRib:

; 545  : 			}
; 546  : 			
; 547  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 548  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  01680	6a 00		 push	 0
  01682	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  01686	50		 push	 eax
  01687	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0168a	8b 11		 mov	 edx, DWORD PTR [ecx]
  0168c	52		 push	 edx
  0168d	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  01691	50		 push	 eax
  01692	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  01696	51		 push	 ecx
  01697	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  0169b	52		 push	 edx
  0169c	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  0169f	d9 7d 82	 fnstcw	 WORD PTR tv302[ebp]
  016a2	0f b7 45 82	 movzx	 eax, WORD PTR tv302[ebp]
  016a6	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  016ab	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv305[ebp], eax
  016b1	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv305[ebp]
  016b7	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv307[ebp]
  016bd	d9 6d 82	 fldcw	 WORD PTR tv302[ebp]
  016c0	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv307[ebp]
  016c7	50		 push	 eax
  016c8	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  016cc	51		 push	 ecx
  016cd	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  016d0	52		 push	 edx
  016d1	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  016d5	50		 push	 eax
  016d6	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  016da	51		 push	 ecx
  016db	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  016de	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  016e5	50		 push	 eax
  016e6	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  016e9	8b 11		 mov	 edx, DWORD PTR [ecx]
  016eb	52		 push	 edx
  016ec	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  016f1	83 c4 34	 add	 esp, 52			; 00000034H

; 549  : 
; 550  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX ] REDRIBBONBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 551  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 552  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 553  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  016f4	6a 00		 push	 0
  016f6	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  016f9	83 e0 01	 and	 eax, 1
  016fc	50		 push	 eax
  016fd	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  01700	83 e1 02	 and	 ecx, 2
  01703	d1 f9		 sar	 ecx, 1
  01705	51		 push	 ecx
  01706	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  01709	83 e2 04	 and	 edx, 4
  0170c	c1 fa 02	 sar	 edx, 2
  0170f	52		 push	 edx
  01710	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  01713	83 e0 08	 and	 eax, 8
  01716	c1 f8 03	 sar	 eax, 3
  01719	50		 push	 eax
  0171a	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  0171d	83 e1 10	 and	 ecx, 16			; 00000010H
  01720	c1 f9 04	 sar	 ecx, 4
  01723	51		 push	 ecx
  01724	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  01727	83 e2 20	 and	 edx, 32			; 00000020H
  0172a	c1 fa 05	 sar	 edx, 5
  0172d	52		 push	 edx
  0172e	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  01731	50		 push	 eax
  01732	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  01735	51		 push	 ecx
  01736	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  01739	52		 push	 edx
  0173a	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  0173d	50		 push	 eax
  0173e	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  01741	51		 push	 ecx
  01742	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  01745	6b d2 70	 imul	 edx, 112		; 00000070H
  01748	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0174e	52		 push	 edx
  0174f	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  01752	50		 push	 eax
  01753	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  01756	51		 push	 ecx
  01757	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  0175a	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  01761	50		 push	 eax
  01762	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01765	83 c1 08	 add	 ecx, 8
  01768	51		 push	 ecx
  01769	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  0176c	83 c2 77	 add	 edx, 119		; 00000077H
  0176f	52		 push	 edx
  01770	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01773	83 c0 6c	 add	 eax, 108		; 0000006cH
  01776	50		 push	 eax
  01777	68 00 00 00 00	 push	 OFFSET ??_C@_0JJ@BMBIJJKC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5RED@
  0177c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  01782	83 c4 50	 add	 esp, 80			; 00000050H
$LN12@DropRedRib:

; 554  : 		}
; 555  : 
; 556  : 		PMSG_SERVERCMD ServerCmd;
; 557  : 
; 558  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  01785	6a 07		 push	 7
  01787	6a 40		 push	 64			; 00000040H
  01789	68 f3 00 00 00	 push	 243			; 000000f3H
  0178e	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228274[ebp]
  01791	50		 push	 eax
  01792	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  01797	83 c4 10	 add	 esp, 16			; 00000010H

; 559  : 		ServerCmd.CmdType = 0;

  0179a	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228274[ebp+4], 0

; 560  : 		ServerCmd.X = lpObj->X;

  0179e	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  017a1	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  017a7	88 4d c9	 mov	 BYTE PTR _ServerCmd$228274[ebp+5], cl

; 561  : 		ServerCmd.Y = lpObj->Y;

  017aa	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  017ad	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  017b3	88 4d ca	 mov	 BYTE PTR _ServerCmd$228274[ebp+6], cl

; 562  : 
; 563  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  017b6	6a 07		 push	 7
  017b8	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228274[ebp]
  017bb	50		 push	 eax
  017bc	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  017bf	51		 push	 ecx
  017c0	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  017c5	83 c4 0c	 add	 esp, 12			; 0000000cH

; 564  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  017c8	6a 07		 push	 7
  017ca	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228274[ebp]
  017cd	50		 push	 eax
  017ce	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  017d1	8b 11		 mov	 edx, DWORD PTR [ecx]
  017d3	52		 push	 edx
  017d4	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  017d9	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN14@DropRedRib:

; 565  : 	}
; 566  : 
; 567  : 	return TRUE;

  017dc	b8 01 00 00 00	 mov	 eax, 1
$LN16@DropRedRib:

; 568  : }

  017e1	5f		 pop	 edi
  017e2	5e		 pop	 esi
  017e3	5b		 pop	 ebx
  017e4	8b e5		 mov	 esp, ebp
  017e6	5d		 pop	 ebp
  017e7	c2 04 00	 ret	 4
?DropRedRibbonBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropRedRibbonBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@ ; `string'
PUBLIC	??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@ ; `string'
PUBLIC	?DropGreenRibbonBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropGreenRibbonBoxEventItem
EXTRN	?g_iGreenRibbonBoxDropZen@@3HA:DWORD		; g_iGreenRibbonBoxDropZen
EXTRN	?g_iGreenRibbonBoxDropZenRate@@3HA:DWORD	; g_iGreenRibbonBoxDropZenRate
;	COMDAT ??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@
CONST	SEGMENT
??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@ DB '[EVENT'
	DB	' CHRISTMAS RIBBONBOX ] GREENRIBBONBOX Event ItemDrop [%s][%s]'
	DB	' [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d'
	DB	' Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@
CONST	SEGMENT
??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@ DB '[EVENT '
	DB	'CHRISTMAS RIBBONBOX] GREENRIBBONBOX Event ItemDrop [%s][%s] ['
	DB	'%d Zen]', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv321 = -136						; size = 4
tv319 = -132						; size = 4
tv316 = -126						; size = 2
_ServerCmd$228321 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropGreenRibbonBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropGreenRibbonBoxEventItem
; _this$ = ecx

; 572  : {

  017f0	55		 push	 ebp
  017f1	8b ec		 mov	 ebp, esp
  017f3	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  017f9	53		 push	 ebx
  017fa	56		 push	 esi
  017fb	57		 push	 edi
  017fc	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 573  : 	if ( this->m_bLoad == FALSE )

  017ff	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  01802	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  01806	75 07		 jne	 SHORT $LN16@DropGreenR

; 574  : 		return FALSE;

  01808	33 c0		 xor	 eax, eax
  0180a	e9 c6 03 00 00	 jmp	 $LN17@DropGreenR
$LN16@DropGreenR:

; 575  : 
; 576  : 	float dur;
; 577  : 	int type;
; 578  : 	int level;
; 579  : 	int x;
; 580  : 	int y;
; 581  : 	int Option1 = 0;

  0180f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 582  : 	int Option2 = 0;

  01816	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 583  : 	int Option3 = 0;

  0181d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 584  : 	int DropItemRate;
; 585  : 	int DropItemNum;
; 586  : 	int ExOption = 0;

  01824	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 587  : 	LPOBJ lpObj = &gObj[aIndex];

  0182b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0182e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01834	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0183a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 588  : 
; 589  : 	if ( this->GetBagCount() > 0 )

  0183d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01840	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  01845	85 c0		 test	 eax, eax
  01847	0f 8e 83 03 00
	00		 jle	 $LN15@DropGreenR

; 590  : 	{
; 591  : 		DropItemRate = rand() % 10000;

  0184d	e8 00 00 00 00	 call	 _rand
  01852	99		 cdq
  01853	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  01858	f7 f9		 idiv	 ecx
  0185a	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 592  : 
; 593  : 		if ( DropItemRate < g_iGreenRibbonBoxDropZenRate )

  0185d	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  01860	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iGreenRibbonBoxDropZenRate@@3HA ; g_iGreenRibbonBoxDropZenRate
  01866	7d 5f		 jge	 SHORT $LN14@DropGreenR

; 594  : 		{
; 595  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iGreenRibbonBoxDropZen, 
; 596  : 				lpObj->X, lpObj->Y);

  01868	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0186b	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  01872	51		 push	 ecx
  01873	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01876	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  0187d	50		 push	 eax
  0187e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iGreenRibbonBoxDropZen@@3HA ; g_iGreenRibbonBoxDropZen
  01884	51		 push	 ecx
  01885	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01888	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  0188f	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  01895	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0189b	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 597  : 
; 598  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX] GREENRIBBONBOX Event ItemDrop [%s][%s] [%d Zen]",
; 599  : 				lpObj->AccountID, lpObj->Name,
; 600  : 				g_iGreenRibbonBoxDropZen);

  018a0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iGreenRibbonBoxDropZen@@3HA ; g_iGreenRibbonBoxDropZen
  018a5	50		 push	 eax
  018a6	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  018a9	83 c1 77	 add	 ecx, 119		; 00000077H
  018ac	51		 push	 ecx
  018ad	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  018b0	83 c2 6c	 add	 edx, 108		; 0000006cH
  018b3	52		 push	 edx
  018b4	68 00 00 00 00	 push	 OFFSET ??_C@_0EM@PFFONPLH@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5GREE@
  018b9	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  018bf	83 c4 10	 add	 esp, 16			; 00000010H

; 601  : 		}
; 602  : 		else

  018c2	e9 b2 02 00 00	 jmp	 $LN13@DropGreenR
$LN14@DropGreenR:

; 603  : 		{
; 604  : 			DropItemNum = rand() % this->GetBagCount();

  018c7	e8 00 00 00 00	 call	 _rand
  018cc	8b f0		 mov	 esi, eax
  018ce	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  018d1	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  018d6	8b c8		 mov	 ecx, eax
  018d8	8b c6		 mov	 eax, esi
  018da	99		 cdq
  018db	f7 f9		 idiv	 ecx
  018dd	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 605  : 			dur = 0;

  018e0	d9 ee		 fldz
  018e2	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 606  : 			x = lpObj->X;

  018e5	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  018e8	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  018ef	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 607  : 			y = lpObj->Y;

  018f2	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  018f5	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  018fc	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 608  : 			level = this->GetLevel(DropItemNum);

  018ff	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01902	50		 push	 eax
  01903	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01906	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  0190b	0f b6 c8	 movzx	 ecx, al
  0190e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 609  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  01911	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01914	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01917	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0191f	52		 push	 edx
  01920	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01923	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01926	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  0192e	52		 push	 edx
  0192f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  01934	83 c4 08	 add	 esp, 8
  01937	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 610  : 
; 611  : 			if ( type == -1 )

  0193a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  0193e	75 07		 jne	 SHORT $LN12@DropGreenR

; 612  : 				return FALSE;

  01940	33 c0		 xor	 eax, eax
  01942	e9 8e 02 00 00	 jmp	 $LN17@DropGreenR
$LN12@DropGreenR:

; 613  : 
; 614  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  01947	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0194a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0194d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  01955	85 d2		 test	 edx, edx
  01957	74 07		 je	 SHORT $LN11@DropGreenR

; 615  : 				Option1 = 1;

  01959	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropGreenR:

; 616  : 
; 617  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  01960	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01963	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01966	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  0196e	85 d2		 test	 edx, edx
  01970	74 23		 je	 SHORT $LN9@DropGreenR

; 618  : 			{
; 619  : 				Option2 = 0;

  01972	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 620  : 
; 621  : 				if ( (rand()%2) == 0 )

  01979	e8 00 00 00 00	 call	 _rand
  0197e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  01983	79 05		 jns	 SHORT $LN19@DropGreenR
  01985	48		 dec	 eax
  01986	83 c8 fe	 or	 eax, -2			; fffffffeH
  01989	40		 inc	 eax
$LN19@DropGreenR:
  0198a	85 c0		 test	 eax, eax
  0198c	75 07		 jne	 SHORT $LN9@DropGreenR

; 622  : 				{
; 623  : 					Option2 = 1;

  0198e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropGreenR:

; 624  : 				}
; 625  : 			}
; 626  : 
; 627  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  01995	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01998	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0199b	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  019a3	85 d2		 test	 edx, edx
  019a5	74 2b		 je	 SHORT $LN6@DropGreenR

; 628  : 			{
; 629  : 				if ( (rand()%5) < 1 )

  019a7	e8 00 00 00 00	 call	 _rand
  019ac	99		 cdq
  019ad	b9 05 00 00 00	 mov	 ecx, 5
  019b2	f7 f9		 idiv	 ecx
  019b4	83 fa 01	 cmp	 edx, 1
  019b7	7d 09		 jge	 SHORT $LN7@DropGreenR

; 630  : 				{
; 631  : 					Option3 = 3;

  019b9	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 632  : 				}
; 633  : 				else

  019c0	eb 10		 jmp	 SHORT $LN6@DropGreenR
$LN7@DropGreenR:

; 634  : 				{
; 635  : 					Option3 = rand() % 3;

  019c2	e8 00 00 00 00	 call	 _rand
  019c7	99		 cdq
  019c8	b9 03 00 00 00	 mov	 ecx, 3
  019cd	f7 f9		 idiv	 ecx
  019cf	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropGreenR:

; 636  : 				}
; 637  : 			}
; 638  : 
; 639  : 			if ( this->BagObject[DropItemNum].m_isexitem )

  019d2	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  019d5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  019d8	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  019e0	85 d2		 test	 edx, edx
  019e2	74 20		 je	 SHORT $LN5@DropGreenR

; 640  : 			{
; 641  : 				ExOption = NewOptionRand(level);

  019e4	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  019e7	50		 push	 eax
  019e8	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  019ed	83 c4 04	 add	 esp, 4
  019f0	0f b6 c8	 movzx	 ecx, al
  019f3	89 4d d0	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 642  : #ifndef _FIX_
; 643  : 				Option2 = 0;
; 644  : #endif
; 645  : 				Option1 = 1;

  019f6	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1

; 646  : 				level = 0;

  019fd	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN5@DropGreenR:

; 647  : 			}
; 648  : 
; 649  : 			if ( type == ITEMGET(12,15) ||
; 650  : 				 type == ITEMGET(14,13) ||
; 651  : 				 type == ITEMGET(14,14) ||
; 652  : 				 type == ITEMGET(14,16) )

  01a04	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  01a0b	74 1b		 je	 SHORT $LN3@DropGreenR
  01a0d	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  01a14	74 12		 je	 SHORT $LN3@DropGreenR
  01a16	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  01a1d	74 09		 je	 SHORT $LN3@DropGreenR
  01a1f	81 7d f4 10 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7184 ; 00001c10H
  01a26	75 1c		 jne	 SHORT $LN4@DropGreenR
$LN3@DropGreenR:

; 653  : 			{
; 654  : 				Option1 = 0;

  01a28	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 655  : 				Option2 = 0;

  01a2f	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 656  : 				Option3 = 0;

  01a36	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 657  : 				level = 0;

  01a3d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropGreenR:

; 658  : 			}
; 659  : 
; 660  : 			if ( type == ITEMGET(14,19) ||
; 661  : 				 type == ITEMGET(14,28) ||
; 662  : 				 type == ITEMGET(13,18) )

  01a44	81 7d f4 13 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7187 ; 00001c13H
  01a4b	74 12		 je	 SHORT $LN1@DropGreenR
  01a4d	81 7d f4 1c 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7196 ; 00001c1cH
  01a54	74 09		 je	 SHORT $LN1@DropGreenR
  01a56	81 7d f4 12 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6674 ; 00001a12H
  01a5d	75 15		 jne	 SHORT $LN2@DropGreenR
$LN1@DropGreenR:

; 663  : 			{
; 664  : 				Option1 = 0;

  01a5f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 665  : 				Option2 = 0;

  01a66	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 666  : 				Option3 = 0;

  01a6d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0
$LN2@DropGreenR:

; 667  : 			}
; 668  : 			
; 669  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 670  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  01a74	6a 00		 push	 0
  01a76	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  01a7a	50		 push	 eax
  01a7b	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01a7e	8b 11		 mov	 edx, DWORD PTR [ecx]
  01a80	52		 push	 edx
  01a81	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  01a85	50		 push	 eax
  01a86	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  01a8a	51		 push	 ecx
  01a8b	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  01a8f	52		 push	 edx
  01a90	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  01a93	d9 7d 82	 fnstcw	 WORD PTR tv316[ebp]
  01a96	0f b7 45 82	 movzx	 eax, WORD PTR tv316[ebp]
  01a9a	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  01a9f	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv319[ebp], eax
  01aa5	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv319[ebp]
  01aab	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv321[ebp]
  01ab1	d9 6d 82	 fldcw	 WORD PTR tv316[ebp]
  01ab4	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv321[ebp]
  01abb	50		 push	 eax
  01abc	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  01ac0	51		 push	 ecx
  01ac1	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  01ac4	52		 push	 edx
  01ac5	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  01ac9	50		 push	 eax
  01aca	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  01ace	51		 push	 ecx
  01acf	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01ad2	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  01ad9	50		 push	 eax
  01ada	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01add	8b 11		 mov	 edx, DWORD PTR [ecx]
  01adf	52		 push	 edx
  01ae0	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  01ae5	83 c4 34	 add	 esp, 52			; 00000034H

; 671  : 
; 672  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX ] GREENRIBBONBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 673  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 674  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 675  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  01ae8	6a 00		 push	 0
  01aea	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  01aed	83 e0 01	 and	 eax, 1
  01af0	50		 push	 eax
  01af1	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  01af4	83 e1 02	 and	 ecx, 2
  01af7	d1 f9		 sar	 ecx, 1
  01af9	51		 push	 ecx
  01afa	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  01afd	83 e2 04	 and	 edx, 4
  01b00	c1 fa 02	 sar	 edx, 2
  01b03	52		 push	 edx
  01b04	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  01b07	83 e0 08	 and	 eax, 8
  01b0a	c1 f8 03	 sar	 eax, 3
  01b0d	50		 push	 eax
  01b0e	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  01b11	83 e1 10	 and	 ecx, 16			; 00000010H
  01b14	c1 f9 04	 sar	 ecx, 4
  01b17	51		 push	 ecx
  01b18	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  01b1b	83 e2 20	 and	 edx, 32			; 00000020H
  01b1e	c1 fa 05	 sar	 edx, 5
  01b21	52		 push	 edx
  01b22	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  01b25	50		 push	 eax
  01b26	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  01b29	51		 push	 ecx
  01b2a	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  01b2d	52		 push	 edx
  01b2e	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  01b31	50		 push	 eax
  01b32	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  01b35	51		 push	 ecx
  01b36	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  01b39	6b d2 70	 imul	 edx, 112		; 00000070H
  01b3c	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  01b42	52		 push	 edx
  01b43	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  01b46	50		 push	 eax
  01b47	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  01b4a	51		 push	 ecx
  01b4b	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01b4e	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  01b55	50		 push	 eax
  01b56	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01b59	83 c1 08	 add	 ecx, 8
  01b5c	51		 push	 ecx
  01b5d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01b60	83 c2 77	 add	 edx, 119		; 00000077H
  01b63	52		 push	 edx
  01b64	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01b67	83 c0 6c	 add	 eax, 108		; 0000006cH
  01b6a	50		 push	 eax
  01b6b	68 00 00 00 00	 push	 OFFSET ??_C@_0JL@ICGIGFIG@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5GRE@
  01b70	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  01b76	83 c4 50	 add	 esp, 80			; 00000050H
$LN13@DropGreenR:

; 676  : 		}
; 677  : 
; 678  : 		PMSG_SERVERCMD ServerCmd;
; 679  : 
; 680  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  01b79	6a 07		 push	 7
  01b7b	6a 40		 push	 64			; 00000040H
  01b7d	68 f3 00 00 00	 push	 243			; 000000f3H
  01b82	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228321[ebp]
  01b85	50		 push	 eax
  01b86	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  01b8b	83 c4 10	 add	 esp, 16			; 00000010H

; 681  : 		ServerCmd.CmdType = 0;

  01b8e	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228321[ebp+4], 0

; 682  : 		ServerCmd.X = lpObj->X;

  01b92	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01b95	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  01b9b	88 4d c9	 mov	 BYTE PTR _ServerCmd$228321[ebp+5], cl

; 683  : 		ServerCmd.Y = lpObj->Y;

  01b9e	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01ba1	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  01ba7	88 4d ca	 mov	 BYTE PTR _ServerCmd$228321[ebp+6], cl

; 684  : 
; 685  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  01baa	6a 07		 push	 7
  01bac	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228321[ebp]
  01baf	50		 push	 eax
  01bb0	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01bb3	51		 push	 ecx
  01bb4	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  01bb9	83 c4 0c	 add	 esp, 12			; 0000000cH

; 686  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  01bbc	6a 07		 push	 7
  01bbe	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228321[ebp]
  01bc1	50		 push	 eax
  01bc2	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01bc5	8b 11		 mov	 edx, DWORD PTR [ecx]
  01bc7	52		 push	 edx
  01bc8	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  01bcd	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@DropGreenR:

; 687  : 	}
; 688  : 
; 689  : 	return TRUE;

  01bd0	b8 01 00 00 00	 mov	 eax, 1
$LN17@DropGreenR:

; 690  : }

  01bd5	5f		 pop	 edi
  01bd6	5e		 pop	 esi
  01bd7	5b		 pop	 ebx
  01bd8	8b e5		 mov	 esp, ebp
  01bda	5d		 pop	 ebp
  01bdb	c2 04 00	 ret	 4
?DropGreenRibbonBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropGreenRibbonBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@ ; `string'
PUBLIC	??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@ ; `string'
PUBLIC	?DropBlueRibbonBoxEventItem@CItemBagEx@@QAEHH@Z	; CItemBagEx::DropBlueRibbonBoxEventItem
EXTRN	?g_iBlueRibbonBoxDropZen@@3HA:DWORD		; g_iBlueRibbonBoxDropZen
EXTRN	?g_iBlueRibbonBoxDropZenRate@@3HA:DWORD		; g_iBlueRibbonBoxDropZenRate
;	COMDAT ??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@
CONST	SEGMENT
??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@ DB '[EVENT'
	DB	' CHRISTMAS RIBBONBOX ] BLUERIBBONBOX Event ItemDrop [%s][%s] '
	DB	'[%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d '
	DB	'Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@
CONST	SEGMENT
??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@ DB '[EVENT '
	DB	'CHRISTMAS RIBBONBOX] BLUERIBBONBOX Event ItemDrop [%s][%s] [%'
	DB	'd Zen]', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv321 = -136						; size = 4
tv319 = -132						; size = 4
tv316 = -126						; size = 2
_ServerCmd$228368 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropBlueRibbonBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropBlueRibbonBoxEventItem
; _this$ = ecx

; 696  : {

  01be0	55		 push	 ebp
  01be1	8b ec		 mov	 ebp, esp
  01be3	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  01be9	53		 push	 ebx
  01bea	56		 push	 esi
  01beb	57		 push	 edi
  01bec	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 697  : 	if ( this->m_bLoad == FALSE )

  01bef	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  01bf2	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  01bf6	75 07		 jne	 SHORT $LN16@DropBlueRi

; 698  : 		return FALSE;

  01bf8	33 c0		 xor	 eax, eax
  01bfa	e9 b8 03 00 00	 jmp	 $LN17@DropBlueRi
$LN16@DropBlueRi:

; 699  : 
; 700  : 	float dur;
; 701  : 	int type;
; 702  : 	int level;
; 703  : 	int x;
; 704  : 	int y;
; 705  : 	int Option1 = 0;

  01bff	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 706  : 	int Option2 = 0;

  01c06	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 707  : 	int Option3 = 0;

  01c0d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 708  : 	int DropItemRate;
; 709  : 	int DropItemNum;
; 710  : 	int ExOption = 0;

  01c14	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 711  : 	LPOBJ lpObj = &gObj[aIndex];

  01c1b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01c1e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  01c24	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  01c2a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 712  : 
; 713  : 	if ( this->GetBagCount() > 0 )

  01c2d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01c30	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  01c35	85 c0		 test	 eax, eax
  01c37	0f 8e 75 03 00
	00		 jle	 $LN15@DropBlueRi

; 714  : 	{
; 715  : 		DropItemRate = rand() % 10000;

  01c3d	e8 00 00 00 00	 call	 _rand
  01c42	99		 cdq
  01c43	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  01c48	f7 f9		 idiv	 ecx
  01c4a	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 716  : 
; 717  : 		if ( DropItemRate < g_iBlueRibbonBoxDropZenRate )

  01c4d	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  01c50	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iBlueRibbonBoxDropZenRate@@3HA ; g_iBlueRibbonBoxDropZenRate
  01c56	7d 5f		 jge	 SHORT $LN14@DropBlueRi

; 718  : 		{
; 719  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iBlueRibbonBoxDropZen, 
; 720  : 				lpObj->X, lpObj->Y);

  01c58	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01c5b	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  01c62	51		 push	 ecx
  01c63	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01c66	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  01c6d	50		 push	 eax
  01c6e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iBlueRibbonBoxDropZen@@3HA ; g_iBlueRibbonBoxDropZen
  01c74	51		 push	 ecx
  01c75	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01c78	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  01c7f	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  01c85	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  01c8b	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 721  : 
; 722  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX] BLUERIBBONBOX Event ItemDrop [%s][%s] [%d Zen]",
; 723  : 				lpObj->AccountID, lpObj->Name,
; 724  : 				g_iBlueRibbonBoxDropZen);

  01c90	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iBlueRibbonBoxDropZen@@3HA ; g_iBlueRibbonBoxDropZen
  01c95	50		 push	 eax
  01c96	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01c99	83 c1 77	 add	 ecx, 119		; 00000077H
  01c9c	51		 push	 ecx
  01c9d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01ca0	83 c2 6c	 add	 edx, 108		; 0000006cH
  01ca3	52		 push	 edx
  01ca4	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@MAIPOPGJ@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?$FN?5BLUE@
  01ca9	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  01caf	83 c4 10	 add	 esp, 16			; 00000010H

; 725  : 		}
; 726  : 		else

  01cb2	e9 a4 02 00 00	 jmp	 $LN13@DropBlueRi
$LN14@DropBlueRi:

; 727  : 		{
; 728  : 			DropItemNum = rand() % this->GetBagCount();

  01cb7	e8 00 00 00 00	 call	 _rand
  01cbc	8b f0		 mov	 esi, eax
  01cbe	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01cc1	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  01cc6	8b c8		 mov	 ecx, eax
  01cc8	8b c6		 mov	 eax, esi
  01cca	99		 cdq
  01ccb	f7 f9		 idiv	 ecx
  01ccd	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 729  : 			dur = 0;

  01cd0	d9 ee		 fldz
  01cd2	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 730  : 			x = lpObj->X;

  01cd5	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01cd8	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  01cdf	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 731  : 			y = lpObj->Y;

  01ce2	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01ce5	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  01cec	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 732  : 			level = this->GetLevel(DropItemNum);

  01cef	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01cf2	50		 push	 eax
  01cf3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01cf6	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  01cfb	0f b6 c8	 movzx	 ecx, al
  01cfe	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 733  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  01d01	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01d04	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01d07	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  01d0f	52		 push	 edx
  01d10	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01d13	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01d16	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  01d1e	52		 push	 edx
  01d1f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  01d24	83 c4 08	 add	 esp, 8
  01d27	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 734  : 
; 735  : 			if ( type == -1 )

  01d2a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  01d2e	75 07		 jne	 SHORT $LN12@DropBlueRi

; 736  : 				return FALSE;

  01d30	33 c0		 xor	 eax, eax
  01d32	e9 80 02 00 00	 jmp	 $LN17@DropBlueRi
$LN12@DropBlueRi:

; 737  : 
; 738  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  01d37	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01d3a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01d3d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  01d45	85 d2		 test	 edx, edx
  01d47	74 07		 je	 SHORT $LN11@DropBlueRi

; 739  : 				Option1 = 1;

  01d49	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropBlueRi:

; 740  : 
; 741  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  01d50	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01d53	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01d56	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  01d5e	85 d2		 test	 edx, edx
  01d60	74 23		 je	 SHORT $LN9@DropBlueRi

; 742  : 			{
; 743  : 				Option2 = 0;

  01d62	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 744  : 
; 745  : 				if ( (rand()%2) == 0 )

  01d69	e8 00 00 00 00	 call	 _rand
  01d6e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  01d73	79 05		 jns	 SHORT $LN19@DropBlueRi
  01d75	48		 dec	 eax
  01d76	83 c8 fe	 or	 eax, -2			; fffffffeH
  01d79	40		 inc	 eax
$LN19@DropBlueRi:
  01d7a	85 c0		 test	 eax, eax
  01d7c	75 07		 jne	 SHORT $LN9@DropBlueRi

; 746  : 				{
; 747  : 					Option2 = 1;

  01d7e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropBlueRi:

; 748  : 				}
; 749  : 			}
; 750  : 
; 751  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  01d85	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01d88	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01d8b	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  01d93	85 d2		 test	 edx, edx
  01d95	74 2b		 je	 SHORT $LN6@DropBlueRi

; 752  : 			{
; 753  : 				if ( (rand()%5) < 1 )

  01d97	e8 00 00 00 00	 call	 _rand
  01d9c	99		 cdq
  01d9d	b9 05 00 00 00	 mov	 ecx, 5
  01da2	f7 f9		 idiv	 ecx
  01da4	83 fa 01	 cmp	 edx, 1
  01da7	7d 09		 jge	 SHORT $LN7@DropBlueRi

; 754  : 				{
; 755  : 					Option3 = 3;

  01da9	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 756  : 				}
; 757  : 				else

  01db0	eb 10		 jmp	 SHORT $LN6@DropBlueRi
$LN7@DropBlueRi:

; 758  : 				{
; 759  : 					Option3 = rand() % 3;

  01db2	e8 00 00 00 00	 call	 _rand
  01db7	99		 cdq
  01db8	b9 03 00 00 00	 mov	 ecx, 3
  01dbd	f7 f9		 idiv	 ecx
  01dbf	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropBlueRi:

; 760  : 				}
; 761  : 			}
; 762  : 
; 763  : 			if ( this->BagObject[DropItemNum].m_isexitem )

  01dc2	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  01dc5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01dc8	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  01dd0	85 d2		 test	 edx, edx
  01dd2	74 20		 je	 SHORT $LN5@DropBlueRi

; 764  : 			{
; 765  : 				ExOption = NewOptionRand(level);

  01dd4	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  01dd7	50		 push	 eax
  01dd8	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  01ddd	83 c4 04	 add	 esp, 4
  01de0	0f b6 c8	 movzx	 ecx, al
  01de3	89 4d d0	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 766  : #ifndef _FIX_
; 767  : 				Option2 = 0;
; 768  : #endif
; 769  : 				Option1 = 1;

  01de6	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1

; 770  : 				level = 0;

  01ded	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN5@DropBlueRi:

; 771  : 			}
; 772  : 
; 773  : 			if ( type == ITEMGET(12,15) ||
; 774  : 				 type == ITEMGET(14,13) ||
; 775  : 				 type == ITEMGET(14,14)  )

  01df4	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  01dfb	74 12		 je	 SHORT $LN3@DropBlueRi
  01dfd	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  01e04	74 09		 je	 SHORT $LN3@DropBlueRi
  01e06	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  01e0d	75 1c		 jne	 SHORT $LN4@DropBlueRi
$LN3@DropBlueRi:

; 776  : 			{
; 777  : 				Option1 = 0;

  01e0f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 778  : 				Option2 = 0;

  01e16	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 779  : 				Option3 = 0;

  01e1d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 780  : 				level = 0;

  01e24	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropBlueRi:

; 781  : 			}
; 782  : 
; 783  : 			if ( type == ITEMGET(13,8) ||
; 784  : 				 type == ITEMGET(13,9) ||
; 785  : 				 type == ITEMGET(13,12) ||
; 786  : 				 type == ITEMGET(13,21) )

  01e2b	81 7d f4 08 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6664 ; 00001a08H
  01e32	74 1b		 je	 SHORT $LN1@DropBlueRi
  01e34	81 7d f4 09 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6665 ; 00001a09H
  01e3b	74 12		 je	 SHORT $LN1@DropBlueRi
  01e3d	81 7d f4 0c 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6668 ; 00001a0cH
  01e44	74 09		 je	 SHORT $LN1@DropBlueRi
  01e46	81 7d f4 15 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6677 ; 00001a15H
  01e4d	75 07		 jne	 SHORT $LN2@DropBlueRi
$LN1@DropBlueRi:

; 787  : 			{
; 788  : 				level = 0;

  01e4f	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN2@DropBlueRi:

; 789  : 			}
; 790  : 			
; 791  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 792  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  01e56	6a 00		 push	 0
  01e58	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  01e5c	50		 push	 eax
  01e5d	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01e60	8b 11		 mov	 edx, DWORD PTR [ecx]
  01e62	52		 push	 edx
  01e63	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  01e67	50		 push	 eax
  01e68	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  01e6c	51		 push	 ecx
  01e6d	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  01e71	52		 push	 edx
  01e72	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  01e75	d9 7d 82	 fnstcw	 WORD PTR tv316[ebp]
  01e78	0f b7 45 82	 movzx	 eax, WORD PTR tv316[ebp]
  01e7c	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  01e81	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv319[ebp], eax
  01e87	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv319[ebp]
  01e8d	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv321[ebp]
  01e93	d9 6d 82	 fldcw	 WORD PTR tv316[ebp]
  01e96	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv321[ebp]
  01e9d	50		 push	 eax
  01e9e	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  01ea2	51		 push	 ecx
  01ea3	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  01ea6	52		 push	 edx
  01ea7	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  01eab	50		 push	 eax
  01eac	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  01eb0	51		 push	 ecx
  01eb1	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01eb4	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  01ebb	50		 push	 eax
  01ebc	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01ebf	8b 11		 mov	 edx, DWORD PTR [ecx]
  01ec1	52		 push	 edx
  01ec2	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  01ec7	83 c4 34	 add	 esp, 52			; 00000034H

; 793  : 
; 794  : 			LogAddTD("[EVENT CHRISTMAS RIBBONBOX ] BLUERIBBONBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 795  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 796  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 797  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  01eca	6a 00		 push	 0
  01ecc	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  01ecf	83 e0 01	 and	 eax, 1
  01ed2	50		 push	 eax
  01ed3	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  01ed6	83 e1 02	 and	 ecx, 2
  01ed9	d1 f9		 sar	 ecx, 1
  01edb	51		 push	 ecx
  01edc	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  01edf	83 e2 04	 and	 edx, 4
  01ee2	c1 fa 02	 sar	 edx, 2
  01ee5	52		 push	 edx
  01ee6	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  01ee9	83 e0 08	 and	 eax, 8
  01eec	c1 f8 03	 sar	 eax, 3
  01eef	50		 push	 eax
  01ef0	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  01ef3	83 e1 10	 and	 ecx, 16			; 00000010H
  01ef6	c1 f9 04	 sar	 ecx, 4
  01ef9	51		 push	 ecx
  01efa	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  01efd	83 e2 20	 and	 edx, 32			; 00000020H
  01f00	c1 fa 05	 sar	 edx, 5
  01f03	52		 push	 edx
  01f04	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  01f07	50		 push	 eax
  01f08	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  01f0b	51		 push	 ecx
  01f0c	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  01f0f	52		 push	 edx
  01f10	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  01f13	50		 push	 eax
  01f14	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  01f17	51		 push	 ecx
  01f18	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  01f1b	6b d2 70	 imul	 edx, 112		; 00000070H
  01f1e	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  01f24	52		 push	 edx
  01f25	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  01f28	50		 push	 eax
  01f29	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  01f2c	51		 push	 ecx
  01f2d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01f30	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  01f37	50		 push	 eax
  01f38	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  01f3b	83 c1 08	 add	 ecx, 8
  01f3e	51		 push	 ecx
  01f3f	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  01f42	83 c2 77	 add	 edx, 119		; 00000077H
  01f45	52		 push	 edx
  01f46	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01f49	83 c0 6c	 add	 eax, 108		; 0000006cH
  01f4c	50		 push	 eax
  01f4d	68 00 00 00 00	 push	 OFFSET ??_C@_0JK@JEKBBHDC@?$FLEVENT?5CHRISTMAS?5RIBBONBOX?5?$FN?5BLU@
  01f52	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  01f58	83 c4 50	 add	 esp, 80			; 00000050H
$LN13@DropBlueRi:

; 798  : 		}
; 799  : 
; 800  : 		PMSG_SERVERCMD ServerCmd;
; 801  : 
; 802  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  01f5b	6a 07		 push	 7
  01f5d	6a 40		 push	 64			; 00000040H
  01f5f	68 f3 00 00 00	 push	 243			; 000000f3H
  01f64	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228368[ebp]
  01f67	50		 push	 eax
  01f68	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  01f6d	83 c4 10	 add	 esp, 16			; 00000010H

; 803  : 		ServerCmd.CmdType = 0;

  01f70	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228368[ebp+4], 0

; 804  : 		ServerCmd.X = lpObj->X;

  01f74	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01f77	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  01f7d	88 4d c9	 mov	 BYTE PTR _ServerCmd$228368[ebp+5], cl

; 805  : 		ServerCmd.Y = lpObj->Y;

  01f80	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  01f83	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  01f89	88 4d ca	 mov	 BYTE PTR _ServerCmd$228368[ebp+6], cl

; 806  : 
; 807  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  01f8c	6a 07		 push	 7
  01f8e	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228368[ebp]
  01f91	50		 push	 eax
  01f92	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01f95	51		 push	 ecx
  01f96	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  01f9b	83 c4 0c	 add	 esp, 12			; 0000000cH

; 808  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  01f9e	6a 07		 push	 7
  01fa0	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228368[ebp]
  01fa3	50		 push	 eax
  01fa4	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  01fa7	8b 11		 mov	 edx, DWORD PTR [ecx]
  01fa9	52		 push	 edx
  01faa	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  01faf	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@DropBlueRi:

; 809  : 	}
; 810  : 
; 811  : 	return TRUE;

  01fb2	b8 01 00 00 00	 mov	 eax, 1
$LN17@DropBlueRi:

; 812  : }

  01fb7	5f		 pop	 edi
  01fb8	5e		 pop	 esi
  01fb9	5b		 pop	 ebx
  01fba	8b e5		 mov	 esp, ebp
  01fbc	5d		 pop	 ebp
  01fbd	c2 04 00	 ret	 4
?DropBlueRibbonBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropBlueRibbonBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	?DropPinkChocolateBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropPinkChocolateBoxEventItem
EXTRN	?g_iPinkChocolateBoxDropZen@@3HA:DWORD		; g_iPinkChocolateBoxDropZen
EXTRN	?g_iPinkChocolateBoxDropZenRate@@3HA:DWORD	; g_iPinkChocolateBoxDropZenRate
;	COMDAT ??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX ] PINKCHOCOLATEBOX Event ItemDrop'
	DB	' [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:'
	DB	'%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX] PINKCHOCOLATE BOX Event ItemDrop'
	DB	' [%s][%s] [%d Zen]', 00H			; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv307 = -136						; size = 4
tv305 = -132						; size = 4
tv302 = -126						; size = 2
_ServerCmd$228414 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropPinkChocolateBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropPinkChocolateBoxEventItem
; _this$ = ecx

; 817  : {

  01fc0	55		 push	 ebp
  01fc1	8b ec		 mov	 ebp, esp
  01fc3	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  01fc9	53		 push	 ebx
  01fca	56		 push	 esi
  01fcb	57		 push	 edi
  01fcc	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 818  : 	if ( this->m_bLoad == FALSE )

  01fcf	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  01fd2	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  01fd6	75 07		 jne	 SHORT $LN15@DropPinkCh

; 819  : 		return FALSE;

  01fd8	33 c0		 xor	 eax, eax
  01fda	e9 92 03 00 00	 jmp	 $LN16@DropPinkCh
$LN15@DropPinkCh:

; 820  : 
; 821  : 	float dur;
; 822  : 	int type;
; 823  : 	int level;
; 824  : 	int x;
; 825  : 	int y;
; 826  : 	int Option1 = 0;

  01fdf	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 827  : 	int Option2 = 0;

  01fe6	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 828  : 	int Option3 = 0;

  01fed	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 829  : 	int DropItemRate;
; 830  : 	int DropItemNum;
; 831  : 	int ExOption = 0;

  01ff4	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 832  : 	LPOBJ lpObj = &gObj[aIndex];

  01ffb	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  01ffe	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02004	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0200a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 833  : 
; 834  : 	if ( this->GetBagCount() > 0 )

  0200d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02010	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02015	85 c0		 test	 eax, eax
  02017	0f 8e 4f 03 00
	00		 jle	 $LN14@DropPinkCh

; 835  : 	{
; 836  : 		DropItemRate = rand() % 10000;

  0201d	e8 00 00 00 00	 call	 _rand
  02022	99		 cdq
  02023	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  02028	f7 f9		 idiv	 ecx
  0202a	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 837  : 
; 838  : 		if ( DropItemRate < g_iPinkChocolateBoxDropZenRate )

  0202d	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  02030	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iPinkChocolateBoxDropZenRate@@3HA ; g_iPinkChocolateBoxDropZenRate
  02036	7d 5f		 jge	 SHORT $LN13@DropPinkCh

; 839  : 		{
; 840  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iPinkChocolateBoxDropZen, 
; 841  : 				lpObj->X, lpObj->Y);

  02038	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0203b	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  02042	51		 push	 ecx
  02043	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02046	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  0204d	50		 push	 eax
  0204e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iPinkChocolateBoxDropZen@@3HA ; g_iPinkChocolateBoxDropZen
  02054	51		 push	 ecx
  02055	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02058	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  0205f	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  02065	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0206b	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 842  : 
; 843  : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX] PINKCHOCOLATE BOX Event ItemDrop [%s][%s] [%d Zen]",
; 844  : 				lpObj->AccountID, lpObj->Name,
; 845  : 				g_iPinkChocolateBoxDropZen);

  02070	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iPinkChocolateBoxDropZen@@3HA ; g_iPinkChocolateBoxDropZen
  02075	50		 push	 eax
  02076	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02079	83 c1 77	 add	 ecx, 119		; 00000077H
  0207c	51		 push	 ecx
  0207d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02080	83 c2 6c	 add	 edx, 108		; 0000006cH
  02083	52		 push	 edx
  02084	68 00 00 00 00	 push	 OFFSET ??_C@_0FI@DOIHGBLI@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  02089	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0208f	83 c4 10	 add	 esp, 16			; 00000010H

; 846  : 		}
; 847  : 		else

  02092	e9 7e 02 00 00	 jmp	 $LN12@DropPinkCh
$LN13@DropPinkCh:

; 848  : 		{
; 849  : 			DropItemNum = rand() % this->GetBagCount();

  02097	e8 00 00 00 00	 call	 _rand
  0209c	8b f0		 mov	 esi, eax
  0209e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  020a1	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  020a6	8b c8		 mov	 ecx, eax
  020a8	8b c6		 mov	 eax, esi
  020aa	99		 cdq
  020ab	f7 f9		 idiv	 ecx
  020ad	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 850  : 			dur = 0;

  020b0	d9 ee		 fldz
  020b2	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 851  : 			x = lpObj->X;

  020b5	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  020b8	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  020bf	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 852  : 			y = lpObj->Y;

  020c2	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  020c5	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  020cc	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 853  : 			level = this->GetLevel(DropItemNum);

  020cf	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  020d2	50		 push	 eax
  020d3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  020d6	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  020db	0f b6 c8	 movzx	 ecx, al
  020de	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 854  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  020e1	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  020e4	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  020e7	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  020ef	52		 push	 edx
  020f0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  020f3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  020f6	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  020fe	52		 push	 edx
  020ff	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  02104	83 c4 08	 add	 esp, 8
  02107	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 855  : 
; 856  : 			if ( type == -1 )

  0210a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  0210e	75 07		 jne	 SHORT $LN11@DropPinkCh

; 857  : 				return FALSE;

  02110	33 c0		 xor	 eax, eax
  02112	e9 5a 02 00 00	 jmp	 $LN16@DropPinkCh
$LN11@DropPinkCh:

; 858  : 
; 859  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  02117	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0211a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0211d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  02125	85 d2		 test	 edx, edx
  02127	74 07		 je	 SHORT $LN10@DropPinkCh

; 860  : 				Option1 = 1;

  02129	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN10@DropPinkCh:

; 861  : 
; 862  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  02130	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02133	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02136	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  0213e	85 d2		 test	 edx, edx
  02140	74 23		 je	 SHORT $LN8@DropPinkCh

; 863  : 			{
; 864  : 				Option2 = 0;

  02142	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 865  : 
; 866  : 				if ( (rand()%2) == 0 )

  02149	e8 00 00 00 00	 call	 _rand
  0214e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  02153	79 05		 jns	 SHORT $LN18@DropPinkCh
  02155	48		 dec	 eax
  02156	83 c8 fe	 or	 eax, -2			; fffffffeH
  02159	40		 inc	 eax
$LN18@DropPinkCh:
  0215a	85 c0		 test	 eax, eax
  0215c	75 07		 jne	 SHORT $LN8@DropPinkCh

; 867  : 				{
; 868  : 					Option2 = 1;

  0215e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN8@DropPinkCh:

; 869  : 				}
; 870  : 			}
; 871  : 
; 872  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  02165	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02168	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0216b	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  02173	85 d2		 test	 edx, edx
  02175	74 2b		 je	 SHORT $LN5@DropPinkCh

; 873  : 			{
; 874  : 				if ( (rand()%5) < 1 )

  02177	e8 00 00 00 00	 call	 _rand
  0217c	99		 cdq
  0217d	b9 05 00 00 00	 mov	 ecx, 5
  02182	f7 f9		 idiv	 ecx
  02184	83 fa 01	 cmp	 edx, 1
  02187	7d 09		 jge	 SHORT $LN6@DropPinkCh

; 875  : 				{
; 876  : 					Option3 = 3;

  02189	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 877  : 				}
; 878  : 				else

  02190	eb 10		 jmp	 SHORT $LN5@DropPinkCh
$LN6@DropPinkCh:

; 879  : 				{
; 880  : 					Option3 = rand() % 3;

  02192	e8 00 00 00 00	 call	 _rand
  02197	99		 cdq
  02198	b9 03 00 00 00	 mov	 ecx, 3
  0219d	f7 f9		 idiv	 ecx
  0219f	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN5@DropPinkCh:

; 881  : 				}
; 882  : 			}
; 883  : 
; 884  : 			ExOption = 0;

  021a2	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 885  : 
; 886  : 			if ( type == ITEMGET(12,15) ||
; 887  : 				 type == ITEMGET(14,13) ||
; 888  : 				 type == ITEMGET(14,14) )

  021a9	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  021b0	74 12		 je	 SHORT $LN3@DropPinkCh
  021b2	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  021b9	74 09		 je	 SHORT $LN3@DropPinkCh
  021bb	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  021c2	75 1c		 jne	 SHORT $LN4@DropPinkCh
$LN3@DropPinkCh:

; 889  : 			{
; 890  : 				Option1 = 0;

  021c4	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 891  : 				Option2 = 0;

  021cb	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 892  : 				Option3 = 0;

  021d2	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 893  : 				level = 0;

  021d9	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropPinkCh:

; 894  : 			}
; 895  : 
; 896  : 			if ( type == ITEMGET(14,19) ||
; 897  : 				 type == ITEMGET(14,28) ||
; 898  : 				 type == ITEMGET(13,18) )

  021e0	81 7d f4 13 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7187 ; 00001c13H
  021e7	74 12		 je	 SHORT $LN1@DropPinkCh
  021e9	81 7d f4 1c 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7196 ; 00001c1cH
  021f0	74 09		 je	 SHORT $LN1@DropPinkCh
  021f2	81 7d f4 12 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6674 ; 00001a12H
  021f9	75 15		 jne	 SHORT $LN2@DropPinkCh
$LN1@DropPinkCh:

; 899  : 			{
; 900  : 				Option1 = 0;

  021fb	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 901  : 				Option2 = 0;

  02202	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 902  : 				Option3 = 0;

  02209	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0
$LN2@DropPinkCh:

; 903  : 			}
; 904  : 			
; 905  : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 906  : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  02210	6a 00		 push	 0
  02212	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  02216	50		 push	 eax
  02217	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0221a	8b 11		 mov	 edx, DWORD PTR [ecx]
  0221c	52		 push	 edx
  0221d	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  02221	50		 push	 eax
  02222	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  02226	51		 push	 ecx
  02227	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  0222b	52		 push	 edx
  0222c	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  0222f	d9 7d 82	 fnstcw	 WORD PTR tv302[ebp]
  02232	0f b7 45 82	 movzx	 eax, WORD PTR tv302[ebp]
  02236	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  0223b	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv305[ebp], eax
  02241	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv305[ebp]
  02247	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv307[ebp]
  0224d	d9 6d 82	 fldcw	 WORD PTR tv302[ebp]
  02250	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv307[ebp]
  02257	50		 push	 eax
  02258	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  0225c	51		 push	 ecx
  0225d	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  02260	52		 push	 edx
  02261	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  02265	50		 push	 eax
  02266	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  0226a	51		 push	 ecx
  0226b	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  0226e	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  02275	50		 push	 eax
  02276	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02279	8b 11		 mov	 edx, DWORD PTR [ecx]
  0227b	52		 push	 edx
  0227c	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  02281	83 c4 34	 add	 esp, 52			; 00000034H

; 907  : 
; 908  : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX ] PINKCHOCOLATEBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 909  : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 910  : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 911  : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  02284	6a 00		 push	 0
  02286	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  02289	83 e0 01	 and	 eax, 1
  0228c	50		 push	 eax
  0228d	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  02290	83 e1 02	 and	 ecx, 2
  02293	d1 f9		 sar	 ecx, 1
  02295	51		 push	 ecx
  02296	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  02299	83 e2 04	 and	 edx, 4
  0229c	c1 fa 02	 sar	 edx, 2
  0229f	52		 push	 edx
  022a0	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  022a3	83 e0 08	 and	 eax, 8
  022a6	c1 f8 03	 sar	 eax, 3
  022a9	50		 push	 eax
  022aa	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  022ad	83 e1 10	 and	 ecx, 16			; 00000010H
  022b0	c1 f9 04	 sar	 ecx, 4
  022b3	51		 push	 ecx
  022b4	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  022b7	83 e2 20	 and	 edx, 32			; 00000020H
  022ba	c1 fa 05	 sar	 edx, 5
  022bd	52		 push	 edx
  022be	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  022c1	50		 push	 eax
  022c2	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  022c5	51		 push	 ecx
  022c6	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  022c9	52		 push	 edx
  022ca	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  022cd	50		 push	 eax
  022ce	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  022d1	51		 push	 ecx
  022d2	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  022d5	6b d2 70	 imul	 edx, 112		; 00000070H
  022d8	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  022de	52		 push	 edx
  022df	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  022e2	50		 push	 eax
  022e3	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  022e6	51		 push	 ecx
  022e7	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  022ea	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  022f1	50		 push	 eax
  022f2	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  022f5	83 c1 08	 add	 ecx, 8
  022f8	51		 push	 ecx
  022f9	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  022fc	83 c2 77	 add	 edx, 119		; 00000077H
  022ff	52		 push	 edx
  02300	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02303	83 c0 6c	 add	 eax, 108		; 0000006cH
  02306	50		 push	 eax
  02307	68 00 00 00 00	 push	 OFFSET ??_C@_0KG@HKBGNNEJ@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  0230c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  02312	83 c4 50	 add	 esp, 80			; 00000050H
$LN12@DropPinkCh:

; 912  : 		}
; 913  : 
; 914  : 		PMSG_SERVERCMD ServerCmd;
; 915  : 
; 916  : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  02315	6a 07		 push	 7
  02317	6a 40		 push	 64			; 00000040H
  02319	68 f3 00 00 00	 push	 243			; 000000f3H
  0231e	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228414[ebp]
  02321	50		 push	 eax
  02322	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  02327	83 c4 10	 add	 esp, 16			; 00000010H

; 917  : 		ServerCmd.CmdType = 0;

  0232a	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228414[ebp+4], 0

; 918  : 		ServerCmd.X = lpObj->X;

  0232e	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02331	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  02337	88 4d c9	 mov	 BYTE PTR _ServerCmd$228414[ebp+5], cl

; 919  : 		ServerCmd.Y = lpObj->Y;

  0233a	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0233d	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  02343	88 4d ca	 mov	 BYTE PTR _ServerCmd$228414[ebp+6], cl

; 920  : 
; 921  : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  02346	6a 07		 push	 7
  02348	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228414[ebp]
  0234b	50		 push	 eax
  0234c	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0234f	51		 push	 ecx
  02350	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  02355	83 c4 0c	 add	 esp, 12			; 0000000cH

; 922  : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  02358	6a 07		 push	 7
  0235a	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228414[ebp]
  0235d	50		 push	 eax
  0235e	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02361	8b 11		 mov	 edx, DWORD PTR [ecx]
  02363	52		 push	 edx
  02364	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  02369	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN14@DropPinkCh:

; 923  : 	}
; 924  : 
; 925  : 	return TRUE;

  0236c	b8 01 00 00 00	 mov	 eax, 1
$LN16@DropPinkCh:

; 926  : }

  02371	5f		 pop	 edi
  02372	5e		 pop	 esi
  02373	5b		 pop	 ebx
  02374	8b e5		 mov	 esp, ebp
  02376	5d		 pop	 ebp
  02377	c2 04 00	 ret	 4
?DropPinkChocolateBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropPinkChocolateBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	?DropRedChocolateBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropRedChocolateBoxEventItem
EXTRN	?g_iRedChocolateBoxDropZen@@3HA:DWORD		; g_iRedChocolateBoxDropZen
EXTRN	?g_iRedChocolateBoxDropZenRate@@3HA:DWORD	; g_iRedChocolateBoxDropZenRate
;	COMDAT ??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX ] REDCHOCOLATEBOX Event ItemDrop '
	DB	'[%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%'
	DB	'd op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX] REDCHOCOLATEBOX Event ItemDrop ['
	DB	'%s][%s] [%d Zen]', 00H			; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv321 = -136						; size = 4
tv319 = -132						; size = 4
tv316 = -126						; size = 2
_ServerCmd$228461 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropRedChocolateBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropRedChocolateBoxEventItem
; _this$ = ecx

; 930  : {

  02380	55		 push	 ebp
  02381	8b ec		 mov	 ebp, esp
  02383	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  02389	53		 push	 ebx
  0238a	56		 push	 esi
  0238b	57		 push	 edi
  0238c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 931  : 	if ( this->m_bLoad == FALSE )

  0238f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  02392	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  02396	75 07		 jne	 SHORT $LN16@DropRedCho

; 932  : 		return FALSE;

  02398	33 c0		 xor	 eax, eax
  0239a	e9 c6 03 00 00	 jmp	 $LN17@DropRedCho
$LN16@DropRedCho:

; 933  : 
; 934  : 	float dur;
; 935  : 	int type;
; 936  : 	int level;
; 937  : 	int x;
; 938  : 	int y;
; 939  : 	int Option1 = 0;

  0239f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 940  : 	int Option2 = 0;

  023a6	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 941  : 	int Option3 = 0;

  023ad	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 942  : 	int DropItemRate;
; 943  : 	int DropItemNum;
; 944  : 	int ExOption = 0;

  023b4	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 945  : 	LPOBJ lpObj = &gObj[aIndex];

  023bb	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  023be	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  023c4	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  023ca	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 946  : 
; 947  : 	if ( this->GetBagCount() > 0 )

  023cd	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  023d0	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  023d5	85 c0		 test	 eax, eax
  023d7	0f 8e 83 03 00
	00		 jle	 $LN15@DropRedCho

; 948  : 	{
; 949  : 		DropItemRate = rand() % 10000;

  023dd	e8 00 00 00 00	 call	 _rand
  023e2	99		 cdq
  023e3	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  023e8	f7 f9		 idiv	 ecx
  023ea	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 950  : 
; 951  : 		if ( DropItemRate < g_iRedChocolateBoxDropZenRate )

  023ed	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  023f0	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iRedChocolateBoxDropZenRate@@3HA ; g_iRedChocolateBoxDropZenRate
  023f6	7d 5f		 jge	 SHORT $LN14@DropRedCho

; 952  : 		{
; 953  : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iRedChocolateBoxDropZen, 
; 954  : 				lpObj->X, lpObj->Y);

  023f8	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  023fb	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  02402	51		 push	 ecx
  02403	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02406	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  0240d	50		 push	 eax
  0240e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iRedChocolateBoxDropZen@@3HA ; g_iRedChocolateBoxDropZen
  02414	51		 push	 ecx
  02415	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02418	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  0241f	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  02425	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0242b	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 955  : 
; 956  : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX] REDCHOCOLATEBOX Event ItemDrop [%s][%s] [%d Zen]",
; 957  : 				lpObj->AccountID, lpObj->Name,
; 958  : 				g_iRedChocolateBoxDropZen);

  02430	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iRedChocolateBoxDropZen@@3HA ; g_iRedChocolateBoxDropZen
  02435	50		 push	 eax
  02436	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02439	83 c1 77	 add	 ecx, 119		; 00000077H
  0243c	51		 push	 ecx
  0243d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02440	83 c2 6c	 add	 edx, 108		; 0000006cH
  02443	52		 push	 edx
  02444	68 00 00 00 00	 push	 OFFSET ??_C@_0FG@HNNCGKKM@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  02449	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0244f	83 c4 10	 add	 esp, 16			; 00000010H

; 959  : 		}
; 960  : 		else

  02452	e9 b2 02 00 00	 jmp	 $LN13@DropRedCho
$LN14@DropRedCho:

; 961  : 		{
; 962  : 			DropItemNum = rand() % this->GetBagCount();

  02457	e8 00 00 00 00	 call	 _rand
  0245c	8b f0		 mov	 esi, eax
  0245e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02461	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02466	8b c8		 mov	 ecx, eax
  02468	8b c6		 mov	 eax, esi
  0246a	99		 cdq
  0246b	f7 f9		 idiv	 ecx
  0246d	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 963  : 			dur = 0;

  02470	d9 ee		 fldz
  02472	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 964  : 			x = lpObj->X;

  02475	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02478	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  0247f	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 965  : 			y = lpObj->Y;

  02482	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02485	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0248c	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 966  : 			level = this->GetLevel(DropItemNum);

  0248f	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02492	50		 push	 eax
  02493	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02496	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  0249b	0f b6 c8	 movzx	 ecx, al
  0249e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 967  : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  024a1	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  024a4	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  024a7	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  024af	52		 push	 edx
  024b0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  024b3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  024b6	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  024be	52		 push	 edx
  024bf	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  024c4	83 c4 08	 add	 esp, 8
  024c7	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 968  : 
; 969  : 			if ( type == -1 )

  024ca	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  024ce	75 07		 jne	 SHORT $LN12@DropRedCho

; 970  : 				return FALSE;

  024d0	33 c0		 xor	 eax, eax
  024d2	e9 8e 02 00 00	 jmp	 $LN17@DropRedCho
$LN12@DropRedCho:

; 971  : 
; 972  : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  024d7	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  024da	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  024dd	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  024e5	85 d2		 test	 edx, edx
  024e7	74 07		 je	 SHORT $LN11@DropRedCho

; 973  : 				Option1 = 1;

  024e9	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropRedCho:

; 974  : 
; 975  : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  024f0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  024f3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  024f6	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  024fe	85 d2		 test	 edx, edx
  02500	74 23		 je	 SHORT $LN9@DropRedCho

; 976  : 			{
; 977  : 				Option2 = 0;

  02502	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 978  : 
; 979  : 				if ( (rand()%2) == 0 )

  02509	e8 00 00 00 00	 call	 _rand
  0250e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  02513	79 05		 jns	 SHORT $LN19@DropRedCho
  02515	48		 dec	 eax
  02516	83 c8 fe	 or	 eax, -2			; fffffffeH
  02519	40		 inc	 eax
$LN19@DropRedCho:
  0251a	85 c0		 test	 eax, eax
  0251c	75 07		 jne	 SHORT $LN9@DropRedCho

; 980  : 				{
; 981  : 					Option2 = 1;

  0251e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropRedCho:

; 982  : 				}
; 983  : 			}
; 984  : 
; 985  : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  02525	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02528	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0252b	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  02533	85 d2		 test	 edx, edx
  02535	74 2b		 je	 SHORT $LN6@DropRedCho

; 986  : 			{
; 987  : 				if ( (rand()%5) < 1 )

  02537	e8 00 00 00 00	 call	 _rand
  0253c	99		 cdq
  0253d	b9 05 00 00 00	 mov	 ecx, 5
  02542	f7 f9		 idiv	 ecx
  02544	83 fa 01	 cmp	 edx, 1
  02547	7d 09		 jge	 SHORT $LN7@DropRedCho

; 988  : 				{
; 989  : 					Option3 = 3;

  02549	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 990  : 				}
; 991  : 				else

  02550	eb 10		 jmp	 SHORT $LN6@DropRedCho
$LN7@DropRedCho:

; 992  : 				{
; 993  : 					Option3 = rand() % 3;

  02552	e8 00 00 00 00	 call	 _rand
  02557	99		 cdq
  02558	b9 03 00 00 00	 mov	 ecx, 3
  0255d	f7 f9		 idiv	 ecx
  0255f	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropRedCho:

; 994  : 				}
; 995  : 			}
; 996  : 
; 997  : 			if ( this->BagObject[DropItemNum].m_isexitem )

  02562	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02565	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02568	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  02570	85 d2		 test	 edx, edx
  02572	74 20		 je	 SHORT $LN5@DropRedCho

; 998  : 			{
; 999  : 				ExOption = NewOptionRand(level);

  02574	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  02577	50		 push	 eax
  02578	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  0257d	83 c4 04	 add	 esp, 4
  02580	0f b6 c8	 movzx	 ecx, al
  02583	89 4d d0	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 1000 : #ifndef _FIX_
; 1001 : 				Option2 = 0;
; 1002 : #endif
; 1003 : 				Option1 = 1;

  02586	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1

; 1004 : 				level = 0;

  0258d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN5@DropRedCho:

; 1005 : 			}
; 1006 : 
; 1007 : 			if ( type == ITEMGET(12,15) ||
; 1008 : 				 type == ITEMGET(14,13) ||
; 1009 : 				 type == ITEMGET(14,14) ||
; 1010 : 				 type == ITEMGET(14,16) )

  02594	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  0259b	74 1b		 je	 SHORT $LN3@DropRedCho
  0259d	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  025a4	74 12		 je	 SHORT $LN3@DropRedCho
  025a6	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  025ad	74 09		 je	 SHORT $LN3@DropRedCho
  025af	81 7d f4 10 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7184 ; 00001c10H
  025b6	75 1c		 jne	 SHORT $LN4@DropRedCho
$LN3@DropRedCho:

; 1011 : 			{
; 1012 : 				Option1 = 0;

  025b8	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1013 : 				Option2 = 0;

  025bf	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1014 : 				Option3 = 0;

  025c6	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1015 : 				level = 0;

  025cd	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropRedCho:

; 1016 : 			}
; 1017 : 
; 1018 : 			if ( type == ITEMGET(14,19) ||
; 1019 : 				 type == ITEMGET(14,28) ||
; 1020 : 				 type == ITEMGET(13,18) )

  025d4	81 7d f4 13 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7187 ; 00001c13H
  025db	74 12		 je	 SHORT $LN1@DropRedCho
  025dd	81 7d f4 1c 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7196 ; 00001c1cH
  025e4	74 09		 je	 SHORT $LN1@DropRedCho
  025e6	81 7d f4 12 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6674 ; 00001a12H
  025ed	75 15		 jne	 SHORT $LN2@DropRedCho
$LN1@DropRedCho:

; 1021 : 			{
; 1022 : 				Option1 = 0;

  025ef	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1023 : 				Option2 = 0;

  025f6	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1024 : 				Option3 = 0;

  025fd	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0
$LN2@DropRedCho:

; 1025 : 			}
; 1026 : 			
; 1027 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1028 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  02604	6a 00		 push	 0
  02606	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  0260a	50		 push	 eax
  0260b	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0260e	8b 11		 mov	 edx, DWORD PTR [ecx]
  02610	52		 push	 edx
  02611	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  02615	50		 push	 eax
  02616	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  0261a	51		 push	 ecx
  0261b	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  0261f	52		 push	 edx
  02620	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  02623	d9 7d 82	 fnstcw	 WORD PTR tv316[ebp]
  02626	0f b7 45 82	 movzx	 eax, WORD PTR tv316[ebp]
  0262a	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  0262f	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv319[ebp], eax
  02635	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv319[ebp]
  0263b	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv321[ebp]
  02641	d9 6d 82	 fldcw	 WORD PTR tv316[ebp]
  02644	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv321[ebp]
  0264b	50		 push	 eax
  0264c	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  02650	51		 push	 ecx
  02651	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  02654	52		 push	 edx
  02655	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  02659	50		 push	 eax
  0265a	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  0265e	51		 push	 ecx
  0265f	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02662	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  02669	50		 push	 eax
  0266a	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0266d	8b 11		 mov	 edx, DWORD PTR [ecx]
  0266f	52		 push	 edx
  02670	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  02675	83 c4 34	 add	 esp, 52			; 00000034H

; 1029 : 
; 1030 : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX ] REDCHOCOLATEBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1031 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1032 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1033 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  02678	6a 00		 push	 0
  0267a	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  0267d	83 e0 01	 and	 eax, 1
  02680	50		 push	 eax
  02681	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  02684	83 e1 02	 and	 ecx, 2
  02687	d1 f9		 sar	 ecx, 1
  02689	51		 push	 ecx
  0268a	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  0268d	83 e2 04	 and	 edx, 4
  02690	c1 fa 02	 sar	 edx, 2
  02693	52		 push	 edx
  02694	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  02697	83 e0 08	 and	 eax, 8
  0269a	c1 f8 03	 sar	 eax, 3
  0269d	50		 push	 eax
  0269e	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  026a1	83 e1 10	 and	 ecx, 16			; 00000010H
  026a4	c1 f9 04	 sar	 ecx, 4
  026a7	51		 push	 ecx
  026a8	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  026ab	83 e2 20	 and	 edx, 32			; 00000020H
  026ae	c1 fa 05	 sar	 edx, 5
  026b1	52		 push	 edx
  026b2	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  026b5	50		 push	 eax
  026b6	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  026b9	51		 push	 ecx
  026ba	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  026bd	52		 push	 edx
  026be	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  026c1	50		 push	 eax
  026c2	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  026c5	51		 push	 ecx
  026c6	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  026c9	6b d2 70	 imul	 edx, 112		; 00000070H
  026cc	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  026d2	52		 push	 edx
  026d3	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  026d6	50		 push	 eax
  026d7	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  026da	51		 push	 ecx
  026db	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  026de	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  026e5	50		 push	 eax
  026e6	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  026e9	83 c1 08	 add	 ecx, 8
  026ec	51		 push	 ecx
  026ed	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  026f0	83 c2 77	 add	 edx, 119		; 00000077H
  026f3	52		 push	 edx
  026f4	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  026f7	83 c0 6c	 add	 eax, 108		; 0000006cH
  026fa	50		 push	 eax
  026fb	68 00 00 00 00	 push	 OFFSET ??_C@_0KF@COCFMJHA@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  02700	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  02706	83 c4 50	 add	 esp, 80			; 00000050H
$LN13@DropRedCho:

; 1034 : 		}
; 1035 : 
; 1036 : 		PMSG_SERVERCMD ServerCmd;
; 1037 : 
; 1038 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  02709	6a 07		 push	 7
  0270b	6a 40		 push	 64			; 00000040H
  0270d	68 f3 00 00 00	 push	 243			; 000000f3H
  02712	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228461[ebp]
  02715	50		 push	 eax
  02716	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  0271b	83 c4 10	 add	 esp, 16			; 00000010H

; 1039 : 		ServerCmd.CmdType = 0;

  0271e	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228461[ebp+4], 0

; 1040 : 		ServerCmd.X = lpObj->X;

  02722	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02725	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  0272b	88 4d c9	 mov	 BYTE PTR _ServerCmd$228461[ebp+5], cl

; 1041 : 		ServerCmd.Y = lpObj->Y;

  0272e	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02731	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  02737	88 4d ca	 mov	 BYTE PTR _ServerCmd$228461[ebp+6], cl

; 1042 : 
; 1043 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  0273a	6a 07		 push	 7
  0273c	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228461[ebp]
  0273f	50		 push	 eax
  02740	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02743	51		 push	 ecx
  02744	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  02749	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1044 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  0274c	6a 07		 push	 7
  0274e	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228461[ebp]
  02751	50		 push	 eax
  02752	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02755	8b 11		 mov	 edx, DWORD PTR [ecx]
  02757	52		 push	 edx
  02758	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  0275d	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@DropRedCho:

; 1045 : 	}
; 1046 : 
; 1047 : 	return TRUE;

  02760	b8 01 00 00 00	 mov	 eax, 1
$LN17@DropRedCho:

; 1048 : }

  02765	5f		 pop	 edi
  02766	5e		 pop	 esi
  02767	5b		 pop	 ebx
  02768	8b e5		 mov	 esp, ebp
  0276a	5d		 pop	 ebp
  0276b	c2 04 00	 ret	 4
?DropRedChocolateBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropRedChocolateBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ ; `string'
PUBLIC	?DropBlueChocolateBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropBlueChocolateBoxEventItem
EXTRN	?g_iBlueChocolateBoxDropZen@@3HA:DWORD		; g_iBlueChocolateBoxDropZen
EXTRN	?g_iBlueChocolateBoxDropZenRate@@3HA:DWORD	; g_iBlueChocolateBoxDropZenRate
;	COMDAT ??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX ] BLUECHOCOLATEBOX Event ItemDrop'
	DB	' [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:'
	DB	'%d op3:%d  Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
CONST	SEGMENT
??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@ DB '[EVENT VA'
	DB	'LENTINE''S DAY CHOCOLATEBOX] BLUECHOCOLATEBOX Event ItemDrop '
	DB	'[%s][%s] [%d Zen]', 00H			; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv321 = -136						; size = 4
tv319 = -132						; size = 4
tv316 = -126						; size = 2
_ServerCmd$228508 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropBlueChocolateBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropBlueChocolateBoxEventItem
; _this$ = ecx

; 1054 : {

  02770	55		 push	 ebp
  02771	8b ec		 mov	 ebp, esp
  02773	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  02779	53		 push	 ebx
  0277a	56		 push	 esi
  0277b	57		 push	 edi
  0277c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1055 : 	if ( this->m_bLoad == FALSE )

  0277f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  02782	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  02786	75 07		 jne	 SHORT $LN16@DropBlueCh

; 1056 : 		return FALSE;

  02788	33 c0		 xor	 eax, eax
  0278a	e9 b8 03 00 00	 jmp	 $LN17@DropBlueCh
$LN16@DropBlueCh:

; 1057 : 
; 1058 : 	float dur;
; 1059 : 	int type;
; 1060 : 	int level;
; 1061 : 	int x;
; 1062 : 	int y;
; 1063 : 	int Option1 = 0;

  0278f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1064 : 	int Option2 = 0;

  02796	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1065 : 	int Option3 = 0;

  0279d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1066 : 	int DropItemRate;
; 1067 : 	int DropItemNum;
; 1068 : 	int ExOption = 0;

  027a4	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1069 : 	LPOBJ lpObj = &gObj[aIndex];

  027ab	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  027ae	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  027b4	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  027ba	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1070 : 
; 1071 : 	if ( this->GetBagCount() > 0 )

  027bd	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  027c0	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  027c5	85 c0		 test	 eax, eax
  027c7	0f 8e 75 03 00
	00		 jle	 $LN15@DropBlueCh

; 1072 : 	{
; 1073 : 		DropItemRate = rand() % 10000;

  027cd	e8 00 00 00 00	 call	 _rand
  027d2	99		 cdq
  027d3	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  027d8	f7 f9		 idiv	 ecx
  027da	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 1074 : 
; 1075 : 		if ( DropItemRate < g_iBlueChocolateBoxDropZenRate )

  027dd	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  027e0	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iBlueChocolateBoxDropZenRate@@3HA ; g_iBlueChocolateBoxDropZenRate
  027e6	7d 5f		 jge	 SHORT $LN14@DropBlueCh

; 1076 : 		{
; 1077 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iBlueChocolateBoxDropZen, 
; 1078 : 				lpObj->X, lpObj->Y);

  027e8	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  027eb	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  027f2	51		 push	 ecx
  027f3	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  027f6	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  027fd	50		 push	 eax
  027fe	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iBlueChocolateBoxDropZen@@3HA ; g_iBlueChocolateBoxDropZen
  02804	51		 push	 ecx
  02805	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02808	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  0280f	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  02815	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0281b	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1079 : 
; 1080 : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX] BLUECHOCOLATEBOX Event ItemDrop [%s][%s] [%d Zen]",
; 1081 : 				lpObj->AccountID, lpObj->Name,
; 1082 : 				g_iBlueChocolateBoxDropZen);

  02820	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iBlueChocolateBoxDropZen@@3HA ; g_iBlueChocolateBoxDropZen
  02825	50		 push	 eax
  02826	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02829	83 c1 77	 add	 ecx, 119		; 00000077H
  0282c	51		 push	 ecx
  0282d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02830	83 c2 6c	 add	 edx, 108		; 0000006cH
  02833	52		 push	 edx
  02834	68 00 00 00 00	 push	 OFFSET ??_C@_0FH@CKADFAKC@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  02839	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  0283f	83 c4 10	 add	 esp, 16			; 00000010H

; 1083 : 		}
; 1084 : 		else

  02842	e9 a4 02 00 00	 jmp	 $LN13@DropBlueCh
$LN14@DropBlueCh:

; 1085 : 		{
; 1086 : 			DropItemNum = rand() % this->GetBagCount();

  02847	e8 00 00 00 00	 call	 _rand
  0284c	8b f0		 mov	 esi, eax
  0284e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02851	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02856	8b c8		 mov	 ecx, eax
  02858	8b c6		 mov	 eax, esi
  0285a	99		 cdq
  0285b	f7 f9		 idiv	 ecx
  0285d	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 1087 : 			dur = 0;

  02860	d9 ee		 fldz
  02862	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 1088 : 			x = lpObj->X;

  02865	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02868	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  0286f	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 1089 : 			y = lpObj->Y;

  02872	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02875	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0287c	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1090 : 			level = this->GetLevel(DropItemNum);

  0287f	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02882	50		 push	 eax
  02883	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02886	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  0288b	0f b6 c8	 movzx	 ecx, al
  0288e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 1091 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  02891	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02894	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02897	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0289f	52		 push	 edx
  028a0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  028a3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  028a6	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  028ae	52		 push	 edx
  028af	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  028b4	83 c4 08	 add	 esp, 8
  028b7	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1092 : 
; 1093 : 			if ( type == -1 )

  028ba	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  028be	75 07		 jne	 SHORT $LN12@DropBlueCh

; 1094 : 				return FALSE;

  028c0	33 c0		 xor	 eax, eax
  028c2	e9 80 02 00 00	 jmp	 $LN17@DropBlueCh
$LN12@DropBlueCh:

; 1095 : 
; 1096 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  028c7	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  028ca	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  028cd	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  028d5	85 d2		 test	 edx, edx
  028d7	74 07		 je	 SHORT $LN11@DropBlueCh

; 1097 : 				Option1 = 1;

  028d9	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropBlueCh:

; 1098 : 
; 1099 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  028e0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  028e3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  028e6	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  028ee	85 d2		 test	 edx, edx
  028f0	74 23		 je	 SHORT $LN9@DropBlueCh

; 1100 : 			{
; 1101 : 				Option2 = 0;

  028f2	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1102 : 
; 1103 : 				if ( (rand()%2) == 0 )

  028f9	e8 00 00 00 00	 call	 _rand
  028fe	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  02903	79 05		 jns	 SHORT $LN19@DropBlueCh
  02905	48		 dec	 eax
  02906	83 c8 fe	 or	 eax, -2			; fffffffeH
  02909	40		 inc	 eax
$LN19@DropBlueCh:
  0290a	85 c0		 test	 eax, eax
  0290c	75 07		 jne	 SHORT $LN9@DropBlueCh

; 1104 : 				{
; 1105 : 					Option2 = 1;

  0290e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropBlueCh:

; 1106 : 				}
; 1107 : 			}
; 1108 : 
; 1109 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  02915	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02918	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0291b	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  02923	85 d2		 test	 edx, edx
  02925	74 2b		 je	 SHORT $LN6@DropBlueCh

; 1110 : 			{
; 1111 : 				if ( (rand()%5) < 1 )

  02927	e8 00 00 00 00	 call	 _rand
  0292c	99		 cdq
  0292d	b9 05 00 00 00	 mov	 ecx, 5
  02932	f7 f9		 idiv	 ecx
  02934	83 fa 01	 cmp	 edx, 1
  02937	7d 09		 jge	 SHORT $LN7@DropBlueCh

; 1112 : 				{
; 1113 : 					Option3 = 3;

  02939	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1114 : 				}
; 1115 : 				else

  02940	eb 10		 jmp	 SHORT $LN6@DropBlueCh
$LN7@DropBlueCh:

; 1116 : 				{
; 1117 : 					Option3 = rand() % 3;

  02942	e8 00 00 00 00	 call	 _rand
  02947	99		 cdq
  02948	b9 03 00 00 00	 mov	 ecx, 3
  0294d	f7 f9		 idiv	 ecx
  0294f	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropBlueCh:

; 1118 : 				}
; 1119 : 			}
; 1120 : 
; 1121 : 			if ( this->BagObject[DropItemNum].m_isexitem )

  02952	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02955	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02958	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  02960	85 d2		 test	 edx, edx
  02962	74 20		 je	 SHORT $LN5@DropBlueCh

; 1122 : 			{
; 1123 : 				ExOption = NewOptionRand(level);

  02964	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  02967	50		 push	 eax
  02968	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  0296d	83 c4 04	 add	 esp, 4
  02970	0f b6 c8	 movzx	 ecx, al
  02973	89 4d d0	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 1124 : #ifndef _FIX_
; 1125 : 				Option2 = 0;
; 1126 : #endif
; 1127 : 				Option1 = 1;

  02976	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1

; 1128 : 				level = 0;

  0297d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN5@DropBlueCh:

; 1129 : 			}
; 1130 : 
; 1131 : 			if ( type == ITEMGET(12,15) ||
; 1132 : 				 type == ITEMGET(14,13) ||
; 1133 : 				 type == ITEMGET(14,14)  )

  02984	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  0298b	74 12		 je	 SHORT $LN3@DropBlueCh
  0298d	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  02994	74 09		 je	 SHORT $LN3@DropBlueCh
  02996	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  0299d	75 1c		 jne	 SHORT $LN4@DropBlueCh
$LN3@DropBlueCh:

; 1134 : 			{
; 1135 : 				Option1 = 0;

  0299f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1136 : 				Option2 = 0;

  029a6	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1137 : 				Option3 = 0;

  029ad	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1138 : 				level = 0;

  029b4	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropBlueCh:

; 1139 : 			}
; 1140 : 
; 1141 : 			if ( type == ITEMGET(13,8) ||
; 1142 : 				 type == ITEMGET(13,9) ||
; 1143 : 				 type == ITEMGET(13,12) ||
; 1144 : 				 type == ITEMGET(13,21) )

  029bb	81 7d f4 08 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6664 ; 00001a08H
  029c2	74 1b		 je	 SHORT $LN1@DropBlueCh
  029c4	81 7d f4 09 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6665 ; 00001a09H
  029cb	74 12		 je	 SHORT $LN1@DropBlueCh
  029cd	81 7d f4 0c 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6668 ; 00001a0cH
  029d4	74 09		 je	 SHORT $LN1@DropBlueCh
  029d6	81 7d f4 15 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6677 ; 00001a15H
  029dd	75 07		 jne	 SHORT $LN2@DropBlueCh
$LN1@DropBlueCh:

; 1145 : 			{
; 1146 : 				level = 0;

  029df	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN2@DropBlueCh:

; 1147 : 			}
; 1148 : 			
; 1149 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1150 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  029e6	6a 00		 push	 0
  029e8	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  029ec	50		 push	 eax
  029ed	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  029f0	8b 11		 mov	 edx, DWORD PTR [ecx]
  029f2	52		 push	 edx
  029f3	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  029f7	50		 push	 eax
  029f8	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  029fc	51		 push	 ecx
  029fd	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  02a01	52		 push	 edx
  02a02	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  02a05	d9 7d 82	 fnstcw	 WORD PTR tv316[ebp]
  02a08	0f b7 45 82	 movzx	 eax, WORD PTR tv316[ebp]
  02a0c	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  02a11	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv319[ebp], eax
  02a17	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv319[ebp]
  02a1d	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv321[ebp]
  02a23	d9 6d 82	 fldcw	 WORD PTR tv316[ebp]
  02a26	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv321[ebp]
  02a2d	50		 push	 eax
  02a2e	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  02a32	51		 push	 ecx
  02a33	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  02a36	52		 push	 edx
  02a37	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  02a3b	50		 push	 eax
  02a3c	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  02a40	51		 push	 ecx
  02a41	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02a44	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  02a4b	50		 push	 eax
  02a4c	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02a4f	8b 11		 mov	 edx, DWORD PTR [ecx]
  02a51	52		 push	 edx
  02a52	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  02a57	83 c4 34	 add	 esp, 52			; 00000034H

; 1151 : 
; 1152 : 			LogAddTD("[EVENT VALENTINE'S DAY CHOCOLATEBOX ] BLUECHOCOLATEBOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d  Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1153 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1154 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1155 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  02a5a	6a 00		 push	 0
  02a5c	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  02a5f	83 e0 01	 and	 eax, 1
  02a62	50		 push	 eax
  02a63	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  02a66	83 e1 02	 and	 ecx, 2
  02a69	d1 f9		 sar	 ecx, 1
  02a6b	51		 push	 ecx
  02a6c	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  02a6f	83 e2 04	 and	 edx, 4
  02a72	c1 fa 02	 sar	 edx, 2
  02a75	52		 push	 edx
  02a76	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  02a79	83 e0 08	 and	 eax, 8
  02a7c	c1 f8 03	 sar	 eax, 3
  02a7f	50		 push	 eax
  02a80	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  02a83	83 e1 10	 and	 ecx, 16			; 00000010H
  02a86	c1 f9 04	 sar	 ecx, 4
  02a89	51		 push	 ecx
  02a8a	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  02a8d	83 e2 20	 and	 edx, 32			; 00000020H
  02a90	c1 fa 05	 sar	 edx, 5
  02a93	52		 push	 edx
  02a94	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  02a97	50		 push	 eax
  02a98	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  02a9b	51		 push	 ecx
  02a9c	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  02a9f	52		 push	 edx
  02aa0	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  02aa3	50		 push	 eax
  02aa4	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  02aa7	51		 push	 ecx
  02aa8	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  02aab	6b d2 70	 imul	 edx, 112		; 00000070H
  02aae	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  02ab4	52		 push	 edx
  02ab5	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  02ab8	50		 push	 eax
  02ab9	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  02abc	51		 push	 ecx
  02abd	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02ac0	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  02ac7	50		 push	 eax
  02ac8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02acb	83 c1 08	 add	 ecx, 8
  02ace	51		 push	 ecx
  02acf	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02ad2	83 c2 77	 add	 edx, 119		; 00000077H
  02ad5	52		 push	 edx
  02ad6	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02ad9	83 c0 6c	 add	 eax, 108		; 0000006cH
  02adc	50		 push	 eax
  02add	68 00 00 00 00	 push	 OFFSET ??_C@_0KH@KCPHJKBG@?$FLEVENT?5VALENTINE?8S?5DAY?5CHOCOLATE@
  02ae2	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  02ae8	83 c4 50	 add	 esp, 80			; 00000050H
$LN13@DropBlueCh:

; 1156 : 		}
; 1157 : 
; 1158 : 		PMSG_SERVERCMD ServerCmd;
; 1159 : 
; 1160 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  02aeb	6a 07		 push	 7
  02aed	6a 40		 push	 64			; 00000040H
  02aef	68 f3 00 00 00	 push	 243			; 000000f3H
  02af4	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228508[ebp]
  02af7	50		 push	 eax
  02af8	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  02afd	83 c4 10	 add	 esp, 16			; 00000010H

; 1161 : 		ServerCmd.CmdType = 0;

  02b00	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228508[ebp+4], 0

; 1162 : 		ServerCmd.X = lpObj->X;

  02b04	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02b07	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  02b0d	88 4d c9	 mov	 BYTE PTR _ServerCmd$228508[ebp+5], cl

; 1163 : 		ServerCmd.Y = lpObj->Y;

  02b10	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02b13	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  02b19	88 4d ca	 mov	 BYTE PTR _ServerCmd$228508[ebp+6], cl

; 1164 : 
; 1165 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  02b1c	6a 07		 push	 7
  02b1e	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228508[ebp]
  02b21	50		 push	 eax
  02b22	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02b25	51		 push	 ecx
  02b26	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  02b2b	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1166 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  02b2e	6a 07		 push	 7
  02b30	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228508[ebp]
  02b33	50		 push	 eax
  02b34	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02b37	8b 11		 mov	 edx, DWORD PTR [ecx]
  02b39	52		 push	 edx
  02b3a	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  02b3f	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@DropBlueCh:

; 1167 : 	}
; 1168 : 
; 1169 : 	return TRUE;

  02b42	b8 01 00 00 00	 mov	 eax, 1
$LN17@DropBlueCh:

; 1170 : }

  02b47	5f		 pop	 edi
  02b48	5e		 pop	 esi
  02b49	5b		 pop	 ebx
  02b4a	8b e5		 mov	 esp, ebp
  02b4c	5d		 pop	 ebp
  02b4d	c2 04 00	 ret	 4
?DropBlueChocolateBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropBlueChocolateBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ ; `string'
PUBLIC	??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ ; `string'
PUBLIC	?DropLightPurpleCandyBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropLightPurpleCandyBoxEventItem
EXTRN	?g_iLightPurpleCandyBoxDropZen@@3HA:DWORD	; g_iLightPurpleCandyBoxDropZen
EXTRN	?g_iLightPurpleCandyBoxDropZenRate@@3HA:DWORD	; g_iLightPurpleCandyBoxDropZenRate
;	COMDAT ??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
CONST	SEGMENT
??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%'
	DB	's] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:'
	DB	'%d Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
CONST	SEGMENT
??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%'
	DB	's] [%d Zen]', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv307 = -136						; size = 4
tv305 = -132						; size = 4
tv302 = -126						; size = 2
_ServerCmd$228554 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropLightPurpleCandyBoxEventItem@CItemBagEx@@QAEHH@Z PROC ; CItemBagEx::DropLightPurpleCandyBoxEventItem
; _this$ = ecx

; 1175 : {

  02b50	55		 push	 ebp
  02b51	8b ec		 mov	 ebp, esp
  02b53	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  02b59	53		 push	 ebx
  02b5a	56		 push	 esi
  02b5b	57		 push	 edi
  02b5c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1176 : 	if ( this->m_bLoad == FALSE )

  02b5f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  02b62	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  02b66	75 07		 jne	 SHORT $LN15@DropLightP

; 1177 : 		return FALSE;

  02b68	33 c0		 xor	 eax, eax
  02b6a	e9 92 03 00 00	 jmp	 $LN16@DropLightP
$LN15@DropLightP:

; 1178 : 
; 1179 : 	float dur;
; 1180 : 	int type;
; 1181 : 	int level;
; 1182 : 	int x;
; 1183 : 	int y;
; 1184 : 	int Option1 = 0;

  02b6f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1185 : 	int Option2 = 0;

  02b76	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1186 : 	int Option3 = 0;

  02b7d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1187 : 	int DropItemRate;
; 1188 : 	int DropItemNum;
; 1189 : 	int ExOption = 0;

  02b84	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1190 : 	LPOBJ lpObj = &gObj[aIndex];

  02b8b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  02b8e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02b94	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02b9a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1191 : 
; 1192 : 	if ( this->GetBagCount() > 0 )

  02b9d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02ba0	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02ba5	85 c0		 test	 eax, eax
  02ba7	0f 8e 4f 03 00
	00		 jle	 $LN14@DropLightP

; 1193 : 	{
; 1194 : 		DropItemRate = rand() % 10000;

  02bad	e8 00 00 00 00	 call	 _rand
  02bb2	99		 cdq
  02bb3	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  02bb8	f7 f9		 idiv	 ecx
  02bba	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 1195 : 
; 1196 : 		if ( DropItemRate < g_iLightPurpleCandyBoxDropZenRate )

  02bbd	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  02bc0	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iLightPurpleCandyBoxDropZenRate@@3HA ; g_iLightPurpleCandyBoxDropZenRate
  02bc6	7d 5f		 jge	 SHORT $LN13@DropLightP

; 1197 : 		{
; 1198 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iLightPurpleCandyBoxDropZen, 
; 1199 : 				lpObj->X, lpObj->Y);

  02bc8	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02bcb	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  02bd2	51		 push	 ecx
  02bd3	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02bd6	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  02bdd	50		 push	 eax
  02bde	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iLightPurpleCandyBoxDropZen@@3HA ; g_iLightPurpleCandyBoxDropZen
  02be4	51		 push	 ecx
  02be5	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02be8	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  02bef	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  02bf5	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  02bfb	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1200 : 
; 1201 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%s] [%d Zen]",
; 1202 : 				lpObj->AccountID, lpObj->Name,
; 1203 : 				g_iLightPurpleCandyBoxDropZen);

  02c00	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iLightPurpleCandyBoxDropZen@@3HA ; g_iLightPurpleCandyBoxDropZen
  02c05	50		 push	 eax
  02c06	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02c09	83 c1 77	 add	 ecx, 119		; 00000077H
  02c0c	51		 push	 ecx
  02c0d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02c10	83 c2 6c	 add	 edx, 108		; 0000006cH
  02c13	52		 push	 edx
  02c14	68 00 00 00 00	 push	 OFFSET ??_C@_0EO@BALFJEBE@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
  02c19	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  02c1f	83 c4 10	 add	 esp, 16			; 00000010H

; 1204 : 		}
; 1205 : 		else

  02c22	e9 7e 02 00 00	 jmp	 $LN12@DropLightP
$LN13@DropLightP:

; 1206 : 		{
; 1207 : 			DropItemNum = rand() % this->GetBagCount();

  02c27	e8 00 00 00 00	 call	 _rand
  02c2c	8b f0		 mov	 esi, eax
  02c2e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02c31	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02c36	8b c8		 mov	 ecx, eax
  02c38	8b c6		 mov	 eax, esi
  02c3a	99		 cdq
  02c3b	f7 f9		 idiv	 ecx
  02c3d	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 1208 : 			dur = 0;

  02c40	d9 ee		 fldz
  02c42	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 1209 : 			x = lpObj->X;

  02c45	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02c48	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  02c4f	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 1210 : 			y = lpObj->Y;

  02c52	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02c55	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  02c5c	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1211 : 			level = this->GetLevel(DropItemNum);

  02c5f	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02c62	50		 push	 eax
  02c63	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02c66	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  02c6b	0f b6 c8	 movzx	 ecx, al
  02c6e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 1212 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  02c71	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02c74	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02c77	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  02c7f	52		 push	 edx
  02c80	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02c83	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02c86	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  02c8e	52		 push	 edx
  02c8f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  02c94	83 c4 08	 add	 esp, 8
  02c97	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1213 : 
; 1214 : 			if ( type == -1 )

  02c9a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  02c9e	75 07		 jne	 SHORT $LN11@DropLightP

; 1215 : 				return FALSE;

  02ca0	33 c0		 xor	 eax, eax
  02ca2	e9 5a 02 00 00	 jmp	 $LN16@DropLightP
$LN11@DropLightP:

; 1216 : 
; 1217 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  02ca7	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02caa	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02cad	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  02cb5	85 d2		 test	 edx, edx
  02cb7	74 07		 je	 SHORT $LN10@DropLightP

; 1218 : 				Option1 = 1;

  02cb9	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN10@DropLightP:

; 1219 : 
; 1220 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  02cc0	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02cc3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02cc6	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  02cce	85 d2		 test	 edx, edx
  02cd0	74 23		 je	 SHORT $LN8@DropLightP

; 1221 : 			{
; 1222 : 				Option2 = 0;

  02cd2	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1223 : 
; 1224 : 				if ( (rand()%2) == 0 )

  02cd9	e8 00 00 00 00	 call	 _rand
  02cde	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  02ce3	79 05		 jns	 SHORT $LN18@DropLightP
  02ce5	48		 dec	 eax
  02ce6	83 c8 fe	 or	 eax, -2			; fffffffeH
  02ce9	40		 inc	 eax
$LN18@DropLightP:
  02cea	85 c0		 test	 eax, eax
  02cec	75 07		 jne	 SHORT $LN8@DropLightP

; 1225 : 				{
; 1226 : 					Option2 = 1;

  02cee	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN8@DropLightP:

; 1227 : 				}
; 1228 : 			}
; 1229 : 
; 1230 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  02cf5	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  02cf8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02cfb	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  02d03	85 d2		 test	 edx, edx
  02d05	74 2b		 je	 SHORT $LN5@DropLightP

; 1231 : 			{
; 1232 : 				if ( (rand()%5) < 1 )

  02d07	e8 00 00 00 00	 call	 _rand
  02d0c	99		 cdq
  02d0d	b9 05 00 00 00	 mov	 ecx, 5
  02d12	f7 f9		 idiv	 ecx
  02d14	83 fa 01	 cmp	 edx, 1
  02d17	7d 09		 jge	 SHORT $LN6@DropLightP

; 1233 : 				{
; 1234 : 					Option3 = 3;

  02d19	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1235 : 				}
; 1236 : 				else

  02d20	eb 10		 jmp	 SHORT $LN5@DropLightP
$LN6@DropLightP:

; 1237 : 				{
; 1238 : 					Option3 = rand() % 3;

  02d22	e8 00 00 00 00	 call	 _rand
  02d27	99		 cdq
  02d28	b9 03 00 00 00	 mov	 ecx, 3
  02d2d	f7 f9		 idiv	 ecx
  02d2f	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN5@DropLightP:

; 1239 : 				}
; 1240 : 			}
; 1241 : 
; 1242 : 			ExOption = 0;

  02d32	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1243 : 
; 1244 : 			if ( type == ITEMGET(12,15) ||
; 1245 : 				 type == ITEMGET(14,13) ||
; 1246 : 				 type == ITEMGET(14,14) )

  02d39	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  02d40	74 12		 je	 SHORT $LN3@DropLightP
  02d42	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  02d49	74 09		 je	 SHORT $LN3@DropLightP
  02d4b	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  02d52	75 1c		 jne	 SHORT $LN4@DropLightP
$LN3@DropLightP:

; 1247 : 			{
; 1248 : 				Option1 = 0;

  02d54	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1249 : 				Option2 = 0;

  02d5b	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1250 : 				Option3 = 0;

  02d62	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1251 : 				level = 0;

  02d69	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropLightP:

; 1252 : 			}
; 1253 : 
; 1254 : 			if ( type == ITEMGET(14,19) ||
; 1255 : 				 type == ITEMGET(14,28) ||
; 1256 : 				 type == ITEMGET(13,18) )

  02d70	81 7d f4 13 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7187 ; 00001c13H
  02d77	74 12		 je	 SHORT $LN1@DropLightP
  02d79	81 7d f4 1c 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7196 ; 00001c1cH
  02d80	74 09		 je	 SHORT $LN1@DropLightP
  02d82	81 7d f4 12 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6674 ; 00001a12H
  02d89	75 15		 jne	 SHORT $LN2@DropLightP
$LN1@DropLightP:

; 1257 : 			{
; 1258 : 				Option1 = 0;

  02d8b	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1259 : 				Option2 = 0;

  02d92	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1260 : 				Option3 = 0;

  02d99	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0
$LN2@DropLightP:

; 1261 : 			}
; 1262 : 			
; 1263 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1264 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  02da0	6a 00		 push	 0
  02da2	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  02da6	50		 push	 eax
  02da7	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02daa	8b 11		 mov	 edx, DWORD PTR [ecx]
  02dac	52		 push	 edx
  02dad	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  02db1	50		 push	 eax
  02db2	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  02db6	51		 push	 ecx
  02db7	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  02dbb	52		 push	 edx
  02dbc	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  02dbf	d9 7d 82	 fnstcw	 WORD PTR tv302[ebp]
  02dc2	0f b7 45 82	 movzx	 eax, WORD PTR tv302[ebp]
  02dc6	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  02dcb	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv305[ebp], eax
  02dd1	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv305[ebp]
  02dd7	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv307[ebp]
  02ddd	d9 6d 82	 fldcw	 WORD PTR tv302[ebp]
  02de0	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv307[ebp]
  02de7	50		 push	 eax
  02de8	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  02dec	51		 push	 ecx
  02ded	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  02df0	52		 push	 edx
  02df1	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  02df5	50		 push	 eax
  02df6	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  02dfa	51		 push	 ecx
  02dfb	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02dfe	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  02e05	50		 push	 eax
  02e06	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02e09	8b 11		 mov	 edx, DWORD PTR [ecx]
  02e0b	52		 push	 edx
  02e0c	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  02e11	83 c4 34	 add	 esp, 52			; 00000034H

; 1265 : 
; 1266 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] LIGHT PURPLE BOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1267 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1268 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1269 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  02e14	6a 00		 push	 0
  02e16	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  02e19	83 e0 01	 and	 eax, 1
  02e1c	50		 push	 eax
  02e1d	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  02e20	83 e1 02	 and	 ecx, 2
  02e23	d1 f9		 sar	 ecx, 1
  02e25	51		 push	 ecx
  02e26	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  02e29	83 e2 04	 and	 edx, 4
  02e2c	c1 fa 02	 sar	 edx, 2
  02e2f	52		 push	 edx
  02e30	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  02e33	83 e0 08	 and	 eax, 8
  02e36	c1 f8 03	 sar	 eax, 3
  02e39	50		 push	 eax
  02e3a	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  02e3d	83 e1 10	 and	 ecx, 16			; 00000010H
  02e40	c1 f9 04	 sar	 ecx, 4
  02e43	51		 push	 ecx
  02e44	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  02e47	83 e2 20	 and	 edx, 32			; 00000020H
  02e4a	c1 fa 05	 sar	 edx, 5
  02e4d	52		 push	 edx
  02e4e	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  02e51	50		 push	 eax
  02e52	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  02e55	51		 push	 ecx
  02e56	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  02e59	52		 push	 edx
  02e5a	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  02e5d	50		 push	 eax
  02e5e	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  02e61	51		 push	 ecx
  02e62	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  02e65	6b d2 70	 imul	 edx, 112		; 00000070H
  02e68	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  02e6e	52		 push	 edx
  02e6f	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  02e72	50		 push	 eax
  02e73	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  02e76	51		 push	 ecx
  02e77	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02e7a	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  02e81	50		 push	 eax
  02e82	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02e85	83 c1 08	 add	 ecx, 8
  02e88	51		 push	 ecx
  02e89	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02e8c	83 c2 77	 add	 edx, 119		; 00000077H
  02e8f	52		 push	 edx
  02e90	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02e93	83 c0 6c	 add	 eax, 108		; 0000006cH
  02e96	50		 push	 eax
  02e97	68 00 00 00 00	 push	 OFFSET ??_C@_0JM@KKDJBICI@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5LIGH@
  02e9c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  02ea2	83 c4 50	 add	 esp, 80			; 00000050H
$LN12@DropLightP:

; 1270 : 		}
; 1271 : 
; 1272 : 		PMSG_SERVERCMD ServerCmd;
; 1273 : 
; 1274 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  02ea5	6a 07		 push	 7
  02ea7	6a 40		 push	 64			; 00000040H
  02ea9	68 f3 00 00 00	 push	 243			; 000000f3H
  02eae	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228554[ebp]
  02eb1	50		 push	 eax
  02eb2	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  02eb7	83 c4 10	 add	 esp, 16			; 00000010H

; 1275 : 		ServerCmd.CmdType = 0;

  02eba	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228554[ebp+4], 0

; 1276 : 		ServerCmd.X = lpObj->X;

  02ebe	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02ec1	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  02ec7	88 4d c9	 mov	 BYTE PTR _ServerCmd$228554[ebp+5], cl

; 1277 : 		ServerCmd.Y = lpObj->Y;

  02eca	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02ecd	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  02ed3	88 4d ca	 mov	 BYTE PTR _ServerCmd$228554[ebp+6], cl

; 1278 : 
; 1279 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  02ed6	6a 07		 push	 7
  02ed8	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228554[ebp]
  02edb	50		 push	 eax
  02edc	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02edf	51		 push	 ecx
  02ee0	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  02ee5	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1280 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  02ee8	6a 07		 push	 7
  02eea	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228554[ebp]
  02eed	50		 push	 eax
  02eee	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02ef1	8b 11		 mov	 edx, DWORD PTR [ecx]
  02ef3	52		 push	 edx
  02ef4	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  02ef9	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN14@DropLightP:

; 1281 : 	}
; 1282 : 
; 1283 : 	return TRUE;

  02efc	b8 01 00 00 00	 mov	 eax, 1
$LN16@DropLightP:

; 1284 : }

  02f01	5f		 pop	 edi
  02f02	5e		 pop	 esi
  02f03	5b		 pop	 ebx
  02f04	8b e5		 mov	 esp, ebp
  02f06	5d		 pop	 ebp
  02f07	c2 04 00	 ret	 4
?DropLightPurpleCandyBoxEventItem@CItemBagEx@@QAEHH@Z ENDP ; CItemBagEx::DropLightPurpleCandyBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ ; `string'
PUBLIC	??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ ; `string'
PUBLIC	?DropVermilionCandyBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropVermilionCandyBoxEventItem
EXTRN	?g_iVermilionCandyBoxDropZen@@3HA:DWORD		; g_iVermilionCandyBoxDropZen
EXTRN	?g_iVermilionCandyBoxDropZenRate@@3HA:DWORD	; g_iVermilionCandyBoxDropZenRate
;	COMDAT ??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
CONST	SEGMENT
??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ DB '[EVENT'
	DB	' WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] ['
	DB	'%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d E'
	DB	'x:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
CONST	SEGMENT
??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] '
	DB	'[%d Zen]', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv321 = -136						; size = 4
tv319 = -132						; size = 4
tv316 = -126						; size = 2
_ServerCmd$228601 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropVermilionCandyBoxEventItem@CItemBagEx@@QAEHH@Z PROC ; CItemBagEx::DropVermilionCandyBoxEventItem
; _this$ = ecx

; 1288 : {

  02f10	55		 push	 ebp
  02f11	8b ec		 mov	 ebp, esp
  02f13	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  02f19	53		 push	 ebx
  02f1a	56		 push	 esi
  02f1b	57		 push	 edi
  02f1c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1289 : 	if ( this->m_bLoad == FALSE )

  02f1f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  02f22	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  02f26	75 07		 jne	 SHORT $LN16@DropVermil

; 1290 : 		return FALSE;

  02f28	33 c0		 xor	 eax, eax
  02f2a	e9 c6 03 00 00	 jmp	 $LN17@DropVermil
$LN16@DropVermil:

; 1291 : 
; 1292 : 	float dur;
; 1293 : 	int type;
; 1294 : 	int level;
; 1295 : 	int x;
; 1296 : 	int y;
; 1297 : 	int Option1 = 0;

  02f2f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1298 : 	int Option2 = 0;

  02f36	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1299 : 	int Option3 = 0;

  02f3d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1300 : 	int DropItemRate;
; 1301 : 	int DropItemNum;
; 1302 : 	int ExOption = 0;

  02f44	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1303 : 	LPOBJ lpObj = &gObj[aIndex];

  02f4b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  02f4e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  02f54	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  02f5a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1304 : 
; 1305 : 	if ( this->GetBagCount() > 0 )

  02f5d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02f60	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02f65	85 c0		 test	 eax, eax
  02f67	0f 8e 83 03 00
	00		 jle	 $LN15@DropVermil

; 1306 : 	{
; 1307 : 		DropItemRate = rand() % 10000;

  02f6d	e8 00 00 00 00	 call	 _rand
  02f72	99		 cdq
  02f73	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  02f78	f7 f9		 idiv	 ecx
  02f7a	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 1308 : 
; 1309 : 		if ( DropItemRate < g_iVermilionCandyBoxDropZenRate )

  02f7d	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  02f80	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iVermilionCandyBoxDropZenRate@@3HA ; g_iVermilionCandyBoxDropZenRate
  02f86	7d 5f		 jge	 SHORT $LN14@DropVermil

; 1310 : 		{
; 1311 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iVermilionCandyBoxDropZen, 
; 1312 : 				lpObj->X, lpObj->Y);

  02f88	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  02f8b	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  02f92	51		 push	 ecx
  02f93	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02f96	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  02f9d	50		 push	 eax
  02f9e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iVermilionCandyBoxDropZen@@3HA ; g_iVermilionCandyBoxDropZen
  02fa4	51		 push	 ecx
  02fa5	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02fa8	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  02faf	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  02fb5	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  02fbb	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1313 : 
; 1314 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] [%d Zen]",
; 1315 : 				lpObj->AccountID, lpObj->Name,
; 1316 : 				g_iVermilionCandyBoxDropZen);

  02fc0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iVermilionCandyBoxDropZen@@3HA ; g_iVermilionCandyBoxDropZen
  02fc5	50		 push	 eax
  02fc6	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  02fc9	83 c1 77	 add	 ecx, 119		; 00000077H
  02fcc	51		 push	 ecx
  02fcd	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  02fd0	83 c2 6c	 add	 edx, 108		; 0000006cH
  02fd3	52		 push	 edx
  02fd4	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@PEMOOOOC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
  02fd9	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  02fdf	83 c4 10	 add	 esp, 16			; 00000010H

; 1317 : 		}
; 1318 : 		else

  02fe2	e9 b2 02 00 00	 jmp	 $LN13@DropVermil
$LN14@DropVermil:

; 1319 : 		{
; 1320 : 			DropItemNum = rand() % this->GetBagCount();

  02fe7	e8 00 00 00 00	 call	 _rand
  02fec	8b f0		 mov	 esi, eax
  02fee	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  02ff1	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  02ff6	8b c8		 mov	 ecx, eax
  02ff8	8b c6		 mov	 eax, esi
  02ffa	99		 cdq
  02ffb	f7 f9		 idiv	 ecx
  02ffd	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 1321 : 			dur = 0;

  03000	d9 ee		 fldz
  03002	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 1322 : 			x = lpObj->X;

  03005	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03008	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  0300f	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 1323 : 			y = lpObj->Y;

  03012	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03015	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0301c	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1324 : 			level = this->GetLevel(DropItemNum);

  0301f	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03022	50		 push	 eax
  03023	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03026	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  0302b	0f b6 c8	 movzx	 ecx, al
  0302e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 1325 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  03031	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03034	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03037	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0303f	52		 push	 edx
  03040	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03043	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03046	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  0304e	52		 push	 edx
  0304f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  03054	83 c4 08	 add	 esp, 8
  03057	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1326 : 
; 1327 : 			if ( type == -1 )

  0305a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  0305e	75 07		 jne	 SHORT $LN12@DropVermil

; 1328 : 				return FALSE;

  03060	33 c0		 xor	 eax, eax
  03062	e9 8e 02 00 00	 jmp	 $LN17@DropVermil
$LN12@DropVermil:

; 1329 : 
; 1330 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  03067	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0306a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0306d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  03075	85 d2		 test	 edx, edx
  03077	74 07		 je	 SHORT $LN11@DropVermil

; 1331 : 				Option1 = 1;

  03079	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropVermil:

; 1332 : 
; 1333 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  03080	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03083	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03086	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  0308e	85 d2		 test	 edx, edx
  03090	74 23		 je	 SHORT $LN9@DropVermil

; 1334 : 			{
; 1335 : 				Option2 = 0;

  03092	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1336 : 
; 1337 : 				if ( (rand()%2) == 0 )

  03099	e8 00 00 00 00	 call	 _rand
  0309e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  030a3	79 05		 jns	 SHORT $LN19@DropVermil
  030a5	48		 dec	 eax
  030a6	83 c8 fe	 or	 eax, -2			; fffffffeH
  030a9	40		 inc	 eax
$LN19@DropVermil:
  030aa	85 c0		 test	 eax, eax
  030ac	75 07		 jne	 SHORT $LN9@DropVermil

; 1338 : 				{
; 1339 : 					Option2 = 1;

  030ae	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropVermil:

; 1340 : 				}
; 1341 : 			}
; 1342 : 
; 1343 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  030b5	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  030b8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  030bb	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  030c3	85 d2		 test	 edx, edx
  030c5	74 2b		 je	 SHORT $LN6@DropVermil

; 1344 : 			{
; 1345 : 				if ( (rand()%5) < 1 )

  030c7	e8 00 00 00 00	 call	 _rand
  030cc	99		 cdq
  030cd	b9 05 00 00 00	 mov	 ecx, 5
  030d2	f7 f9		 idiv	 ecx
  030d4	83 fa 01	 cmp	 edx, 1
  030d7	7d 09		 jge	 SHORT $LN7@DropVermil

; 1346 : 				{
; 1347 : 					Option3 = 3;

  030d9	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1348 : 				}
; 1349 : 				else

  030e0	eb 10		 jmp	 SHORT $LN6@DropVermil
$LN7@DropVermil:

; 1350 : 				{
; 1351 : 					Option3 = rand() % 3;

  030e2	e8 00 00 00 00	 call	 _rand
  030e7	99		 cdq
  030e8	b9 03 00 00 00	 mov	 ecx, 3
  030ed	f7 f9		 idiv	 ecx
  030ef	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropVermil:

; 1352 : 				}
; 1353 : 			}
; 1354 : 
; 1355 : 			if ( this->BagObject[DropItemNum].m_isexitem )

  030f2	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  030f5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  030f8	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  03100	85 d2		 test	 edx, edx
  03102	74 20		 je	 SHORT $LN5@DropVermil

; 1356 : 			{
; 1357 : 				ExOption = NewOptionRand(level);

  03104	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  03107	50		 push	 eax
  03108	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  0310d	83 c4 04	 add	 esp, 4
  03110	0f b6 c8	 movzx	 ecx, al
  03113	89 4d d0	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 1358 : #ifndef _FIX_
; 1359 : 				Option2 = 0;
; 1360 : #endif
; 1361 : 				Option1 = 1;

  03116	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1

; 1362 : 				level = 0;

  0311d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN5@DropVermil:

; 1363 : 			}
; 1364 : 
; 1365 : 			if ( type == ITEMGET(12,15) ||
; 1366 : 				 type == ITEMGET(14,13) ||
; 1367 : 				 type == ITEMGET(14,14) ||
; 1368 : 				 type == ITEMGET(14,16) )

  03124	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  0312b	74 1b		 je	 SHORT $LN3@DropVermil
  0312d	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  03134	74 12		 je	 SHORT $LN3@DropVermil
  03136	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  0313d	74 09		 je	 SHORT $LN3@DropVermil
  0313f	81 7d f4 10 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7184 ; 00001c10H
  03146	75 1c		 jne	 SHORT $LN4@DropVermil
$LN3@DropVermil:

; 1369 : 			{
; 1370 : 				Option1 = 0;

  03148	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1371 : 				Option2 = 0;

  0314f	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1372 : 				Option3 = 0;

  03156	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1373 : 				level = 0;

  0315d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropVermil:

; 1374 : 			}
; 1375 : 
; 1376 : 			if ( type == ITEMGET(14,19) ||
; 1377 : 				 type == ITEMGET(14,28) ||
; 1378 : 				 type == ITEMGET(13,18) )

  03164	81 7d f4 13 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7187 ; 00001c13H
  0316b	74 12		 je	 SHORT $LN1@DropVermil
  0316d	81 7d f4 1c 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7196 ; 00001c1cH
  03174	74 09		 je	 SHORT $LN1@DropVermil
  03176	81 7d f4 12 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6674 ; 00001a12H
  0317d	75 15		 jne	 SHORT $LN2@DropVermil
$LN1@DropVermil:

; 1379 : 			{
; 1380 : 				Option1 = 0;

  0317f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1381 : 				Option2 = 0;

  03186	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1382 : 				Option3 = 0;

  0318d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0
$LN2@DropVermil:

; 1383 : 			}
; 1384 : 			
; 1385 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1386 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  03194	6a 00		 push	 0
  03196	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  0319a	50		 push	 eax
  0319b	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0319e	8b 11		 mov	 edx, DWORD PTR [ecx]
  031a0	52		 push	 edx
  031a1	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  031a5	50		 push	 eax
  031a6	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  031aa	51		 push	 ecx
  031ab	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  031af	52		 push	 edx
  031b0	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  031b3	d9 7d 82	 fnstcw	 WORD PTR tv316[ebp]
  031b6	0f b7 45 82	 movzx	 eax, WORD PTR tv316[ebp]
  031ba	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  031bf	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv319[ebp], eax
  031c5	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv319[ebp]
  031cb	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv321[ebp]
  031d1	d9 6d 82	 fldcw	 WORD PTR tv316[ebp]
  031d4	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv321[ebp]
  031db	50		 push	 eax
  031dc	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  031e0	51		 push	 ecx
  031e1	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  031e4	52		 push	 edx
  031e5	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  031e9	50		 push	 eax
  031ea	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  031ee	51		 push	 ecx
  031ef	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  031f2	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  031f9	50		 push	 eax
  031fa	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  031fd	8b 11		 mov	 edx, DWORD PTR [ecx]
  031ff	52		 push	 edx
  03200	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  03205	83 c4 34	 add	 esp, 52			; 00000034H

; 1387 : 
; 1388 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] VERMILION BOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1389 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1390 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1391 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  03208	6a 00		 push	 0
  0320a	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  0320d	83 e0 01	 and	 eax, 1
  03210	50		 push	 eax
  03211	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  03214	83 e1 02	 and	 ecx, 2
  03217	d1 f9		 sar	 ecx, 1
  03219	51		 push	 ecx
  0321a	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  0321d	83 e2 04	 and	 edx, 4
  03220	c1 fa 02	 sar	 edx, 2
  03223	52		 push	 edx
  03224	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  03227	83 e0 08	 and	 eax, 8
  0322a	c1 f8 03	 sar	 eax, 3
  0322d	50		 push	 eax
  0322e	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  03231	83 e1 10	 and	 ecx, 16			; 00000010H
  03234	c1 f9 04	 sar	 ecx, 4
  03237	51		 push	 ecx
  03238	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  0323b	83 e2 20	 and	 edx, 32			; 00000020H
  0323e	c1 fa 05	 sar	 edx, 5
  03241	52		 push	 edx
  03242	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  03245	50		 push	 eax
  03246	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  03249	51		 push	 ecx
  0324a	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  0324d	52		 push	 edx
  0324e	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  03251	50		 push	 eax
  03252	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  03255	51		 push	 ecx
  03256	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  03259	6b d2 70	 imul	 edx, 112		; 00000070H
  0325c	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  03262	52		 push	 edx
  03263	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  03266	50		 push	 eax
  03267	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  0326a	51		 push	 ecx
  0326b	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  0326e	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  03275	50		 push	 eax
  03276	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03279	83 c1 08	 add	 ecx, 8
  0327c	51		 push	 ecx
  0327d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  03280	83 c2 77	 add	 edx, 119		; 00000077H
  03283	52		 push	 edx
  03284	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03287	83 c0 6c	 add	 eax, 108		; 0000006cH
  0328a	50		 push	 eax
  0328b	68 00 00 00 00	 push	 OFFSET ??_C@_0JJ@NBIHGBN@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5VERM@
  03290	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  03296	83 c4 50	 add	 esp, 80			; 00000050H
$LN13@DropVermil:

; 1392 : 		}
; 1393 : 
; 1394 : 		PMSG_SERVERCMD ServerCmd;
; 1395 : 
; 1396 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  03299	6a 07		 push	 7
  0329b	6a 40		 push	 64			; 00000040H
  0329d	68 f3 00 00 00	 push	 243			; 000000f3H
  032a2	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228601[ebp]
  032a5	50		 push	 eax
  032a6	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  032ab	83 c4 10	 add	 esp, 16			; 00000010H

; 1397 : 		ServerCmd.CmdType = 0;

  032ae	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228601[ebp+4], 0

; 1398 : 		ServerCmd.X = lpObj->X;

  032b2	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  032b5	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  032bb	88 4d c9	 mov	 BYTE PTR _ServerCmd$228601[ebp+5], cl

; 1399 : 		ServerCmd.Y = lpObj->Y;

  032be	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  032c1	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  032c7	88 4d ca	 mov	 BYTE PTR _ServerCmd$228601[ebp+6], cl

; 1400 : 
; 1401 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  032ca	6a 07		 push	 7
  032cc	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228601[ebp]
  032cf	50		 push	 eax
  032d0	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  032d3	51		 push	 ecx
  032d4	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  032d9	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1402 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  032dc	6a 07		 push	 7
  032de	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228601[ebp]
  032e1	50		 push	 eax
  032e2	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  032e5	8b 11		 mov	 edx, DWORD PTR [ecx]
  032e7	52		 push	 edx
  032e8	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  032ed	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@DropVermil:

; 1403 : 	}
; 1404 : 
; 1405 : 	return TRUE;

  032f0	b8 01 00 00 00	 mov	 eax, 1
$LN17@DropVermil:

; 1406 : }

  032f5	5f		 pop	 edi
  032f6	5e		 pop	 esi
  032f7	5b		 pop	 ebx
  032f8	8b e5		 mov	 esp, ebp
  032fa	5d		 pop	 ebp
  032fb	c2 04 00	 ret	 4
?DropVermilionCandyBoxEventItem@CItemBagEx@@QAEHH@Z ENDP ; CItemBagEx::DropVermilionCandyBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ ; `string'
PUBLIC	??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ ; `string'
PUBLIC	?DropDeepBlueCandyBoxEventItem@CItemBagEx@@QAEHH@Z ; CItemBagEx::DropDeepBlueCandyBoxEventItem
EXTRN	?g_iDeepBlueCandyBoxDropZen@@3HA:DWORD		; g_iDeepBlueCandyBoxDropZen
EXTRN	?g_iDeepBlueCandyBoxDropZenRate@@3HA:DWORD	; g_iDeepBlueCandyBoxDropZenRate
;	COMDAT ??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
CONST	SEGMENT
??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] '
	DB	'[%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d '
	DB	'Ex:[%d,%d,%d,%d,%d,%d,%d]', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
CONST	SEGMENT
??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@ DB '[EVEN'
	DB	'T WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] '
	DB	'[%d Zen]', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv321 = -136						; size = 4
tv319 = -132						; size = 4
tv316 = -126						; size = 2
_ServerCmd$228648 = -60					; size = 7
_lpObj$ = -52						; size = 4
_ExOption$ = -48					; size = 4
_DropItemNum$ = -44					; size = 4
_DropItemRate$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
?DropDeepBlueCandyBoxEventItem@CItemBagEx@@QAEHH@Z PROC	; CItemBagEx::DropDeepBlueCandyBoxEventItem
; _this$ = ecx

; 1412 : {

  03300	55		 push	 ebp
  03301	8b ec		 mov	 ebp, esp
  03303	81 ec 88 00 00
	00		 sub	 esp, 136		; 00000088H
  03309	53		 push	 ebx
  0330a	56		 push	 esi
  0330b	57		 push	 edi
  0330c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1413 : 	if ( this->m_bLoad == FALSE )

  0330f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  03312	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  03316	75 07		 jne	 SHORT $LN16@DropDeepBl

; 1414 : 		return FALSE;

  03318	33 c0		 xor	 eax, eax
  0331a	e9 b8 03 00 00	 jmp	 $LN17@DropDeepBl
$LN16@DropDeepBl:

; 1415 : 
; 1416 : 	float dur;
; 1417 : 	int type;
; 1418 : 	int level;
; 1419 : 	int x;
; 1420 : 	int y;
; 1421 : 	int Option1 = 0;

  0331f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1422 : 	int Option2 = 0;

  03326	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1423 : 	int Option3 = 0;

  0332d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1424 : 	int DropItemRate;
; 1425 : 	int DropItemNum;
; 1426 : 	int ExOption = 0;

  03334	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1427 : 	LPOBJ lpObj = &gObj[aIndex];

  0333b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0333e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  03344	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  0334a	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1428 : 
; 1429 : 	if ( this->GetBagCount() > 0 )

  0334d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03350	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  03355	85 c0		 test	 eax, eax
  03357	0f 8e 75 03 00
	00		 jle	 $LN15@DropDeepBl

; 1430 : 	{
; 1431 : 		DropItemRate = rand() % 10000;

  0335d	e8 00 00 00 00	 call	 _rand
  03362	99		 cdq
  03363	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  03368	f7 f9		 idiv	 ecx
  0336a	89 55 d8	 mov	 DWORD PTR _DropItemRate$[ebp], edx

; 1432 : 
; 1433 : 		if ( DropItemRate < g_iDeepBlueCandyBoxDropZenRate )

  0336d	8b 45 d8	 mov	 eax, DWORD PTR _DropItemRate$[ebp]
  03370	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iDeepBlueCandyBoxDropZenRate@@3HA ; g_iDeepBlueCandyBoxDropZenRate
  03376	7d 5f		 jge	 SHORT $LN14@DropDeepBl

; 1434 : 		{
; 1435 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iDeepBlueCandyBoxDropZen, 
; 1436 : 				lpObj->X, lpObj->Y);

  03378	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0337b	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  03382	51		 push	 ecx
  03383	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  03386	0f bf 82 44 01
	00 00		 movsx	 eax, WORD PTR [edx+324]
  0338d	50		 push	 eax
  0338e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?g_iDeepBlueCandyBoxDropZen@@3HA ; g_iDeepBlueCandyBoxDropZen
  03394	51		 push	 ecx
  03395	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  03398	0f b6 8a 49 01
	00 00		 movzx	 ecx, BYTE PTR [edx+329]
  0339f	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  033a5	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  033ab	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1437 : 
; 1438 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] [%d Zen]",
; 1439 : 				lpObj->AccountID, lpObj->Name,
; 1440 : 				g_iDeepBlueCandyBoxDropZen);

  033b0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iDeepBlueCandyBoxDropZen@@3HA ; g_iDeepBlueCandyBoxDropZen
  033b5	50		 push	 eax
  033b6	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  033b9	83 c1 77	 add	 ecx, 119		; 00000077H
  033bc	51		 push	 ecx
  033bd	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  033c0	83 c2 6c	 add	 edx, 108		; 0000006cH
  033c3	52		 push	 edx
  033c4	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@DLLMPLND@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
  033c9	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  033cf	83 c4 10	 add	 esp, 16			; 00000010H

; 1441 : 		}
; 1442 : 		else

  033d2	e9 a4 02 00 00	 jmp	 $LN13@DropDeepBl
$LN14@DropDeepBl:

; 1443 : 		{
; 1444 : 			DropItemNum = rand() % this->GetBagCount();

  033d7	e8 00 00 00 00	 call	 _rand
  033dc	8b f0		 mov	 esi, eax
  033de	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  033e1	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  033e6	8b c8		 mov	 ecx, eax
  033e8	8b c6		 mov	 eax, esi
  033ea	99		 cdq
  033eb	f7 f9		 idiv	 ecx
  033ed	89 55 d4	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 1445 : 			dur = 0;

  033f0	d9 ee		 fldz
  033f2	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 1446 : 			x = lpObj->X;

  033f5	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  033f8	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  033ff	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 1447 : 			y = lpObj->Y;

  03402	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03405	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0340c	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1448 : 			level = this->GetLevel(DropItemNum);

  0340f	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03412	50		 push	 eax
  03413	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03416	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  0341b	0f b6 c8	 movzx	 ecx, al
  0341e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 1449 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  03421	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03424	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03427	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0342f	52		 push	 edx
  03430	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03433	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03436	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  0343e	52		 push	 edx
  0343f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  03444	83 c4 08	 add	 esp, 8
  03447	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1450 : 
; 1451 : 			if ( type == -1 )

  0344a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  0344e	75 07		 jne	 SHORT $LN12@DropDeepBl

; 1452 : 				return FALSE;

  03450	33 c0		 xor	 eax, eax
  03452	e9 80 02 00 00	 jmp	 $LN17@DropDeepBl
$LN12@DropDeepBl:

; 1453 : 
; 1454 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  03457	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  0345a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0345d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  03465	85 d2		 test	 edx, edx
  03467	74 07		 je	 SHORT $LN11@DropDeepBl

; 1455 : 				Option1 = 1;

  03469	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropDeepBl:

; 1456 : 
; 1457 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  03470	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03473	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03476	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  0347e	85 d2		 test	 edx, edx
  03480	74 23		 je	 SHORT $LN9@DropDeepBl

; 1458 : 			{
; 1459 : 				Option2 = 0;

  03482	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1460 : 
; 1461 : 				if ( (rand()%2) == 0 )

  03489	e8 00 00 00 00	 call	 _rand
  0348e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  03493	79 05		 jns	 SHORT $LN19@DropDeepBl
  03495	48		 dec	 eax
  03496	83 c8 fe	 or	 eax, -2			; fffffffeH
  03499	40		 inc	 eax
$LN19@DropDeepBl:
  0349a	85 c0		 test	 eax, eax
  0349c	75 07		 jne	 SHORT $LN9@DropDeepBl

; 1462 : 				{
; 1463 : 					Option2 = 1;

  0349e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropDeepBl:

; 1464 : 				}
; 1465 : 			}
; 1466 : 
; 1467 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  034a5	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  034a8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  034ab	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  034b3	85 d2		 test	 edx, edx
  034b5	74 2b		 je	 SHORT $LN6@DropDeepBl

; 1468 : 			{
; 1469 : 				if ( (rand()%5) < 1 )

  034b7	e8 00 00 00 00	 call	 _rand
  034bc	99		 cdq
  034bd	b9 05 00 00 00	 mov	 ecx, 5
  034c2	f7 f9		 idiv	 ecx
  034c4	83 fa 01	 cmp	 edx, 1
  034c7	7d 09		 jge	 SHORT $LN7@DropDeepBl

; 1470 : 				{
; 1471 : 					Option3 = 3;

  034c9	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1472 : 				}
; 1473 : 				else

  034d0	eb 10		 jmp	 SHORT $LN6@DropDeepBl
$LN7@DropDeepBl:

; 1474 : 				{
; 1475 : 					Option3 = rand() % 3;

  034d2	e8 00 00 00 00	 call	 _rand
  034d7	99		 cdq
  034d8	b9 03 00 00 00	 mov	 ecx, 3
  034dd	f7 f9		 idiv	 ecx
  034df	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropDeepBl:

; 1476 : 				}
; 1477 : 			}
; 1478 : 
; 1479 : 			if ( this->BagObject[DropItemNum].m_isexitem )

  034e2	8b 45 d4	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  034e5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  034e8	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  034f0	85 d2		 test	 edx, edx
  034f2	74 20		 je	 SHORT $LN5@DropDeepBl

; 1480 : 			{
; 1481 : 				ExOption = NewOptionRand(level);

  034f4	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  034f7	50		 push	 eax
  034f8	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  034fd	83 c4 04	 add	 esp, 4
  03500	0f b6 c8	 movzx	 ecx, al
  03503	89 4d d0	 mov	 DWORD PTR _ExOption$[ebp], ecx

; 1482 : #ifndef _FIX_
; 1483 : 				Option2 = 0;
; 1484 : #endif
; 1485 : 				Option1 = 1;

  03506	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1

; 1486 : 				level = 0;

  0350d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN5@DropDeepBl:

; 1487 : 			}
; 1488 : 
; 1489 : 			if ( type == ITEMGET(12,15) ||
; 1490 : 				 type == ITEMGET(14,13) ||
; 1491 : 				 type == ITEMGET(14,14)  )

  03514	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  0351b	74 12		 je	 SHORT $LN3@DropDeepBl
  0351d	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  03524	74 09		 je	 SHORT $LN3@DropDeepBl
  03526	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  0352d	75 1c		 jne	 SHORT $LN4@DropDeepBl
$LN3@DropDeepBl:

; 1492 : 			{
; 1493 : 				Option1 = 0;

  0352f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1494 : 				Option2 = 0;

  03536	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1495 : 				Option3 = 0;

  0353d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1496 : 				level = 0;

  03544	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropDeepBl:

; 1497 : 			}
; 1498 : 
; 1499 : 			if ( type == ITEMGET(13,8) ||
; 1500 : 				 type == ITEMGET(13,9) ||
; 1501 : 				 type == ITEMGET(13,12) ||
; 1502 : 				 type == ITEMGET(13,21) )

  0354b	81 7d f4 08 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6664 ; 00001a08H
  03552	74 1b		 je	 SHORT $LN1@DropDeepBl
  03554	81 7d f4 09 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6665 ; 00001a09H
  0355b	74 12		 je	 SHORT $LN1@DropDeepBl
  0355d	81 7d f4 0c 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6668 ; 00001a0cH
  03564	74 09		 je	 SHORT $LN1@DropDeepBl
  03566	81 7d f4 15 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6677 ; 00001a15H
  0356d	75 07		 jne	 SHORT $LN2@DropDeepBl
$LN1@DropDeepBl:

; 1503 : 			{
; 1504 : 				level = 0;

  0356f	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN2@DropDeepBl:

; 1505 : 			}
; 1506 : 			
; 1507 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur,
; 1508 : 				(BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  03576	6a 00		 push	 0
  03578	0f b6 45 d0	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  0357c	50		 push	 eax
  0357d	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  03580	8b 11		 mov	 edx, DWORD PTR [ecx]
  03582	52		 push	 edx
  03583	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  03587	50		 push	 eax
  03588	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  0358c	51		 push	 ecx
  0358d	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  03591	52		 push	 edx
  03592	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  03595	d9 7d 82	 fnstcw	 WORD PTR tv316[ebp]
  03598	0f b7 45 82	 movzx	 eax, WORD PTR tv316[ebp]
  0359c	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  035a1	89 85 7c ff ff
	ff		 mov	 DWORD PTR tv319[ebp], eax
  035a7	d9 ad 7c ff ff
	ff		 fldcw	 WORD PTR tv319[ebp]
  035ad	db 9d 78 ff ff
	ff		 fistp	 DWORD PTR tv321[ebp]
  035b3	d9 6d 82	 fldcw	 WORD PTR tv316[ebp]
  035b6	0f b6 85 78 ff
	ff ff		 movzx	 eax, BYTE PTR tv321[ebp]
  035bd	50		 push	 eax
  035be	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  035c2	51		 push	 ecx
  035c3	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  035c6	52		 push	 edx
  035c7	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  035cb	50		 push	 eax
  035cc	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  035d0	51		 push	 ecx
  035d1	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  035d4	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  035db	50		 push	 eax
  035dc	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  035df	8b 11		 mov	 edx, DWORD PTR [ecx]
  035e1	52		 push	 edx
  035e2	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  035e7	83 c4 34	 add	 esp, 52			; 00000034H

; 1509 : 
; 1510 : 			LogAddTD("[EVENT WHITE DAY CANDY BOX] DEEP BLUE BOX Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d Ex:[%d,%d,%d,%d,%d,%d,%d]",
; 1511 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName,
; 1512 : 				lpObj->MapNumber, x, y, ItemAttribute[type].Name,
; 1513 : 				type, level, Option1, Option2, Option3, ((ExOption&0x20) >> 5), ((ExOption&0x10) >> 4), ((ExOption&0x08) >> 3), ((ExOption&0x04) >> 2), ((ExOption&0x02) >> 1), (ExOption&0x01), 0);

  035ea	6a 00		 push	 0
  035ec	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  035ef	83 e0 01	 and	 eax, 1
  035f2	50		 push	 eax
  035f3	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  035f6	83 e1 02	 and	 ecx, 2
  035f9	d1 f9		 sar	 ecx, 1
  035fb	51		 push	 ecx
  035fc	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  035ff	83 e2 04	 and	 edx, 4
  03602	c1 fa 02	 sar	 edx, 2
  03605	52		 push	 edx
  03606	8b 45 d0	 mov	 eax, DWORD PTR _ExOption$[ebp]
  03609	83 e0 08	 and	 eax, 8
  0360c	c1 f8 03	 sar	 eax, 3
  0360f	50		 push	 eax
  03610	8b 4d d0	 mov	 ecx, DWORD PTR _ExOption$[ebp]
  03613	83 e1 10	 and	 ecx, 16			; 00000010H
  03616	c1 f9 04	 sar	 ecx, 4
  03619	51		 push	 ecx
  0361a	8b 55 d0	 mov	 edx, DWORD PTR _ExOption$[ebp]
  0361d	83 e2 20	 and	 edx, 32			; 00000020H
  03620	c1 fa 05	 sar	 edx, 5
  03623	52		 push	 edx
  03624	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  03627	50		 push	 eax
  03628	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  0362b	51		 push	 ecx
  0362c	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  0362f	52		 push	 edx
  03630	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  03633	50		 push	 eax
  03634	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  03637	51		 push	 ecx
  03638	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  0363b	6b d2 70	 imul	 edx, 112		; 00000070H
  0363e	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  03644	52		 push	 edx
  03645	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  03648	50		 push	 eax
  03649	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  0364c	51		 push	 ecx
  0364d	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  03650	0f b6 82 49 01
	00 00		 movzx	 eax, BYTE PTR [edx+329]
  03657	50		 push	 eax
  03658	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0365b	83 c1 08	 add	 ecx, 8
  0365e	51		 push	 ecx
  0365f	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  03662	83 c2 77	 add	 edx, 119		; 00000077H
  03665	52		 push	 edx
  03666	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03669	83 c0 6c	 add	 eax, 108		; 0000006cH
  0366c	50		 push	 eax
  0366d	68 00 00 00 00	 push	 OFFSET ??_C@_0JJ@HJCJJLKC@?$FLEVENT?5WHITE?5DAY?5CANDY?5BOX?$FN?5DEEP@
  03672	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  03678	83 c4 50	 add	 esp, 80			; 00000050H
$LN13@DropDeepBl:

; 1514 : 		}
; 1515 : 
; 1516 : 		PMSG_SERVERCMD ServerCmd;
; 1517 : 
; 1518 : 		PHeadSubSetB((LPBYTE)&ServerCmd, 0xF3, 0x40, sizeof(ServerCmd));

  0367b	6a 07		 push	 7
  0367d	6a 40		 push	 64			; 00000040H
  0367f	68 f3 00 00 00	 push	 243			; 000000f3H
  03684	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228648[ebp]
  03687	50		 push	 eax
  03688	e8 00 00 00 00	 call	 ?PHeadSubSetB@@YAXPAEEEH@Z ; PHeadSubSetB
  0368d	83 c4 10	 add	 esp, 16			; 00000010H

; 1519 : 		ServerCmd.CmdType = 0;

  03690	c6 45 c8 00	 mov	 BYTE PTR _ServerCmd$228648[ebp+4], 0

; 1520 : 		ServerCmd.X = lpObj->X;

  03694	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03697	8a 88 44 01 00
	00		 mov	 cl, BYTE PTR [eax+324]
  0369d	88 4d c9	 mov	 BYTE PTR _ServerCmd$228648[ebp+5], cl

; 1521 : 		ServerCmd.Y = lpObj->Y;

  036a0	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  036a3	8a 88 46 01 00
	00		 mov	 cl, BYTE PTR [eax+326]
  036a9	88 4d ca	 mov	 BYTE PTR _ServerCmd$228648[ebp+6], cl

; 1522 : 
; 1523 : 		MsgSendV2(lpObj, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  036ac	6a 07		 push	 7
  036ae	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228648[ebp]
  036b1	50		 push	 eax
  036b2	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  036b5	51		 push	 ecx
  036b6	e8 00 00 00 00	 call	 ?MsgSendV2@@YAXPAUOBJECTSTRUCT@@PAEH@Z ; MsgSendV2
  036bb	83 c4 0c	 add	 esp, 12			; 0000000cH

; 1524 : 		DataSend(lpObj->m_Index, (LPBYTE)&ServerCmd, sizeof(ServerCmd));

  036be	6a 07		 push	 7
  036c0	8d 45 c4	 lea	 eax, DWORD PTR _ServerCmd$228648[ebp]
  036c3	50		 push	 eax
  036c4	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  036c7	8b 11		 mov	 edx, DWORD PTR [ecx]
  036c9	52		 push	 edx
  036ca	e8 00 00 00 00	 call	 ?DataSend@@YAHHPAEK@Z	; DataSend
  036cf	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@DropDeepBl:

; 1525 : 	}
; 1526 : 
; 1527 : 	return TRUE;

  036d2	b8 01 00 00 00	 mov	 eax, 1
$LN17@DropDeepBl:

; 1528 : }

  036d7	5f		 pop	 edi
  036d8	5e		 pop	 esi
  036d9	5b		 pop	 ebx
  036da	8b e5		 mov	 esp, ebp
  036dc	5d		 pop	 ebp
  036dd	c2 04 00	 ret	 4
?DropDeepBlueCandyBoxEventItem@CItemBagEx@@QAEHH@Z ENDP	; CItemBagEx::DropDeepBlueCandyBoxEventItem
_TEXT	ENDS
PUBLIC	??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@ ; `string'
PUBLIC	?DropHallowinEventItem@CItemBagEx@@QAEHPAUOBJECTSTRUCT@@@Z ; CItemBagEx::DropHallowinEventItem
EXTRN	?g_iHallowinDayEventJOLPolymorphRingDropRate@@3HA:DWORD ; g_iHallowinDayEventJOLPolymorphRingDropRate
EXTRN	?g_iHallowinDayEventJOLDrinkDropRate@@3HA:DWORD	; g_iHallowinDayEventJOLDrinkDropRate
EXTRN	?g_iHallowinDayEventJOLFoodDropRate@@3HA:DWORD	; g_iHallowinDayEventJOLFoodDropRate
EXTRN	?g_iHallowinDayEventJOLScreamDropRate@@3HA:DWORD ; g_iHallowinDayEventJOLScreamDropRate
EXTRN	?g_iHallowinDayEventJOLAngerDropRaTe@@3HA:DWORD	; g_iHallowinDayEventJOLAngerDropRaTe
EXTRN	?g_iHallowinDayEventJOLBlessDropRate@@3HA:DWORD	; g_iHallowinDayEventJOLBlessDropRate
;	COMDAT ??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@
CONST	SEGMENT
??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@ DB '[Hal'
	DB	'lowinDay Event][Pumpkin of Luck] Event Item Drop [%s][%s] : ('
	DB	'%d)(%d/%d) Item Attribute : %s(%d) Level : %d Dur : %d', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
_iItemBagCount$ = -40					; size = 4
_iTotalDropRate$ = -36					; size = 4
_iDuration$ = -32					; size = 4
_iDropItemRate$ = -28					; size = 4
_iDropItemNum$ = -24					; size = 4
_Y$ = -20						; size = 4
_X$ = -16						; size = 4
_iLevel$ = -12						; size = 4
_iType$ = -8						; size = 4
_this$ = -4						; size = 4
_lpObj$ = 8						; size = 4
?DropHallowinEventItem@CItemBagEx@@QAEHPAUOBJECTSTRUCT@@@Z PROC ; CItemBagEx::DropHallowinEventItem
; _this$ = ecx

; 1531 : {

  036e0	55		 push	 ebp
  036e1	8b ec		 mov	 ebp, esp
  036e3	83 ec 68	 sub	 esp, 104		; 00000068H
  036e6	53		 push	 ebx
  036e7	56		 push	 esi
  036e8	57		 push	 edi
  036e9	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1532 : 	if ( this->m_bLoad == FALSE )

  036ec	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  036ef	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  036f3	75 07		 jne	 SHORT $LN15@DropHallow

; 1533 : 		return FALSE;

  036f5	33 c0		 xor	 eax, eax
  036f7	e9 4d 02 00 00	 jmp	 $LN16@DropHallow
$LN15@DropHallow:

; 1534 : 
; 1535 : 	int iType;
; 1536 : 	int iLevel;
; 1537 : 	int X;
; 1538 : 	int Y;
; 1539 : 	int iDropItemNum = 0;

  036fc	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 1540 : 	int iDropItemRate;
; 1541 : 	int iDuration = 0;

  03703	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iDuration$[ebp], 0

; 1542 : 	int iTotalDropRate = 0;

  0370a	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iTotalDropRate$[ebp], 0

; 1543 : 	int iItemBagCount = this->GetBagCount();

  03711	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03714	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  03719	89 45 d8	 mov	 DWORD PTR _iItemBagCount$[ebp], eax

; 1544 : 
; 1545 : 	if ( iItemBagCount > 0 )

  0371c	83 7d d8 00	 cmp	 DWORD PTR _iItemBagCount$[ebp], 0
  03720	0f 8e 1e 02 00
	00		 jle	 $LN14@DropHallow

; 1546 : 	{
; 1547 : 		iTotalDropRate = g_iHallowinDayEventJOLBlessDropRate +
; 1548 : 			             g_iHallowinDayEventJOLAngerDropRaTe +
; 1549 : 						 g_iHallowinDayEventJOLScreamDropRate +
; 1550 : 						 g_iHallowinDayEventJOLFoodDropRate +
; 1551 : 						 g_iHallowinDayEventJOLDrinkDropRate +
; 1552 : 						 g_iHallowinDayEventJOLPolymorphRingDropRate;

  03726	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  0372b	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  03731	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  03737	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  0373d	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?g_iHallowinDayEventJOLDrinkDropRate@@3HA ; g_iHallowinDayEventJOLDrinkDropRate
  03743	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?g_iHallowinDayEventJOLPolymorphRingDropRate@@3HA ; g_iHallowinDayEventJOLPolymorphRingDropRate
  03749	89 45 dc	 mov	 DWORD PTR _iTotalDropRate$[ebp], eax

; 1553 : 
; 1554 : 		iDropItemRate = rand() % iTotalDropRate;

  0374c	e8 00 00 00 00	 call	 _rand
  03751	99		 cdq
  03752	f7 7d dc	 idiv	 DWORD PTR _iTotalDropRate$[ebp]
  03755	89 55 e4	 mov	 DWORD PTR _iDropItemRate$[ebp], edx

; 1555 : 
; 1556 : 		if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate)  )

  03758	8b 45 dc	 mov	 eax, DWORD PTR _iTotalDropRate$[ebp]
  0375b	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  03761	39 45 e4	 cmp	 DWORD PTR _iDropItemRate$[ebp], eax
  03764	7c 0c		 jl	 SHORT $LN13@DropHallow

; 1557 : 			iDropItemNum = 0;

  03766	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0
  0376d	e9 d1 00 00 00	 jmp	 $LN12@DropHallow
$LN13@DropHallow:

; 1558 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe) )

  03772	8b 45 dc	 mov	 eax, DWORD PTR _iTotalDropRate$[ebp]
  03775	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  0377b	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  03781	39 45 e4	 cmp	 DWORD PTR _iDropItemRate$[ebp], eax
  03784	7c 0c		 jl	 SHORT $LN11@DropHallow

; 1559 : 			iDropItemNum = 1;

  03786	c7 45 e8 01 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 1
  0378d	e9 b1 00 00 00	 jmp	 $LN12@DropHallow
$LN11@DropHallow:

; 1560 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate) )

  03792	8b 45 dc	 mov	 eax, DWORD PTR _iTotalDropRate$[ebp]
  03795	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  0379b	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  037a1	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  037a7	39 45 e4	 cmp	 DWORD PTR _iDropItemRate$[ebp], eax
  037aa	7c 0c		 jl	 SHORT $LN9@DropHallow

; 1561 : 			iDropItemNum = 2;

  037ac	c7 45 e8 02 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 2
  037b3	e9 8b 00 00 00	 jmp	 $LN12@DropHallow
$LN9@DropHallow:

; 1562 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate - g_iHallowinDayEventJOLFoodDropRate) )

  037b8	8b 45 dc	 mov	 eax, DWORD PTR _iTotalDropRate$[ebp]
  037bb	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  037c1	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  037c7	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  037cd	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  037d3	39 45 e4	 cmp	 DWORD PTR _iDropItemRate$[ebp], eax
  037d6	7c 09		 jl	 SHORT $LN7@DropHallow

; 1563 : 			iDropItemNum = 3;

  037d8	c7 45 e8 03 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 3
  037df	eb 62		 jmp	 SHORT $LN12@DropHallow
$LN7@DropHallow:

; 1564 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate - g_iHallowinDayEventJOLFoodDropRate - g_iHallowinDayEventJOLDrinkDropRate) )

  037e1	8b 45 dc	 mov	 eax, DWORD PTR _iTotalDropRate$[ebp]
  037e4	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  037ea	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  037f0	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  037f6	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  037fc	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLDrinkDropRate@@3HA ; g_iHallowinDayEventJOLDrinkDropRate
  03802	39 45 e4	 cmp	 DWORD PTR _iDropItemRate$[ebp], eax
  03805	7c 09		 jl	 SHORT $LN5@DropHallow

; 1565 : 			iDropItemNum = 4;

  03807	c7 45 e8 04 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 4
  0380e	eb 33		 jmp	 SHORT $LN12@DropHallow
$LN5@DropHallow:

; 1566 : 		else if ( iDropItemRate >= (iTotalDropRate - g_iHallowinDayEventJOLBlessDropRate - g_iHallowinDayEventJOLAngerDropRaTe - g_iHallowinDayEventJOLScreamDropRate - g_iHallowinDayEventJOLFoodDropRate - g_iHallowinDayEventJOLDrinkDropRate - g_iHallowinDayEventJOLPolymorphRingDropRate) )

  03810	8b 45 dc	 mov	 eax, DWORD PTR _iTotalDropRate$[ebp]
  03813	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLBlessDropRate@@3HA ; g_iHallowinDayEventJOLBlessDropRate
  03819	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLAngerDropRaTe@@3HA ; g_iHallowinDayEventJOLAngerDropRaTe
  0381f	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLScreamDropRate@@3HA ; g_iHallowinDayEventJOLScreamDropRate
  03825	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLFoodDropRate@@3HA ; g_iHallowinDayEventJOLFoodDropRate
  0382b	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLDrinkDropRate@@3HA ; g_iHallowinDayEventJOLDrinkDropRate
  03831	2b 05 00 00 00
	00		 sub	 eax, DWORD PTR ?g_iHallowinDayEventJOLPolymorphRingDropRate@@3HA ; g_iHallowinDayEventJOLPolymorphRingDropRate
  03837	39 45 e4	 cmp	 DWORD PTR _iDropItemRate$[ebp], eax
  0383a	7c 07		 jl	 SHORT $LN12@DropHallow

; 1567 : 			iDropItemNum = 5;

  0383c	c7 45 e8 05 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 5
$LN12@DropHallow:

; 1568 : 
; 1569 : 		X = lpObj->X;

  03843	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03846	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  0384d	89 4d f0	 mov	 DWORD PTR _X$[ebp], ecx

; 1570 : 		Y = lpObj->Y;

  03850	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03853	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0385a	89 4d ec	 mov	 DWORD PTR _Y$[ebp], ecx

; 1571 : 		iLevel = this->GetLevel(iDropItemNum);

  0385d	8b 45 e8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  03860	50		 push	 eax
  03861	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03864	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  03869	0f b6 c8	 movzx	 ecx, al
  0386c	89 4d f4	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 1572 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  0386f	8b 45 e8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  03872	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03875	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  0387d	52		 push	 edx
  0387e	8b 45 e8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  03881	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03884	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  0388c	52		 push	 edx
  0388d	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  03892	83 c4 08	 add	 esp, 8
  03895	89 45 f8	 mov	 DWORD PTR _iType$[ebp], eax

; 1573 : 
; 1574 : 		if ( iType == -1 )

  03898	83 7d f8 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  0389c	75 07		 jne	 SHORT $LN2@DropHallow

; 1575 : 			return FALSE;

  0389e	33 c0		 xor	 eax, eax
  038a0	e9 a4 00 00 00	 jmp	 $LN16@DropHallow
$LN2@DropHallow:

; 1576 : 
; 1577 : 		if ( iType == ITEMGET(13,40) )

  038a5	81 7d f8 28 1a
	00 00		 cmp	 DWORD PTR _iType$[ebp], 6696 ; 00001a28H
  038ac	75 0e		 jne	 SHORT $LN1@DropHallow

; 1578 : 		{
; 1579 : 			iLevel = 0;

  038ae	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 1580 : 			iDuration = 100;

  038b5	c7 45 e0 64 00
	00 00		 mov	 DWORD PTR _iDuration$[ebp], 100 ; 00000064H
$LN1@DropHallow:

; 1581 : 		}
; 1582 : 
; 1583 : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)lpObj->MapNumber, (BYTE)X, (BYTE)Y,
; 1584 : 			iType, (BYTE)iLevel, (BYTE)iDuration, 0, 0, 0, lpObj->m_Index, 0, 0);

  038bc	6a 00		 push	 0
  038be	6a 00		 push	 0
  038c0	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  038c3	8b 08		 mov	 ecx, DWORD PTR [eax]
  038c5	51		 push	 ecx
  038c6	6a 00		 push	 0
  038c8	6a 00		 push	 0
  038ca	6a 00		 push	 0
  038cc	0f b6 55 e0	 movzx	 edx, BYTE PTR _iDuration$[ebp]
  038d0	52		 push	 edx
  038d1	0f b6 45 f4	 movzx	 eax, BYTE PTR _iLevel$[ebp]
  038d5	50		 push	 eax
  038d6	8b 4d f8	 mov	 ecx, DWORD PTR _iType$[ebp]
  038d9	51		 push	 ecx
  038da	0f b6 55 ec	 movzx	 edx, BYTE PTR _Y$[ebp]
  038de	52		 push	 edx
  038df	0f b6 45 f0	 movzx	 eax, BYTE PTR _X$[ebp]
  038e3	50		 push	 eax
  038e4	8b 4d 08	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  038e7	0f b6 91 49 01
	00 00		 movzx	 edx, BYTE PTR [ecx+329]
  038ee	52		 push	 edx
  038ef	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  038f2	8b 08		 mov	 ecx, DWORD PTR [eax]
  038f4	51		 push	 ecx
  038f5	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  038fa	83 c4 34	 add	 esp, 52			; 00000034H

; 1585 : 
; 1586 : 		LogAddTD("[HallowinDay Event][Pumpkin of Luck] Event Item Drop [%s][%s] : (%d)(%d/%d) Item Attribute : %s(%d) Level : %d Dur : %d",
; 1587 : 			lpObj->AccountID, lpObj->Name, lpObj->MapNumber, X, Y, ItemAttribute[iType].Name, iType, iLevel, iDuration);

  038fd	8b 45 e0	 mov	 eax, DWORD PTR _iDuration$[ebp]
  03900	50		 push	 eax
  03901	8b 4d f4	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  03904	51		 push	 ecx
  03905	8b 55 f8	 mov	 edx, DWORD PTR _iType$[ebp]
  03908	52		 push	 edx
  03909	8b 45 f8	 mov	 eax, DWORD PTR _iType$[ebp]
  0390c	6b c0 70	 imul	 eax, 112		; 00000070H
  0390f	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  03914	50		 push	 eax
  03915	8b 4d ec	 mov	 ecx, DWORD PTR _Y$[ebp]
  03918	51		 push	 ecx
  03919	8b 55 f0	 mov	 edx, DWORD PTR _X$[ebp]
  0391c	52		 push	 edx
  0391d	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03920	0f b6 88 49 01
	00 00		 movzx	 ecx, BYTE PTR [eax+329]
  03927	51		 push	 ecx
  03928	8b 55 08	 mov	 edx, DWORD PTR _lpObj$[ebp]
  0392b	83 c2 77	 add	 edx, 119		; 00000077H
  0392e	52		 push	 edx
  0392f	8b 45 08	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03932	83 c0 6c	 add	 eax, 108		; 0000006cH
  03935	50		 push	 eax
  03936	68 00 00 00 00	 push	 OFFSET ??_C@_0HI@MKOHGFOD@?$FLHallowinDay?5Event?$FN?$FLPumpkin?5of?5L@
  0393b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  03941	83 c4 28	 add	 esp, 40			; 00000028H
$LN14@DropHallow:

; 1588 : 	}
; 1589 : 
; 1590 : 	return TRUE;

  03944	b8 01 00 00 00	 mov	 eax, 1
$LN16@DropHallow:

; 1591 : }

  03949	5f		 pop	 edi
  0394a	5e		 pop	 esi
  0394b	5b		 pop	 ebx
  0394c	8b e5		 mov	 esp, ebp
  0394e	5d		 pop	 ebp
  0394f	c2 04 00	 ret	 4
?DropHallowinEventItem@CItemBagEx@@QAEHPAUOBJECTSTRUCT@@@Z ENDP ; CItemBagEx::DropHallowinEventItem
_TEXT	ENDS
PUBLIC	??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@ ; `string'
PUBLIC	??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@ ; `string'
PUBLIC	?DropKundunEventItem@CItemBagEx@@QAEHHEEE@Z	; CItemBagEx::DropKundunEventItem
;	COMDAT ??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@
CONST	SEGMENT
??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@ DB '['
	DB	0a1H, 0dbH, 'Kundun EVENT] ', 0a1H, 0daH, 'KUNDUN Event ItemDr'
	DB	'op [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op'
	DB	'2:%d op3:%d', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@
CONST	SEGMENT
??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@ DB '['
	DB	0a1H, 0dbH, 'KUNDUN EVENT][KUNDUN ITEM BAG LIST] Item:(%s)%d L'
	DB	'evel:%d-%d op1:%d op2:%d op3:%d expo:%d', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv344 = -132						; size = 4
tv342 = -128						; size = 4
tv339 = -122						; size = 2
_i$228706 = -56						; size = 4
_iItemBagCount$ = -52					; size = 4
_lpObj$ = -48						; size = 4
_ExOption$ = -44					; size = 4
_DropItemNum$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropKundunEventItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropKundunEventItem
; _this$ = ecx

; 1594 : {

  03960	55		 push	 ebp
  03961	8b ec		 mov	 ebp, esp
  03963	81 ec 84 00 00
	00		 sub	 esp, 132		; 00000084H
  03969	53		 push	 ebx
  0396a	56		 push	 esi
  0396b	57		 push	 edi
  0396c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1595 : 	if ( this->m_bLoad == FALSE )

  0396f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  03972	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  03976	75 07		 jne	 SHORT $LN20@DropKundun

; 1596 : 	{
; 1597 : 		return FALSE;

  03978	33 c0		 xor	 eax, eax
  0397a	e9 ba 03 00 00	 jmp	 $LN21@DropKundun
$LN20@DropKundun:

; 1598 : 	}
; 1599 : 
; 1600 : 	float dur;
; 1601 : 	int type;
; 1602 : 	int level;
; 1603 : 	int x;
; 1604 : 	int y;
; 1605 : 	int Option1 = 0;

  0397f	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1606 : 	int Option2 = 0;

  03986	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1607 : 	int Option3 = 0;

  0398d	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1608 : 	int DropItemNum;
; 1609 : 	int ExOption = 0;

  03994	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1610 : 	LPOBJ lpObj = &gObj[aIndex];

  0399b	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  0399e	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  039a4	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  039aa	89 45 d0	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1611 : 	int iItemBagCount = this->GetBagCount();

  039ad	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  039b0	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  039b5	89 45 cc	 mov	 DWORD PTR _iItemBagCount$[ebp], eax

; 1612 : 
; 1613 : 	for(int i=0;i<iItemBagCount;i++)

  039b8	c7 45 c8 00 00
	00 00		 mov	 DWORD PTR _i$228706[ebp], 0
  039bf	eb 09		 jmp	 SHORT $LN19@DropKundun
$LN18@DropKundun:
  039c1	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  039c4	83 c0 01	 add	 eax, 1
  039c7	89 45 c8	 mov	 DWORD PTR _i$228706[ebp], eax
$LN19@DropKundun:
  039ca	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  039cd	3b 45 cc	 cmp	 eax, DWORD PTR _iItemBagCount$[ebp]
  039d0	0f 8d a7 00 00
	00		 jge	 $LN17@DropKundun

; 1614 : 	{
; 1615 : 		type = ItemGetNumberMake(this->BagObject[i].m_type, this->BagObject[i].m_index);

  039d6	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  039d9	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  039dc	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  039e4	52		 push	 edx
  039e5	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  039e8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  039eb	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  039f3	52		 push	 edx
  039f4	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  039f9	83 c4 08	 add	 esp, 8
  039fc	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1616 : 
; 1617 : 		LogAdd("[KUNDUN EVENT][KUNDUN ITEM BAG LIST] Item:(%s)%d Level:%d-%d op1:%d op2:%d op3:%d expo:%d",
; 1618 : 			ItemAttribute[type].Name, type, this->BagObject[i].m_minLevel, BagObject[i].m_maxLevel,
; 1619 : 			BagObject[i].m_isskill, BagObject[i].m_isluck, BagObject[i].m_isoption, BagObject[i].m_isexitem);

  039ff	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  03a02	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a05	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  03a0d	52		 push	 edx
  03a0e	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  03a11	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a14	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  03a1c	52		 push	 edx
  03a1d	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  03a20	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a23	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  03a2b	52		 push	 edx
  03a2c	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  03a2f	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a32	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  03a3a	52		 push	 edx
  03a3b	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  03a3e	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a41	0f b6 94 c1 35
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+565]
  03a49	52		 push	 edx
  03a4a	8b 45 c8	 mov	 eax, DWORD PTR _i$228706[ebp]
  03a4d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a50	0f b6 94 c1 34
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+564]
  03a58	52		 push	 edx
  03a59	8b 45 f4	 mov	 eax, DWORD PTR _type$[ebp]
  03a5c	50		 push	 eax
  03a5d	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  03a60	6b c9 70	 imul	 ecx, 112		; 00000070H
  03a63	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  03a69	51		 push	 ecx
  03a6a	68 00 00 00 00	 push	 OFFSET ??_C@_0FM@IBDEHDFI@?$FL?$KB?$NLKUNDUN?5EVENT?$FN?$FLKUNDUN?5ITEM?5BAG@
  03a6f	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAdd@@3P6AXPADZZA ; LogAdd
  03a75	83 c4 24	 add	 esp, 36			; 00000024H

; 1620 : 	}

  03a78	e9 44 ff ff ff	 jmp	 $LN18@DropKundun
$LN17@DropKundun:

; 1621 : 
; 1622 : 	if ( this->GetBagCount() > 0 )

  03a7d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03a80	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  03a85	85 c0		 test	 eax, eax
  03a87	0f 8e a7 02 00
	00		 jle	 $LN15@DropKundun

; 1623 : 	{
; 1624 : 		if ( true )

  03a8d	b8 01 00 00 00	 mov	 eax, 1
  03a92	85 c0		 test	 eax, eax
  03a94	0f 84 9a 02 00
	00		 je	 $LN15@DropKundun

; 1625 : 		{
; 1626 : 			DropItemNum =  rand() % this->GetBagCount();

  03a9a	e8 00 00 00 00	 call	 _rand
  03a9f	8b f0		 mov	 esi, eax
  03aa1	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03aa4	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  03aa9	8b c8		 mov	 ecx, eax
  03aab	8b c6		 mov	 eax, esi
  03aad	99		 cdq
  03aae	f7 f9		 idiv	 ecx
  03ab0	89 55 d8	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 1627 : 			dur = 0;

  03ab3	d9 ee		 fldz
  03ab5	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 1628 : 			
; 1629 : 			if ( cX == 0 && cY == 0 )

  03ab8	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  03abc	85 c0		 test	 eax, eax
  03abe	75 24		 jne	 SHORT $LN14@DropKundun
  03ac0	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  03ac4	85 c0		 test	 eax, eax
  03ac6	75 1c		 jne	 SHORT $LN14@DropKundun

; 1630 : 			{
; 1631 : 				x = lpObj->X;

  03ac8	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03acb	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  03ad2	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 1632 : 				y = lpObj->Y;

  03ad5	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03ad8	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  03adf	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1633 : 			}
; 1634 : 			else

  03ae2	eb 0e		 jmp	 SHORT $LN13@DropKundun
$LN14@DropKundun:

; 1635 : 			{
; 1636 : 				x = cX;

  03ae4	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  03ae8	89 45 ec	 mov	 DWORD PTR _x$[ebp], eax

; 1637 : 				y = cY;

  03aeb	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  03aef	89 45 e8	 mov	 DWORD PTR _y$[ebp], eax
$LN13@DropKundun:

; 1638 : 			}
; 1639 : 
; 1640 : 			level = this->GetLevel(DropItemNum);

  03af2	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03af5	50		 push	 eax
  03af6	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03af9	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  03afe	0f b6 c8	 movzx	 ecx, al
  03b01	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 1641 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  03b04	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03b07	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03b0a	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  03b12	52		 push	 edx
  03b13	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03b16	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03b19	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  03b21	52		 push	 edx
  03b22	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  03b27	83 c4 08	 add	 esp, 8
  03b2a	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1642 : 
; 1643 : 			if ( type == -1 )

  03b2d	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  03b31	75 07		 jne	 SHORT $LN12@DropKundun

; 1644 : 			{
; 1645 : 				return FALSE;

  03b33	33 c0		 xor	 eax, eax
  03b35	e9 ff 01 00 00	 jmp	 $LN21@DropKundun
$LN12@DropKundun:

; 1646 : 			}
; 1647 : 
; 1648 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  03b3a	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03b3d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03b40	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  03b48	85 d2		 test	 edx, edx
  03b4a	74 07		 je	 SHORT $LN11@DropKundun

; 1649 : 			{
; 1650 : 				Option1 =1;

  03b4c	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropKundun:

; 1651 : 			}
; 1652 : 
; 1653 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  03b53	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03b56	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03b59	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  03b61	85 d2		 test	 edx, edx
  03b63	74 23		 je	 SHORT $LN9@DropKundun

; 1654 : 			{
; 1655 : 				Option2 = 0;

  03b65	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1656 : 
; 1657 : 				if ( (rand()%2) == 0 )

  03b6c	e8 00 00 00 00	 call	 _rand
  03b71	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  03b76	79 05		 jns	 SHORT $LN23@DropKundun
  03b78	48		 dec	 eax
  03b79	83 c8 fe	 or	 eax, -2			; fffffffeH
  03b7c	40		 inc	 eax
$LN23@DropKundun:
  03b7d	85 c0		 test	 eax, eax
  03b7f	75 07		 jne	 SHORT $LN9@DropKundun

; 1658 : 				{
; 1659 : 					Option2 = 1;

  03b81	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropKundun:

; 1660 : 				}
; 1661 : 			}
; 1662 : 
; 1663 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  03b88	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03b8b	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03b8e	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  03b96	85 d2		 test	 edx, edx
  03b98	74 2b		 je	 SHORT $LN6@DropKundun

; 1664 : 			{
; 1665 : 				if ( rand()%5 < 1 )

  03b9a	e8 00 00 00 00	 call	 _rand
  03b9f	99		 cdq
  03ba0	b9 05 00 00 00	 mov	 ecx, 5
  03ba5	f7 f9		 idiv	 ecx
  03ba7	83 fa 01	 cmp	 edx, 1
  03baa	7d 09		 jge	 SHORT $LN7@DropKundun

; 1666 : 				{
; 1667 : 					Option3 = 3;

  03bac	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1668 : 				}
; 1669 : 				else

  03bb3	eb 10		 jmp	 SHORT $LN6@DropKundun
$LN7@DropKundun:

; 1670 : 				{
; 1671 : 					Option3 = rand()%3;

  03bb5	e8 00 00 00 00	 call	 _rand
  03bba	99		 cdq
  03bbb	b9 03 00 00 00	 mov	 ecx, 3
  03bc0	f7 f9		 idiv	 ecx
  03bc2	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropKundun:

; 1672 : 				}
; 1673 : 			}
; 1674 : 
; 1675 : 			if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  03bc5	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03bc8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03bcb	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  03bd3	85 d2		 test	 edx, edx
  03bd5	74 17		 je	 SHORT $LN5@DropKundun

; 1676 : 			{
; 1677 : 				ExOption = NewOptionRand(0);

  03bd7	6a 00		 push	 0
  03bd9	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  03bde	83 c4 04	 add	 esp, 4
  03be1	0f b6 c0	 movzx	 eax, al
  03be4	89 45 d4	 mov	 DWORD PTR _ExOption$[ebp], eax

; 1678 : #ifndef _FIX_
; 1679 : 				Option2 = 0;
; 1680 : #endif
; 1681 : 				Option1 = 1;

  03be7	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN5@DropKundun:

; 1682 : 			}
; 1683 : 
; 1684 : 			if ( type == ITEMGET(12,15) || type == ITEMGET(14,13) || type == ITEMGET(14,14) || type == ITEMGET(14,16))	// Chaos, Bless, Soul

  03bee	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  03bf5	74 1b		 je	 SHORT $LN3@DropKundun
  03bf7	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  03bfe	74 12		 je	 SHORT $LN3@DropKundun
  03c00	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  03c07	74 09		 je	 SHORT $LN3@DropKundun
  03c09	81 7d f4 10 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7184 ; 00001c10H
  03c10	75 1c		 jne	 SHORT $LN4@DropKundun
$LN3@DropKundun:

; 1685 : 			{
; 1686 : 				Option1 = 0;

  03c12	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1687 : 				Option2 = 0;

  03c19	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1688 : 				Option3 = 0;

  03c20	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1689 : 				level = 0;

  03c27	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropKundun:

; 1690 : 			}
; 1691 : 
; 1692 : 			if ( type == ITEMGET(13,0) ||
; 1693 : 				 type == ITEMGET(13,1) ||
; 1694 : 				 type == ITEMGET(13,2) ||
; 1695 : 				 type == ITEMGET(13,8) ||
; 1696 : 				 type == ITEMGET(13,9) ||
; 1697 : 				 type == ITEMGET(13,12) ||
; 1698 : 				 type ==ITEMGET(13,13) )	// Angel, imp, unirioa, dino, r and pendant of ice, poisonm

  03c2e	81 7d f4 00 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6656 ; 00001a00H
  03c35	74 36		 je	 SHORT $LN1@DropKundun
  03c37	81 7d f4 01 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6657 ; 00001a01H
  03c3e	74 2d		 je	 SHORT $LN1@DropKundun
  03c40	81 7d f4 02 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6658 ; 00001a02H
  03c47	74 24		 je	 SHORT $LN1@DropKundun
  03c49	81 7d f4 08 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6664 ; 00001a08H
  03c50	74 1b		 je	 SHORT $LN1@DropKundun
  03c52	81 7d f4 09 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6665 ; 00001a09H
  03c59	74 12		 je	 SHORT $LN1@DropKundun
  03c5b	81 7d f4 0c 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6668 ; 00001a0cH
  03c62	74 09		 je	 SHORT $LN1@DropKundun
  03c64	81 7d f4 0d 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6669 ; 00001a0dH
  03c6b	75 07		 jne	 SHORT $LN2@DropKundun
$LN1@DropKundun:

; 1699 : 			{
; 1700 : 				level = 0;

  03c6d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN2@DropKundun:

; 1701 : 			}
; 1702 : 
; 1703 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur, (BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  03c74	6a 00		 push	 0
  03c76	0f b6 45 d4	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  03c7a	50		 push	 eax
  03c7b	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  03c7e	8b 11		 mov	 edx, DWORD PTR [ecx]
  03c80	52		 push	 edx
  03c81	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  03c85	50		 push	 eax
  03c86	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  03c8a	51		 push	 ecx
  03c8b	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  03c8f	52		 push	 edx
  03c90	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  03c93	d9 7d 86	 fnstcw	 WORD PTR tv339[ebp]
  03c96	0f b7 45 86	 movzx	 eax, WORD PTR tv339[ebp]
  03c9a	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  03c9f	89 45 80	 mov	 DWORD PTR tv342[ebp], eax
  03ca2	d9 6d 80	 fldcw	 WORD PTR tv342[ebp]
  03ca5	db 9d 7c ff ff
	ff		 fistp	 DWORD PTR tv344[ebp]
  03cab	d9 6d 86	 fldcw	 WORD PTR tv339[ebp]
  03cae	0f b6 85 7c ff
	ff ff		 movzx	 eax, BYTE PTR tv344[ebp]
  03cb5	50		 push	 eax
  03cb6	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  03cba	51		 push	 ecx
  03cbb	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  03cbe	52		 push	 edx
  03cbf	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  03cc3	50		 push	 eax
  03cc4	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  03cc8	51		 push	 ecx
  03cc9	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  03ccd	52		 push	 edx
  03cce	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03cd1	8b 08		 mov	 ecx, DWORD PTR [eax]
  03cd3	51		 push	 ecx
  03cd4	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  03cd9	83 c4 34	 add	 esp, 52			; 00000034H

; 1704 : 
; 1705 : 			LogAddTD("[Kundun EVENT] KUNDUN Event ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d",
; 1706 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName, btMapNumber, x, y, ItemAttribute[type].Name, type, level, Option1, Option2, Option3);

  03cdc	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  03cdf	50		 push	 eax
  03ce0	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  03ce3	51		 push	 ecx
  03ce4	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  03ce7	52		 push	 edx
  03ce8	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  03ceb	50		 push	 eax
  03cec	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  03cef	51		 push	 ecx
  03cf0	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  03cf3	6b d2 70	 imul	 edx, 112		; 00000070H
  03cf6	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  03cfc	52		 push	 edx
  03cfd	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  03d00	50		 push	 eax
  03d01	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  03d04	51		 push	 ecx
  03d05	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  03d09	52		 push	 edx
  03d0a	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  03d0d	83 c0 08	 add	 eax, 8
  03d10	50		 push	 eax
  03d11	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  03d14	83 c1 77	 add	 ecx, 119		; 00000077H
  03d17	51		 push	 ecx
  03d18	8b 55 d0	 mov	 edx, DWORD PTR _lpObj$[ebp]
  03d1b	83 c2 6c	 add	 edx, 108		; 0000006cH
  03d1e	52		 push	 edx
  03d1f	68 00 00 00 00	 push	 OFFSET ??_C@_0GP@IHPHEILG@?$FL?$KB?$NLKundun?5EVENT?$FN?5?$KB?ZKUNDUN?5Event?5@
  03d24	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  03d2a	83 c4 34	 add	 esp, 52			; 00000034H

; 1707 : 			return TRUE;

  03d2d	b8 01 00 00 00	 mov	 eax, 1
  03d32	eb 05		 jmp	 SHORT $LN21@DropKundun
$LN15@DropKundun:

; 1708 : 		}
; 1709 : 	}
; 1710 : 
; 1711 : 	return TRUE;

  03d34	b8 01 00 00 00	 mov	 eax, 1
$LN21@DropKundun:

; 1712 : }

  03d39	5f		 pop	 edi
  03d3a	5e		 pop	 esi
  03d3b	5b		 pop	 ebx
  03d3c	8b e5		 mov	 esp, ebp
  03d3e	5d		 pop	 ebp
  03d3f	c2 10 00	 ret	 16			; 00000010H
?DropKundunEventItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropKundunEventItem
_TEXT	ENDS
PUBLIC	??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@ ; `string'
PUBLIC	?DropCastleHuntZoneBossReward@CItemBagEx@@QAEHHEEE@Z ; CItemBagEx::DropCastleHuntZoneBossReward
;	COMDAT ??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@
CONST	SEGMENT
??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@ DB '[Ca'
	DB	'stle HuntZone] ', 0a1H, 0daH, 'Castle HuntZone Boss ItemDrop '
	DB	'[%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%'
	DB	'd op3:%d', 00H				; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv264 = -124						; size = 4
tv262 = -120						; size = 4
tv259 = -114						; size = 2
_lpObj$ = -48						; size = 4
_ExOption$ = -44					; size = 4
_DropItemNum$ = -40					; size = 4
_Option3$ = -36						; size = 4
_Option2$ = -32						; size = 4
_Option1$ = -28						; size = 4
_y$ = -24						; size = 4
_x$ = -20						; size = 4
_level$ = -16						; size = 4
_type$ = -12						; size = 4
_dur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropCastleHuntZoneBossReward@CItemBagEx@@QAEHHEEE@Z PROC ; CItemBagEx::DropCastleHuntZoneBossReward
; _this$ = ecx

; 1716 : {

  03d50	55		 push	 ebp
  03d51	8b ec		 mov	 ebp, esp
  03d53	83 ec 7c	 sub	 esp, 124		; 0000007cH
  03d56	53		 push	 ebx
  03d57	56		 push	 esi
  03d58	57		 push	 edi
  03d59	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1717 : 	if ( this->m_bLoad == FALSE )

  03d5c	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  03d5f	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  03d63	75 07		 jne	 SHORT $LN17@DropCastle

; 1718 : 		return FALSE;

  03d65	33 c0		 xor	 eax, eax
  03d67	e9 db 02 00 00	 jmp	 $LN18@DropCastle
$LN17@DropCastle:

; 1719 : 
; 1720 : 	float dur;
; 1721 : 	int type;
; 1722 : 	int level;
; 1723 : 	int x;
; 1724 : 	int y;
; 1725 : 	int Option1 = 0;

  03d6c	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1726 : 	int Option2 = 0;

  03d73	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1727 : 	int Option3 = 0;

  03d7a	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1728 : 	int DropItemNum;
; 1729 : 	int ExOption = 0;

  03d81	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _ExOption$[ebp], 0

; 1730 : 	LPOBJ lpObj = &gObj[aIndex];

  03d88	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  03d8b	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  03d91	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  03d97	89 45 d0	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1731 : 
; 1732 : 	if ( this->GetBagCount() > 0 )

  03d9a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03d9d	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  03da2	85 c0		 test	 eax, eax
  03da4	0f 8e 98 02 00
	00		 jle	 $LN16@DropCastle

; 1733 : 	{
; 1734 : 		if ( true )

  03daa	b8 01 00 00 00	 mov	 eax, 1
  03daf	85 c0		 test	 eax, eax
  03db1	0f 84 84 02 00
	00		 je	 $LN15@DropCastle

; 1735 : 		{
; 1736 : 			DropItemNum =  rand() % this->GetBagCount();

  03db7	e8 00 00 00 00	 call	 _rand
  03dbc	8b f0		 mov	 esi, eax
  03dbe	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03dc1	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  03dc6	8b c8		 mov	 ecx, eax
  03dc8	8b c6		 mov	 eax, esi
  03dca	99		 cdq
  03dcb	f7 f9		 idiv	 ecx
  03dcd	89 55 d8	 mov	 DWORD PTR _DropItemNum$[ebp], edx

; 1737 : 			dur = 0;

  03dd0	d9 ee		 fldz
  03dd2	d9 5d f8	 fstp	 DWORD PTR _dur$[ebp]

; 1738 : 
; 1739 : 			if ( cX == 0 && cY == 0 )

  03dd5	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  03dd9	85 c0		 test	 eax, eax
  03ddb	75 24		 jne	 SHORT $LN14@DropCastle
  03ddd	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  03de1	85 c0		 test	 eax, eax
  03de3	75 1c		 jne	 SHORT $LN14@DropCastle

; 1740 : 			{
; 1741 : 				x = lpObj->X;

  03de5	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03de8	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  03def	89 4d ec	 mov	 DWORD PTR _x$[ebp], ecx

; 1742 : 				y = lpObj->Y;

  03df2	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03df5	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  03dfc	89 4d e8	 mov	 DWORD PTR _y$[ebp], ecx

; 1743 : 			}
; 1744 : 			else

  03dff	eb 0e		 jmp	 SHORT $LN13@DropCastle
$LN14@DropCastle:

; 1745 : 			{
; 1746 : 				x = cX;

  03e01	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  03e05	89 45 ec	 mov	 DWORD PTR _x$[ebp], eax

; 1747 : 				y = cY;

  03e08	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  03e0c	89 45 e8	 mov	 DWORD PTR _y$[ebp], eax
$LN13@DropCastle:

; 1748 : 			}
; 1749 : 
; 1750 : 			level = this->GetLevel(DropItemNum);

  03e0f	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03e12	50		 push	 eax
  03e13	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03e16	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  03e1b	0f b6 c8	 movzx	 ecx, al
  03e1e	89 4d f0	 mov	 DWORD PTR _level$[ebp], ecx

; 1751 : 			type = ItemGetNumberMake(this->BagObject[DropItemNum].m_type, this->BagObject[DropItemNum].m_index);

  03e21	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03e24	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03e27	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  03e2f	52		 push	 edx
  03e30	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03e33	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03e36	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  03e3e	52		 push	 edx
  03e3f	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  03e44	83 c4 08	 add	 esp, 8
  03e47	89 45 f4	 mov	 DWORD PTR _type$[ebp], eax

; 1752 : 
; 1753 : 			if ( type == -1 )

  03e4a	83 7d f4 ff	 cmp	 DWORD PTR _type$[ebp], -1
  03e4e	75 07		 jne	 SHORT $LN12@DropCastle

; 1754 : 			{
; 1755 : 				return FALSE;

  03e50	33 c0		 xor	 eax, eax
  03e52	e9 f0 01 00 00	 jmp	 $LN18@DropCastle
$LN12@DropCastle:

; 1756 : 			}
; 1757 : 
; 1758 : 			if ( this->BagObject[DropItemNum].m_isskill != 0 )

  03e57	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03e5a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03e5d	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  03e65	85 d2		 test	 edx, edx
  03e67	74 07		 je	 SHORT $LN11@DropCastle

; 1759 : 			{
; 1760 : 				Option1 =1;

  03e69	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN11@DropCastle:

; 1761 : 			}
; 1762 : 
; 1763 : 			if ( this->BagObject[DropItemNum].m_isluck != 0 )

  03e70	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03e73	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03e76	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  03e7e	85 d2		 test	 edx, edx
  03e80	74 23		 je	 SHORT $LN9@DropCastle

; 1764 : 			{
; 1765 : 				Option2 = 0;

  03e82	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1766 : 
; 1767 : 				if ( (rand()%2) == 0 )

  03e89	e8 00 00 00 00	 call	 _rand
  03e8e	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  03e93	79 05		 jns	 SHORT $LN20@DropCastle
  03e95	48		 dec	 eax
  03e96	83 c8 fe	 or	 eax, -2			; fffffffeH
  03e99	40		 inc	 eax
$LN20@DropCastle:
  03e9a	85 c0		 test	 eax, eax
  03e9c	75 07		 jne	 SHORT $LN9@DropCastle

; 1768 : 				{
; 1769 : 					Option2 = 1;

  03e9e	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 1
$LN9@DropCastle:

; 1770 : 				}
; 1771 : 			}
; 1772 : 
; 1773 : 			if ( this->BagObject[DropItemNum].m_isoption != 0 )

  03ea5	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03ea8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03eab	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  03eb3	85 d2		 test	 edx, edx
  03eb5	74 2b		 je	 SHORT $LN6@DropCastle

; 1774 : 			{
; 1775 : 				if ( rand()%5 < 1 )

  03eb7	e8 00 00 00 00	 call	 _rand
  03ebc	99		 cdq
  03ebd	b9 05 00 00 00	 mov	 ecx, 5
  03ec2	f7 f9		 idiv	 ecx
  03ec4	83 fa 01	 cmp	 edx, 1
  03ec7	7d 09		 jge	 SHORT $LN7@DropCastle

; 1776 : 				{
; 1777 : 					Option3 = 3;

  03ec9	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 3

; 1778 : 				}
; 1779 : 				else

  03ed0	eb 10		 jmp	 SHORT $LN6@DropCastle
$LN7@DropCastle:

; 1780 : 				{
; 1781 : 					Option3 = rand()%3;

  03ed2	e8 00 00 00 00	 call	 _rand
  03ed7	99		 cdq
  03ed8	b9 03 00 00 00	 mov	 ecx, 3
  03edd	f7 f9		 idiv	 ecx
  03edf	89 55 dc	 mov	 DWORD PTR _Option3$[ebp], edx
$LN6@DropCastle:

; 1782 : 				}
; 1783 : 			}
; 1784 : 
; 1785 : 			if ( this->BagObject[DropItemNum].m_isexitem != 0 )

  03ee2	8b 45 d8	 mov	 eax, DWORD PTR _DropItemNum$[ebp]
  03ee5	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  03ee8	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  03ef0	85 d2		 test	 edx, edx
  03ef2	74 17		 je	 SHORT $LN5@DropCastle

; 1786 : 			{
; 1787 : 				ExOption = NewOptionRand(0);

  03ef4	6a 00		 push	 0
  03ef6	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  03efb	83 c4 04	 add	 esp, 4
  03efe	0f b6 c0	 movzx	 eax, al
  03f01	89 45 d4	 mov	 DWORD PTR _ExOption$[ebp], eax

; 1788 : #ifndef _FIX_
; 1789 : 				Option2 = 0;
; 1790 : #endif
; 1791 : 				Option1 = 1;

  03f04	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 1
$LN5@DropCastle:

; 1792 : 			}
; 1793 : 
; 1794 : 			if ( type == ITEMGET(12,15) || type == ITEMGET(14,13) || type == ITEMGET(14,14))	// Chaos, Bless, Soul

  03f0b	81 7d f4 0f 18
	00 00		 cmp	 DWORD PTR _type$[ebp], 6159 ; 0000180fH
  03f12	74 12		 je	 SHORT $LN3@DropCastle
  03f14	81 7d f4 0d 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7181 ; 00001c0dH
  03f1b	74 09		 je	 SHORT $LN3@DropCastle
  03f1d	81 7d f4 0e 1c
	00 00		 cmp	 DWORD PTR _type$[ebp], 7182 ; 00001c0eH
  03f24	75 1c		 jne	 SHORT $LN4@DropCastle
$LN3@DropCastle:

; 1795 : 			{
; 1796 : 				Option1 = 0;

  03f26	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _Option1$[ebp], 0

; 1797 : 				Option2 = 0;

  03f2d	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _Option2$[ebp], 0

; 1798 : 				Option3 = 0;

  03f34	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _Option3$[ebp], 0

; 1799 : 				level = 0;

  03f3b	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN4@DropCastle:

; 1800 : 			}
; 1801 : 
; 1802 : 			if ( type == ITEMGET(13,0) ||
; 1803 : 				 type == ITEMGET(13,1) ||
; 1804 : 				 type == ITEMGET(13,2) ||
; 1805 : 				 type == ITEMGET(13,8) ||
; 1806 : 				 type == ITEMGET(13,9) ||
; 1807 : 				 type == ITEMGET(13,12) ||
; 1808 : 				 type ==ITEMGET(13,13) )	// Angel, imp, unirioa, dino, r and pendant of ice, poisonm

  03f42	81 7d f4 00 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6656 ; 00001a00H
  03f49	74 36		 je	 SHORT $LN1@DropCastle
  03f4b	81 7d f4 01 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6657 ; 00001a01H
  03f52	74 2d		 je	 SHORT $LN1@DropCastle
  03f54	81 7d f4 02 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6658 ; 00001a02H
  03f5b	74 24		 je	 SHORT $LN1@DropCastle
  03f5d	81 7d f4 08 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6664 ; 00001a08H
  03f64	74 1b		 je	 SHORT $LN1@DropCastle
  03f66	81 7d f4 09 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6665 ; 00001a09H
  03f6d	74 12		 je	 SHORT $LN1@DropCastle
  03f6f	81 7d f4 0c 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6668 ; 00001a0cH
  03f76	74 09		 je	 SHORT $LN1@DropCastle
  03f78	81 7d f4 0d 1a
	00 00		 cmp	 DWORD PTR _type$[ebp], 6669 ; 00001a0dH
  03f7f	75 07		 jne	 SHORT $LN2@DropCastle
$LN1@DropCastle:

; 1809 : 			{
; 1810 : 				level = 0;

  03f81	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _level$[ebp], 0
$LN2@DropCastle:

; 1811 : 			}
; 1812 : 
; 1813 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)x, (BYTE)y, type, (BYTE)level, (BYTE)dur, (BYTE)Option1, (BYTE)Option2, (BYTE)Option3, lpObj->m_Index, (BYTE)ExOption, 0);

  03f88	6a 00		 push	 0
  03f8a	0f b6 45 d4	 movzx	 eax, BYTE PTR _ExOption$[ebp]
  03f8e	50		 push	 eax
  03f8f	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  03f92	8b 11		 mov	 edx, DWORD PTR [ecx]
  03f94	52		 push	 edx
  03f95	0f b6 45 dc	 movzx	 eax, BYTE PTR _Option3$[ebp]
  03f99	50		 push	 eax
  03f9a	0f b6 4d e0	 movzx	 ecx, BYTE PTR _Option2$[ebp]
  03f9e	51		 push	 ecx
  03f9f	0f b6 55 e4	 movzx	 edx, BYTE PTR _Option1$[ebp]
  03fa3	52		 push	 edx
  03fa4	d9 45 f8	 fld	 DWORD PTR _dur$[ebp]
  03fa7	d9 7d 8e	 fnstcw	 WORD PTR tv259[ebp]
  03faa	0f b7 45 8e	 movzx	 eax, WORD PTR tv259[ebp]
  03fae	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  03fb3	89 45 88	 mov	 DWORD PTR tv262[ebp], eax
  03fb6	d9 6d 88	 fldcw	 WORD PTR tv262[ebp]
  03fb9	db 5d 84	 fistp	 DWORD PTR tv264[ebp]
  03fbc	d9 6d 8e	 fldcw	 WORD PTR tv259[ebp]
  03fbf	0f b6 45 84	 movzx	 eax, BYTE PTR tv264[ebp]
  03fc3	50		 push	 eax
  03fc4	0f b6 4d f0	 movzx	 ecx, BYTE PTR _level$[ebp]
  03fc8	51		 push	 ecx
  03fc9	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  03fcc	52		 push	 edx
  03fcd	0f b6 45 e8	 movzx	 eax, BYTE PTR _y$[ebp]
  03fd1	50		 push	 eax
  03fd2	0f b6 4d ec	 movzx	 ecx, BYTE PTR _x$[ebp]
  03fd6	51		 push	 ecx
  03fd7	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  03fdb	52		 push	 edx
  03fdc	8b 45 d0	 mov	 eax, DWORD PTR _lpObj$[ebp]
  03fdf	8b 08		 mov	 ecx, DWORD PTR [eax]
  03fe1	51		 push	 ecx
  03fe2	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  03fe7	83 c4 34	 add	 esp, 52			; 00000034H

; 1814 : 
; 1815 : 			LogAddTD("[Castle HuntZone] Castle HuntZone Boss ItemDrop [%s][%s] [%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d",
; 1816 : 				lpObj->AccountID, lpObj->Name, this->m_sEventName, btMapNumber, x, y, ItemAttribute[type].Name, type, level, Option1, Option2, Option3);

  03fea	8b 45 dc	 mov	 eax, DWORD PTR _Option3$[ebp]
  03fed	50		 push	 eax
  03fee	8b 4d e0	 mov	 ecx, DWORD PTR _Option2$[ebp]
  03ff1	51		 push	 ecx
  03ff2	8b 55 e4	 mov	 edx, DWORD PTR _Option1$[ebp]
  03ff5	52		 push	 edx
  03ff6	8b 45 f0	 mov	 eax, DWORD PTR _level$[ebp]
  03ff9	50		 push	 eax
  03ffa	8b 4d f4	 mov	 ecx, DWORD PTR _type$[ebp]
  03ffd	51		 push	 ecx
  03ffe	8b 55 f4	 mov	 edx, DWORD PTR _type$[ebp]
  04001	6b d2 70	 imul	 edx, 112		; 00000070H
  04004	81 c2 00 00 00
	00		 add	 edx, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0400a	52		 push	 edx
  0400b	8b 45 e8	 mov	 eax, DWORD PTR _y$[ebp]
  0400e	50		 push	 eax
  0400f	8b 4d ec	 mov	 ecx, DWORD PTR _x$[ebp]
  04012	51		 push	 ecx
  04013	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  04017	52		 push	 edx
  04018	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  0401b	83 c0 08	 add	 eax, 8
  0401e	50		 push	 eax
  0401f	8b 4d d0	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  04022	83 c1 77	 add	 ecx, 119		; 00000077H
  04025	51		 push	 ecx
  04026	8b 55 d0	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04029	83 c2 6c	 add	 edx, 108		; 0000006cH
  0402c	52		 push	 edx
  0402d	68 00 00 00 00	 push	 OFFSET ??_C@_0HI@EDAEPOLG@?$FLCastle?5HuntZone?$FN?5?$KB?ZCastle?5HuntZ@
  04032	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04038	83 c4 34	 add	 esp, 52			; 00000034H
$LN15@DropCastle:

; 1817 : 
; 1818 : 		}
; 1819 : 		return TRUE;

  0403b	b8 01 00 00 00	 mov	 eax, 1
  04040	eb 05		 jmp	 SHORT $LN18@DropCastle
$LN16@DropCastle:

; 1820 : 	}
; 1821 : 	return TRUE;

  04042	b8 01 00 00 00	 mov	 eax, 1
$LN18@DropCastle:

; 1822 : }

  04047	5f		 pop	 edi
  04048	5e		 pop	 esi
  04049	5b		 pop	 ebx
  0404a	8b e5		 mov	 esp, ebp
  0404c	5d		 pop	 ebp
  0404d	c2 10 00	 ret	 16			; 00000010H
?DropCastleHuntZoneBossReward@CItemBagEx@@QAEHHEEE@Z ENDP ; CItemBagEx::DropCastleHuntZoneBossReward
_TEXT	ENDS
PUBLIC	??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ ; `string'
PUBLIC	??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ ; `string'
PUBLIC	?DropCrywolfDarkElfItem@CItemBagEx@@QAEHHEEE@Z	; CItemBagEx::DropCrywolfDarkElfItem
EXTRN	?g_iCrywolfMonsterDarkElfDropZen@@3HA:DWORD	; g_iCrywolfMonsterDarkElfDropZen
EXTRN	?g_iCrywolfMonsterDarkElfDropZenRate@@3HA:DWORD	; g_iCrywolfMonsterDarkElfDropZenRate
;	COMDAT ??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
CONST	SEGMENT
??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ DB '['
	DB	' Crywolf ][Reward] Dark Elf Item Drop [%s][%s] : (%d)(%d/%d) '
	DB	'Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
CONST	SEGMENT
??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@ DB '['
	DB	' Crywolf ][Reward] Dark Elf Item Drop [%s][%s] [%d Zen]', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv283 = -128						; size = 4
tv281 = -124						; size = 4
tv278 = -118						; size = 2
_lpObj$ = -52						; size = 4
_iExOption$ = -48					; size = 4
_iDropItemRate$ = -44					; size = 4
_iDropItemNum$ = -40					; size = 4
_iOption3$ = -36					; size = 4
_iOption2$ = -32					; size = 4
_iOption1$ = -28					; size = 4
_Y$ = -24						; size = 4
_X$ = -20						; size = 4
_iLevel$ = -16						; size = 4
_iType$ = -12						; size = 4
_fDur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropCrywolfDarkElfItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropCrywolfDarkElfItem
; _this$ = ecx

; 1826 : {

  04050	55		 push	 ebp
  04051	8b ec		 mov	 ebp, esp
  04053	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  04059	53		 push	 ebx
  0405a	56		 push	 esi
  0405b	57		 push	 edi
  0405c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1827 : 	if ( this->m_bLoad == FALSE )

  0405f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  04062	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  04066	75 07		 jne	 SHORT $LN14@DropCrywol

; 1828 : 		return FALSE;

  04068	33 c0		 xor	 eax, eax
  0406a	e9 f1 02 00 00	 jmp	 $LN15@DropCrywol
$LN14@DropCrywol:

; 1829 : 
; 1830 : 	float fDur = 0;

  0406f	d9 ee		 fldz
  04071	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 1831 : 	int iType = 0;

  04074	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iType$[ebp], 0

; 1832 : 	int iLevel = 0;

  0407b	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 1833 : 	int X = 0;

  04082	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _X$[ebp], 0

; 1834 : 	int Y = 0;

  04089	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _Y$[ebp], 0

; 1835 : 	int iOption1 = 0;

  04090	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 0

; 1836 : 	int iOption2 = 0;

  04097	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 1837 : 	int iOption3 = 0;

  0409e	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 0

; 1838 : 	int iDropItemNum = 0;

  040a5	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 1839 : 	int iDropItemRate = 0;

  040ac	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _iDropItemRate$[ebp], 0

; 1840 : 	int iExOption = 0;

  040b3	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _iExOption$[ebp], 0

; 1841 : 	LPOBJ lpObj = &gObj[aIndex];

  040ba	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  040bd	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  040c3	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  040c9	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1842 : 
; 1843 : 	if ( this->GetBagCount() > 0 )

  040cc	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  040cf	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  040d4	85 c0		 test	 eax, eax
  040d6	0f 8e 7f 02 00
	00		 jle	 $LN11@DropCrywol

; 1844 : 	{
; 1845 : 		iDropItemRate = rand() % 10000;

  040dc	e8 00 00 00 00	 call	 _rand
  040e1	99		 cdq
  040e2	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  040e7	f7 f9		 idiv	 ecx
  040e9	89 55 d4	 mov	 DWORD PTR _iDropItemRate$[ebp], edx

; 1846 : 
; 1847 : 		if ( iDropItemRate < g_iCrywolfMonsterDarkElfDropZenRate ) 

  040ec	8b 45 d4	 mov	 eax, DWORD PTR _iDropItemRate$[ebp]
  040ef	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iCrywolfMonsterDarkElfDropZenRate@@3HA ; g_iCrywolfMonsterDarkElfDropZenRate
  040f5	7d 53		 jge	 SHORT $LN12@DropCrywol

; 1848 : 		{
; 1849 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iCrywolfMonsterDarkElfDropZen, cX, cY);

  040f7	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  040fb	50		 push	 eax
  040fc	0f b6 4d 10	 movzx	 ecx, BYTE PTR _cX$[ebp]
  04100	51		 push	 ecx
  04101	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iCrywolfMonsterDarkElfDropZen@@3HA ; g_iCrywolfMonsterDarkElfDropZen
  04107	52		 push	 edx
  04108	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0410b	0f b6 88 49 01
	00 00		 movzx	 ecx, BYTE PTR [eax+329]
  04112	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  04118	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0411e	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1850 : 
; 1851 : 			LogAddTD("[ Crywolf ][Reward] Dark Elf Item Drop [%s][%s] [%d Zen]",
; 1852 : 				lpObj->AccountID, lpObj->Name, g_iCrywolfMonsterDarkElfDropZen);

  04123	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iCrywolfMonsterDarkElfDropZen@@3HA ; g_iCrywolfMonsterDarkElfDropZen
  04128	50		 push	 eax
  04129	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0412c	83 c1 77	 add	 ecx, 119		; 00000077H
  0412f	51		 push	 ecx
  04130	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04133	83 c2 6c	 add	 edx, 108		; 0000006cH
  04136	52		 push	 edx
  04137	68 00 00 00 00	 push	 OFFSET ??_C@_0DJ@HFCGAAID@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
  0413c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04142	83 c4 10	 add	 esp, 16			; 00000010H

; 1853 : 		}
; 1854 : 		else

  04145	e9 11 02 00 00	 jmp	 $LN11@DropCrywol
$LN12@DropCrywol:

; 1855 : 		{
; 1856 : 			iDropItemNum = rand()% this->GetBagCount();

  0414a	e8 00 00 00 00	 call	 _rand
  0414f	8b f0		 mov	 esi, eax
  04151	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04154	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04159	8b c8		 mov	 ecx, eax
  0415b	8b c6		 mov	 eax, esi
  0415d	99		 cdq
  0415e	f7 f9		 idiv	 ecx
  04160	89 55 d8	 mov	 DWORD PTR _iDropItemNum$[ebp], edx

; 1857 : 			fDur = 0;

  04163	d9 ee		 fldz
  04165	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 1858 : 
; 1859 : 			if ( cX == 0 && cY == 0 )

  04168	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  0416c	85 c0		 test	 eax, eax
  0416e	75 24		 jne	 SHORT $LN10@DropCrywol
  04170	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04174	85 c0		 test	 eax, eax
  04176	75 1c		 jne	 SHORT $LN10@DropCrywol

; 1860 : 			{
; 1861 : 				X = lpObj->X;

  04178	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0417b	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  04182	89 4d ec	 mov	 DWORD PTR _X$[ebp], ecx

; 1862 : 				Y = lpObj->Y;

  04185	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04188	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  0418f	89 4d e8	 mov	 DWORD PTR _Y$[ebp], ecx

; 1863 : 			}
; 1864 : 			else

  04192	eb 0e		 jmp	 SHORT $LN9@DropCrywol
$LN10@DropCrywol:

; 1865 : 			{
; 1866 : 				X = cX;

  04194	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  04198	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax

; 1867 : 				Y = cY;

  0419b	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  0419f	89 45 e8	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropCrywol:

; 1868 : 			}
; 1869 : 
; 1870 : 			iLevel = this->GetLevel(iDropItemNum);

  041a2	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  041a5	50		 push	 eax
  041a6	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  041a9	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  041ae	0f b6 c8	 movzx	 ecx, al
  041b1	89 4d f0	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 1871 : 			iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  041b4	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  041b7	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  041ba	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  041c2	52		 push	 edx
  041c3	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  041c6	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  041c9	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  041d1	52		 push	 edx
  041d2	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  041d7	83 c4 08	 add	 esp, 8
  041da	89 45 f4	 mov	 DWORD PTR _iType$[ebp], eax

; 1872 : 
; 1873 : 			if ( iType == -1 )

  041dd	83 7d f4 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  041e1	75 07		 jne	 SHORT $LN8@DropCrywol

; 1874 : 				return FALSE;

  041e3	33 c0		 xor	 eax, eax
  041e5	e9 76 01 00 00	 jmp	 $LN15@DropCrywol
$LN8@DropCrywol:

; 1875 : 
; 1876 : 			if ( this->BagObject[iDropItemNum].m_isskill )

  041ea	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  041ed	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  041f0	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  041f8	85 d2		 test	 edx, edx
  041fa	74 07		 je	 SHORT $LN7@DropCrywol

; 1877 : 				iOption1 = 1;

  041fc	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN7@DropCrywol:

; 1878 : 
; 1879 : 			if ( this->BagObject[iDropItemNum].m_isluck )

  04203	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04206	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04209	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  04211	85 d2		 test	 edx, edx
  04213	74 23		 je	 SHORT $LN5@DropCrywol

; 1880 : 			{
; 1881 : 				iOption2 = 0;

  04215	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 1882 : 
; 1883 : 				if ( (rand()%2) == 0 )

  0421c	e8 00 00 00 00	 call	 _rand
  04221	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  04226	79 05		 jns	 SHORT $LN17@DropCrywol
  04228	48		 dec	 eax
  04229	83 c8 fe	 or	 eax, -2			; fffffffeH
  0422c	40		 inc	 eax
$LN17@DropCrywol:
  0422d	85 c0		 test	 eax, eax
  0422f	75 07		 jne	 SHORT $LN5@DropCrywol

; 1884 : 				{
; 1885 : 					iOption2 = 1;

  04231	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN5@DropCrywol:

; 1886 : 				}
; 1887 : 			}
; 1888 : 
; 1889 : 			if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  04238	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0423b	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0423e	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  04246	85 d2		 test	 edx, edx
  04248	74 2b		 je	 SHORT $LN2@DropCrywol

; 1890 : 			{
; 1891 : 				if ( rand()%5 < 1 )

  0424a	e8 00 00 00 00	 call	 _rand
  0424f	99		 cdq
  04250	b9 05 00 00 00	 mov	 ecx, 5
  04255	f7 f9		 idiv	 ecx
  04257	83 fa 01	 cmp	 edx, 1
  0425a	7d 09		 jge	 SHORT $LN3@DropCrywol

; 1892 : 				{
; 1893 : 					iOption3 = 3;

  0425c	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 1894 : 				}
; 1895 : 				else

  04263	eb 10		 jmp	 SHORT $LN2@DropCrywol
$LN3@DropCrywol:

; 1896 : 				{
; 1897 : 					iOption3 = rand()%3;

  04265	e8 00 00 00 00	 call	 _rand
  0426a	99		 cdq
  0426b	b9 03 00 00 00	 mov	 ecx, 3
  04270	f7 f9		 idiv	 ecx
  04272	89 55 dc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropCrywol:

; 1898 : 				}
; 1899 : 			}
; 1900 : 
; 1901 : 			if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  04275	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04278	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0427b	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  04283	85 d2		 test	 edx, edx
  04285	74 1e		 je	 SHORT $LN1@DropCrywol

; 1902 : 			{
; 1903 : 				iExOption = NewOptionRand(0);

  04287	6a 00		 push	 0
  04289	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  0428e	83 c4 04	 add	 esp, 4
  04291	0f b6 c0	 movzx	 eax, al
  04294	89 45 d0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 1904 : #ifndef _FIX_
; 1905 : 				iOption2 = 0;
; 1906 : #endif
; 1907 : 				iOption1 = 1;

  04297	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 1908 : 				iLevel = 0;

  0429e	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN1@DropCrywol:

; 1909 : 			}
; 1910 : 
; 1911 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 1912 : 				(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  042a5	6a 00		 push	 0
  042a7	0f b6 45 d0	 movzx	 eax, BYTE PTR _iExOption$[ebp]
  042ab	50		 push	 eax
  042ac	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  042af	8b 11		 mov	 edx, DWORD PTR [ecx]
  042b1	52		 push	 edx
  042b2	0f b6 45 dc	 movzx	 eax, BYTE PTR _iOption3$[ebp]
  042b6	50		 push	 eax
  042b7	0f b6 4d e0	 movzx	 ecx, BYTE PTR _iOption2$[ebp]
  042bb	51		 push	 ecx
  042bc	0f b6 55 e4	 movzx	 edx, BYTE PTR _iOption1$[ebp]
  042c0	52		 push	 edx
  042c1	d9 45 f8	 fld	 DWORD PTR _fDur$[ebp]
  042c4	d9 7d 8a	 fnstcw	 WORD PTR tv278[ebp]
  042c7	0f b7 45 8a	 movzx	 eax, WORD PTR tv278[ebp]
  042cb	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  042d0	89 45 84	 mov	 DWORD PTR tv281[ebp], eax
  042d3	d9 6d 84	 fldcw	 WORD PTR tv281[ebp]
  042d6	db 5d 80	 fistp	 DWORD PTR tv283[ebp]
  042d9	d9 6d 8a	 fldcw	 WORD PTR tv278[ebp]
  042dc	0f b6 45 80	 movzx	 eax, BYTE PTR tv283[ebp]
  042e0	50		 push	 eax
  042e1	0f b6 4d f0	 movzx	 ecx, BYTE PTR _iLevel$[ebp]
  042e5	51		 push	 ecx
  042e6	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  042e9	52		 push	 edx
  042ea	0f b6 45 e8	 movzx	 eax, BYTE PTR _Y$[ebp]
  042ee	50		 push	 eax
  042ef	0f b6 4d ec	 movzx	 ecx, BYTE PTR _X$[ebp]
  042f3	51		 push	 ecx
  042f4	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  042f8	52		 push	 edx
  042f9	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  042fc	8b 08		 mov	 ecx, DWORD PTR [eax]
  042fe	51		 push	 ecx
  042ff	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  04304	83 c4 34	 add	 esp, 52			; 00000034H

; 1913 : 
; 1914 : 			LogAddTD("[ Crywolf ][Reward] Dark Elf Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 1915 : 				lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 1916 : 				iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  04307	8b 45 d0	 mov	 eax, DWORD PTR _iExOption$[ebp]
  0430a	50		 push	 eax
  0430b	8b 4d dc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  0430e	51		 push	 ecx
  0430f	8b 55 e0	 mov	 edx, DWORD PTR _iOption2$[ebp]
  04312	52		 push	 edx
  04313	8b 45 e4	 mov	 eax, DWORD PTR _iOption1$[ebp]
  04316	50		 push	 eax
  04317	8b 4d f0	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  0431a	51		 push	 ecx
  0431b	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  0431e	52		 push	 edx
  0431f	8b 45 f4	 mov	 eax, DWORD PTR _iType$[ebp]
  04322	6b c0 70	 imul	 eax, 112		; 00000070H
  04325	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0432a	50		 push	 eax
  0432b	8b 4d e8	 mov	 ecx, DWORD PTR _Y$[ebp]
  0432e	51		 push	 ecx
  0432f	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  04332	52		 push	 edx
  04333	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  04337	50		 push	 eax
  04338	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0433b	83 c1 77	 add	 ecx, 119		; 00000077H
  0433e	51		 push	 ecx
  0433f	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04342	83 c2 6c	 add	 edx, 108		; 0000006cH
  04345	52		 push	 edx
  04346	68 00 00 00 00	 push	 OFFSET ??_C@_0HA@EIEHAAMC@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Dark?5Elf?5Ite@
  0434b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04351	83 c4 34	 add	 esp, 52			; 00000034H

; 1917 : 
; 1918 : 			return TRUE;

  04354	b8 01 00 00 00	 mov	 eax, 1
  04359	eb 05		 jmp	 SHORT $LN15@DropCrywol
$LN11@DropCrywol:

; 1919 : 		}
; 1920 : 	}
; 1921 : 
; 1922 : 	return TRUE;

  0435b	b8 01 00 00 00	 mov	 eax, 1
$LN15@DropCrywol:

; 1923 : 
; 1924 : 
; 1925 : }

  04360	5f		 pop	 edi
  04361	5e		 pop	 esi
  04362	5b		 pop	 ebx
  04363	8b e5		 mov	 esp, ebp
  04365	5d		 pop	 ebp
  04366	c2 10 00	 ret	 16			; 00000010H
?DropCrywolfDarkElfItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropCrywolfDarkElfItem
_TEXT	ENDS
PUBLIC	??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ ; `string'
PUBLIC	??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ ; `string'
PUBLIC	?DropCrywolfBossMonsterItem@CItemBagEx@@QAEHHEEE@Z ; CItemBagEx::DropCrywolfBossMonsterItem
EXTRN	?g_iCrywolfBossMonsterDropZen@@3HA:DWORD	; g_iCrywolfBossMonsterDropZen
EXTRN	?g_iCrywolfBossMonsterDropZenRate@@3HA:DWORD	; g_iCrywolfBossMonsterDropZenRate
;	COMDAT ??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
CONST	SEGMENT
??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ DB '['
	DB	' Crywolf ][Reward] Boss Monster Item Drop [%s][%s] : (%d)(%d/'
	DB	'%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
CONST	SEGMENT
??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@ DB '['
	DB	' Crywolf ][Reward] Boss Monster Item Drop [%s][%s] [%d Zen]', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv283 = -128						; size = 4
tv281 = -124						; size = 4
tv278 = -118						; size = 2
_lpObj$ = -52						; size = 4
_iExOption$ = -48					; size = 4
_iDropItemRate$ = -44					; size = 4
_iDropItemNum$ = -40					; size = 4
_iOption3$ = -36					; size = 4
_iOption2$ = -32					; size = 4
_iOption1$ = -28					; size = 4
_Y$ = -24						; size = 4
_X$ = -20						; size = 4
_iLevel$ = -16						; size = 4
_iType$ = -12						; size = 4
_fDur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropCrywolfBossMonsterItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropCrywolfBossMonsterItem
; _this$ = ecx

; 1931 : {

  04370	55		 push	 ebp
  04371	8b ec		 mov	 ebp, esp
  04373	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  04379	53		 push	 ebx
  0437a	56		 push	 esi
  0437b	57		 push	 edi
  0437c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 1932 : 	if ( this->m_bLoad == FALSE )

  0437f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  04382	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  04386	75 07		 jne	 SHORT $LN14@DropCrywol@2

; 1933 : 		return FALSE;

  04388	33 c0		 xor	 eax, eax
  0438a	e9 f1 02 00 00	 jmp	 $LN15@DropCrywol@2
$LN14@DropCrywol@2:

; 1934 : 
; 1935 : 	float fDur = 0;

  0438f	d9 ee		 fldz
  04391	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 1936 : 	int iType = 0;

  04394	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iType$[ebp], 0

; 1937 : 	int iLevel = 0;

  0439b	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 1938 : 	int X = 0;

  043a2	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _X$[ebp], 0

; 1939 : 	int Y = 0;

  043a9	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _Y$[ebp], 0

; 1940 : 	int iOption1 = 0;

  043b0	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 0

; 1941 : 	int iOption2 = 0;

  043b7	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 1942 : 	int iOption3 = 0;

  043be	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 0

; 1943 : 	int iDropItemNum = 0;

  043c5	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 1944 : 	int iDropItemRate = 0;

  043cc	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _iDropItemRate$[ebp], 0

; 1945 : 	int iExOption = 0;

  043d3	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _iExOption$[ebp], 0

; 1946 : 	LPOBJ lpObj = &gObj[aIndex];

  043da	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  043dd	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  043e3	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  043e9	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 1947 : 
; 1948 : 	if ( this->GetBagCount() > 0 )

  043ec	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  043ef	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  043f4	85 c0		 test	 eax, eax
  043f6	0f 8e 7f 02 00
	00		 jle	 $LN11@DropCrywol@2

; 1949 : 	{
; 1950 : 		iDropItemRate = rand() % 10000;

  043fc	e8 00 00 00 00	 call	 _rand
  04401	99		 cdq
  04402	b9 10 27 00 00	 mov	 ecx, 10000		; 00002710H
  04407	f7 f9		 idiv	 ecx
  04409	89 55 d4	 mov	 DWORD PTR _iDropItemRate$[ebp], edx

; 1951 : 
; 1952 : 		if ( iDropItemRate < g_iCrywolfBossMonsterDropZenRate ) 

  0440c	8b 45 d4	 mov	 eax, DWORD PTR _iDropItemRate$[ebp]
  0440f	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?g_iCrywolfBossMonsterDropZenRate@@3HA ; g_iCrywolfBossMonsterDropZenRate
  04415	7d 53		 jge	 SHORT $LN12@DropCrywol@2

; 1953 : 		{
; 1954 : 			MapC[lpObj->MapNumber].MoneyItemDrop(g_iCrywolfBossMonsterDropZen, cX, cY);

  04417	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  0441b	50		 push	 eax
  0441c	0f b6 4d 10	 movzx	 ecx, BYTE PTR _cX$[ebp]
  04420	51		 push	 ecx
  04421	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?g_iCrywolfBossMonsterDropZen@@3HA ; g_iCrywolfBossMonsterDropZen
  04427	52		 push	 edx
  04428	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0442b	0f b6 88 49 01
	00 00		 movzx	 ecx, BYTE PTR [eax+329]
  04432	69 c9 b8 3d 05
	00		 imul	 ecx, 343480		; 00053db8H
  04438	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  0443e	e8 00 00 00 00	 call	 ?MoneyItemDrop@MapClass@@QAEHHHH@Z ; MapClass::MoneyItemDrop

; 1955 : 
; 1956 : 			LogAddTD("[ Crywolf ][Reward] Boss Monster Item Drop [%s][%s] [%d Zen]",
; 1957 : 				lpObj->AccountID, lpObj->Name, g_iCrywolfBossMonsterDropZen);

  04443	a1 00 00 00 00	 mov	 eax, DWORD PTR ?g_iCrywolfBossMonsterDropZen@@3HA ; g_iCrywolfBossMonsterDropZen
  04448	50		 push	 eax
  04449	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0444c	83 c1 77	 add	 ecx, 119		; 00000077H
  0444f	51		 push	 ecx
  04450	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04453	83 c2 6c	 add	 edx, 108		; 0000006cH
  04456	52		 push	 edx
  04457	68 00 00 00 00	 push	 OFFSET ??_C@_0DN@DJADCOFL@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
  0445c	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04462	83 c4 10	 add	 esp, 16			; 00000010H

; 1958 : 		}
; 1959 : 		else

  04465	e9 11 02 00 00	 jmp	 $LN11@DropCrywol@2
$LN12@DropCrywol@2:

; 1960 : 		{
; 1961 : 			iDropItemNum = rand()% this->GetBagCount();

  0446a	e8 00 00 00 00	 call	 _rand
  0446f	8b f0		 mov	 esi, eax
  04471	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04474	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04479	8b c8		 mov	 ecx, eax
  0447b	8b c6		 mov	 eax, esi
  0447d	99		 cdq
  0447e	f7 f9		 idiv	 ecx
  04480	89 55 d8	 mov	 DWORD PTR _iDropItemNum$[ebp], edx

; 1962 : 			fDur = 0;

  04483	d9 ee		 fldz
  04485	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 1963 : 
; 1964 : 			if ( cX == 0 && cY == 0 )

  04488	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  0448c	85 c0		 test	 eax, eax
  0448e	75 24		 jne	 SHORT $LN10@DropCrywol@2
  04490	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04494	85 c0		 test	 eax, eax
  04496	75 1c		 jne	 SHORT $LN10@DropCrywol@2

; 1965 : 			{
; 1966 : 				X = lpObj->X;

  04498	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0449b	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  044a2	89 4d ec	 mov	 DWORD PTR _X$[ebp], ecx

; 1967 : 				Y = lpObj->Y;

  044a5	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  044a8	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  044af	89 4d e8	 mov	 DWORD PTR _Y$[ebp], ecx

; 1968 : 			}
; 1969 : 			else

  044b2	eb 0e		 jmp	 SHORT $LN9@DropCrywol@2
$LN10@DropCrywol@2:

; 1970 : 			{
; 1971 : 				X = cX;

  044b4	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  044b8	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax

; 1972 : 				Y = cY;

  044bb	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  044bf	89 45 e8	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropCrywol@2:

; 1973 : 			}
; 1974 : 
; 1975 : 			iLevel = this->GetLevel(iDropItemNum);

  044c2	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  044c5	50		 push	 eax
  044c6	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  044c9	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  044ce	0f b6 c8	 movzx	 ecx, al
  044d1	89 4d f0	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 1976 : 			iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  044d4	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  044d7	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  044da	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  044e2	52		 push	 edx
  044e3	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  044e6	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  044e9	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  044f1	52		 push	 edx
  044f2	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  044f7	83 c4 08	 add	 esp, 8
  044fa	89 45 f4	 mov	 DWORD PTR _iType$[ebp], eax

; 1977 : 
; 1978 : 			if ( iType == -1 )

  044fd	83 7d f4 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  04501	75 07		 jne	 SHORT $LN8@DropCrywol@2

; 1979 : 				return FALSE;

  04503	33 c0		 xor	 eax, eax
  04505	e9 76 01 00 00	 jmp	 $LN15@DropCrywol@2
$LN8@DropCrywol@2:

; 1980 : 
; 1981 : 			if ( this->BagObject[iDropItemNum].m_isskill )

  0450a	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0450d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04510	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  04518	85 d2		 test	 edx, edx
  0451a	74 07		 je	 SHORT $LN7@DropCrywol@2

; 1982 : 				iOption1 = 1;

  0451c	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN7@DropCrywol@2:

; 1983 : 
; 1984 : 			if ( this->BagObject[iDropItemNum].m_isluck )

  04523	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04526	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04529	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  04531	85 d2		 test	 edx, edx
  04533	74 23		 je	 SHORT $LN5@DropCrywol@2

; 1985 : 			{
; 1986 : 				iOption2 = 0;

  04535	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 1987 : 
; 1988 : 				if ( (rand()%2) == 0 )

  0453c	e8 00 00 00 00	 call	 _rand
  04541	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  04546	79 05		 jns	 SHORT $LN17@DropCrywol@2
  04548	48		 dec	 eax
  04549	83 c8 fe	 or	 eax, -2			; fffffffeH
  0454c	40		 inc	 eax
$LN17@DropCrywol@2:
  0454d	85 c0		 test	 eax, eax
  0454f	75 07		 jne	 SHORT $LN5@DropCrywol@2

; 1989 : 				{
; 1990 : 					iOption2 = 1;

  04551	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN5@DropCrywol@2:

; 1991 : 				}
; 1992 : 			}
; 1993 : 
; 1994 : 			if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  04558	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0455b	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0455e	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  04566	85 d2		 test	 edx, edx
  04568	74 2b		 je	 SHORT $LN2@DropCrywol@2

; 1995 : 			{
; 1996 : 				if ( rand()%5 < 1 )

  0456a	e8 00 00 00 00	 call	 _rand
  0456f	99		 cdq
  04570	b9 05 00 00 00	 mov	 ecx, 5
  04575	f7 f9		 idiv	 ecx
  04577	83 fa 01	 cmp	 edx, 1
  0457a	7d 09		 jge	 SHORT $LN3@DropCrywol@2

; 1997 : 				{
; 1998 : 					iOption3 = 3;

  0457c	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 1999 : 				}
; 2000 : 				else

  04583	eb 10		 jmp	 SHORT $LN2@DropCrywol@2
$LN3@DropCrywol@2:

; 2001 : 				{
; 2002 : 					iOption3 = rand()%3;

  04585	e8 00 00 00 00	 call	 _rand
  0458a	99		 cdq
  0458b	b9 03 00 00 00	 mov	 ecx, 3
  04590	f7 f9		 idiv	 ecx
  04592	89 55 dc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropCrywol@2:

; 2003 : 				}
; 2004 : 			}
; 2005 : 
; 2006 : 			if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  04595	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04598	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0459b	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  045a3	85 d2		 test	 edx, edx
  045a5	74 1e		 je	 SHORT $LN1@DropCrywol@2

; 2007 : 			{
; 2008 : 				iExOption = NewOptionRand(0);

  045a7	6a 00		 push	 0
  045a9	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  045ae	83 c4 04	 add	 esp, 4
  045b1	0f b6 c0	 movzx	 eax, al
  045b4	89 45 d0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2009 : #ifndef _FIX_
; 2010 : 				iOption2 = 0;
; 2011 : #endif
; 2012 : 				iOption1 = 1;

  045b7	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2013 : 				iLevel = 0;

  045be	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN1@DropCrywol@2:

; 2014 : 			}
; 2015 : 
; 2016 : 			ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 2017 : 				(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  045c5	6a 00		 push	 0
  045c7	0f b6 45 d0	 movzx	 eax, BYTE PTR _iExOption$[ebp]
  045cb	50		 push	 eax
  045cc	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  045cf	8b 11		 mov	 edx, DWORD PTR [ecx]
  045d1	52		 push	 edx
  045d2	0f b6 45 dc	 movzx	 eax, BYTE PTR _iOption3$[ebp]
  045d6	50		 push	 eax
  045d7	0f b6 4d e0	 movzx	 ecx, BYTE PTR _iOption2$[ebp]
  045db	51		 push	 ecx
  045dc	0f b6 55 e4	 movzx	 edx, BYTE PTR _iOption1$[ebp]
  045e0	52		 push	 edx
  045e1	d9 45 f8	 fld	 DWORD PTR _fDur$[ebp]
  045e4	d9 7d 8a	 fnstcw	 WORD PTR tv278[ebp]
  045e7	0f b7 45 8a	 movzx	 eax, WORD PTR tv278[ebp]
  045eb	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  045f0	89 45 84	 mov	 DWORD PTR tv281[ebp], eax
  045f3	d9 6d 84	 fldcw	 WORD PTR tv281[ebp]
  045f6	db 5d 80	 fistp	 DWORD PTR tv283[ebp]
  045f9	d9 6d 8a	 fldcw	 WORD PTR tv278[ebp]
  045fc	0f b6 45 80	 movzx	 eax, BYTE PTR tv283[ebp]
  04600	50		 push	 eax
  04601	0f b6 4d f0	 movzx	 ecx, BYTE PTR _iLevel$[ebp]
  04605	51		 push	 ecx
  04606	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  04609	52		 push	 edx
  0460a	0f b6 45 e8	 movzx	 eax, BYTE PTR _Y$[ebp]
  0460e	50		 push	 eax
  0460f	0f b6 4d ec	 movzx	 ecx, BYTE PTR _X$[ebp]
  04613	51		 push	 ecx
  04614	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  04618	52		 push	 edx
  04619	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0461c	8b 08		 mov	 ecx, DWORD PTR [eax]
  0461e	51		 push	 ecx
  0461f	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  04624	83 c4 34	 add	 esp, 52			; 00000034H

; 2018 : 
; 2019 : 			LogAddTD("[ Crywolf ][Reward] Boss Monster Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2020 : 				lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2021 : 				iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  04627	8b 45 d0	 mov	 eax, DWORD PTR _iExOption$[ebp]
  0462a	50		 push	 eax
  0462b	8b 4d dc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  0462e	51		 push	 ecx
  0462f	8b 55 e0	 mov	 edx, DWORD PTR _iOption2$[ebp]
  04632	52		 push	 edx
  04633	8b 45 e4	 mov	 eax, DWORD PTR _iOption1$[ebp]
  04636	50		 push	 eax
  04637	8b 4d f0	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  0463a	51		 push	 ecx
  0463b	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  0463e	52		 push	 edx
  0463f	8b 45 f4	 mov	 eax, DWORD PTR _iType$[ebp]
  04642	6b c0 70	 imul	 eax, 112		; 00000070H
  04645	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0464a	50		 push	 eax
  0464b	8b 4d e8	 mov	 ecx, DWORD PTR _Y$[ebp]
  0464e	51		 push	 ecx
  0464f	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  04652	52		 push	 edx
  04653	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  04657	50		 push	 eax
  04658	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0465b	83 c1 77	 add	 ecx, 119		; 00000077H
  0465e	51		 push	 ecx
  0465f	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04662	83 c2 6c	 add	 edx, 108		; 0000006cH
  04665	52		 push	 edx
  04666	68 00 00 00 00	 push	 OFFSET ??_C@_0HE@LHMNDJDE@?$FL?5Crywolf?5?$FN?$FLReward?$FN?5Boss?5Monster@
  0466b	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04671	83 c4 34	 add	 esp, 52			; 00000034H

; 2022 : 
; 2023 : 			return TRUE;

  04674	b8 01 00 00 00	 mov	 eax, 1
  04679	eb 05		 jmp	 SHORT $LN15@DropCrywol@2
$LN11@DropCrywol@2:

; 2024 : 		}
; 2025 : 	}
; 2026 : 
; 2027 : 	return TRUE;

  0467b	b8 01 00 00 00	 mov	 eax, 1
$LN15@DropCrywol@2:

; 2028 : }

  04680	5f		 pop	 edi
  04681	5e		 pop	 esi
  04682	5b		 pop	 ebx
  04683	8b e5		 mov	 esp, ebp
  04685	5d		 pop	 ebp
  04686	c2 10 00	 ret	 16			; 00000010H
?DropCrywolfBossMonsterItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropCrywolfBossMonsterItem
_TEXT	ENDS
PUBLIC	??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@ ; `string'
PUBLIC	?DropKanturuMayaHandItem@CItemBagEx@@QAEHHEEE@Z	; CItemBagEx::DropKanturuMayaHandItem
;	COMDAT ??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@
CONST	SEGMENT
??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@ DB '['
	DB	' KANTURU ][ Reward ] MayaHand Item Drop [%s][%s] : (%d)(%d/%d'
	DB	') Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv252 = -128						; size = 4
tv250 = -124						; size = 4
tv247 = -118						; size = 2
_lpObj$ = -52						; size = 4
_iExOption$ = -48					; size = 4
_iDropItemRate$ = -44					; size = 4
_iDropItemNum$ = -40					; size = 4
_iOption3$ = -36					; size = 4
_iOption2$ = -32					; size = 4
_iOption1$ = -28					; size = 4
_Y$ = -24						; size = 4
_X$ = -20						; size = 4
_iLevel$ = -16						; size = 4
_iType$ = -12						; size = 4
_fDur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropKanturuMayaHandItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropKanturuMayaHandItem
; _this$ = ecx

; 2033 : {

  04690	55		 push	 ebp
  04691	8b ec		 mov	 ebp, esp
  04693	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  04699	53		 push	 ebx
  0469a	56		 push	 esi
  0469b	57		 push	 edi
  0469c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 2034 : 	if ( this->m_bLoad == FALSE )

  0469f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  046a2	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  046a6	75 07		 jne	 SHORT $LN12@DropKantur

; 2035 : 		return FALSE;

  046a8	33 c0		 xor	 eax, eax
  046aa	e9 83 02 00 00	 jmp	 $LN13@DropKantur
$LN12@DropKantur:

; 2036 : 
; 2037 : 	float fDur = 0;

  046af	d9 ee		 fldz
  046b1	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2038 : 	int iType = 0;

  046b4	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iType$[ebp], 0

; 2039 : 	int iLevel = 0;

  046bb	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 2040 : 	int X = 0;

  046c2	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _X$[ebp], 0

; 2041 : 	int Y = 0;

  046c9	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _Y$[ebp], 0

; 2042 : 	int iOption1 = 0;

  046d0	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 0

; 2043 : 	int iOption2 = 0;

  046d7	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2044 : 	int iOption3 = 0;

  046de	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 0

; 2045 : 	int iDropItemNum = 0;

  046e5	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 2046 : 	int iDropItemRate = 0;

  046ec	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _iDropItemRate$[ebp], 0

; 2047 : 	int iExOption = 0;

  046f3	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _iExOption$[ebp], 0

; 2048 : 	LPOBJ lpObj = &gObj[aIndex];

  046fa	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  046fd	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  04703	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  04709	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 2049 : 
; 2050 : 	if ( this->GetBagCount() > 0 )

  0470c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0470f	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04714	85 c0		 test	 eax, eax
  04716	0f 8e 11 02 00
	00		 jle	 $LN11@DropKantur

; 2051 : 	{
; 2052 : 		iDropItemNum = rand()% this->GetBagCount();

  0471c	e8 00 00 00 00	 call	 _rand
  04721	8b f0		 mov	 esi, eax
  04723	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04726	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  0472b	8b c8		 mov	 ecx, eax
  0472d	8b c6		 mov	 eax, esi
  0472f	99		 cdq
  04730	f7 f9		 idiv	 ecx
  04732	89 55 d8	 mov	 DWORD PTR _iDropItemNum$[ebp], edx

; 2053 : 		fDur = 0;

  04735	d9 ee		 fldz
  04737	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2054 : 
; 2055 : 		if ( cX == 0 && cY == 0 )

  0473a	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  0473e	85 c0		 test	 eax, eax
  04740	75 24		 jne	 SHORT $LN10@DropKantur
  04742	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04746	85 c0		 test	 eax, eax
  04748	75 1c		 jne	 SHORT $LN10@DropKantur

; 2056 : 		{
; 2057 : 			X = lpObj->X;

  0474a	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0474d	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  04754	89 4d ec	 mov	 DWORD PTR _X$[ebp], ecx

; 2058 : 			Y = lpObj->Y;

  04757	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  0475a	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  04761	89 4d e8	 mov	 DWORD PTR _Y$[ebp], ecx

; 2059 : 		}
; 2060 : 		else

  04764	eb 0e		 jmp	 SHORT $LN9@DropKantur
$LN10@DropKantur:

; 2061 : 		{
; 2062 : 			X = cX;

  04766	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  0476a	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax

; 2063 : 			Y = cY;

  0476d	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04771	89 45 e8	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropKantur:

; 2064 : 		}
; 2065 : 
; 2066 : 		iLevel = this->GetLevel(iDropItemNum);

  04774	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04777	50		 push	 eax
  04778	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0477b	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  04780	0f b6 c8	 movzx	 ecx, al
  04783	89 4d f0	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 2067 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  04786	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04789	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0478c	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  04794	52		 push	 edx
  04795	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04798	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0479b	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  047a3	52		 push	 edx
  047a4	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  047a9	83 c4 08	 add	 esp, 8
  047ac	89 45 f4	 mov	 DWORD PTR _iType$[ebp], eax

; 2068 : 
; 2069 : 		if ( iType == -1 )

  047af	83 7d f4 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  047b3	75 07		 jne	 SHORT $LN8@DropKantur

; 2070 : 			return FALSE;

  047b5	33 c0		 xor	 eax, eax
  047b7	e9 76 01 00 00	 jmp	 $LN13@DropKantur
$LN8@DropKantur:

; 2071 : 
; 2072 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  047bc	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  047bf	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  047c2	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  047ca	85 d2		 test	 edx, edx
  047cc	74 07		 je	 SHORT $LN7@DropKantur

; 2073 : 			iOption1 = 1;

  047ce	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN7@DropKantur:

; 2074 : 
; 2075 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  047d5	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  047d8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  047db	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  047e3	85 d2		 test	 edx, edx
  047e5	74 23		 je	 SHORT $LN5@DropKantur

; 2076 : 		{
; 2077 : 			iOption2 = 0;

  047e7	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2078 : 
; 2079 : 			if ( (rand()%2) == 0 )

  047ee	e8 00 00 00 00	 call	 _rand
  047f3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  047f8	79 05		 jns	 SHORT $LN15@DropKantur
  047fa	48		 dec	 eax
  047fb	83 c8 fe	 or	 eax, -2			; fffffffeH
  047fe	40		 inc	 eax
$LN15@DropKantur:
  047ff	85 c0		 test	 eax, eax
  04801	75 07		 jne	 SHORT $LN5@DropKantur

; 2080 : 			{
; 2081 : 				iOption2 = 1;

  04803	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN5@DropKantur:

; 2082 : 			}
; 2083 : 		}
; 2084 : 
; 2085 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  0480a	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0480d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04810	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  04818	85 d2		 test	 edx, edx
  0481a	74 2b		 je	 SHORT $LN2@DropKantur

; 2086 : 		{
; 2087 : 			if ( rand()%5 < 1 )

  0481c	e8 00 00 00 00	 call	 _rand
  04821	99		 cdq
  04822	b9 05 00 00 00	 mov	 ecx, 5
  04827	f7 f9		 idiv	 ecx
  04829	83 fa 01	 cmp	 edx, 1
  0482c	7d 09		 jge	 SHORT $LN3@DropKantur

; 2088 : 			{
; 2089 : 				iOption3 = 3;

  0482e	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2090 : 			}
; 2091 : 			else

  04835	eb 10		 jmp	 SHORT $LN2@DropKantur
$LN3@DropKantur:

; 2092 : 			{
; 2093 : 				iOption3 = rand()%3;

  04837	e8 00 00 00 00	 call	 _rand
  0483c	99		 cdq
  0483d	b9 03 00 00 00	 mov	 ecx, 3
  04842	f7 f9		 idiv	 ecx
  04844	89 55 dc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropKantur:

; 2094 : 			}
; 2095 : 		}
; 2096 : 
; 2097 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  04847	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0484a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0484d	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  04855	85 d2		 test	 edx, edx
  04857	74 1e		 je	 SHORT $LN1@DropKantur

; 2098 : 		{
; 2099 : 			iExOption = NewOptionRand(0);

  04859	6a 00		 push	 0
  0485b	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  04860	83 c4 04	 add	 esp, 4
  04863	0f b6 c0	 movzx	 eax, al
  04866	89 45 d0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2100 : #ifndef _FIX_
; 2101 : 			iOption2 = 0;
; 2102 : #endif
; 2103 : 			iOption1 = 1;

  04869	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2104 : 			iLevel = 0;

  04870	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN1@DropKantur:

; 2105 : 		}
; 2106 : 
; 2107 : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 2108 : 			(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  04877	6a 00		 push	 0
  04879	0f b6 45 d0	 movzx	 eax, BYTE PTR _iExOption$[ebp]
  0487d	50		 push	 eax
  0487e	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  04881	8b 11		 mov	 edx, DWORD PTR [ecx]
  04883	52		 push	 edx
  04884	0f b6 45 dc	 movzx	 eax, BYTE PTR _iOption3$[ebp]
  04888	50		 push	 eax
  04889	0f b6 4d e0	 movzx	 ecx, BYTE PTR _iOption2$[ebp]
  0488d	51		 push	 ecx
  0488e	0f b6 55 e4	 movzx	 edx, BYTE PTR _iOption1$[ebp]
  04892	52		 push	 edx
  04893	d9 45 f8	 fld	 DWORD PTR _fDur$[ebp]
  04896	d9 7d 8a	 fnstcw	 WORD PTR tv247[ebp]
  04899	0f b7 45 8a	 movzx	 eax, WORD PTR tv247[ebp]
  0489d	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  048a2	89 45 84	 mov	 DWORD PTR tv250[ebp], eax
  048a5	d9 6d 84	 fldcw	 WORD PTR tv250[ebp]
  048a8	db 5d 80	 fistp	 DWORD PTR tv252[ebp]
  048ab	d9 6d 8a	 fldcw	 WORD PTR tv247[ebp]
  048ae	0f b6 45 80	 movzx	 eax, BYTE PTR tv252[ebp]
  048b2	50		 push	 eax
  048b3	0f b6 4d f0	 movzx	 ecx, BYTE PTR _iLevel$[ebp]
  048b7	51		 push	 ecx
  048b8	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  048bb	52		 push	 edx
  048bc	0f b6 45 e8	 movzx	 eax, BYTE PTR _Y$[ebp]
  048c0	50		 push	 eax
  048c1	0f b6 4d ec	 movzx	 ecx, BYTE PTR _X$[ebp]
  048c5	51		 push	 ecx
  048c6	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  048ca	52		 push	 edx
  048cb	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  048ce	8b 08		 mov	 ecx, DWORD PTR [eax]
  048d0	51		 push	 ecx
  048d1	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  048d6	83 c4 34	 add	 esp, 52			; 00000034H

; 2109 : 
; 2110 : 		LogAddTD("[ KANTURU ][ Reward ] MayaHand Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2111 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2112 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  048d9	8b 45 d0	 mov	 eax, DWORD PTR _iExOption$[ebp]
  048dc	50		 push	 eax
  048dd	8b 4d dc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  048e0	51		 push	 ecx
  048e1	8b 55 e0	 mov	 edx, DWORD PTR _iOption2$[ebp]
  048e4	52		 push	 edx
  048e5	8b 45 e4	 mov	 eax, DWORD PTR _iOption1$[ebp]
  048e8	50		 push	 eax
  048e9	8b 4d f0	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  048ec	51		 push	 ecx
  048ed	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  048f0	52		 push	 edx
  048f1	8b 45 f4	 mov	 eax, DWORD PTR _iType$[ebp]
  048f4	6b c0 70	 imul	 eax, 112		; 00000070H
  048f7	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  048fc	50		 push	 eax
  048fd	8b 4d e8	 mov	 ecx, DWORD PTR _Y$[ebp]
  04900	51		 push	 ecx
  04901	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  04904	52		 push	 edx
  04905	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  04909	50		 push	 eax
  0490a	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0490d	83 c1 77	 add	 ecx, 119		; 00000077H
  04910	51		 push	 ecx
  04911	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04914	83 c2 6c	 add	 edx, 108		; 0000006cH
  04917	52		 push	 edx
  04918	68 00 00 00 00	 push	 OFFSET ??_C@_0HC@MEHIGOLO@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5MayaHand?5I@
  0491d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04923	83 c4 34	 add	 esp, 52			; 00000034H

; 2113 : 
; 2114 : 		return TRUE;

  04926	b8 01 00 00 00	 mov	 eax, 1
  0492b	eb 05		 jmp	 SHORT $LN13@DropKantur
$LN11@DropKantur:

; 2115 : 	}
; 2116 : 
; 2117 : 	return TRUE;

  0492d	b8 01 00 00 00	 mov	 eax, 1
$LN13@DropKantur:

; 2118 : }

  04932	5f		 pop	 edi
  04933	5e		 pop	 esi
  04934	5b		 pop	 ebx
  04935	8b e5		 mov	 esp, ebp
  04937	5d		 pop	 ebp
  04938	c2 10 00	 ret	 16			; 00000010H
?DropKanturuMayaHandItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropKanturuMayaHandItem
_TEXT	ENDS
PUBLIC	??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@ ; `string'
PUBLIC	?DropKanturuNightmareItem@CItemBagEx@@QAEHHEEE@Z ; CItemBagEx::DropKanturuNightmareItem
;	COMDAT ??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@
CONST	SEGMENT
??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@ DB '['
	DB	' KANTURU ][ Reward ] Nightmare Item Drop [%s][%s] : (%d)(%d/%'
	DB	'd) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv252 = -128						; size = 4
tv250 = -124						; size = 4
tv247 = -118						; size = 2
_lpObj$ = -52						; size = 4
_iExOption$ = -48					; size = 4
_iDropItemRate$ = -44					; size = 4
_iDropItemNum$ = -40					; size = 4
_iOption3$ = -36					; size = 4
_iOption2$ = -32					; size = 4
_iOption1$ = -28					; size = 4
_Y$ = -24						; size = 4
_X$ = -20						; size = 4
_iLevel$ = -16						; size = 4
_iType$ = -12						; size = 4
_fDur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropKanturuNightmareItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropKanturuNightmareItem
; _this$ = ecx

; 2122 : {

  04940	55		 push	 ebp
  04941	8b ec		 mov	 ebp, esp
  04943	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  04949	53		 push	 ebx
  0494a	56		 push	 esi
  0494b	57		 push	 edi
  0494c	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 2123 : 	if ( this->m_bLoad == FALSE )

  0494f	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  04952	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  04956	75 07		 jne	 SHORT $LN12@DropKantur@2

; 2124 : 		return FALSE;

  04958	33 c0		 xor	 eax, eax
  0495a	e9 83 02 00 00	 jmp	 $LN13@DropKantur@2
$LN12@DropKantur@2:

; 2125 : 
; 2126 : 	float fDur = 0;

  0495f	d9 ee		 fldz
  04961	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2127 : 	int iType = 0;

  04964	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iType$[ebp], 0

; 2128 : 	int iLevel = 0;

  0496b	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 2129 : 	int X = 0;

  04972	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _X$[ebp], 0

; 2130 : 	int Y = 0;

  04979	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _Y$[ebp], 0

; 2131 : 	int iOption1 = 0;

  04980	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 0

; 2132 : 	int iOption2 = 0;

  04987	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2133 : 	int iOption3 = 0;

  0498e	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 0

; 2134 : 	int iDropItemNum = 0;

  04995	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 2135 : 	int iDropItemRate = 0;

  0499c	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _iDropItemRate$[ebp], 0

; 2136 : 	int iExOption = 0;

  049a3	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _iExOption$[ebp], 0

; 2137 : 	LPOBJ lpObj = &gObj[aIndex];

  049aa	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  049ad	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  049b3	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  049b9	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 2138 : 
; 2139 : 	if ( this->GetBagCount() > 0 )

  049bc	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  049bf	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  049c4	85 c0		 test	 eax, eax
  049c6	0f 8e 11 02 00
	00		 jle	 $LN11@DropKantur@2

; 2140 : 	{
; 2141 : 		iDropItemNum = rand()% this->GetBagCount();

  049cc	e8 00 00 00 00	 call	 _rand
  049d1	8b f0		 mov	 esi, eax
  049d3	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  049d6	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  049db	8b c8		 mov	 ecx, eax
  049dd	8b c6		 mov	 eax, esi
  049df	99		 cdq
  049e0	f7 f9		 idiv	 ecx
  049e2	89 55 d8	 mov	 DWORD PTR _iDropItemNum$[ebp], edx

; 2142 : 		fDur = 0;

  049e5	d9 ee		 fldz
  049e7	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2143 : 
; 2144 : 		if ( cX == 0 && cY == 0 )

  049ea	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  049ee	85 c0		 test	 eax, eax
  049f0	75 24		 jne	 SHORT $LN10@DropKantur@2
  049f2	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  049f6	85 c0		 test	 eax, eax
  049f8	75 1c		 jne	 SHORT $LN10@DropKantur@2

; 2145 : 		{
; 2146 : 			X = lpObj->X;

  049fa	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  049fd	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  04a04	89 4d ec	 mov	 DWORD PTR _X$[ebp], ecx

; 2147 : 			Y = lpObj->Y;

  04a07	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04a0a	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  04a11	89 4d e8	 mov	 DWORD PTR _Y$[ebp], ecx

; 2148 : 		}
; 2149 : 		else

  04a14	eb 0e		 jmp	 SHORT $LN9@DropKantur@2
$LN10@DropKantur@2:

; 2150 : 		{
; 2151 : 			X = cX;

  04a16	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  04a1a	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax

; 2152 : 			Y = cY;

  04a1d	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04a21	89 45 e8	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropKantur@2:

; 2153 : 		}
; 2154 : 
; 2155 : 		iLevel = this->GetLevel(iDropItemNum);

  04a24	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04a27	50		 push	 eax
  04a28	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04a2b	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  04a30	0f b6 c8	 movzx	 ecx, al
  04a33	89 4d f0	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 2156 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  04a36	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04a39	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04a3c	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  04a44	52		 push	 edx
  04a45	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04a48	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04a4b	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  04a53	52		 push	 edx
  04a54	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  04a59	83 c4 08	 add	 esp, 8
  04a5c	89 45 f4	 mov	 DWORD PTR _iType$[ebp], eax

; 2157 : 
; 2158 : 		if ( iType == -1 )

  04a5f	83 7d f4 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  04a63	75 07		 jne	 SHORT $LN8@DropKantur@2

; 2159 : 			return FALSE;

  04a65	33 c0		 xor	 eax, eax
  04a67	e9 76 01 00 00	 jmp	 $LN13@DropKantur@2
$LN8@DropKantur@2:

; 2160 : 
; 2161 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  04a6c	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04a6f	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04a72	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  04a7a	85 d2		 test	 edx, edx
  04a7c	74 07		 je	 SHORT $LN7@DropKantur@2

; 2162 : 			iOption1 = 1;

  04a7e	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN7@DropKantur@2:

; 2163 : 
; 2164 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  04a85	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04a88	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04a8b	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  04a93	85 d2		 test	 edx, edx
  04a95	74 23		 je	 SHORT $LN5@DropKantur@2

; 2165 : 		{
; 2166 : 			iOption2 = 0;

  04a97	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2167 : 
; 2168 : 			if ( (rand()%2) == 0 )

  04a9e	e8 00 00 00 00	 call	 _rand
  04aa3	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  04aa8	79 05		 jns	 SHORT $LN15@DropKantur@2
  04aaa	48		 dec	 eax
  04aab	83 c8 fe	 or	 eax, -2			; fffffffeH
  04aae	40		 inc	 eax
$LN15@DropKantur@2:
  04aaf	85 c0		 test	 eax, eax
  04ab1	75 07		 jne	 SHORT $LN5@DropKantur@2

; 2169 : 			{
; 2170 : 				iOption2 = 1;

  04ab3	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN5@DropKantur@2:

; 2171 : 			}
; 2172 : 		}
; 2173 : 
; 2174 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  04aba	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04abd	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04ac0	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  04ac8	85 d2		 test	 edx, edx
  04aca	74 2b		 je	 SHORT $LN2@DropKantur@2

; 2175 : 		{
; 2176 : 			if ( rand()%5 < 1 )

  04acc	e8 00 00 00 00	 call	 _rand
  04ad1	99		 cdq
  04ad2	b9 05 00 00 00	 mov	 ecx, 5
  04ad7	f7 f9		 idiv	 ecx
  04ad9	83 fa 01	 cmp	 edx, 1
  04adc	7d 09		 jge	 SHORT $LN3@DropKantur@2

; 2177 : 			{
; 2178 : 				iOption3 = 3;

  04ade	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2179 : 			}
; 2180 : 			else

  04ae5	eb 10		 jmp	 SHORT $LN2@DropKantur@2
$LN3@DropKantur@2:

; 2181 : 			{
; 2182 : 				iOption3 = rand()%3;

  04ae7	e8 00 00 00 00	 call	 _rand
  04aec	99		 cdq
  04aed	b9 03 00 00 00	 mov	 ecx, 3
  04af2	f7 f9		 idiv	 ecx
  04af4	89 55 dc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropKantur@2:

; 2183 : 			}
; 2184 : 		}
; 2185 : 
; 2186 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  04af7	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04afa	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04afd	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  04b05	85 d2		 test	 edx, edx
  04b07	74 1e		 je	 SHORT $LN1@DropKantur@2

; 2187 : 		{
; 2188 : 			iExOption = NewOptionRand(0);

  04b09	6a 00		 push	 0
  04b0b	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  04b10	83 c4 04	 add	 esp, 4
  04b13	0f b6 c0	 movzx	 eax, al
  04b16	89 45 d0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2189 : #ifndef _FIX_
; 2190 : 			iOption2 = 0;
; 2191 : #endif
; 2192 : 			iOption1 = 1;

  04b19	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2193 : 			iLevel = 0;

  04b20	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN1@DropKantur@2:

; 2194 : 		}
; 2195 : 
; 2196 : 		ItemSerialCreateSend(lpObj->m_Index, (BYTE)btMapNumber, (BYTE)X, (BYTE)Y, iType, (BYTE)iLevel, (BYTE)fDur,
; 2197 : 			(BYTE)iOption1, (BYTE)iOption2, (BYTE)iOption3, lpObj->m_Index, (BYTE)iExOption, 0);

  04b27	6a 00		 push	 0
  04b29	0f b6 45 d0	 movzx	 eax, BYTE PTR _iExOption$[ebp]
  04b2d	50		 push	 eax
  04b2e	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  04b31	8b 11		 mov	 edx, DWORD PTR [ecx]
  04b33	52		 push	 edx
  04b34	0f b6 45 dc	 movzx	 eax, BYTE PTR _iOption3$[ebp]
  04b38	50		 push	 eax
  04b39	0f b6 4d e0	 movzx	 ecx, BYTE PTR _iOption2$[ebp]
  04b3d	51		 push	 ecx
  04b3e	0f b6 55 e4	 movzx	 edx, BYTE PTR _iOption1$[ebp]
  04b42	52		 push	 edx
  04b43	d9 45 f8	 fld	 DWORD PTR _fDur$[ebp]
  04b46	d9 7d 8a	 fnstcw	 WORD PTR tv247[ebp]
  04b49	0f b7 45 8a	 movzx	 eax, WORD PTR tv247[ebp]
  04b4d	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  04b52	89 45 84	 mov	 DWORD PTR tv250[ebp], eax
  04b55	d9 6d 84	 fldcw	 WORD PTR tv250[ebp]
  04b58	db 5d 80	 fistp	 DWORD PTR tv252[ebp]
  04b5b	d9 6d 8a	 fldcw	 WORD PTR tv247[ebp]
  04b5e	0f b6 45 80	 movzx	 eax, BYTE PTR tv252[ebp]
  04b62	50		 push	 eax
  04b63	0f b6 4d f0	 movzx	 ecx, BYTE PTR _iLevel$[ebp]
  04b67	51		 push	 ecx
  04b68	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  04b6b	52		 push	 edx
  04b6c	0f b6 45 e8	 movzx	 eax, BYTE PTR _Y$[ebp]
  04b70	50		 push	 eax
  04b71	0f b6 4d ec	 movzx	 ecx, BYTE PTR _X$[ebp]
  04b75	51		 push	 ecx
  04b76	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  04b7a	52		 push	 edx
  04b7b	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04b7e	8b 08		 mov	 ecx, DWORD PTR [eax]
  04b80	51		 push	 ecx
  04b81	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  04b86	83 c4 34	 add	 esp, 52			; 00000034H

; 2198 : 
; 2199 : 		LogAddTD("[ KANTURU ][ Reward ] Nightmare Item Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2200 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2201 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  04b89	8b 45 d0	 mov	 eax, DWORD PTR _iExOption$[ebp]
  04b8c	50		 push	 eax
  04b8d	8b 4d dc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  04b90	51		 push	 ecx
  04b91	8b 55 e0	 mov	 edx, DWORD PTR _iOption2$[ebp]
  04b94	52		 push	 edx
  04b95	8b 45 e4	 mov	 eax, DWORD PTR _iOption1$[ebp]
  04b98	50		 push	 eax
  04b99	8b 4d f0	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  04b9c	51		 push	 ecx
  04b9d	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  04ba0	52		 push	 edx
  04ba1	8b 45 f4	 mov	 eax, DWORD PTR _iType$[ebp]
  04ba4	6b c0 70	 imul	 eax, 112		; 00000070H
  04ba7	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  04bac	50		 push	 eax
  04bad	8b 4d e8	 mov	 ecx, DWORD PTR _Y$[ebp]
  04bb0	51		 push	 ecx
  04bb1	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  04bb4	52		 push	 edx
  04bb5	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  04bb9	50		 push	 eax
  04bba	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  04bbd	83 c1 77	 add	 ecx, 119		; 00000077H
  04bc0	51		 push	 ecx
  04bc1	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04bc4	83 c2 6c	 add	 edx, 108		; 0000006cH
  04bc7	52		 push	 edx
  04bc8	68 00 00 00 00	 push	 OFFSET ??_C@_0HD@MEBEJHHD@?$FL?5KANTURU?5?$FN?$FL?5Reward?5?$FN?5Nightmare?5@
  04bcd	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04bd3	83 c4 34	 add	 esp, 52			; 00000034H

; 2202 : 
; 2203 : 		return TRUE;

  04bd6	b8 01 00 00 00	 mov	 eax, 1
  04bdb	eb 05		 jmp	 SHORT $LN13@DropKantur@2
$LN11@DropKantur@2:

; 2204 : 	}
; 2205 : 
; 2206 : 	return TRUE;

  04bdd	b8 01 00 00 00	 mov	 eax, 1
$LN13@DropKantur@2:

; 2207 : }

  04be2	5f		 pop	 edi
  04be3	5e		 pop	 esi
  04be4	5b		 pop	 ebx
  04be5	8b e5		 mov	 esp, ebp
  04be7	5d		 pop	 ebp
  04be8	c2 10 00	 ret	 16			; 00000010H
?DropKanturuNightmareItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropKanturuNightmareItem
_TEXT	ENDS
PUBLIC	??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@ ; `string'
PUBLIC	?DropSilverChestItem@CItemBagEx@@QAEHHEEE@Z	; CItemBagEx::DropSilverChestItem
;	COMDAT ??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@
CONST	SEGMENT
??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@ DB '['
	DB	' DOUBLEGOER ][ Reward ] Silver Chest Drop [%s][%s] : (%d)(%d/'
	DB	'%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv252 = -128						; size = 4
tv250 = -124						; size = 4
tv247 = -118						; size = 2
_lpObj$ = -52						; size = 4
_iExOption$ = -48					; size = 4
_iDropItemRate$ = -44					; size = 4
_iDropItemNum$ = -40					; size = 4
_iOption3$ = -36					; size = 4
_iOption2$ = -32					; size = 4
_iOption1$ = -28					; size = 4
_Y$ = -24						; size = 4
_X$ = -20						; size = 4
_iLevel$ = -16						; size = 4
_iType$ = -12						; size = 4
_fDur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropSilverChestItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropSilverChestItem
; _this$ = ecx

; 2211 : {

  04bf0	55		 push	 ebp
  04bf1	8b ec		 mov	 ebp, esp
  04bf3	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  04bf9	53		 push	 ebx
  04bfa	56		 push	 esi
  04bfb	57		 push	 edi
  04bfc	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 2212 : 	if ( this->m_bLoad == FALSE )

  04bff	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  04c02	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  04c06	75 07		 jne	 SHORT $LN12@DropSilver

; 2213 : 		return FALSE;

  04c08	33 c0		 xor	 eax, eax
  04c0a	e9 83 02 00 00	 jmp	 $LN13@DropSilver
$LN12@DropSilver:

; 2214 : 
; 2215 : 	float fDur = 0;

  04c0f	d9 ee		 fldz
  04c11	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2216 : 	int iType = 0;

  04c14	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iType$[ebp], 0

; 2217 : 	int iLevel = 0;

  04c1b	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 2218 : 	int X = 0;

  04c22	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _X$[ebp], 0

; 2219 : 	int Y = 0;

  04c29	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _Y$[ebp], 0

; 2220 : 	int iOption1 = 0;

  04c30	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 0

; 2221 : 	int iOption2 = 0;

  04c37	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2222 : 	int iOption3 = 0;

  04c3e	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 0

; 2223 : 	int iDropItemNum = 0;

  04c45	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 2224 : 	int iDropItemRate = 0;

  04c4c	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _iDropItemRate$[ebp], 0

; 2225 : 	int iExOption = 0;

  04c53	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _iExOption$[ebp], 0

; 2226 : 	LPOBJ lpObj = &gObj[aIndex];

  04c5a	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  04c5d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  04c63	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  04c69	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 2227 : 
; 2228 : 	if ( this->GetBagCount() > 0 )

  04c6c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04c6f	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04c74	85 c0		 test	 eax, eax
  04c76	0f 8e 11 02 00
	00		 jle	 $LN11@DropSilver

; 2229 : 	{
; 2230 : 		iDropItemNum = rand()% this->GetBagCount();

  04c7c	e8 00 00 00 00	 call	 _rand
  04c81	8b f0		 mov	 esi, eax
  04c83	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04c86	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04c8b	8b c8		 mov	 ecx, eax
  04c8d	8b c6		 mov	 eax, esi
  04c8f	99		 cdq
  04c90	f7 f9		 idiv	 ecx
  04c92	89 55 d8	 mov	 DWORD PTR _iDropItemNum$[ebp], edx

; 2231 : 		fDur = 0;

  04c95	d9 ee		 fldz
  04c97	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2232 : 
; 2233 : 		if ( cX == 0 && cY == 0 )

  04c9a	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  04c9e	85 c0		 test	 eax, eax
  04ca0	75 24		 jne	 SHORT $LN10@DropSilver
  04ca2	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04ca6	85 c0		 test	 eax, eax
  04ca8	75 1c		 jne	 SHORT $LN10@DropSilver

; 2234 : 		{
; 2235 : 			X = lpObj->X;

  04caa	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04cad	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  04cb4	89 4d ec	 mov	 DWORD PTR _X$[ebp], ecx

; 2236 : 			Y = lpObj->Y;

  04cb7	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04cba	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  04cc1	89 4d e8	 mov	 DWORD PTR _Y$[ebp], ecx

; 2237 : 		}
; 2238 : 		else

  04cc4	eb 0e		 jmp	 SHORT $LN9@DropSilver
$LN10@DropSilver:

; 2239 : 		{
; 2240 : 			X = cX;

  04cc6	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  04cca	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax

; 2241 : 			Y = cY;

  04ccd	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04cd1	89 45 e8	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropSilver:

; 2242 : 		}
; 2243 : 
; 2244 : 		iLevel = this->GetLevel(iDropItemNum);

  04cd4	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04cd7	50		 push	 eax
  04cd8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04cdb	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  04ce0	0f b6 c8	 movzx	 ecx, al
  04ce3	89 4d f0	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 2245 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  04ce6	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04ce9	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04cec	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  04cf4	52		 push	 edx
  04cf5	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04cf8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04cfb	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  04d03	52		 push	 edx
  04d04	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  04d09	83 c4 08	 add	 esp, 8
  04d0c	89 45 f4	 mov	 DWORD PTR _iType$[ebp], eax

; 2246 : 
; 2247 : 		if ( iType == -1 )

  04d0f	83 7d f4 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  04d13	75 07		 jne	 SHORT $LN8@DropSilver

; 2248 : 			return FALSE;

  04d15	33 c0		 xor	 eax, eax
  04d17	e9 76 01 00 00	 jmp	 $LN13@DropSilver
$LN8@DropSilver:

; 2249 : 
; 2250 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  04d1c	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04d1f	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04d22	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  04d2a	85 d2		 test	 edx, edx
  04d2c	74 07		 je	 SHORT $LN7@DropSilver

; 2251 : 			iOption1 = 1;

  04d2e	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN7@DropSilver:

; 2252 : 
; 2253 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  04d35	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04d38	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04d3b	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  04d43	85 d2		 test	 edx, edx
  04d45	74 23		 je	 SHORT $LN5@DropSilver

; 2254 : 		{
; 2255 : 			iOption2 = 0;

  04d47	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2256 : 
; 2257 : 			if ( (rand()%2) == 0 )

  04d4e	e8 00 00 00 00	 call	 _rand
  04d53	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  04d58	79 05		 jns	 SHORT $LN15@DropSilver
  04d5a	48		 dec	 eax
  04d5b	83 c8 fe	 or	 eax, -2			; fffffffeH
  04d5e	40		 inc	 eax
$LN15@DropSilver:
  04d5f	85 c0		 test	 eax, eax
  04d61	75 07		 jne	 SHORT $LN5@DropSilver

; 2258 : 			{
; 2259 : 				iOption2 = 1;

  04d63	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN5@DropSilver:

; 2260 : 			}
; 2261 : 		}
; 2262 : 
; 2263 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  04d6a	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04d6d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04d70	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  04d78	85 d2		 test	 edx, edx
  04d7a	74 2b		 je	 SHORT $LN2@DropSilver

; 2264 : 		{
; 2265 : 			if ( rand()%5 < 1 )

  04d7c	e8 00 00 00 00	 call	 _rand
  04d81	99		 cdq
  04d82	b9 05 00 00 00	 mov	 ecx, 5
  04d87	f7 f9		 idiv	 ecx
  04d89	83 fa 01	 cmp	 edx, 1
  04d8c	7d 09		 jge	 SHORT $LN3@DropSilver

; 2266 : 			{
; 2267 : 				iOption3 = 3;

  04d8e	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2268 : 			}
; 2269 : 			else

  04d95	eb 10		 jmp	 SHORT $LN2@DropSilver
$LN3@DropSilver:

; 2270 : 			{
; 2271 : 				iOption3 = rand()%3;

  04d97	e8 00 00 00 00	 call	 _rand
  04d9c	99		 cdq
  04d9d	b9 03 00 00 00	 mov	 ecx, 3
  04da2	f7 f9		 idiv	 ecx
  04da4	89 55 dc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropSilver:

; 2272 : 			}
; 2273 : 		}
; 2274 : 
; 2275 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  04da7	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04daa	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04dad	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  04db5	85 d2		 test	 edx, edx
  04db7	74 1e		 je	 SHORT $LN1@DropSilver

; 2276 : 		{
; 2277 : 			iExOption = NewOptionRand(0);

  04db9	6a 00		 push	 0
  04dbb	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  04dc0	83 c4 04	 add	 esp, 4
  04dc3	0f b6 c0	 movzx	 eax, al
  04dc6	89 45 d0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2278 : #ifndef _FIX_
; 2279 : 			iOption2 = 0;
; 2280 : #endif
; 2281 : 			iOption1 = 1;

  04dc9	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2282 : 			iLevel = 0;

  04dd0	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN1@DropSilver:

; 2283 : 		}
; 2284 : 
; 2285 : 		ItemSerialCreateSend(lpObj->m_Index, btMapNumber, X, Y, iType, iLevel, fDur,
; 2286 : 			iOption1, iOption2, iOption3, lpObj->m_Index, iExOption, 0);

  04dd7	6a 00		 push	 0
  04dd9	0f b6 45 d0	 movzx	 eax, BYTE PTR _iExOption$[ebp]
  04ddd	50		 push	 eax
  04dde	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  04de1	8b 11		 mov	 edx, DWORD PTR [ecx]
  04de3	52		 push	 edx
  04de4	0f b6 45 dc	 movzx	 eax, BYTE PTR _iOption3$[ebp]
  04de8	50		 push	 eax
  04de9	0f b6 4d e0	 movzx	 ecx, BYTE PTR _iOption2$[ebp]
  04ded	51		 push	 ecx
  04dee	0f b6 55 e4	 movzx	 edx, BYTE PTR _iOption1$[ebp]
  04df2	52		 push	 edx
  04df3	d9 45 f8	 fld	 DWORD PTR _fDur$[ebp]
  04df6	d9 7d 8a	 fnstcw	 WORD PTR tv247[ebp]
  04df9	0f b7 45 8a	 movzx	 eax, WORD PTR tv247[ebp]
  04dfd	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  04e02	89 45 84	 mov	 DWORD PTR tv250[ebp], eax
  04e05	d9 6d 84	 fldcw	 WORD PTR tv250[ebp]
  04e08	db 5d 80	 fistp	 DWORD PTR tv252[ebp]
  04e0b	d9 6d 8a	 fldcw	 WORD PTR tv247[ebp]
  04e0e	0f b6 45 80	 movzx	 eax, BYTE PTR tv252[ebp]
  04e12	50		 push	 eax
  04e13	0f b6 4d f0	 movzx	 ecx, BYTE PTR _iLevel$[ebp]
  04e17	51		 push	 ecx
  04e18	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  04e1b	52		 push	 edx
  04e1c	0f b6 45 e8	 movzx	 eax, BYTE PTR _Y$[ebp]
  04e20	50		 push	 eax
  04e21	0f b6 4d ec	 movzx	 ecx, BYTE PTR _X$[ebp]
  04e25	51		 push	 ecx
  04e26	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  04e2a	52		 push	 edx
  04e2b	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04e2e	8b 08		 mov	 ecx, DWORD PTR [eax]
  04e30	51		 push	 ecx
  04e31	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  04e36	83 c4 34	 add	 esp, 52			; 00000034H

; 2287 : 
; 2288 : 		LogAddTD("[ DOUBLEGOER ][ Reward ] Silver Chest Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2289 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2290 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  04e39	8b 45 d0	 mov	 eax, DWORD PTR _iExOption$[ebp]
  04e3c	50		 push	 eax
  04e3d	8b 4d dc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  04e40	51		 push	 ecx
  04e41	8b 55 e0	 mov	 edx, DWORD PTR _iOption2$[ebp]
  04e44	52		 push	 edx
  04e45	8b 45 e4	 mov	 eax, DWORD PTR _iOption1$[ebp]
  04e48	50		 push	 eax
  04e49	8b 4d f0	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  04e4c	51		 push	 ecx
  04e4d	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  04e50	52		 push	 edx
  04e51	8b 45 f4	 mov	 eax, DWORD PTR _iType$[ebp]
  04e54	6b c0 70	 imul	 eax, 112		; 00000070H
  04e57	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  04e5c	50		 push	 eax
  04e5d	8b 4d e8	 mov	 ecx, DWORD PTR _Y$[ebp]
  04e60	51		 push	 ecx
  04e61	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  04e64	52		 push	 edx
  04e65	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  04e69	50		 push	 eax
  04e6a	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  04e6d	83 c1 77	 add	 ecx, 119		; 00000077H
  04e70	51		 push	 ecx
  04e71	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  04e74	83 c2 6c	 add	 edx, 108		; 0000006cH
  04e77	52		 push	 edx
  04e78	68 00 00 00 00	 push	 OFFSET ??_C@_0HE@PLDIECFP@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Silver?5@
  04e7d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  04e83	83 c4 34	 add	 esp, 52			; 00000034H

; 2291 : 
; 2292 : 		return TRUE;

  04e86	b8 01 00 00 00	 mov	 eax, 1
  04e8b	eb 05		 jmp	 SHORT $LN13@DropSilver
$LN11@DropSilver:

; 2293 : 	}
; 2294 : 
; 2295 : 	return TRUE;

  04e8d	b8 01 00 00 00	 mov	 eax, 1
$LN13@DropSilver:

; 2296 : }

  04e92	5f		 pop	 edi
  04e93	5e		 pop	 esi
  04e94	5b		 pop	 ebx
  04e95	8b e5		 mov	 esp, ebp
  04e97	5d		 pop	 ebp
  04e98	c2 10 00	 ret	 16			; 00000010H
?DropSilverChestItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropSilverChestItem
_TEXT	ENDS
PUBLIC	??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@ ; `string'
PUBLIC	?DropGoldenChestItem@CItemBagEx@@QAEHHEEE@Z	; CItemBagEx::DropGoldenChestItem
;	COMDAT ??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@
CONST	SEGMENT
??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@ DB '['
	DB	' DOUBLEGOER ][ Reward ] Golden Chest Drop [%s][%s] : (%d)(%d/'
	DB	'%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d', 00H ; `string'
; Function compile flags: /Odtp /ZI
CONST	ENDS
_TEXT	SEGMENT
tv252 = -128						; size = 4
tv250 = -124						; size = 4
tv247 = -118						; size = 2
_lpObj$ = -52						; size = 4
_iExOption$ = -48					; size = 4
_iDropItemRate$ = -44					; size = 4
_iDropItemNum$ = -40					; size = 4
_iOption3$ = -36					; size = 4
_iOption2$ = -32					; size = 4
_iOption1$ = -28					; size = 4
_Y$ = -24						; size = 4
_X$ = -20						; size = 4
_iLevel$ = -16						; size = 4
_iType$ = -12						; size = 4
_fDur$ = -8						; size = 4
_this$ = -4						; size = 4
_aIndex$ = 8						; size = 4
_btMapNumber$ = 12					; size = 1
_cX$ = 16						; size = 1
_cY$ = 20						; size = 1
?DropGoldenChestItem@CItemBagEx@@QAEHHEEE@Z PROC	; CItemBagEx::DropGoldenChestItem
; _this$ = ecx

; 2299 : {

  04ea0	55		 push	 ebp
  04ea1	8b ec		 mov	 ebp, esp
  04ea3	81 ec 80 00 00
	00		 sub	 esp, 128		; 00000080H
  04ea9	53		 push	 ebx
  04eaa	56		 push	 esi
  04eab	57		 push	 edi
  04eac	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx

; 2300 : 	if ( this->m_bLoad == FALSE )

  04eaf	8b 45 fc	 mov	 eax, DWORD PTR _this$[ebp]
  04eb2	83 78 04 00	 cmp	 DWORD PTR [eax+4], 0
  04eb6	75 07		 jne	 SHORT $LN12@DropGolden

; 2301 : 		return FALSE;

  04eb8	33 c0		 xor	 eax, eax
  04eba	e9 83 02 00 00	 jmp	 $LN13@DropGolden
$LN12@DropGolden:

; 2302 : 
; 2303 : 	float fDur = 0;

  04ebf	d9 ee		 fldz
  04ec1	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2304 : 	int iType = 0;

  04ec4	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _iType$[ebp], 0

; 2305 : 	int iLevel = 0;

  04ecb	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0

; 2306 : 	int X = 0;

  04ed2	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _X$[ebp], 0

; 2307 : 	int Y = 0;

  04ed9	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _Y$[ebp], 0

; 2308 : 	int iOption1 = 0;

  04ee0	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 0

; 2309 : 	int iOption2 = 0;

  04ee7	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2310 : 	int iOption3 = 0;

  04eee	c7 45 dc 00 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 0

; 2311 : 	int iDropItemNum = 0;

  04ef5	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _iDropItemNum$[ebp], 0

; 2312 : 	int iDropItemRate = 0;

  04efc	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _iDropItemRate$[ebp], 0

; 2313 : 	int iExOption = 0;

  04f03	c7 45 d0 00 00
	00 00		 mov	 DWORD PTR _iExOption$[ebp], 0

; 2314 : 	LPOBJ lpObj = &gObj[aIndex];

  04f0a	8b 45 08	 mov	 eax, DWORD PTR _aIndex$[ebp]
  04f0d	69 c0 38 2b 00
	00		 imul	 eax, 11064		; 00002b38H
  04f13	03 05 00 00 00
	00		 add	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  04f19	89 45 cc	 mov	 DWORD PTR _lpObj$[ebp], eax

; 2315 : 
; 2316 : 	if ( this->GetBagCount() > 0 )

  04f1c	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04f1f	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04f24	85 c0		 test	 eax, eax
  04f26	0f 8e 11 02 00
	00		 jle	 $LN11@DropGolden

; 2317 : 	{
; 2318 : 		iDropItemNum = rand()% this->GetBagCount();

  04f2c	e8 00 00 00 00	 call	 _rand
  04f31	8b f0		 mov	 esi, eax
  04f33	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04f36	e8 00 00 00 00	 call	 ?GetBagCount@CItemBagEx@@AAEHXZ ; CItemBagEx::GetBagCount
  04f3b	8b c8		 mov	 ecx, eax
  04f3d	8b c6		 mov	 eax, esi
  04f3f	99		 cdq
  04f40	f7 f9		 idiv	 ecx
  04f42	89 55 d8	 mov	 DWORD PTR _iDropItemNum$[ebp], edx

; 2319 : 		fDur = 0;

  04f45	d9 ee		 fldz
  04f47	d9 5d f8	 fstp	 DWORD PTR _fDur$[ebp]

; 2320 : 
; 2321 : 		if ( cX == 0 && cY == 0 )

  04f4a	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  04f4e	85 c0		 test	 eax, eax
  04f50	75 24		 jne	 SHORT $LN10@DropGolden
  04f52	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04f56	85 c0		 test	 eax, eax
  04f58	75 1c		 jne	 SHORT $LN10@DropGolden

; 2322 : 		{
; 2323 : 			X = lpObj->X;

  04f5a	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04f5d	0f bf 88 44 01
	00 00		 movsx	 ecx, WORD PTR [eax+324]
  04f64	89 4d ec	 mov	 DWORD PTR _X$[ebp], ecx

; 2324 : 			Y = lpObj->Y;

  04f67	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  04f6a	0f bf 88 46 01
	00 00		 movsx	 ecx, WORD PTR [eax+326]
  04f71	89 4d e8	 mov	 DWORD PTR _Y$[ebp], ecx

; 2325 : 		}
; 2326 : 		else

  04f74	eb 0e		 jmp	 SHORT $LN9@DropGolden
$LN10@DropGolden:

; 2327 : 		{
; 2328 : 			X = cX;

  04f76	0f b6 45 10	 movzx	 eax, BYTE PTR _cX$[ebp]
  04f7a	89 45 ec	 mov	 DWORD PTR _X$[ebp], eax

; 2329 : 			Y = cY;

  04f7d	0f b6 45 14	 movzx	 eax, BYTE PTR _cY$[ebp]
  04f81	89 45 e8	 mov	 DWORD PTR _Y$[ebp], eax
$LN9@DropGolden:

; 2330 : 		}
; 2331 : 
; 2332 : 		iLevel = this->GetLevel(iDropItemNum);

  04f84	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04f87	50		 push	 eax
  04f88	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04f8b	e8 00 00 00 00	 call	 ?GetLevel@CItemBagEx@@AAEEH@Z ; CItemBagEx::GetLevel
  04f90	0f b6 c8	 movzx	 ecx, al
  04f93	89 4d f0	 mov	 DWORD PTR _iLevel$[ebp], ecx

; 2333 : 		iType = ItemGetNumberMake(this->BagObject[iDropItemNum].m_type, this->BagObject[iDropItemNum].m_index);

  04f96	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04f99	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04f9c	0f b6 94 c1 33
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+563]
  04fa4	52		 push	 edx
  04fa5	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04fa8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04fab	0f b6 94 c1 32
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+562]
  04fb3	52		 push	 edx
  04fb4	e8 00 00 00 00	 call	 ?ItemGetNumberMake@@YAHHH@Z ; ItemGetNumberMake
  04fb9	83 c4 08	 add	 esp, 8
  04fbc	89 45 f4	 mov	 DWORD PTR _iType$[ebp], eax

; 2334 : 
; 2335 : 		if ( iType == -1 )

  04fbf	83 7d f4 ff	 cmp	 DWORD PTR _iType$[ebp], -1
  04fc3	75 07		 jne	 SHORT $LN8@DropGolden

; 2336 : 			return FALSE;

  04fc5	33 c0		 xor	 eax, eax
  04fc7	e9 76 01 00 00	 jmp	 $LN13@DropGolden
$LN8@DropGolden:

; 2337 : 
; 2338 : 		if ( this->BagObject[iDropItemNum].m_isskill )

  04fcc	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04fcf	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04fd2	0f b6 94 c1 36
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+566]
  04fda	85 d2		 test	 edx, edx
  04fdc	74 07		 je	 SHORT $LN7@DropGolden

; 2339 : 			iOption1 = 1;

  04fde	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1
$LN7@DropGolden:

; 2340 : 
; 2341 : 		if ( this->BagObject[iDropItemNum].m_isluck )

  04fe5	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  04fe8	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  04feb	0f b6 94 c1 37
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+567]
  04ff3	85 d2		 test	 edx, edx
  04ff5	74 23		 je	 SHORT $LN5@DropGolden

; 2342 : 		{
; 2343 : 			iOption2 = 0;

  04ff7	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 0

; 2344 : 
; 2345 : 			if ( (rand()%2) == 0 )

  04ffe	e8 00 00 00 00	 call	 _rand
  05003	25 01 00 00 80	 and	 eax, -2147483647	; 80000001H
  05008	79 05		 jns	 SHORT $LN15@DropGolden
  0500a	48		 dec	 eax
  0500b	83 c8 fe	 or	 eax, -2			; fffffffeH
  0500e	40		 inc	 eax
$LN15@DropGolden:
  0500f	85 c0		 test	 eax, eax
  05011	75 07		 jne	 SHORT $LN5@DropGolden

; 2346 : 			{
; 2347 : 				iOption2 = 1;

  05013	c7 45 e0 01 00
	00 00		 mov	 DWORD PTR _iOption2$[ebp], 1
$LN5@DropGolden:

; 2348 : 			}
; 2349 : 		}
; 2350 : 
; 2351 : 		if ( this->BagObject[iDropItemNum].m_isoption != 0 )

  0501a	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0501d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  05020	0f b6 94 c1 38
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+568]
  05028	85 d2		 test	 edx, edx
  0502a	74 2b		 je	 SHORT $LN2@DropGolden

; 2352 : 		{
; 2353 : 			if ( rand()%5 < 1 )

  0502c	e8 00 00 00 00	 call	 _rand
  05031	99		 cdq
  05032	b9 05 00 00 00	 mov	 ecx, 5
  05037	f7 f9		 idiv	 ecx
  05039	83 fa 01	 cmp	 edx, 1
  0503c	7d 09		 jge	 SHORT $LN3@DropGolden

; 2354 : 			{
; 2355 : 				iOption3 = 3;

  0503e	c7 45 dc 03 00
	00 00		 mov	 DWORD PTR _iOption3$[ebp], 3

; 2356 : 			}
; 2357 : 			else

  05045	eb 10		 jmp	 SHORT $LN2@DropGolden
$LN3@DropGolden:

; 2358 : 			{
; 2359 : 				iOption3 = rand()%3;

  05047	e8 00 00 00 00	 call	 _rand
  0504c	99		 cdq
  0504d	b9 03 00 00 00	 mov	 ecx, 3
  05052	f7 f9		 idiv	 ecx
  05054	89 55 dc	 mov	 DWORD PTR _iOption3$[ebp], edx
$LN2@DropGolden:

; 2360 : 			}
; 2361 : 		}
; 2362 : 
; 2363 : 		if ( this->BagObject[iDropItemNum].m_isexitem != 0 )

  05057	8b 45 d8	 mov	 eax, DWORD PTR _iDropItemNum$[ebp]
  0505a	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0505d	0f b6 94 c1 39
	02 00 00	 movzx	 edx, BYTE PTR [ecx+eax*8+569]
  05065	85 d2		 test	 edx, edx
  05067	74 1e		 je	 SHORT $LN1@DropGolden

; 2364 : 		{
; 2365 : 			iExOption = NewOptionRand(0);

  05069	6a 00		 push	 0
  0506b	e8 00 00 00 00	 call	 ?NewOptionRand@@YAEH@Z	; NewOptionRand
  05070	83 c4 04	 add	 esp, 4
  05073	0f b6 c0	 movzx	 eax, al
  05076	89 45 d0	 mov	 DWORD PTR _iExOption$[ebp], eax

; 2366 : #ifndef _FIX_
; 2367 : 			iOption2 = 0;
; 2368 : #endif
; 2369 : 			iOption1 = 1;

  05079	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _iOption1$[ebp], 1

; 2370 : 			iLevel = 0;

  05080	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _iLevel$[ebp], 0
$LN1@DropGolden:

; 2371 : 		}
; 2372 : 
; 2373 : 		ItemSerialCreateSend(lpObj->m_Index, btMapNumber, X, Y, iType, iLevel, fDur,
; 2374 : 			iOption1, iOption2, iOption3, lpObj->m_Index, iExOption, 0);

  05087	6a 00		 push	 0
  05089	0f b6 45 d0	 movzx	 eax, BYTE PTR _iExOption$[ebp]
  0508d	50		 push	 eax
  0508e	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  05091	8b 11		 mov	 edx, DWORD PTR [ecx]
  05093	52		 push	 edx
  05094	0f b6 45 dc	 movzx	 eax, BYTE PTR _iOption3$[ebp]
  05098	50		 push	 eax
  05099	0f b6 4d e0	 movzx	 ecx, BYTE PTR _iOption2$[ebp]
  0509d	51		 push	 ecx
  0509e	0f b6 55 e4	 movzx	 edx, BYTE PTR _iOption1$[ebp]
  050a2	52		 push	 edx
  050a3	d9 45 f8	 fld	 DWORD PTR _fDur$[ebp]
  050a6	d9 7d 8a	 fnstcw	 WORD PTR tv247[ebp]
  050a9	0f b7 45 8a	 movzx	 eax, WORD PTR tv247[ebp]
  050ad	0d 00 0c 00 00	 or	 eax, 3072		; 00000c00H
  050b2	89 45 84	 mov	 DWORD PTR tv250[ebp], eax
  050b5	d9 6d 84	 fldcw	 WORD PTR tv250[ebp]
  050b8	db 5d 80	 fistp	 DWORD PTR tv252[ebp]
  050bb	d9 6d 8a	 fldcw	 WORD PTR tv247[ebp]
  050be	0f b6 45 80	 movzx	 eax, BYTE PTR tv252[ebp]
  050c2	50		 push	 eax
  050c3	0f b6 4d f0	 movzx	 ecx, BYTE PTR _iLevel$[ebp]
  050c7	51		 push	 ecx
  050c8	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  050cb	52		 push	 edx
  050cc	0f b6 45 e8	 movzx	 eax, BYTE PTR _Y$[ebp]
  050d0	50		 push	 eax
  050d1	0f b6 4d ec	 movzx	 ecx, BYTE PTR _X$[ebp]
  050d5	51		 push	 ecx
  050d6	0f b6 55 0c	 movzx	 edx, BYTE PTR _btMapNumber$[ebp]
  050da	52		 push	 edx
  050db	8b 45 cc	 mov	 eax, DWORD PTR _lpObj$[ebp]
  050de	8b 08		 mov	 ecx, DWORD PTR [eax]
  050e0	51		 push	 ecx
  050e1	e8 00 00 00 00	 call	 ?ItemSerialCreateSend@@YAXHEEEHEEEEEHEE@Z ; ItemSerialCreateSend
  050e6	83 c4 34	 add	 esp, 52			; 00000034H

; 2375 : 
; 2376 : 		LogAddTD("[ DOUBLEGOER ][ Reward ] Golden Chest Drop [%s][%s] : (%d)(%d/%d) Item:(%s)%d Level:%d op1:%d op2:%d op3:%d ExOp:%d",
; 2377 : 			lpObj->AccountID, lpObj->Name, btMapNumber, X, Y, ItemAttribute[iType].Name,
; 2378 : 			iType, iLevel, iOption1, iOption2, iOption3, iExOption);

  050e9	8b 45 d0	 mov	 eax, DWORD PTR _iExOption$[ebp]
  050ec	50		 push	 eax
  050ed	8b 4d dc	 mov	 ecx, DWORD PTR _iOption3$[ebp]
  050f0	51		 push	 ecx
  050f1	8b 55 e0	 mov	 edx, DWORD PTR _iOption2$[ebp]
  050f4	52		 push	 edx
  050f5	8b 45 e4	 mov	 eax, DWORD PTR _iOption1$[ebp]
  050f8	50		 push	 eax
  050f9	8b 4d f0	 mov	 ecx, DWORD PTR _iLevel$[ebp]
  050fc	51		 push	 ecx
  050fd	8b 55 f4	 mov	 edx, DWORD PTR _iType$[ebp]
  05100	52		 push	 edx
  05101	8b 45 f4	 mov	 eax, DWORD PTR _iType$[ebp]
  05104	6b c0 70	 imul	 eax, 112		; 00000070H
  05107	05 00 00 00 00	 add	 eax, OFFSET ?ItemAttribute@@3PAUITEM_ATTRIBUTE@@A ; ItemAttribute
  0510c	50		 push	 eax
  0510d	8b 4d e8	 mov	 ecx, DWORD PTR _Y$[ebp]
  05110	51		 push	 ecx
  05111	8b 55 ec	 mov	 edx, DWORD PTR _X$[ebp]
  05114	52		 push	 edx
  05115	0f b6 45 0c	 movzx	 eax, BYTE PTR _btMapNumber$[ebp]
  05119	50		 push	 eax
  0511a	8b 4d cc	 mov	 ecx, DWORD PTR _lpObj$[ebp]
  0511d	83 c1 77	 add	 ecx, 119		; 00000077H
  05120	51		 push	 ecx
  05121	8b 55 cc	 mov	 edx, DWORD PTR _lpObj$[ebp]
  05124	83 c2 6c	 add	 edx, 108		; 0000006cH
  05127	52		 push	 edx
  05128	68 00 00 00 00	 push	 OFFSET ??_C@_0HE@BPPBJCGL@?$FL?5DOUBLEGOER?5?$FN?$FL?5Reward?5?$FN?5Golden?5@
  0512d	ff 15 00 00 00
	00		 call	 DWORD PTR ?LogAddTD@@3P6AXPADZZA ; LogAddTD
  05133	83 c4 34	 add	 esp, 52			; 00000034H

; 2379 : 
; 2380 : 		return TRUE;

  05136	b8 01 00 00 00	 mov	 eax, 1
  0513b	eb 05		 jmp	 SHORT $LN13@DropGolden
$LN11@DropGolden:

; 2381 : 	}
; 2382 : 
; 2383 : 	return TRUE;

  0513d	b8 01 00 00 00	 mov	 eax, 1
$LN13@DropGolden:

; 2384 : }

  05142	5f		 pop	 edi
  05143	5e		 pop	 esi
  05144	5b		 pop	 ebx
  05145	8b e5		 mov	 esp, ebp
  05147	5d		 pop	 ebp
  05148	c2 10 00	 ret	 16			; 00000010H
?DropGoldenChestItem@CItemBagEx@@QAEHHEEE@Z ENDP	; CItemBagEx::DropGoldenChestItem
_TEXT	ENDS
END
